
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Algebraic diagrammatic construction &#8212; Computational Chemistry from  Laptop to HPC</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exciton coupling model" href="excoupl.html" />
    <link rel="prev" title="SCF states" href="scf-response.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Chemistry from  Laptop to HPC</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Getting started
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials and workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="uv-vis.html">
   UV/vis absorption/emission
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reactivity.html">
   Catalysis and reactivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dichroism.html">
   Optical activity and dichroism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vibrational.html">
   Vibrational spectroscopies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="transmetal.html">
   Transition metals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="magnetic.html">
   Magnetic resonances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nlo.html">
   Multi-photon interactions
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="xray.html">
   X-ray spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_calc.html">
     Calculating spectra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_analysis.html">
     Two-step approach with TDDFT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_topics.html">
     Special topics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_large.html">
     Consider large systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_rec.html">
     General recommendations
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Electronic structure theory
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="elecstruct-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="orbitals.html">
     Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basis.html">
     Basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="slater.html">
     Slater determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="secondquant.html">
     Second quantization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="wft.html">
   Wave function theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="wft-general.html">
     General aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ci.html">
     Configuration interaction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mp2.html">
     Møller–Plesset
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dft.html">
   Density functional theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hohenberg.html">
     Hohenberg–Kohn theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kohn-sham.html">
     Kohn–Sham method
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Potential energy surfaces
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="pes-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="coordinates.html">
     Choice of coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gradhess.html">
     Gradients and Hessians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="forcefields.html">
     Force fields
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="structopt.html">
   Molecular structure optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tst.html">
   Transition-state theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="conint.html">
   Conical intersection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="moldyn.html">
   Molecular dynamics
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Properties
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="response.html">
   Response theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="exact-response.html">
     Exact states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="scf-response.html">
     SCF states
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Algebraic diagrammatic construction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="excoupl.html">
   Exciton coupling model
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="pe.html">
   Polarizable embedding
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Visualization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="visual-orbitals.html">
   Molecular orbitals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visual-densities.html">
   Reduced particle densities
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/adc.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdocs/adc.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#intermediate-state-representation">
   Intermediate state representation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#core-valence-separation">
   Core–valence separation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#large-scale-calculations">
   Large-scale calculations
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="algebraic-diagrammatic-construction">
<h1>Algebraic diagrammatic construction<a class="headerlink" href="#algebraic-diagrammatic-construction" title="Permalink to this headline">¶</a></h1>
<p>The algebraic diagrammatic construction (ADC) scheme for the polarization propagator is a method to describe excited states and related properties based on the Møller-Plesset perturbation theory partition of the Hamiltonian <span id="id1">[<a class="reference internal" href="intro.html#id44">DW15</a>]</span>. The original derivation of ADC is related to many-body Green’s function theory and relies on the perturbation series expansion of the polarization propagator <span id="id2">[<a class="reference internal" href="intro.html#id44">DW15</a>]</span>. This propagator describes how a perturbation of the electron density propagates through a system of interacting electrons. Such a process can be imagined as a sequence of excitation and de-excitation events, captured in the following spectral representation <span id="id3">[<a class="reference internal" href="intro.html#id43">Sch82</a>, <a class="reference internal" href="intro.html#id51">Wor09</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-ph-propagator">
<span class="eqno">(122)<a class="headerlink" href="#equation-eq-ph-propagator" title="Permalink to this equation">¶</a></span>\[\Pi_{pq,rs}(\omega)=\frac{1}{\hbar}\sum_{n&gt;0}\left(\frac{\bra{0}\hat{a}_q^\dagger\hat{a}_p\ket{n}\bra{n}\hat{a}_r^\dagger\hat{a}_s\ket{0}}{\omega-\omega_{n0}+i\gamma_n}+\frac{\bra{0}\hat{a}_r^\dagger\hat{a}_s\ket{n}\bra{n}\hat{a}_q^\dagger\hat{a}_p\ket{0}}{-\omega-\omega_{n0}-i\gamma_n}\right)\,,%=\Pi_{+}(\omega)+\Pi_{-}(\omega)\, ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\hbar\)</span> is the reduced Planck constant, <span class="math notranslate nohighlight">\(\hat{a}_p\)</span> and <span class="math notranslate nohighlight">\(\hat{a}_q^\dagger\)</span> are the annihilation and, respectively, creation operators, acting on single-electron states <span class="math notranslate nohighlight">\(\chi_p\)</span>, respectively, <span class="math notranslate nohighlight">\(\chi_q\)</span> of the many-body ground state <span class="math notranslate nohighlight">\(\ket{0}\)</span>, or excited state <span class="math notranslate nohighlight">\(\ket{n}\)</span>. The summation is over all electronically excited states <span class="math notranslate nohighlight">\(\ket{n}\)</span>, <span class="math notranslate nohighlight">\(\omega_{n0}=(E_n-E_0)/\hbar\)</span> is the angular frequency corresponding to the total energy difference between the excited state and the ground state, and <span class="math notranslate nohighlight">\(\gamma_n\)</span> is the half-width broadening corresponding to the lifetime of the excited state <span class="math notranslate nohighlight">\(\ket{n}\)</span>.</p>
<div class="margin-caption figure align-default" id="fig-propagator">
<a class="reference internal image-reference" href="../_images/propagator.svg"><img alt="../_images/propagator.svg" height="260" src="../_images/propagator.svg" width="612" /></a>
<p class="caption"><span class="caption-number">Fig. 16 </span><span class="caption-text">Illustration of the propagation of an excitation in a many-electron system (inspired from Ref. <span id="id4">[<a class="reference internal" href="intro.html#id64">Mat92</a>]</span>): (a) a particle-hole pair is created by photon absorption; (b) the pair propagates through the system; (c) the particle and hole interact (the interaction is marked by a wiggly line); (d) the particle interacts with another particle in the system, lifting it out of its place and creating a new particle-hole pair (excitation); (e) the particle interacts with the lifted-out particle and knocks it back into the hole (de-excitation); (f) the particle and hole recombine and emit a photon. (g) Illustration of the series expansion of the polarization propagator (adapted from <span id="id5">[<a class="reference internal" href="intro.html#id51">Wor09</a>]</span>).</span><a class="headerlink" href="#fig-propagator" title="Permalink to this image">¶</a></p>
</div>
<p>A few of the possible excitation and de-excitation pathways are schematically illustrated in <a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>. A photon is absorbed by the system, creating an electron-hole pair (<a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>a). The electron and hole propagate through the system (<a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>b) interacting with each other and with other particles (<a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>c, d, e). These interactions produce second-order excitations (<a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>d) and de-excitations <a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>e). The system returns to the ground state when, for example, a photon is emitted (<a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>f).</p>
<p>The poles and residues of the polarization propagator described by Eq. <a class="reference internal" href="#equation-eq-ph-propagator">(122)</a> represent excitation energies and transition amplitudes, respectively. One possible strategy to determine these quantities is to expand <span class="math notranslate nohighlight">\(\Pi_{pq,rs}\)</span> in a time-dependent perturbation series based on a Hamiltonian partitioned in the same way as was done for the Møller–Plesset ground-state. This expansion is also called a diagrammatic expansion because each term in the series can be represented by a Feynman diagram (<a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>). For example, the zeroth order term corresponds to non-interacting particles that propagate freely and is depicted by a diagram consisting of two parallel lines, one representing the particle (arrow pointing up) and the other representing the hole (arrow pointing down). This diagram corresponds to the situation depicted in <a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>b of a particle and hole propagating through the system without any further interactions. The first order term introduces direct Coulomb and exchange interactions between the particle and hole (<a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>c), while second order terms introduce interactions with a particle-hole pair generated by the initial particle and/or hole.</p>
<p>By truncating the series expansion of the polarization propagator to a desired order, different levels of ADC are obtained. The practical way to obtain the excitation energies and vectors is to assert that there is a non-diagonal matrix representation of the polarization propagator, construct this matrix, called the ADC matrix, and obtain the excitation energies and vectors via matrix diagonalization <span id="id6">[<a class="reference internal" href="intro.html#id44">DW15</a>]</span>. The ADC matrix elements can be deduced with the help of the Feynman diagrams in <a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>g (see a detailed derivation in Ref. <span id="id7">[<a class="reference internal" href="intro.html#id51">Wor09</a>]</span>, or via an alternative formulation of the ADC equations called the intermediate state representation (ISR), discussed in detail below.</p>
<div class="section" id="intermediate-state-representation">
<h2>Intermediate state representation<a class="headerlink" href="#intermediate-state-representation" title="Permalink to this headline">¶</a></h2>
<p>As the name suggest, the intermediate state representation (ISR) approach consists in constructing the ADC matrix with the help of intermediate states <span class="math notranslate nohighlight">\(\ket{\tilde{\psi}_I}\)</span>. These are obtained by applying excitation operators to the ground state <span class="math notranslate nohighlight">\(\ket{0}\)</span>. In second quantization, the excitation operator is written as <span class="math notranslate nohighlight">\(\hat{C}_I=\{ \hat{a}_a^\dagger\hat{a}_i;\hat{a}_a^\dagger\hat{a}_b^\dagger\hat{a}_i\hat{a}_j;... \}\)</span>, where the indices <span class="math notranslate nohighlight">\(a,b...\)</span> refer to unoccupied orbitals, while <span class="math notranslate nohighlight">\(i,j...\)</span> represent occupied orbitals <span id="id8">[<a class="reference internal" href="intro.html#id45">MS96</a>, <a class="reference internal" href="intro.html#id47">ST04</a>, <a class="reference internal" href="intro.html#id46">Sch91</a>]</span>. Schematic representations of single and double excitations, which are the only two excitation classes that are needed for ADC orders up to ADC(3), are depicted in <a class="reference internal" href="#fig-isr"><span class="std std-numref">Fig. 17</span></a>a and <a class="reference internal" href="#fig-isr"><span class="std std-numref">Fig. 17</span></a>b, respectively.</p>
<div class="margin-caption figure align-default" id="fig-isr">
<a class="reference internal image-reference" href="../_images/isr_adc_matrix.svg"><img alt="../_images/isr_adc_matrix.svg" height="238" src="../_images/isr_adc_matrix.svg" width="483" /></a>
<p class="caption"><span class="caption-number">Fig. 17 </span><span class="caption-text">Illustration of (a) single excitations, (b) double excitations, (c) the structure of the ADC(2) matrix. The numbers in parenthesis indicate the highest order of perturbation theory used to describe each particular block.</span><a class="headerlink" href="#fig-isr" title="Permalink to this image">¶</a></p>
</div>
<p>The intermediate states <span class="math notranslate nohighlight">\(\ket{\tilde{\psi}_I}\)</span> are obtained by first applying <span class="math notranslate nohighlight">\(\hat{C}_I\)</span> to the many-body ground state:</p>
<div class="math notranslate nohighlight" id="equation-eq-precursor">
<span class="eqno">(123)<a class="headerlink" href="#equation-eq-precursor" title="Permalink to this equation">¶</a></span>\[\ket{\psi_I^{\#}}=\hat{C}_I\ket{0}-\ket{0}\bra{0}\hat{C}_I\ket{0} \, ,\]</div>
<p>and then performing an orthonormalization <span id="id9">[<a class="reference internal" href="intro.html#id48">Wen16</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-isdefinition">
<span class="eqno">(124)<a class="headerlink" href="#equation-eq-isdefinition" title="Permalink to this equation">¶</a></span>\[%%%\ket{\tilde{\psi}_I}=\sum_J\ket{\psi_J^{\#}}S_{IJ}^{-1/2}\, ,\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{IJ}=\braket{\psi_I^{\#}|\psi_J^{\#}}\)</span> are overlap integrals.</p>
<p>The ADC matrix elements are obtained as matrix elements of the shifted Hamiltonian in the basis of the intermediate states:</p>
<div class="math notranslate nohighlight" id="equation-eq-mdef">
<span class="eqno">(125)<a class="headerlink" href="#equation-eq-mdef" title="Permalink to this equation">¶</a></span>\[M_{IJ}=\bra{\tilde{\psi}_I}\hat{H}-E_0\ket{\tilde{\psi}_J}=\sum_{K,L}S_{IK}^{-1/2}\bra{ \psi_K^{\#}}\hat{H}-E_0\ket{\psi_L^{\#}}S_{JL}^{-1/2} \, ,\]</div>
<p>where <span class="math notranslate nohighlight">\(E_0\)</span> is the ground state energy.</p>
<p>Having obtained an expression for the ADC matrix, we return to the series expansion of the polarization propagator. In the same way as the propagator is expanded in series, also the matrix elements can be written in terms of orders of perturbation <span id="id10">[<a class="reference internal" href="intro.html#id48">Wen16</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-mseries">
<span class="eqno">(126)<a class="headerlink" href="#equation-eq-mseries" title="Permalink to this equation">¶</a></span>\[M_{IJ}^{(k+l+m)}=\sum_{K,L}\left(S_{IK}^{-1/2}\right)^{(k)}\left(\bra{\psi_K^{\#}}\hat{H}-E_0\ket{\psi_L^{\#}}\right)^{(l)}\left(S_{JL}^{-1/2}\right)^{(m)}\, ,\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(m\)</span> are the orders of perturbation theory used for the overlap matrices <span class="math notranslate nohighlight">\(S_{IK}\)</span> and <span class="math notranslate nohighlight">\(S_{JL}\)</span>, <span class="math notranslate nohighlight">\(l\)</span> is the order used for the matrix elements of the shifted Hamiltonian, and the sum <span class="math notranslate nohighlight">\(k+l+m\)</span> represents the order of the ADC matrix.</p>
<p>Using Eq. <a class="reference internal" href="#equation-eq-mseries">(126)</a> in combination with specific classes of excitation operators and truncating the series at the desired order, various levels of ADC theory are obtained. One aspect to note is that the excitation classes needed to construct a specific ADC level are directly connected to the order of perturbation theory. This can be easily seen from <a class="reference internal" href="#fig-propagator"><span class="std std-numref">Fig. 16</span></a>, where the zeroth and first order terms are related to single excitations (only one particle-hole pair is involved), while second order terms involve double excitations (two particle-hole pairs are involved). To illustrate this further, we list the explicit expressions for the ADC matrix elements up to second order <span id="id11">[<a class="reference internal" href="intro.html#id48">Wen16</a>, <a class="reference internal" href="intro.html#id51">Wor09</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-adcmat-ph-ph-0">
<span class="eqno">(127)<a class="headerlink" href="#equation-eq-adcmat-ph-ph-0" title="Permalink to this equation">¶</a></span>\[M_{ia,jb}^{(0)}=(\epsilon_a-\epsilon_i)\delta_{ab}\delta_{ij}\,,\]</div>
<div class="math notranslate nohighlight" id="equation-eq-adcmat-ph-ph-1">
<span class="eqno">(128)<a class="headerlink" href="#equation-eq-adcmat-ph-ph-1" title="Permalink to this equation">¶</a></span>\[M_{ia,jb}^{(1)}=-\braket{ja||ib}\,,\]</div>
<div class="math notranslate nohighlight" id="equation-eq-adcmat-ph-ph-2">
<span class="eqno">(129)<a class="headerlink" href="#equation-eq-adcmat-ph-ph-2" title="Permalink to this equation">¶</a></span>\[\begin{split}M_{ia,jb}^{(2)}&amp;=\frac{1}{4}\delta_{ij}\sum_{c,k,l}\left[\frac{\braket{ac||kl}\braket{kl||bc}}{\epsilon_a+\epsilon_c-\epsilon_k-\epsilon_l}+\frac{\braket{ac||kl}\braket{kl||bc}}{\epsilon_b+\epsilon_c-\epsilon_k-\epsilon_l}\right]\nonumber\\ &amp;+\frac{1}{4}\delta_{ab}\sum_{c,d,k}\left[\frac{\braket{cd||ik}\braket{jk||cd}}{\epsilon_c+\epsilon_d-\epsilon_i-\epsilon_k}+\frac{{\braket{cd||Ik}\braket{Jk||cd}}}{\epsilon_c+\epsilon_d-\epsilon_j-\epsilon_k}\right] \nonumber \\
&amp;-\frac{1}{2}\sum_{c,k}\left[\frac{{\braket{ac||ik}\braket{jk||bc}}}{\epsilon_a+\epsilon_c-\epsilon_i-\epsilon_k}+\frac{{\braket{ac||ik}\braket{jk||bc}}}{\epsilon_b+\epsilon_c-\epsilon_j-\epsilon_k}\right] \, ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-adcmat-ph-2p2h-1">
<span class="eqno">(130)<a class="headerlink" href="#equation-eq-adcmat-ph-2p2h-1" title="Permalink to this equation">¶</a></span>\[M_{ia,klcd}^{(1)}=\braket{kl||id}\delta_{ac}-\braket{kl||ic}\delta_{ad}-\braket{al||cd}\delta_{ik}+{\braket{ak||cd}\delta_{il}}\label{eq:adcmat_ph_2p2h_1}\,,\]</div>
<div class="math notranslate nohighlight" id="equation-eq-c2p2hph-1">
<span class="eqno">(131)<a class="headerlink" href="#equation-eq-c2p2hph-1" title="Permalink to this equation">¶</a></span>\[M_{ijab,kc}^{(1)}=\braket{kb||ij}\delta_{ac}-\braket{ka||ij}\delta_{bc}-\braket{ab||cj}\delta_{ik}+{\braket{ab||ci}\delta_{jk}}\label{c2p2hph_1}\,,\]</div>
<div class="math notranslate nohighlight" id="equation-eq-adcmat-2p2h-2p2h-0">
<span class="eqno">(132)<a class="headerlink" href="#equation-eq-adcmat-2p2h-2p2h-0" title="Permalink to this equation">¶</a></span>\[M_{ijab,klcd}^{(0)}=(\epsilon_a+\epsilon_b-\epsilon_i-\epsilon_j)\delta_{ac}\delta_{bd}\delta_{ik}\delta_{jl}\,,\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta_{pq}\)</span> is the Kronecker delta.</p>
<p>The structure of the ADC(2) matrix is depicted in <a class="reference internal" href="#fig-isr"><span class="std std-numref">Fig. 17</span></a>c. In principle, the ADC(2) matrix contains all the possible single and double excitations which can be constructed for the system of interest (using a particular basis set). However, except for very small molecules, to include all these excitations would make the ADC matrix intractably large and impossible to diagonalize. In practice, therefore, only the lowest <span class="math notranslate nohighlight">\(n\)</span> excited states are ever constructed, where <span class="math notranslate nohighlight">\(n\)</span> is the number of states requested by the user. This means that the space of valence excitations is easily accessible, but makes the space of core excitations impossible to reach, except for molecules with very few electrons. An approach to overcome this problem will be discussed in more details in the next section.</p>
</div>
<div class="section" id="core-valence-separation">
<h2>Core–valence separation<a class="headerlink" href="#core-valence-separation" title="Permalink to this headline">¶</a></h2>
<p>One way to reach the space of core-excitations (and be able to compute, for example, X-ray absorption spectra), without having to deal with an intractably large ADC matrix is provided by the core–valence separation (CVS) approximation. CVS is obtained by decoupling the core and valence excitation spaces and is motivated by the large energy separation between them <span id="id12">[<a class="reference internal" href="intro.html#id84">CDS80</a>]</span>. Essentially, it consists of applying only excitation operators that involve one core electron (<a class="reference internal" href="#fig-cvs"><span class="std std-numref">Fig. 18</span></a>a and b). This translates into keeping only those blocks of the ADC matrix which include one core orbital (<a class="reference internal" href="#fig-cvs"><span class="std std-numref">Fig. 18</span></a>c) and significantly reduces the size of the matrix to be diagonalized (<a class="reference internal" href="#fig-cvs"><span class="std std-numref">Fig. 18</span></a>d). The error introduced by this approximation is very small and system-independent <span id="id13">[<a class="reference internal" href="intro.html#id86">HF20</a>]</span>.</p>
<div class="margin-caption figure align-default" id="fig-cvs">
<a class="reference internal image-reference" href="../_images/cvs_adc_matrix.svg"><img alt="../_images/cvs_adc_matrix.svg" height="238" src="../_images/cvs_adc_matrix.svg" width="638" /></a>
<p class="caption"><span class="caption-number">Fig. 18 </span><span class="caption-text">Illustration of the (a) single excitations and (b) double excitations involved in the CVS approximation. (c) Schematic representation of the full ADC(2) matrix and (d) the size reduction achieved by the CVS approximation.</span><a class="headerlink" href="#fig-cvs" title="Permalink to this image">¶</a></p>
</div>
<p>The CVS approximation allows the computation of X-ray spectroscopies, which are very important techniques for the characterisation of materials, from atoms and molecules, to surfaces and condensed matter systems. In the remaining of this section we will introduce X-ray absorption spectroscopy (XAS) and review some of its features. For a more in-depth discussion see Refs. <span id="id14">[<a class="reference internal" href="intro.html#id87">Stohr92</a>]</span> and <span id="id15">[<a class="reference internal" href="intro.html#id85">ND18</a>]</span>.</p>
<p>The absorption of soft X-ray electromagnetic radiation by a molecular system results in electronic excitation between core initial electronic states (localized, atomic-like) and final states that are delocalized, sometimes continuum-like. A schematic and simplified illustration of this process, alongside the corresponding XAS spectrum is shown in <a class="reference internal" href="#fig-xas"><span class="std std-numref">Fig. 19</span></a>.</p>
<p>The core level binding energies of 1s electrons are element-specific, with very large energy separations between different elements, e.g. <span class="math notranslate nohighlight">\(\sim\)</span>290 eV (C), <span class="math notranslate nohighlight">\(\sim\)</span>400 eV (N), and <span class="math notranslate nohighlight">\(\sim\)</span>500 eV (O). Additionally, atoms of the same species placed in different chemical environments have binding energies which differ by a few electron-volts. This means that absorption peaks corresponding to transitions from chemically inequivalent atoms will occur at different photon energies. The separation between these peaks is called “chemical shift” and it enables the use of XAS for chemical analysis and materials characterization.</p>
<div class="margin-caption figure align-default" id="fig-xas">
<a class="reference internal image-reference" href="../_images/xas.svg"><img alt="../_images/xas.svg" height="313" src="../_images/xas.svg" width="540" /></a>
<p class="caption"><span class="caption-number">Fig. 19 </span><span class="caption-text">(a) Schematic potential and (b) schematic representation of the C K-edge X-ray absorption spectrum for the dichloroethylene molecule (adapted from Ref. <span id="id16">[<a class="reference internal" href="intro.html#id87">Stohr92</a>]</span>, Fig. 4.2.).</span><a class="headerlink" href="#fig-xas" title="Permalink to this image">¶</a></p>
</div>
<p>In the case of core-excitations, electron–electron correlation and the presence of the core-hole influence the excitation energies and transition probabilities. These relaxation effects are present also in the case of valence-excitations, but they are more pronounced in the case of core-excitations. The is due the presence of a localized core-hole which leads to a strong net attraction of the electron density towards the probed atom. In addition, the interaction with the excited electron creates a small repulsive polarisation effect in the valence region. Both these two counteracting effects need to be accounted for in order to accurately model XAS. At the ADC level of theory, this is achieved by including at least doubly excited configurations in the construction of the ADC matrix.</p>
</div>
<div class="section" id="large-scale-calculations">
<h2>Large-scale calculations<a class="headerlink" href="#large-scale-calculations" title="Permalink to this headline">¶</a></h2>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="scf-response.html" title="previous page">SCF states</a>
    <a class='right-next' id="next-link" href="excoupl.html" title="next page">Exciton coupling model</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The eChem team<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>