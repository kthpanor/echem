
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rovibronic states &#8212; Computational Chemistry from  Laptop to HPC</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Chemistry from  Laptop to HPC</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Getting started
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials and workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="vibrational.html">
   Vibrational spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ir.html">
     IR spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="raman.html">
     Raman spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ir_raman_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="uv-vis.html">
   UV/vis spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_rec.html">
     Recommendations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="xray.html">
   X-ray spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_nonstandard.html">
     Non-standard calculations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_rec.html">
     Recommendations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_exercises.html">
     Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_cheat.html">
     Cheat sheet
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Electronic ground states
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="elecstruct-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="orbitals.html">
     Orbitals and basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="slater.html">
     Many-electron wave functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="operators.html">
     Operators and matrix elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals.html">
     Integral evaluation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="spin.html">
     Electron spin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="correlation.html">
     Electron correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="perturbation_theory.html">
     Rayleigh–Schrödinger perturbation theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="secondquant.html">
     Second quantization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="wft.html">
   Wave function theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hartree-fock.html">
     Hartree–Fock theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ci.html">
     Configuration interaction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mp2.html">
     Møller–Plesset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mcscf.html">
     Multiconfigurational methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="wft-exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dft.html">
   Density functional theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hohenberg.html">
     Hohenberg–Kohn theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kohn-sham.html">
     Kohn–Sham method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kernel_integration.html">
     Kernel integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dft_scf.html">
     SCF optimization of a closed-shell state
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Molecular structure and dynamics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="struct-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="coordinates.html">
     Choice of coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="forcefields.html">
     Force fields
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="gradients.html">
   Gradients
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="energy_grad.html">
     Energy gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="property_grad.html">
     Property gradients
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hessians.html">
   Hessians and vibrations
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="structopt-overview.html">
   Structure optimization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="structopt.html">
     Optimization Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gsstructopt.html">
     Ground state structure optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="structopt-exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tst.html">
   Transition-state theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="transition_state.html">
     Transition state geometry optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="impes-overview.html">
   PES interpolation techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="impes.html">
     Potential energy surfaces by interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="impes-exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="moldyn.html">
   Molecular dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="md_ffs.html">
     Force field parameterization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_setup.html">
     Ensembles and time integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_run.html">
     Running a simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_biased.html">
     Biased molecular dynamics
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Spectra and properties
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="response.html">
   General aspects
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tddft.html">
   TDDFT
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="tddft_basics.html">
     Foundations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tddft_rpa.html">
     RPA equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tddft_tda.html">
     Tamm-Dancoff approximation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tddft_challenge.html">
     Challenges
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mr-response.html">
   Multi-reference
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="adc.html">
   ADC
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="adc-pp.html">
     Polarization propagator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adc-isr.html">
     Intermediate state representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adc-cvs.html">
     Core–valence separation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adc-hpc.html">
     HPC-QC implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adc-exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="excoupl.html">
   Exciton coupling model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="excoupl_impl.html">
     Implementation of the exciton coupling model
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="localprop.html">
   Localized properties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="esp.html">
     ESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="resp.html">
     RESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="loprop.html">
     LoProp charges and polarisabilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pe.html">
   Polarizable embedding
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Visualization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="vis_structure.html">
   Molecular structure and dynamics
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="elec_vis.html">
   Electronic structure
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="orb_vis.html">
     Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="exc_vis.html">
     Excited states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dens_vis.html">
     Reduced particle densities
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bibliography
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="refs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/vibrot.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kthpanor/echem"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/vibrot.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kthpanor/echem/master?urlpath=tree/docs/docs/vibrot.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rovibrational-spectroscopy-for-diatomic-molecules">
   Rovibrational spectroscopy for diatomic molecules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerov-s-method-for-solving-the-schrodinger-equation">
   Numerov’s method for solving the Schrödinger equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerov-s-method-in-veloxchem">
   Numerov’s method in VeloxChem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rovibrational-spectra">
   Rovibrational spectra
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rovibronic-transitions-uv-spectrum">
   Rovibronic transitions: UV spectrum
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-defined-potential">
   User defined potential
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Rovibronic states</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rovibrational-spectroscopy-for-diatomic-molecules">
   Rovibrational spectroscopy for diatomic molecules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerov-s-method-for-solving-the-schrodinger-equation">
   Numerov’s method for solving the Schrödinger equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerov-s-method-in-veloxchem">
   Numerov’s method in VeloxChem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rovibrational-spectra">
   Rovibrational spectra
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rovibronic-transitions-uv-spectrum">
   Rovibronic transitions: UV spectrum
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-defined-potential">
   User defined potential
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="rovibronic-states">
<h1>Rovibronic states<a class="headerlink" href="#rovibronic-states" title="Permalink to this headline">¶</a></h1>
<p>The sum-over-states expressions for response functions are expressed in terms of the exact rovibronic eigenstates of the molecular Hamiltonian in the absence of external fields. These states are rarely available in practical calculations, where instead electronic states are employed. However, for a diatomic system, we can determine the rovibrational wave functions and the associated transition moments and energies.</p>
<div class="section" id="rovibrational-spectroscopy-for-diatomic-molecules">
<h2>Rovibrational spectroscopy for diatomic molecules<a class="headerlink" href="#rovibrational-spectroscopy-for-diatomic-molecules" title="Permalink to this headline">¶</a></h2>
<p>In a diatomic molecule there are sequences of quantized <strong>rotational</strong> levels associated with the ground and excited <strong>vibrational</strong> levels. The transitions between rotational levels from a vibrational state to other are called bands, and depending on the difference in the rotational quantum number (<span class="math notranslate nohighlight">\(J\)</span>) we classify the bands in:</p>
<ol class="simple">
<li><p>Q-branch: when <span class="math notranslate nohighlight">\(\Delta J = 0\)</span></p></li>
<li><p>R-branch: when <span class="math notranslate nohighlight">\(\Delta J = +1\)</span></p></li>
<li><p>P-branch: when <span class="math notranslate nohighlight">\(\Delta J = -1\)</span></p></li>
</ol>
<p>Before digging more into the theoretical determination of the branches, we need first a method to get the wave functions for the different vibrational levels, i.e., solving the Schrödinger equation for a given potential.</p>
</div>
<div class="section" id="numerov-s-method-for-solving-the-schrodinger-equation">
<h2>Numerov’s method for solving the Schrödinger equation<a class="headerlink" href="#numerov-s-method-for-solving-the-schrodinger-equation" title="Permalink to this headline">¶</a></h2>
<p>Numerov’s method can be employed to solve 1D differential equations using finite differences over a grid.</p>
<p>The radial Schrödinger equation for a diatomic system takes the form</p>
<div class="math notranslate nohighlight">
\[   
[- \dfrac {\hbar^{2}} {2 m} ... + V (R)] \chi_n(R) = 
E_n \chi_n(R)  
\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the reduced mass.</p>
</div>
<div class="section" id="numerov-s-method-in-veloxchem">
<h2>Numerov’s method in VeloxChem<a class="headerlink" href="#numerov-s-method-in-veloxchem" title="Permalink to this headline">¶</a></h2>
<p>We start by importing the modules and setting up the system</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
</pre></div>
</div>
</div>
</div>
<p>The system that we will use as an example is HCl.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecule_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Cl   0.0     0.0   0.0</span>
<span class="s2">H    1.274   0.0   0.0</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_str</span><span class="p">(</span><span class="n">molecule_string</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;angs&quot;</span><span class="p">)</span>
<span class="n">basis_set_label</span> <span class="o">=</span> <span class="s2">&quot;6-31+G&quot;</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis_set_label</span><span class="p">)</span>
<span class="n">molecule</span><span class="o">.</span><span class="n">set_charge</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">molecule</span><span class="o">.</span><span class="n">set_multiplicity</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">scf_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;conv_thresh&quot;</span><span class="p">:</span> <span class="mf">1.0e-6</span><span class="p">}</span>
<span class="n">method_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;xcfun&quot;</span><span class="p">:</span> <span class="s2">&quot;b3lyp&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_level&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>To run the Numerov driver in VeloxChem we need to define the settings in a dictionary. We can consult all the settings as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">NumerovDriver</span><span class="p">()</span>
<span class="n">num_drv</span><span class="o">.</span><span class="n">print_keywords</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                     ================================================================================                     
                       @numerov                                                                                           
                     --------------------------------------------------------------------------------                     
                       pec_displacements   sequence       PEC scanning range [bohr]                                       
                       pec_potential       string         potential type for fitting                                      
                       reduced_mass        float          reduced mass of the molecule                                    
                       el_transition       boolean        include an electronic transition                                
                       final_el_state      integer        final state of the electronic transition                        
                       exc_conv_thresh     float          excited state calculation threshold                             
                       n_vib_states        integer        number of vibrational states to be resolved                     
                       temp                float          temperature in Kelvin                                           
                       n_rot_states        integer        number of rotational states to be resolved                      
                       conv_thresh         float          convergence threshold for vibronic energies                     
                       max_iter            integer        max. iteration number per vibronic state                        
                       n_margin            float          negative margin of the grid [bohr]                              
                       p_margin            float          positive margin of the grid [bohr]                              
                       steps_per_au        integer        number of grid points per Bohr radius                           
                     ================================================================================                     
</pre></div>
</div>
</div>
</div>
<p>Now we proceed with the calculation, the potential <span class="math notranslate nohighlight">\(V(R)\)</span> will be calculated by mapping the bond distance and we can decide if we want to fit it with a harmonic or a Morse potential. As a disclaimer the Morse potential will work fine for as many vibrational excited states as we want meanwhile the harmonic will work only for the lower ones as it is not able to reproduce the dissociation limit.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerov_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_vib_states&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s2">&quot;pec_displacements&quot;</span><span class="p">:</span> <span class="s2">&quot;-0.7 - 2.0 (0.1)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;el_transition&quot;</span><span class="p">:</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pec_potential&quot;</span><span class="p">:</span> <span class="s2">&quot;morse&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n_rot_states&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">num_drv</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">numerov_settings</span><span class="p">,</span> <span class="n">scf_settings</span><span class="p">,</span> <span class="n">method_settings</span><span class="p">)</span>
<span class="n">num_results</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                           Potential Energy Curve Driver Setup                                            
                                          =====================================                                           
                                                                                                                          
                              Number of Geometries          : 28                                                          
                              Wave Function Model           : Spin-Unrestricted Kohn-Sham                                 
                              SCF Convergece Threshold      : 1.0e-06                                                     
                              DFT Functional                : B3LYP                                                       
                              Molecular Grid Level          : 4                                                           
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 1/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 2/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 3/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 4/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 5/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 6/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 7/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 8/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 9/28:  Initial state converged                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 10/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 11/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 12/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 13/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 14/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 15/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 16/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 17/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 18/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 19/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 20/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 21/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 22/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 23/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 24/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 25/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 26/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 27/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 28/28:  Initial state converged                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Potential Energy Curve Information                                                                         
               ----------------------------------                                                                         
                                               rel. GS energy                                                             
               Bond distance:     0.9036 angs      5.68241 eV                                                             
               Bond distance:     0.9565 angs      3.81796 eV                                                             
               Bond distance:     1.0094 angs      2.47425 eV                                                             
               Bond distance:     1.0623 angs      1.51382 eV                                                             
               Bond distance:     1.1152 angs      0.85345 eV                                                             
               Bond distance:     1.1682 angs      0.42410 eV                                                             
               Bond distance:     1.2211 angs      0.16198 eV                                                             
               Bond distance:     1.2740 angs      0.03092 eV                                                             
               Bond distance:     1.3269 angs      0.00000 eV                                                             
               Bond distance:     1.3798 angs      0.03972 eV                                                             
               Bond distance:     1.4328 angs      0.13267 eV                                                             
               Bond distance:     1.4857 angs      0.26646 eV                                                             
               Bond distance:     1.5386 angs      0.42875 eV                                                             
               Bond distance:     1.5915 angs      0.60969 eV                                                             
               Bond distance:     1.6444 angs      0.80427 eV                                                             
               Bond distance:     1.6973 angs      1.00788 eV                                                             
               Bond distance:     1.7503 angs      1.21606 eV                                                             
               Bond distance:     1.8032 angs      1.42556 eV                                                             
               Bond distance:     1.8561 angs      1.63464 eV                                                             
               Bond distance:     1.9090 angs      1.84150 eV                                                             
               Bond distance:     1.9619 angs      2.04471 eV                                                             
               Bond distance:     2.0148 angs      2.24327 eV                                                             
               Bond distance:     2.0678 angs      2.43647 eV                                                             
               Bond distance:     2.1207 angs      2.62367 eV                                                             
               Bond distance:     2.1736 angs      2.80427 eV                                                             
               Bond distance:     2.2265 angs      2.97812 eV                                                             
               Bond distance:     2.2794 angs      3.14527 eV                                                             
               Bond distance:     2.3324 angs      3.30559 eV                                                             
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                   Numerov Driver Setup                                                   
                                                  ======================                                                  
                                                                                                                          
                                         Number of Vibrational States : 15                                                
                                         Energy Convergence Threshold : 1.0e-12                                           
                                         Max. Number of Iterations    : 1000                                              
                                         Grid Points per Bohr Radius  : 500                                               
                                         Margin right of scanned PEC  : 1.50                                              
                                         Margin left of scanned PEC   : 0.50                                              
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 0 converged in 87 iterations                                                            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 1 converged in 177 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 2 converged in 157 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 3 converged in 155 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 4 converged in 164 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 5 converged in 161 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 6 converged in 126 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 7 converged in 145 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 8 converged in 137 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 9 converged in 127 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 10 converged in 130 iterations                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 11 converged in 123 iterations                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 12 converged in 120 iterations                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 13 converged in 112 iterations                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 14 converged in 119 iterations                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** All vibronic states converged for the initial electronic state                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Rovibronic IR Spectrum                                                                                     
               ----------------------                                                                                     
                           Excitation energy    Oscillator strength                                                       
               P Branch                                                                                                   
                                2711.26 cm-1            4.00736e-09                                                       
                                2691.71 cm-1            5.53061e-09                                                       
                                2672.16 cm-1            5.83444e-09                                                       
                                2652.62 cm-1            5.14369e-09                                                       
                                2633.07 cm-1            3.92274e-09                                                       
                                2613.52 cm-1            2.63231e-09                                                       
                                2593.97 cm-1            1.56933e-09                                                       
                                2574.43 cm-1            8.36248e-10                                                       
                                2554.88 cm-1            3.99885e-10                                                       
                                2535.33 cm-1            1.72079e-10                                                       
                                2515.78 cm-1            6.67727e-11                                                       
                                2496.24 cm-1            2.33994e-11                                                       
                                2476.69 cm-1            7.41405e-12                                                       
                                2457.14 cm-1            2.12593e-12                                                       
               Q Branch                                                                                                   
                                2730.81 cm-1            6.02968e-08                                                       
               R Branch                                                                                                   
                                2750.36 cm-1            1.39977e-09                                                       
                                2769.90 cm-1            3.82130e-09                                                       
                                2789.45 cm-1            5.27382e-09                                                       
                                2809.00 cm-1            5.56355e-09                                                       
                                2828.55 cm-1            4.90488e-09                                                       
                                2848.09 cm-1            3.74061e-09                                                       
                                2867.64 cm-1            2.51009e-09                                                       
                                2887.19 cm-1            1.49647e-09                                                       
                                2906.74 cm-1            7.97421e-10                                                       
                                2926.28 cm-1            3.81319e-10                                                       
                                2945.83 cm-1            1.64090e-10                                                       
                                2965.38 cm-1            6.36725e-11                                                       
                                2984.93 cm-1            2.23130e-11                                                       
                                3004.47 cm-1            7.06982e-12                                                       
                                3024.02 cm-1            2.02723e-12                                                       
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>The results are stored in a dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">num_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;grid&#39;, &#39;potential&#39;, &#39;psi&#39;, &#39;vib_levels&#39;, &#39;excitation_energies&#39;, &#39;oscillator_strengths&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span>
<span class="n">potential</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;potential&quot;</span><span class="p">]</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;psi&quot;</span><span class="p">]</span>
<span class="n">vib_levels</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;vib_levels&quot;</span><span class="p">]</span>
<span class="n">displacements</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">pec_displacements</span>
<span class="n">energies</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">pec_energies</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">]</span>
<span class="n">psi_squared</span> <span class="o">=</span> <span class="n">psi</span><span class="o">**</span><span class="mi">2</span>
<span class="n">exc</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;excitation_energies&quot;</span><span class="p">]</span>
<span class="n">osc</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;oscillator_strengths&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The vibrational levels can be plotted against the potential energy curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">psi_squared</span><span class="p">)):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">vib_levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">psi_squared</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">potential</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">vib_levels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Displacements [Å] respect to the input structure&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy [a.u.]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/vibrot_13_0.png" src="../_images/vibrot_13_0.png" />
</div>
</div>
</div>
<div class="section" id="rovibrational-spectra">
<h2>Rovibrational spectra<a class="headerlink" href="#rovibrational-spectra" title="Permalink to this headline">¶</a></h2>
<p>Once we have the vibrational wave functions we can calculate the dipole transition moments</p>
<div class="math notranslate nohighlight">
\[ 
\mu^{fi} = \langle \nu_{f} | \mu^\mathrm{e}(R) | \nu_{i} \rangle
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu^\mathrm{e}(R)\)</span> is the dipole moment at internuclear separation distance <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>Only the first transition dipole moment (corresponding to the Q-branch) is relevant and the rest are negligible. We will obtain the fine structure by deriving the rotational excited states for the R and P branches.</p>
<p>Applying the rotational selection rules derived for linear molecules, we get the P-branch</p>
<div class="math notranslate nohighlight">
\[ 
E = \hbar \omega_{\text{stretch}} + \left( \dfrac{h^2}{8\pi^2I} \right)((L - 1)L - L(L + 1)) = \hbar \omega_{\text{stretch}} -2\left( \dfrac{h^2}{8\pi^2 I} \right)L 
\]</div>
<p>and the R-branch</p>
<div class="math notranslate nohighlight">
\[
E = \hbar \omega_{\text{stretch}} + \left( \dfrac{h^2}{8\pi^2I} \right)((L+1)(L+2) - L(L + 1)) = \hbar \omega_{\text{stretch}} + 2\left( \dfrac{h^2}{8\pi^2I} \right)(L + 1) \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ 
I = \frac{m_a m_b}{m_a + m_b} R^2 
\]</div>
<p>VeloxChem takes care of the spectra and the branches storing the data on the keys: <code class="docutils literal notranslate"><span class="pre">excitation_energies</span></code> and <code class="docutils literal notranslate"><span class="pre">oscillator_strengths</span></code>.</p>
<p>As well, computes the dipole moment for every point of the potential energy curve</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exc</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">osc</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exc</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">],</span> <span class="n">osc</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">branches</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">({</span><span class="s2">&quot;P-branch&quot;</span><span class="p">,</span> <span class="s2">&quot;R-branch&quot;</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Excitation energies in cm-1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Oscillator strength&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">branches</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/vibrot_15_0.png" src="../_images/vibrot_15_0.png" />
</div>
</div>
</div>
<div class="section" id="rovibronic-transitions-uv-spectrum">
<h2>Rovibronic transitions: UV spectrum<a class="headerlink" href="#rovibronic-transitions-uv-spectrum" title="Permalink to this headline">¶</a></h2>
<p>In this case, we want to consider the transition dipole moments between rovibrational states in different electronic states. The expression for the transition dipole integral in this case will involve different electronic states, so it’s in essence, a generalization of the expression for the vibrational transition dipole moment.</p>
<p>The electronic transition dipole moment equals</p>
<div class="math notranslate nohighlight">
\[ 
\mu^{fi}(R) = \langle \psi^\mathrm{e}_{f} | \hat{\mu} | \psi^\mathrm{e}_{i} \rangle
\]</div>
<p>where <span class="math notranslate nohighlight">\(\psi^\mathrm{e}_{f}\)</span> and <span class="math notranslate nohighlight">\(\psi^\mathrm{e}_{i}\)</span> are the final and initial electronic wave function, respectively.</p>
<p>Expanding the transition moment in a power series about the equilibrium distance, we get</p>
<div class="math notranslate nohighlight">
\[ \mu_{f,i}(\textbf{R}) = \mu_{f,i}(\textbf{R}_e) + \sum\limits_a \dfrac{\partial \mu_{f,i}}{\partial R_a} (R_a - R_{a,e}) + \cdots . \]</div>
<p>Now, by truncating this expression in the first term we get the so called Frank-Condon approximation. We could also include the second term with is reffered as the Herzberg-Teller correction. But for out purposes we will go with the Frank-Condon approximation. <br />
In that framework, transition energies can be obtained as: <br />
$<span class="math notranslate nohighlight">\( f_{if} = \frac{2}{3} \omega_{nl} \sum_{\alpha}^{x,y,z} | \langle \phi_n \langle \psi_i | \mu_{\alpha} | \psi_f \rangle \phi'_l \rangle |^2   \)</span><span class="math notranslate nohighlight">\(
Being \)</span>\psi_i,\psi_f<span class="math notranslate nohighlight">\( the initial and final electronic wavefunctions &lt;br /&gt;
And \)</span>\phi_n, \phi’_l$ the vibrational wavefunctions of the initial and final electronic states  <br /></p>
<p>Now, the only difference with respect to the pure rovibrational spectrum is that we are going to include an excited state</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerov_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_vib_states&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;pec_displacements&quot;</span><span class="p">:</span> <span class="s2">&quot;-0.7 - 2.0 (0.1)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;el_transition&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;final_el_state&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;pec_potential&quot;</span><span class="p">:</span> <span class="s2">&quot;morse&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">num_drv</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">numerov_settings</span><span class="p">,</span> <span class="n">scf_settings</span><span class="p">,</span> <span class="n">method_settings</span><span class="p">)</span>
<span class="n">num_results</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                           Potential Energy Curve Driver Setup                                            
                                          =====================================                                           
                                                                                                                          
                              Number of Geometries          : 28                                                          
                              Wave Function Model           : Spin-Unrestricted Kohn-Sham                                 
                              SCF Convergece Threshold      : 1.0e-06                                                     
                              DFT Functional                : B3LYP                                                       
                              Molecular Grid Level          : 4                                                           
                              Targeted Exicted State        : 2                                                           
                              Excited State Threshold       : 1.0e-04                                                     
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 1/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 2/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 3/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 4/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 5/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 6/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 7/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 8/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 9/28:  Initial state converged,  Final state converged                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 10/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 11/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 12/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 13/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 14/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 15/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 16/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 17/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 18/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 19/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 20/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 21/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 22/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 23/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 24/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 25/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 26/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 27/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Geometry 28/28:  Initial state converged,  Final state converged                                       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Potential Energy Curve Information                                                                         
               ----------------------------------                                                                         
                                               rel. GS energy  rel. ES energy                                             
               Bond distance:     0.9036 angs      5.68241 eV     16.00175 eV                                             
               Bond distance:     0.9565 angs      3.81796 eV     14.09261 eV                                             
               Bond distance:     1.0094 angs      2.47425 eV     12.70655 eV                                             
               Bond distance:     1.0623 angs      1.51382 eV     11.70482 eV                                             
               Bond distance:     1.1152 angs      0.85345 eV     11.00173 eV                                             
               Bond distance:     1.1682 angs      0.42410 eV     10.52228 eV                                             
               Bond distance:     1.2211 angs      0.16198 eV     10.18858 eV                                             
               Bond distance:     1.2740 angs      0.03092 eV      9.94565 eV                                             
               Bond distance:     1.3269 angs      0.00000 eV      9.77834 eV                                             
               Bond distance:     1.3798 angs      0.03972 eV      9.69357 eV                                             
               Bond distance:     1.4328 angs      0.13267 eV      9.68542 eV                                             
               Bond distance:     1.4857 angs      0.26646 eV      9.73875 eV                                             
               Bond distance:     1.5386 angs      0.42875 eV      9.83600 eV                                             
               Bond distance:     1.5915 angs      0.60969 eV      9.96287 eV                                             
               Bond distance:     1.6444 angs      0.80427 eV     10.11118 eV                                             
               Bond distance:     1.6973 angs      1.00788 eV     10.37408 eV                                             
               Bond distance:     1.7503 angs      1.21606 eV     10.44543 eV                                             
               Bond distance:     1.8032 angs      1.42556 eV     10.62116 eV                                             
               Bond distance:     1.8561 angs      1.63464 eV     10.79876 eV                                             
               Bond distance:     1.9090 angs      1.84150 eV     10.97595 eV                                             
               Bond distance:     1.9619 angs      2.04471 eV     11.15095 eV                                             
               Bond distance:     2.0148 angs      2.24327 eV     11.32257 eV                                             
               Bond distance:     2.0678 angs      2.43647 eV     11.48995 eV                                             
               Bond distance:     2.1207 angs      2.62367 eV     11.65227 eV                                             
               Bond distance:     2.1736 angs      2.80427 eV     11.80884 eV                                             
               Bond distance:     2.2265 angs      2.97812 eV     11.95941 eV                                             
               Bond distance:     2.2794 angs      3.14527 eV     12.10401 eV                                             
               Bond distance:     2.3324 angs      3.30559 eV     12.24245 eV                                             
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                   Numerov Driver Setup                                                   
                                                  ======================                                                  
                                                                                                                          
                                         Number of Vibrational States : 10                                                
                                         Energy Convergence Threshold : 1.0e-12                                           
                                         Max. Number of Iterations    : 1000                                              
                                         Grid Points per Bohr Radius  : 500                                               
                                         Margin right of scanned PEC  : 1.50                                              
                                         Margin left of scanned PEC   : 0.50                                              
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 0 converged in 86 iterations                                                            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 1 converged in 164 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 2 converged in 153 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 3 converged in 153 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 4 converged in 161 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 5 converged in 160 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 6 converged in 126 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 7 converged in 145 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 8 converged in 138 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 9 converged in 128 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** All vibronic states converged for the initial electronic state                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 0 converged in 112 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 1 converged in 150 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 2 converged in 152 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 3 converged in 141 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 4 converged in 139 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 5 converged in 128 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 6 converged in 139 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 7 converged in 129 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 8 converged in 110 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 9 converged in 121 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** All vibronic states converged for the final electronic state                                           
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               UV/vis Absorption/Emission Spectrum                                                                        
               -----------------------------------                                                                        
                             Excitation energy    Oscillator strength                                                     
               Absorption                                                                                                 
                                 78549.62 cm-1            2.90688e-01                                                     
                                 80930.00 cm-1            3.13498e-02                                                     
                                 83217.43 cm-1            7.98128e-04                                                     
                                 85411.91 cm-1            2.43095e-04                                                     
                                 87513.43 cm-1            4.10657e-04                                                     
                                 89522.00 cm-1            1.76392e-04                                                     
                                 91437.61 cm-1            2.64333e-05                                                     
                                 93260.27 cm-1            5.31359e-07                                                     
                                 94989.97 cm-1            1.44920e-05                                                     
                                 96626.72 cm-1            2.18021e-05                                                     
               Emission                                                                                                   
                                 78549.62 cm-1            2.90688e-01                                                     
                                 75818.81 cm-1            7.33952e-02                                                     
                                 73191.54 cm-1            1.46006e-03                                                     
                                 70667.81 cm-1            3.37681e-05                                                     
                                 68247.61 cm-1            7.25831e-06                                                     
                                 65930.96 cm-1            1.30834e-05                                                     
                                 63717.84 cm-1            6.58177e-06                                                     
                                 61608.26 cm-1            1.11752e-06                                                     
                                 59602.22 cm-1            1.98291e-08                                                     
                                 57699.71 cm-1            6.14938e-07                                                     
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>The results will be stored as keys that we can see here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">num_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;grid&#39;, &#39;i_potential&#39;, &#39;i_psi&#39;, &#39;i_vib_levels&#39;, &#39;f_potential&#39;, &#39;f_psi&#39;, &#39;f_vib_levels&#39;, &#39;excitation_energies&#39;, &#39;oscillator_strengths&#39;])
</pre></div>
</div>
</div>
</div>
<p>We store the results in variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span>
<span class="n">gs_potential</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;i_potential&quot;</span><span class="p">]</span>
<span class="n">gs_psi</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;i_psi&quot;</span><span class="p">]</span>
<span class="n">gs_vib_levels</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;i_vib_levels&quot;</span><span class="p">]</span>
<span class="n">es_potential</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;f_potential&quot;</span><span class="p">]</span>
<span class="n">es_psi</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;f_psi&quot;</span><span class="p">]</span>
<span class="n">es_vib_levels</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;f_vib_levels&quot;</span><span class="p">]</span>

<span class="n">exc</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;excitation_energies&quot;</span><span class="p">]</span>
<span class="n">osc</span> <span class="o">=</span> <span class="n">num_results</span><span class="p">[</span><span class="s2">&quot;oscillator_strengths&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>For the purposes of the representation of the vibrational levels in both electronic states we will store also this variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">pec_displacements</span>
<span class="n">gs_energies</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">pec_energies</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">]</span>
<span class="n">es_energies</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">pec_energies</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">]</span>

<span class="c1"># relative potentials:</span>
<span class="n">rel_es_potential</span> <span class="o">=</span> <span class="n">es_potential</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">es_energies</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gs_energies</span><span class="p">))</span>

<span class="c1"># relative excited state vibrational levels:</span>
<span class="n">rel_es_vib_levels</span> <span class="o">=</span> <span class="n">es_vib_levels</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">es_energies</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gs_energies</span><span class="p">))</span>

<span class="n">gs_psi_squared</span> <span class="o">=</span> <span class="n">gs_psi</span><span class="o">**</span><span class="mi">2</span>
<span class="n">es_psi_squared</span> <span class="o">=</span> <span class="n">es_psi</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>The vibrational levels can be then plotted against the potential energy curves:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gs_psi_squared</span><span class="p">)):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">gs_vib_levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gs_psi_squared</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">rel_es_vib_levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">es_psi_squared</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">gs_potential</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">rel_es_potential</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">rel_es_vib_levels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Displacements in Å respect to the input distance&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy in a.u.&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/vibrot_26_0.png" src="../_images/vibrot_26_0.png" />
</div>
</div>
<p>Now we can just plot the spectrum by representing the results from the driver:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exc</span><span class="p">[</span><span class="s2">&quot;absorption&quot;</span><span class="p">],</span> <span class="n">osc</span><span class="p">[</span><span class="s2">&quot;absorption&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">500.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;absorption&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exc</span><span class="p">[</span><span class="s2">&quot;emission&quot;</span><span class="p">],</span> <span class="n">osc</span><span class="p">[</span><span class="s2">&quot;emission&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">500.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;emission&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Excitation energies in cm-1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Oscillator strength&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/vibrot_28_0.png" src="../_images/vibrot_28_0.png" />
</div>
</div>
</div>
<div class="section" id="user-defined-potential">
<h2>User defined potential<a class="headerlink" href="#user-defined-potential" title="Permalink to this headline">¶</a></h2>
<p>If you want to just explore the equations and have your own potentials and transition moments you can define them by using the method <code class="docutils literal notranslate"><span class="pre">read_pec_data</span></code> from the Numerov driver to get the wavefunctions and compute the UV spectrum as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">NumerovDriver</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Definition of the user potentials: In this example we will use two harmonic potentials and a linear polarization with respect to the nuclear displacement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_bond_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">new_gs_energies</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">new_bond_lengths</span><span class="p">]</span>
<span class="n">new_es_energies</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.35</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">new_bond_lengths</span><span class="p">]</span>
<span class="n">new_properties</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">new_bond_lengths</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Also we will use an example reduced mass of 1 and to the bond lenghts we will add 2 Å to the right to account the shift between the ground and excited electronic states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_drv</span><span class="o">.</span><span class="n">read_pec_data</span><span class="p">(</span>
    <span class="n">new_bond_lengths</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">new_properties</span><span class="p">,</span> <span class="n">new_gs_energies</span><span class="p">,</span> <span class="n">new_es_energies</span>
<span class="p">)</span>
<span class="n">num_drv</span><span class="o">.</span><span class="n">set_reduced_mass</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">numerov_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_vib_states&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;el_transition&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;final_el_state&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;pec_potential&quot;</span><span class="p">:</span> <span class="s2">&quot;harmonic&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">num_drv</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">numerov_settings</span><span class="p">,</span> <span class="n">scf_settings</span><span class="p">,</span> <span class="n">method_settings</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_results</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                   Numerov Driver Setup                                                   
                                                  ======================                                                  
                                                                                                                          
                                         Number of Vibrational States : 10                                                
                                         Energy Convergence Threshold : 1.0e-12                                           
                                         Max. Number of Iterations    : 1000                                              
                                         Grid Points per Bohr Radius  : 500                                               
                                         Margin right of scanned PEC  : 1.50                                              
                                         Margin left of scanned PEC   : 0.50                                              
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 0 converged in 120 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 1 converged in 194 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 2 converged in 193 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 3 converged in 190 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 4 converged in 191 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 5 converged in 187 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 6 converged in 188 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 7 converged in 194 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 8 converged in 195 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 9 converged in 200 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** All vibronic states converged for the initial electronic state                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 0 converged in 103 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 1 converged in 172 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 2 converged in 167 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 3 converged in 170 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 4 converged in 170 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 5 converged in 167 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 6 converged in 172 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 7 converged in 173 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 8 converged in 171 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Vibronic state 9 converged in 167 iterations                                                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** All vibronic states converged for the final electronic state                                           
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               UV/vis Absorption/Emission Spectrum                                                                        
               -----------------------------------                                                                        
                             Excitation energy    Oscillator strength                                                     
               Absorption                                                                                                 
                                 87209.80 cm-1            2.28498e-05                                                     
                                 89930.03 cm-1            1.41158e-04                                                     
                                 92650.26 cm-1            4.21033e-04                                                     
                                 95370.49 cm-1            8.07088e-04                                                     
                                 98090.72 cm-1            1.11638e-03                                                     
                                100810.95 cm-1            1.18593e-03                                                     
                                103531.17 cm-1            1.00529e-03                                                     
                                106251.40 cm-1            6.97370e-04                                                     
                                108971.63 cm-1            4.02758e-04                                                     
                                111691.86 cm-1            1.95937e-04                                                     
               Emission                                                                                                   
                                 87209.80 cm-1            2.28498e-05                                                     
                                 83878.22 cm-1            1.07498e-04                                                     
                                 80546.63 cm-1            2.63000e-04                                                     
                                 77215.04 cm-1            4.45018e-04                                                     
                                 73883.46 cm-1            5.84568e-04                                                     
                                 70551.87 cm-1            6.34554e-04                                                     
                                 67220.29 cm-1            5.91832e-04                                                     
                                 63888.70 cm-1            4.86979e-04                                                     
                                 60557.11 cm-1            3.60294e-04                                                     
                                 57225.53 cm-1            2.43116e-04                                                     
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>As usual we store the results in variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span>
<span class="n">gs_potential</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;i_potential&quot;</span><span class="p">]</span>
<span class="n">gs_psi</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;i_psi&quot;</span><span class="p">]</span>
<span class="n">gs_vib_levels</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;i_vib_levels&quot;</span><span class="p">]</span>
<span class="n">es_potential</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;f_potential&quot;</span><span class="p">]</span>
<span class="n">es_psi</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;f_psi&quot;</span><span class="p">]</span>
<span class="n">es_vib_levels</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;f_vib_levels&quot;</span><span class="p">]</span>

<span class="n">exc</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;excitation_energies&quot;</span><span class="p">]</span>
<span class="n">osc</span> <span class="o">=</span> <span class="n">model_results</span><span class="p">[</span><span class="s2">&quot;oscillator_strengths&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">pec_displacements</span>
<span class="n">gs_energies</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">pec_energies</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">]</span>
<span class="n">es_energies</span> <span class="o">=</span> <span class="n">num_drv</span><span class="o">.</span><span class="n">pec_energies</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">]</span>

<span class="c1"># relative potentials:</span>
<span class="n">rel_es_potential</span> <span class="o">=</span> <span class="n">es_potential</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">es_energies</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gs_energies</span><span class="p">))</span>

<span class="c1"># relative excited state vibrational levels:</span>
<span class="n">rel_es_vib_levels</span> <span class="o">=</span> <span class="n">es_vib_levels</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">es_energies</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gs_energies</span><span class="p">))</span>

<span class="n">gs_psi_squared</span> <span class="o">=</span> <span class="n">gs_psi</span><span class="o">**</span><span class="mi">2</span>
<span class="n">es_psi_squared</span> <span class="o">=</span> <span class="n">es_psi</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>We can now visualize the vibrational levels against the potential energy curves:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gs_psi_squared</span><span class="p">)):</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">gs_vib_levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gs_psi_squared</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">rel_es_vib_levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">es_psi_squared</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">gs_potential</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">rel_es_potential</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">rel_es_vib_levels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/vibrot_40_0.png" src="../_images/vibrot_40_0.png" />
</div>
</div>
<p>And we plot the UV spectrum by using the results from the driver:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exc</span><span class="p">[</span><span class="s2">&quot;absorption&quot;</span><span class="p">],</span> <span class="n">osc</span><span class="p">[</span><span class="s2">&quot;absorption&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">500.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Absorption&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">exc</span><span class="p">[</span><span class="s2">&quot;emission&quot;</span><span class="p">],</span> <span class="n">osc</span><span class="p">[</span><span class="s2">&quot;emission&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">500.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Emission&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Excitation energies in cm-1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Oscillator strength&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/vibrot_42_0.png" src="../_images/vibrot_42_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The eChem team<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>