
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Choice of coordinates &#8212; Computational Chemistry from  Laptop to HPC</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gradients" href="gradients.html" />
    <link rel="prev" title="General aspects" href="pes-general.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Chemistry from  Laptop to HPC</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Getting started
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials and workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="uv-vis.html">
   UV/vis absorption/emission
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_rec.html">
     Recommendations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reactivity.html">
   Catalysis and reactivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dichroism.html">
   Optical activity and dichroism
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="vibrational.html">
   Vibrational spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ir.html">
     IR spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="raman.html">
     Raman spectroscopy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="magnetic.html">
   Magnetic resonances
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="xray.html">
   X-ray spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_rec.html">
     Recommendations
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Electronic structure theory
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="elecstruct-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="orbitals.html">
     Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basis.html">
     Basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="slater.html">
     Slater determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="secondquant.html">
     Second quantization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="wft.html">
   Wave function theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="wft-general.html">
     General aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hartree-fock.html">
     Hartree–Fock theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ci.html">
     Configuration interaction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mp2.html">
     Møller–Plesset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mcscf.html">
     Multiconfigurational methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dft.html">
   Density functional theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hohenberg.html">
     Hohenberg–Kohn theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kohn-sham.html">
     Kohn–Sham method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kernel_integration.html">
     Kernel integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dft_scf.html">
     SCF optimization
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Potential energy surfaces
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="pes-general.html">
   General aspects
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Choice of coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gradients.html">
     Gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hessians.html">
     Hessians and vibrations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="forcefields.html">
     Force fields
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="structopt.html">
   Molecular structure optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tst.html">
   Transition-state theory
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="moldyn.html">
   Molecular dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="md_ffs.html">
     Force field parameterization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_setup.html">
     Ensembles and time integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_run.html">
     Running a simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_biased.html">
     Biased molecular dynamics
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Properties
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="response.html">
   Response theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="exact-response.html">
     Exact states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="scf-response.html">
     SCF states
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="adc.html">
   Algebraic diagrammatic construction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="excoupl.html">
   Exciton coupling model
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="localprop.html">
   Localized properties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="esp.html">
     ESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="resp.html">
     RESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="loprop.html">
     LoProp charges and polarizabilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pe.html">
   Polarizable embedding
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Visualization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="visual-orbitals.html">
   Molecular orbitals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visual-densities.html">
   Reduced particle densities
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="refs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/coordinates.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kthpanor/echem"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/coordinates.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cartesian">
   Cartesian
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#redundant-coordinates">
     Redundant coordinates
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#delocalized-internal-coordinates">
   Delocalized internal coordinates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hybrid-delocalized-internal-coordinates">
     Hybrid delocalized internal coordinates
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#translation-rotation-internal-coordinates">
   Translation–rotation internal coordinates
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="choice-of-coordinates">
<h1>Choice of coordinates<a class="headerlink" href="#choice-of-coordinates" title="Permalink to this headline">¶</a></h1>
<p>A fundamental concept in quantum chemistry is the multi-dimensional potential energy surface (PES). This mathematical object captures the interplay between the electronic and nuclear degrees of freedom in a particular system (molecule, complex, etc.), where the special points on the PES are important in elucidating molecular conformations and explaining the mechanisms of chemical and photo-chemical reactions. The first and second order derivatives of the energy with respect to nuclear displacements (gradients, Hessians, respectively) are key elements in locating these special points (local minima, transition states) and determining minimum energy reaction pathways. In this section, we will discuss:</p>
<ul class="simple">
<li><p>how the molecular geometry is defined in terms of the atomic positions (link);</p></li>
<li><p>how analytical expressions for the first order energy derivatives with respect to nuclear displacements are derived (link);</p></li>
<li><p>second order derivatives (link);
In the next section, we will see how these energy derivatives are used to perform structure and transition state optimizations (link, link).</p></li>
</ul>
<div class="section" id="cartesian">
<h2>Cartesian<a class="headerlink" href="#cartesian" title="Permalink to this headline">¶</a></h2>
<p>There are multiple ways to define relative atomic positions. The simplest way is to use a Cartesian reference system and define each atomic position in terms of its <span class="math notranslate nohighlight">\((x,y,z)\)</span> coordinates. In this coordinate system it is very easy to determine the total energy and energy gradient, but this choice is not favourable for geometry optimization because the energy depends non-linearly on atomic Cartesian coordinates and these coordinates are strongly coupled to each other <span id="id1">[<a class="reference internal" href="refs.html#id126">Sch11</a>, <a class="reference internal" href="refs.html#id124">WS16</a>]</span>.</p>
<div class="figure align-default">
<a class="reference internal image-reference" href="../_images/coordinates.svg"><img alt="../_images/coordinates.svg" height="245" src="../_images/coordinates.svg" width="510" /></a>
</div>
<p>A more favourable choice is to work with internal coordinates, such as bond lengths, valence angles and dihedrals (one example is the Z-matrix). Using internal coordinates poses, however, two problems: (1) the choice of coordinates is not unique (they are redundant) and (2) internal coordinates have to be transformed back into Cartesian coordinates to compute the energy and gradient. Several ways of handling these problems are discussed below.</p>
<div class="section" id="redundant-coordinates">
<h3>Redundant coordinates<a class="headerlink" href="#redundant-coordinates" title="Permalink to this headline">¶</a></h3>
<p>One common choice of coordinates in molecular structure optimization are the Redundant internal coordinates (RIC) <span id="id2">[<a class="reference internal" href="refs.html#id127">PF92</a>]</span>.</p>
<p>Given the set of internal coordinates <span class="math notranslate nohighlight">\(\mathbf{q}=(q_1,q_2,...,q_{n_q})\)</span>, we would like to relate displacements performed in these coordinates to displacements in the <span class="math notranslate nohighlight">\(n_x=3N\)</span> Cartesian coordinates <span class="math notranslate nohighlight">\(\mathbf{x}=(x_1,x_2,...,x_{n_x})\)</span> (to simplify, we denoted all Cartesian coordinates by <span class="math notranslate nohighlight">\(x\)</span>). For this purpose, we define a rectangular matrix B (called Wilson B-matrix)  <span id="id3">[<a class="reference internal" href="refs.html#id130">Neal09</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-b-ij">
<span class="eqno">(65)<a class="headerlink" href="#equation-eq-b-ij" title="Permalink to this equation">¶</a></span>\[    B_{ij} = \frac{\partial q_i}{\partial x_j}\,.\]</div>
<p>To determine the changes in <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> as a result of changes performed in <span class="math notranslate nohighlight">\(\mathbf{q}\)</span>, we basically need to obtain the inverse relation <span class="math notranslate nohighlight">\(\partial x_j/\partial q_i\)</span>. However, because <span class="math notranslate nohighlight">\(B\)</span> is rectangular and cannot be directly inverted, we first have to construct a square matrix <span class="math notranslate nohighlight">\(\mathbf{G}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-g">
<span class="eqno">(66)<a class="headerlink" href="#equation-eq-g" title="Permalink to this equation">¶</a></span>\[    \mathbf{G} = \mathbf{B}\mathbf{B}^\mathrm{T} \,.\]</div>
<p>Additionally, the internal coordinates are redundant, meaning that the rows of <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> are linearly dependent. We therefore have to set up and solve an eigenvalue equation that will allow us to separate out the redundancies <span id="id4">[<a class="reference internal" href="refs.html#id127">PF92</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-g-eigenval">
<span class="eqno">(67)<a class="headerlink" href="#equation-g-eigenval" title="Permalink to this equation">¶</a></span>\[\begin{split}    \mathbf{G} 
    \begin{pmatrix}
    \mathbf{U} &amp; \mathbf{R}
    \end{pmatrix} = 
    \begin{pmatrix}
    \mathbf{U} &amp; \mathbf{R}
    \end{pmatrix} 
    \begin{bmatrix}
    \boldsymbol{\Lambda} &amp; 0 \\
    0 &amp; 0
    \end{bmatrix} \,.\end{split}\]</div>
<p>This equation has <span class="math notranslate nohighlight">\(n=3N-6\)</span> (or <span class="math notranslate nohighlight">\(3N-5\)</span> for linear molecules) non-zero eigenvalues and <span class="math notranslate nohighlight">\(n_q-n\)</span> zero eigenvalues. The non-zero eigenvalues correspond to linearly independent coordinates, while those which are zero identify the redundant ones. Furthermore, the first <span class="math notranslate nohighlight">\(n\)</span> eigenvectors contained in the matrix <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> are non-redundant and can be used to define a set of non-redundant coordinates <span class="math notranslate nohighlight">\(\mathbf{s}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-non-redundant">
<span class="eqno">(68)<a class="headerlink" href="#equation-eq-non-redundant" title="Permalink to this equation">¶</a></span>\[    \mathbf{s} = \mathbf{U}^\mathrm{T} \mathbf{q} \,. \]</div>
<p>The eigenvalue equation, Eq. <a class="reference internal" href="#equation-g-eigenval">(67)</a>, can be used to define a generalized inverse matrix <span class="math notranslate nohighlight">\(\mathbf{G}^{-}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-generalized-inverse">
<span class="eqno">(69)<a class="headerlink" href="#equation-eq-generalized-inverse" title="Permalink to this equation">¶</a></span>\[\begin{split} \mathbf{G}^{-} = 
    \begin{pmatrix}
    \mathbf{U} &amp; \mathbf{R}
    \end{pmatrix}    
    \begin{bmatrix}
    \boldsymbol{\Lambda}^{-1} &amp; 0 \\
    0\,\,\,\,\,\,\,\, &amp; 0
    \end{bmatrix}
    \begin{pmatrix}
    \mathbf{U}^\mathrm{T}\\ 
    \mathbf{R}^\mathrm{T}
    \end{pmatrix}\, , \end{split}\]</div>
<p>which, in turn, is used to determine the transformation between Cartesian and internal coordinates displacements <span id="id5">[<a class="reference internal" href="refs.html#id124">WS16</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-displacement-q-to-x">
<span class="eqno">(70)<a class="headerlink" href="#equation-eq-displacement-q-to-x" title="Permalink to this equation">¶</a></span>\[    \Delta\mathbf{x} = \mathbf{B}^\mathrm{T}\mathbf{G}^{-}\Delta\mathbf{q}\, . \]</div>
<p>In a similar way, the gradient can be transformed from Cartesian to internal coordinates <span id="id6">[<a class="reference internal" href="refs.html#id130">Neal09</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-gradient-x-to-q">
<span class="eqno">(71)<a class="headerlink" href="#equation-eq-gradient-x-to-q" title="Permalink to this equation">¶</a></span>\[    \mathbf{g}_q = \mathbf{G}^{-}\mathbf{B}\mathbf{g}_x \, , \]</div>
<p>where we have denoted the gradient in Cartesian coordinates by <span class="math notranslate nohighlight">\(\mathbf{g}_x\)</span> and the gradient in internal coordinates by <span class="math notranslate nohighlight">\(\mathbf{g}_q\)</span>.</p>
<p>With Eqs.<a class="reference internal" href="#equation-eq-displacement-q-to-x">(70)</a> and <a class="reference internal" href="#equation-eq-gradient-x-to-q">(71)</a> we can now transform a displacement in internal coordinates to a displacement in Cartesian coordinates, compute the energy gradient, and transform the gradient back to internal coordinates.</p>
<p>In the case of the Hessian matrix, the transformation to internal coordinates requires the second order derivatives of <span class="math notranslate nohighlight">\(q_i\)</span> with respect to the Cartesian coordinates <span class="math notranslate nohighlight">\(x_j\)</span>, <span class="math notranslate nohighlight">\(x_k\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-bp-ij">
<span class="eqno">(72)<a class="headerlink" href="#equation-eq-bp-ij" title="Permalink to this equation">¶</a></span>\[    B^{(2)}_{ijk} = \frac{\partial^2 q_i}{\partial x_j\partial x_k}\,.\]</div>
<p>These derivatives, together with <span class="math notranslate nohighlight">\(\mathbf{G}^{-}\)</span>, the Wilson <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> matrix and gradient are then used to trasform the Hessian from Cartesian (<span class="math notranslate nohighlight">\(\mathbf{H}_x\)</span>) to internal (<span class="math notranslate nohighlight">\(\mathbf{H}_q\)</span>) coordinates:</p>
<div class="math notranslate nohighlight" id="equation-eq-hessian-int">
<span class="eqno">(73)<a class="headerlink" href="#equation-eq-hessian-int" title="Permalink to this equation">¶</a></span>\[    \mathbf{H}_q = \mathbf{G}^{-} \mathbf{B} \left[ \mathbf{H}_x - \mathbf{g}_q \mathbf{B}^{(2)}\right]\mathbf{B}^\mathrm{T} \mathbf{G}^{-\mathrm{T}}\,.\]</div>
<p>After these transformations are carried out, further transformations to related internal coordinates, for example to use <span class="math notranslate nohighlight">\(1/R\)</span> instead of the <span class="math notranslate nohighlight">\(R\)</span> (bond length), are easy to implement, as illustrated below for the gradient. Given the gradient in terms of <span class="math notranslate nohighlight">\(R\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-grad-r">
<span class="eqno">(74)<a class="headerlink" href="#equation-eq-grad-r" title="Permalink to this equation">¶</a></span>\[    g(R) = \frac{\mathrm{d} E}{\mathrm{d}R},\]</div>
<p>the transformation to <span class="math notranslate nohighlight">\(u=1/R\)</span> is a simple change of variables:</p>
<div class="math notranslate nohighlight" id="equation-eq-grad-rinv">
<span class="eqno">(75)<a class="headerlink" href="#equation-eq-grad-rinv" title="Permalink to this equation">¶</a></span>\[    g(u) = \frac{\mathrm{d} E}{\mathrm{d}u}=\frac{\mathrm{d} E}{\mathrm{d}R}\frac{\mathrm{d} R}{\mathrm{d}u} = \frac{\mathrm{d} E}{\mathrm{d}R}\frac{\mathrm{d} u^{-1}}{\mathrm{d}u} =  -u^{-2}\,g(R) =  -R^{2} \,g(R)\,.\]</div>
<p>The transformation of the Hessian can be carried out similarly.</p>
</div>
</div>
<div class="section" id="delocalized-internal-coordinates">
<h2>Delocalized internal coordinates<a class="headerlink" href="#delocalized-internal-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Geometry optimizations using internal coordinates require, as we have seen above, to find the generalized inverse matrix <span class="math notranslate nohighlight">\(\mathbf{G}\)</span>. This is an expensive step, since the matrices involved in Eq. <a class="reference internal" href="#equation-eq-generalized-inverse">(69)</a> are constructed in terms of the primitive internal coordinates which are very numerous. One idea to reduce this computational cost is to use the non-redundant coordinates defined in Eq. <a class="reference internal" href="#equation-eq-non-redundant">(68)</a>. These new coordinates are actually linear combinations of primitives, and therefore are called “delocalized” internal coordinates (DLC) <span id="id7">[<a class="reference internal" href="refs.html#id128">BKP99</a>]</span>.</p>
<p>Within this coordinate system, we define a new <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> matrix which now has a significantly smaller dimension (3<span class="math notranslate nohighlight">\(N\)</span>-6) compared to the <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> matrix in primitive internal coordinates. The new <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> matrix is then used to reformulate the displacement and gradient transformations between the Cartesian and delocalized internal coordinate systems. For a detailed derivation of these transformations see Ref. <span id="id8">[<a class="reference internal" href="refs.html#id128">BKP99</a>]</span>.</p>
<div class="section" id="hybrid-delocalized-internal-coordinates">
<h3>Hybrid delocalized internal coordinates<a class="headerlink" href="#hybrid-delocalized-internal-coordinates" title="Permalink to this headline">¶</a></h3>
<p>The situation becomes a bit more complicated when the system we would like to optimize is composed of two ore more individual molecules. In this case, fictitious intermolecular bonds, angles, and dihedrals have to be included to define the relative positions between the separate components of the multi-molecular system <span id="id9">[<a class="reference internal" href="refs.html#id129">BTT00</a>, <a class="reference internal" href="refs.html#id124">WS16</a>]</span>. In an analogous way as for single molecules, hybrid delocalized internal coordinates (HDLC) can be obtained by including the intermolecular primitives in the transformation defined by Eq. <a class="reference internal" href="#equation-eq-non-redundant">(68)</a>. In this approach, the intra- and intermolecular degrees of freedom become mixed, i.e., a displacement in one intermolecular primitive will affects both the intramolecular and intermolecular structures <span id="id10">[<a class="reference internal" href="refs.html#id124">WS16</a>]</span>.</p>
</div>
</div>
<div class="section" id="translation-rotation-internal-coordinates">
<h2>Translation–rotation internal coordinates<a class="headerlink" href="#translation-rotation-internal-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Another option is to treat the intra- and intermolecular coordinates separately, by introducing translation and rotation coordinates into the set of internal primitives. The resulting choice of coordinates are known as translation–rotation internal coordinates (TRIC) <span id="id11">[<a class="reference internal" href="refs.html#id124">WS16</a>]</span>. What this actually means is that, instead of adding the full set of Cartesian coordinates in the construction of primitive internal coordinates (HDLC), only six new internal coordinates are used for each molecule to describe its translation and rotation, essentially constraining the intermolecular orientations. This reduces the computational cost and represents a more intuitive way to define the relative orientation between molecules <span id="id12">[<a class="reference internal" href="refs.html#id124">WS16</a>]</span>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="pes-general.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">General aspects</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="gradients.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Gradients</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The eChem team<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>