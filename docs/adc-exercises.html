
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercises &#8212; Computational Chemistry from  Laptop to HPC</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exciton coupling model" href="excoupl.html" />
    <link rel="prev" title="HPC-QC implementation" href="adc-hpc.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Chemistry from  Laptop to HPC</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Getting started
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials and workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="vibrational.html">
   Vibrational spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ir.html">
     IR spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="raman.html">
     Raman spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ir_raman_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="uv-vis.html">
   UV/vis spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_rec.html">
     Recommendations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="xray.html">
   X-ray spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_nonstandard.html">
     Non-standard calculations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_rec.html">
     Recommendations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_exercises.html">
     Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_cheat.html">
     Cheat sheet
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Electronic ground states
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="elecstruct-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="orbitals.html">
     Orbitals and basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="slater.html">
     Many-electron wave functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="operators.html">
     Operators and matrix elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals.html">
     Integral evaluation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="spin.html">
     Electron spin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="correlation.html">
     Electron correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="perturbation_theory.html">
     Rayleigh–Schrödinger perturbation theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="secondquant.html">
     Second quantization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="wft.html">
   Wave function theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hartree-fock.html">
     Hartree–Fock theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ci.html">
     Configuration interaction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mp2.html">
     Møller–Plesset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mcscf.html">
     Multiconfigurational methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="wft-exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dft.html">
   Density functional theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hohenberg.html">
     Hohenberg–Kohn theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kohn-sham.html">
     Kohn–Sham method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kernel_integration.html">
     Kernel integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dft_scf.html">
     SCF optimization of a closed-shell state
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Molecular structure and dynamics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="struct-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="coordinates.html">
     Choice of coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="forcefields.html">
     Force fields
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="gradients.html">
   Gradients
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="energy_grad.html">
     Energy gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="property_grad.html">
     Property gradients
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="hess-vib.html">
   Hessians and vibrations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hessians.html">
     Molecular Hessians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vibrations.html">
     Vibrational analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="structopt-overview.html">
   Structure optimization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="structopt.html">
     Optimization methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gsstructopt.html">
     Ground-state structure optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tst.html">
   Transition-state theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="transition_state.html">
     Transition state geometry optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="impes-overview.html">
   PES interpolation techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="impes.html">
     Constructing the PES by interpolation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="moldyn.html">
   Molecular dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="md_ffs.html">
     Force field parameterization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_setup.html">
     Ensembles and time integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_run.html">
     Running a simulation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Spectra and properties
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="spectra_aspects.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="vibrot.html">
     Rovibronic states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="response.html">
     Responses to external fields
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tddft.html">
   TDDFT
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="tddft_basics.html">
     Foundations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tddft_rpa.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tddft_ex.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mr-response.html">
   Multireference response
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ci-response.html">
     CI response
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sa-mcscf.html">
     State-averaged MCSCF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mr-response-exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="adc.html">
   ADC
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="adc-pp.html">
     Polarization propagator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adc-isr.html">
     Intermediate state representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adc-cvs.html">
     Core-valence separation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adc-hpc.html">
     HPC-QC implementation
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="excoupl.html">
   Exciton coupling model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="excoupl_impl.html">
     Implementation of the exciton coupling model
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="localprop.html">
   Localized properties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="esp.html">
     ESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="resp.html">
     RESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="loprop.html">
     LoProp charges and polarisabilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="pe.html">
   Polarizable embedding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="pe_basics.html">
     General aspects
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Visualization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="vis_structure.html">
   Molecular structure and dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="struct_vis.html">
     Molecular structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_vis.html">
     MD trajectories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="opt_vib_vis.html">
     Optimization and normal modes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="elec_vis.html">
   Electronic structure
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="orb_vis.html">
     Orbitals and densities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="exc_vis.html">
     Excited states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dens_vis.html">
     Reduced particle densities
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bibliography
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cite.html">
   How to cite
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="refs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/adc-exercises.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kthpanor/echem"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/adc-exercises.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kthpanor/echem/master?urlpath=tree/docs/docs/adc-exercises.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-reference-state">
   Calculate reference state
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#construct-the-adc-1-matrix">
   Construct the ADC(1) matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adc-calculation-in-gator">
   ADC calculation in Gator
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#obtain-and-diagonalize-the-full-adc-1-matrix">
   Obtain and diagonalize the full ADC(1) matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#core-excited-states-and-core-valence-separation-cvs-approximation">
   Core-excited states and core-valence separation (CVS) approximation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transition-moments-and-oscillator-strengths">
   Transition moments and oscillator strengths
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Exercises</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-reference-state">
   Calculate reference state
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#construct-the-adc-1-matrix">
   Construct the ADC(1) matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adc-calculation-in-gator">
   ADC calculation in Gator
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#obtain-and-diagonalize-the-full-adc-1-matrix">
   Obtain and diagonalize the full ADC(1) matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#core-excited-states-and-core-valence-separation-cvs-approximation">
   Core-excited states and core-valence separation (CVS) approximation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transition-moments-and-oscillator-strengths">
   Transition moments and oscillator strengths
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="exercises">
<h1>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h1>
<p>In this exercise, we will implement the closed-shell restricted ADC(1) matrix yourself and diagonalize it to obtain excitation energies. We will use <a class="reference internal" href="intro.html#sec-gator"><span class="std std-ref">Gator</span></a> to compare the results and obtain both singlet and triplet excitation energies. Furthermore, we will consider the core-valence separation (CVS) approximation for the calculation of core-excited states.</p>
<p>First, we define a small molecule (lithium hydride) and minimal basis set (STO-3G).</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
<span class="kn">import</span> <span class="nn">gator</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span> <span class="k">as</span> <span class="nn">p3d</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">veloxchem.mointsdriver</span> <span class="kn">import</span> <span class="n">MOIntegralsDriver</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Conversion from Hartree to eV for later use</span>
<span class="n">au2ev</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">veloxchemlib</span><span class="o">.</span><span class="n">hartree_in_ev</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">au2ev</span><span class="p">)</span>

<span class="n">lih_xyz</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;2</span>

<span class="s2">Li  0.000000   0.000000   0.000000</span>
<span class="s2">H   0.000000   0.000000   1.000000</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">lih</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">lih_xyz</span><span class="p">)</span>

<span class="c1"># Method and basis set</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;adc1&#39;</span>
<span class="n">basis_set_label</span> <span class="o">=</span> <span class="s2">&quot;sto-3g&quot;</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis_set_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Warning * Environment variable OMP_NUM_THREADS not set.
* Warning * Setting OMP_NUM_THREADS to 4.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Warning * Setting MKL_THREADING_LAYER to &quot;INTEL&quot;.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27.211386245988
</pre></div>
</div>
</div>
</div>
<div class="section" id="calculate-reference-state">
<h2>Calculate reference state<a class="headerlink" href="#calculate-reference-state" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SCF will be run by VeloxChem through Gator</span>
<span class="n">scf</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_scf</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">conv_thresh</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-10                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 1.5875316327 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.01 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -7.700339131917 a.u. Time: 0.03 sec.                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1        -7.754598884992    0.0000000000      0.11640130      0.02003396      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2        -7.766253797554   -0.0116549126      0.02865771      0.00623056      0.16614678                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3        -7.767359946315   -0.0011061488      0.00245225      0.00058050      0.06952428                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4        -7.767362132932   -0.0000021866      0.00013369      0.00003556      0.00290197                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5        -7.767362137063   -0.0000000041      0.00002228      0.00000633      0.00013144                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6        -7.767362137239   -0.0000000002      0.00000168      0.00000050      0.00002351                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7        -7.767362137240   -0.0000000000      0.00000000      0.00000000      0.00000192                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8        -7.767362137240    0.0000000000      0.00000000      0.00000000      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  9        -7.767362137240   -0.0000000000      0.00000000      0.00000000      0.00000001                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 10        -7.767362137240    0.0000000000      0.00000000      0.00000000      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 10 iterations. Time: 0.03 sec.                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :       -7.7673621372 a.u.                                              
               Electronic Energy                  :       -9.3548937699 a.u.                                              
               Nuclear Repulsion Energy           :        1.5875316327 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000000001 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -2.37090 a.u.                                                                  
               (   1 Li  1s  :     0.99)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.31666 a.u.                                                                  
               (   1 Li  1s  :     0.26) (   1 Li  2s  :    -0.39) (   1 Li  1p0 :    -0.38)                              
               (   2 H   1s  :    -0.55)                                                                                  
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.07685 a.u.                                                                  
               (   1 Li  1s  :     0.19) (   1 Li  2s  :    -0.84) (   1 Li  1p0 :     0.59)                              
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.15794 a.u.                                                                  
               (   1 Li  1p+1:     0.17) (   1 Li  1p-1:    -0.99)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.15794 a.u.                                                                  
               (   1 Li  1p+1:     0.99) (   1 Li  1p-1:     0.17)                                                        
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.61300 a.u.                                                                  
               (   1 Li  2s  :     0.93) (   1 Li  1p0 :     1.12) (   2 H   1s  :    -1.47)                              
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p><strong>Look at the molecular orbitals</strong></p>
<ul class="simple">
<li><p>Can you assign symmetry labels to the orbitals?</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> orbitals are rotationally symmetric around the molecular axis (projection of the electron’s angular momentum onto the molecular axis <span class="math notranslate nohighlight">\(\lambda = 0\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(\pi\)</span> orbitals have one nodal plane along the axis (<span class="math notranslate nohighlight">\(\lambda = \pm 1\)</span>)</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">orb_viewer</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OrbitalViewer</span><span class="p">()</span>
<span class="n">orb_viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">)</span>
</pre></div>
</div>
<div class="toggle docutils container">
<p>Assuming that blue = positive, red = negative</p>
<ul class="simple">
<li><p>Orbital 1: <span class="math notranslate nohighlight">\(1\sigma\)</span> (Li 1s)</p></li>
<li><p>Orbital 2: <span class="math notranslate nohighlight">\(2\sigma\)</span> (Li 2s + Li 2p<span class="math notranslate nohighlight">\(_z\)</span> - H 1s)</p></li>
<li><p>Orbital 3: <span class="math notranslate nohighlight">\(3\sigma\)</span> (-Li 2s + Li 2p<span class="math notranslate nohighlight">\(_z\)</span> + H 1s)</p></li>
<li><p>Orbital 4: <span class="math notranslate nohighlight">\(1\pi^*\)</span> (Li 2p<span class="math notranslate nohighlight">\(_x\)</span>)</p></li>
<li><p>Orbital 5: <span class="math notranslate nohighlight">\(2\pi^*\)</span> (Li 2p<span class="math notranslate nohighlight">\(_y\)</span>)</p></li>
<li><p>Orbital 6: <span class="math notranslate nohighlight">\(4\sigma^*\)</span> (-Li 2s + Li 2p<span class="math notranslate nohighlight">\(_z\)</span> - H 1s)</p></li>
</ul>
</div>
</div>
<div class="section" id="construct-the-adc-1-matrix">
<h2>Construct the ADC(1) matrix<a class="headerlink" href="#construct-the-adc-1-matrix" title="Permalink to this headline">¶</a></h2>
<p>The ADC(1) matrix <span class="math notranslate nohighlight">\(\mathbf{M} = \mathbf{M}^{(0)} + \mathbf{M}^{(1)}\)</span> in a <em>spin-orbital basis</em> is given by</p>
<div class="math notranslate nohighlight">
\[
  M_{ia,jb} = (\varepsilon_a - \varepsilon_i) \delta_{ij} \delta_{ab} - \langle ja || ib \rangle \, ,
\]</div>
<p>which for a closed-shell restricted HF reference can be written in terms of <em>spatial</em> orbitals as</p>
<div class="math notranslate nohighlight">
\[
   M_{ia,jb} = (\varepsilon_a - \varepsilon_i) \delta_{ij} \delta_{ab} + 2 \langle i j | a b \rangle  - \langle j a | i b \rangle \, ,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\varepsilon_p\)</span> are HF orbital energies and <span class="math notranslate nohighlight">\(\langle p q | r s \rangle\)</span> are two-electron repulsion integrals in physicists’ (“1212”) notation.</p>
<ul class="simple">
<li><p>We look at a very simple example of the LiH molecule in a minimal basis (STO-3G), having two occupied and four virtual orbitals</p></li>
<li><p>The first task is to construct the closed-shell ADC(1) matrix “by hand.” For this, we need the HF orbital energies (collected in a diagonal matrix) and the two-electron integrals</p></li>
<li><p>You can also construct the ADC(0) matrix (<span class="math notranslate nohighlight">\(\mathbf{M} = \mathbf{M}^{(0)}\)</span>), which consists only of the orbital-energy differences on the diagonal</p></li>
</ul>
<p>Extract MO energies and two-electron integrals:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MO energies in diagonal matrix</span>
<span class="n">mo_energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">scf_tensors</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">])</span>

<span class="c1"># Two-electron integrals from vlx</span>
<span class="n">moints_drv</span> <span class="o">=</span> <span class="n">MOIntegralsDriver</span><span class="p">()</span>
<span class="n">oovv</span> <span class="o">=</span> <span class="n">moints_drv</span><span class="o">.</span><span class="n">compute_in_mem</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="s2">&quot;OOVV&quot;</span><span class="p">)</span>
<span class="n">ovov</span> <span class="o">=</span> <span class="n">moints_drv</span><span class="o">.</span><span class="n">compute_in_mem</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="s2">&quot;OVOV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Construct matrix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of occupied and virtual orbitals</span>
<span class="n">nocc</span> <span class="o">=</span> <span class="n">lih</span><span class="o">.</span><span class="n">number_of_alpha_electrons</span><span class="p">()</span>
<span class="n">norb</span> <span class="o">=</span> <span class="n">mo_energies</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nvir</span> <span class="o">=</span> <span class="n">norb</span> <span class="o">-</span> <span class="n">nocc</span>
<span class="n">nexc</span> <span class="o">=</span> <span class="n">nocc</span> <span class="o">*</span> <span class="n">nvir</span> <span class="c1"># number of excited (singlet or triplet) states in ADC(1)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nocc: &quot;</span><span class="p">,</span> <span class="n">nocc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nvir: &quot;</span><span class="p">,</span> <span class="n">nvir</span><span class="p">)</span>

<span class="c1"># ADC matrices with zeroes</span>
<span class="n">adc0_mat4d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">))</span>
<span class="n">adc1_mat4d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">))</span>

<span class="c1"># Loop over all indices and fill matrix with corresponding elements</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nocc</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvir</span><span class="p">):</span>
        <span class="c1"># Fill the diagonal (orbital-energy differences)</span>
        <span class="n">adc0_mat4d</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
        <span class="n">adc1_mat4d</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nocc</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvir</span><span class="p">):</span>
                <span class="c1"># Fill the rest (two-electron integrals)</span>
                <span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of occupied and virtual orbitals</span>
<span class="n">nocc</span> <span class="o">=</span> <span class="n">lih</span><span class="o">.</span><span class="n">number_of_alpha_electrons</span><span class="p">()</span>
<span class="n">norb</span> <span class="o">=</span> <span class="n">mo_energies</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nvir</span> <span class="o">=</span> <span class="n">norb</span> <span class="o">-</span> <span class="n">nocc</span>
<span class="n">nexc</span> <span class="o">=</span> <span class="n">nocc</span> <span class="o">*</span> <span class="n">nvir</span> <span class="c1"># number of excited (singlet or triplet) states in ADC(1)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nocc: &quot;</span><span class="p">,</span> <span class="n">nocc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nvir: &quot;</span><span class="p">,</span> <span class="n">nvir</span><span class="p">)</span>

<span class="c1"># ADC matrices with zeroes</span>
<span class="n">adc0_mat4d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">))</span>
<span class="n">adc1_mat4d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">,</span> <span class="n">nocc</span><span class="p">,</span> <span class="n">nvir</span><span class="p">))</span>

<span class="c1"># Loop over all indices and fill matrix with corresponding elements</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nocc</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvir</span><span class="p">):</span>
        <span class="c1"># Fill the diagonal (orbital-energy differences)</span>
        <span class="n">adc0_mat4d</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">mo_energies</span><span class="p">[</span><span class="n">nocc</span><span class="o">+</span><span class="n">a</span><span class="p">,</span><span class="n">nocc</span><span class="o">+</span><span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="n">mo_energies</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
        <span class="n">adc1_mat4d</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">mo_energies</span><span class="p">[</span><span class="n">nocc</span><span class="o">+</span><span class="n">a</span><span class="p">,</span><span class="n">nocc</span><span class="o">+</span><span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="n">mo_energies</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nocc</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvir</span><span class="p">):</span>
                <span class="c1"># Fill the rest (two-electron integrals)</span>
                <span class="n">adc1_mat4d</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">-=</span> <span class="n">ovov</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">b</span><span class="p">]</span>
                <span class="n">adc1_mat4d</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">oovv</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nocc:  2
nvir:  4
</pre></div>
</div>
</div>
</div>
<p>Reshape:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reshape the 4D into 2D matrices (and print them if you like)</span>
<span class="n">adc0_mat2d</span> <span class="o">=</span> <span class="o">...</span>
<span class="c1">#print(&quot;ADC(0) matrix:\n&quot;, adc0_mat2d.shape, &quot;\n&quot;, adc0_mat2d)</span>

<span class="n">adc1_mat2d</span> <span class="o">=</span> <span class="o">...</span>
<span class="c1">#print(&quot;\nclosed-shell ADC(1) matrix:\n&quot;, adc1_mat2d.shape, &quot;\n&quot;, adc1_mat2d)</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reshape the 4D into 2D matrices</span>
<span class="n">adc0_mat2d</span> <span class="o">=</span> <span class="n">adc0_mat4d</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nocc</span><span class="o">*</span><span class="n">nvir</span><span class="p">,</span> <span class="n">nocc</span><span class="o">*</span><span class="n">nvir</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ADC(0) matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc0_mat2d</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc0_mat2d</span><span class="p">)</span>
<span class="n">adc1_mat2d</span> <span class="o">=</span> <span class="n">adc1_mat4d</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nocc</span><span class="o">*</span><span class="n">nvir</span><span class="p">,</span> <span class="n">nocc</span><span class="o">*</span><span class="n">nvir</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">closed-shell ADC(1) matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc1_mat2d</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc1_mat2d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADC(0) matrix:
 (8, 8) 
 [[2.44775 0.      0.      0.      0.      0.      0.      0.     ]
 [0.      2.52884 0.      0.      0.      0.      0.      0.     ]
 [0.      0.      2.52884 0.      0.      0.      0.      0.     ]
 [0.      0.      0.      2.9839  0.      0.      0.      0.     ]
 [0.      0.      0.      0.      0.39351 0.      0.      0.     ]
 [0.      0.      0.      0.      0.      0.4746  0.      0.     ]
 [0.      0.      0.      0.      0.      0.      0.4746  0.     ]
 [0.      0.      0.      0.      0.      0.      0.      0.92966]]

closed-shell ADC(1) matrix:
 (8, 8) 
 [[ 2.09257 -0.       0.      -0.0027  -0.01754  0.      -0.       0.01495]
 [-0.       2.15253  0.      -0.      -0.      -0.02263  0.       0.     ]
 [ 0.       0.       2.15253  0.       0.       0.      -0.02263  0.     ]
 [-0.0027  -0.       0.       2.61432 -0.00275 -0.       0.      -0.00196]
 [-0.01754 -0.       0.      -0.00275  0.16579 -0.       0.      -0.00932]
 [ 0.      -0.02263  0.      -0.      -0.       0.22846  0.      -0.     ]
 [-0.       0.      -0.02263  0.       0.       0.       0.22846 -0.     ]
 [ 0.01495  0.       0.      -0.00196 -0.00932 -0.      -0.       0.7151 ]]
</pre></div>
</div>
</div>
</div>
<p>And diagonalize the ADC(1) matrix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">adc1_eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closed-shell ADC(1)/STO-3G eigenvalues:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc1_eigvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Diagonalize the ADC(1) matrix using numpy</span>
<span class="n">adc1_eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="n">adc1_mat2d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closed-shell ADC(1) eigenvalues:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc1_eigvals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Closed-shell ADC(1) eigenvalues:
 [0.16547 0.22819 0.22819 0.71508 2.09288 2.1528  2.1528  2.61434]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Now we want to compare the obtained eigenvalues with the results from Gator</p></li>
</ul>
</div>
<div class="section" id="adc-calculation-in-gator">
<h2>ADC calculation in Gator<a class="headerlink" href="#adc-calculation-in-gator" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adc_results</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_adc</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;adc1&#39;</span><span class="p">,</span>
                            <span class="n">singlets</span><span class="o">=</span><span class="n">nexc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Numpy 1.16 has memory leak bug  https://github.com/numpy/numpy/issues/13808
It is recommended to downgrade to numpy 1.15 or older
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">ky</span><span class="o">/</span><span class="mi">5</span><span class="n">h8mb6gs32nbvf3w8cyqwrhm0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_36020</span><span class="o">/</span><span class="mf">660788326.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">adc_results</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_adc</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;adc1&#39;</span><span class="p">,</span>
<span class="ne">----&gt; </span><span class="mi">2</span>                             <span class="n">singlets</span><span class="o">=</span><span class="n">nexc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/gator/gatorutils.py</span> in <span class="ni">run_adc</span><span class="nt">(mol, basis, scf_drv, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span> 
<span class="g g-Whitespace">    </span><span class="mi">156</span>     <span class="n">task</span> <span class="o">=</span> <span class="n">MockTask</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">ostream</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">157</span>     <span class="k">return</span> <span class="n">adc_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">scf_drv</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/gator/adcdriver.py</span> in <span class="ni">compute</span><span class="nt">(self, task, scf_drv, verbose)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>                                        <span class="n">frozen_core</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">adc_frozen_core</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>                                        <span class="n">frozen_virtual</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">adc_frozen_virtual</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">303</span>                                        <span class="n">conv_tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">adc_tol</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span> 
<span class="g g-Whitespace">    </span><span class="mi">305</span>                 <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/adcc/workflow.py</span> in <span class="ni">run_adc</span><span class="nt">(data_or_matrix, n_states, kind, conv_tol, eigensolver, guesses, n_guesses, n_guesses_doubles, output, core_orbitals, frozen_core, frozen_virtual, method, n_singlets, n_triplets, n_spin_flip, environment, **solverargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>     <span class="n">matrix</span> <span class="o">=</span> <span class="n">construct_adcmatrix</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span>         <span class="n">data_or_matrix</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="n">core_orbitals</span><span class="p">,</span> <span class="n">frozen_core</span><span class="o">=</span><span class="n">frozen_core</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">181</span>         <span class="n">frozen_virtual</span><span class="o">=</span><span class="n">frozen_virtual</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span> 
<span class="g g-Whitespace">    </span><span class="mi">183</span>     <span class="n">n_states</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="n">validate_state_parameters</span><span class="p">(</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/adcc/workflow.py</span> in <span class="ni">construct_adcmatrix</span><span class="nt">(data_or_matrix, core_orbitals, frozen_core, frozen_virtual, method)</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span>                                            <span class="n">core_orbitals</span><span class="o">=</span><span class="n">core_orbitals</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span>                                            <span class="n">frozen_core</span><span class="o">=</span><span class="n">frozen_core</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">248</span>                                            <span class="n">frozen_virtual</span><span class="o">=</span><span class="n">frozen_virtual</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>         <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">250</span>             <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>  <span class="c1"># In case of an issue with the spaces</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/adcc/ReferenceState.py</span> in <span class="ni">__init__</span><span class="nt">(self, hfdata, core_orbitals, frozen_core, frozen_virtual, symmetry_check_on_import, import_all_below_n_orbs)</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span>         <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">141</span><span class="sd">         if not isinstance(hfdata, libadcc.HartreeFockSolution_i):</span>
<span class="ne">--&gt; </span><span class="mi">142</span><span class="sd">             hfdata = import_scf_results(hfdata)</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">144</span><span class="sd">         self._mospaces = MoSpaces(hfdata, frozen_core=frozen_core,</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/adcc/backends/__init__.py</span> in <span class="ni">import_scf_results</span><span class="nt">(res)</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span><span class="sd">     and guess what the host program was and how to import it.</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">60</span>     <span class="k">if</span> <span class="n">have_backend</span><span class="p">(</span><span class="s2">&quot;pyscf&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span>         <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">pyscf</span> <span class="k">as</span> <span class="n">backend_pyscf</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>         <span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/adcc/backends/__init__.py</span> in <span class="ni">have_backend</span><span class="nt">(backend)</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span> <span class="k">def</span> <span class="nf">have_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span>     <span class="sd">&quot;&quot;&quot;Is a particular backend available?&quot;&quot;&quot;</span>
<span class="nn">---&gt; 52     return backend</span> in <span class="ni">available</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> 
<span class="g g-Whitespace">     </span><span class="mi">54</span> 

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/adcc/backends/__init__.py</span> in <span class="ni">available</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">__status</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>         <span class="n">status</span> <span class="o">=</span> <span class="p">{</span>
<span class="ne">---&gt; </span><span class="mi">41</span>             <span class="s2">&quot;pyscf&quot;</span><span class="p">:</span> <span class="n">is_module_available</span><span class="p">(</span><span class="s2">&quot;pyscf&quot;</span><span class="p">,</span> <span class="s2">&quot;1.5.0&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>             <span class="s2">&quot;psi4&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">is_module_available</span><span class="p">(</span><span class="s2">&quot;psi4&quot;</span><span class="p">,</span> <span class="s2">&quot;1.3.0&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>                      <span class="ow">and</span> <span class="n">is_module_available</span><span class="p">(</span><span class="s2">&quot;psi4.core&quot;</span><span class="p">)),</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/adcc/misc.py</span> in <span class="ni">is_module_available</span><span class="nt">(module, min_version)</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span> 
<span class="g g-Whitespace">    </span><span class="mi">124</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">125</span>         <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span>     <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span>         <span class="k">return</span> <span class="kc">False</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/importlib/__init__.py</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>                 <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span>             <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">127</span>     <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span> 
<span class="g g-Whitespace">    </span><span class="mi">129</span> 

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/importlib/_bootstrap.py</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/importlib/_bootstrap_external.py</span> in <span class="ni">exec_module</span><span class="nt">(self, module)</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/importlib/_bootstrap.py</span> in <span class="ni">_call_with_frames_removed</span><span class="nt">(f, *args, **kwds)</span>

<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">echem</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span> <span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">__config__</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="ne">---&gt; </span><span class="mi">62</span> <span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span> <span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> <span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">ao2mo</span>

<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">echem</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">gto</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="c1">#</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> 
<span class="ne">---&gt; </span><span class="mi">19</span> <span class="kn">from</span> <span class="nn">pyscf.gto</span> <span class="kn">import</span> <span class="n">mole</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="kn">from</span> <span class="nn">pyscf.gto</span> <span class="kn">import</span> <span class="n">basis</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="kn">from</span> <span class="nn">pyscf.gto.basis</span> <span class="kn">import</span> <span class="n">parse</span><span class="p">,</span> <span class="n">load</span><span class="p">,</span> <span class="n">parse_ecp</span><span class="p">,</span> <span class="n">load_ecp</span>

<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">echem</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">gto</span><span class="o">/</span><span class="n">mole</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span> <span class="kn">from</span> <span class="nn">pyscf.gto</span> <span class="kn">import</span> <span class="n">cmd_args</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span> <span class="kn">from</span> <span class="nn">pyscf.gto</span> <span class="kn">import</span> <span class="n">basis</span>
<span class="ne">---&gt; </span><span class="mi">37</span> <span class="kn">from</span> <span class="nn">pyscf.gto</span> <span class="kn">import</span> <span class="n">moleintor</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span> <span class="kn">from</span> <span class="nn">pyscf.gto.eval_gto</span> <span class="kn">import</span> <span class="n">eval_gto</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span> <span class="kn">from</span> <span class="nn">pyscf.gto</span> <span class="kn">import</span> <span class="n">ecp</span>

<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">echem</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pyscf</span><span class="o">/</span><span class="n">gto</span><span class="o">/</span><span class="n">moleintor</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> 
<span class="ne">---&gt; </span><span class="mi">29</span> <span class="n">libcgto</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">load_library</span><span class="p">(</span><span class="s1">&#39;libcgto&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> 
<span class="g g-Whitespace">     </span><span class="mi">31</span> <span class="n">ANG_OF</span>     <span class="o">=</span> <span class="mi">1</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/misc.py</span> in <span class="ni">load_library</span><span class="nt">(libname)</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span>             <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="s1">&#39;Unknown platform&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span>         <span class="n">libname_so</span> <span class="o">=</span> <span class="n">libname</span> <span class="o">+</span> <span class="n">so_ext</span>
<span class="ne">---&gt; </span><span class="mi">60</span>         <span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">CDLL</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="n">libname_so</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>         <span class="n">_loaderpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>

<span class="nn">/opt/miniconda3/envs/echem/lib/python3.7/ctypes/__init__.py</span> in <span class="ni">__init__</span><span class="nt">(self, name, mode, handle, use_errno, use_last_error)</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span> 
<span class="g g-Whitespace">    </span><span class="mi">363</span>         <span class="k">if</span> <span class="n">handle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">364</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="n">_dlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">365</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="n">handle</span>

<span class="ne">OSError</span>: dlopen(/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/libcgto.dylib, 0x0006): Library not loaded: &#39;@rpath/libcint.3.0.13.dylib&#39;
  <span class="n">Referenced</span> <span class="n">from</span><span class="p">:</span> <span class="s1">&#39;/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/libcgto.dylib&#39;</span>
  <span class="n">Reason</span><span class="p">:</span> <span class="n">tried</span><span class="p">:</span> <span class="s1">&#39;/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/../../../../libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/../../../../libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;/opt/miniconda3/envs/echem/lib/python3.7/lib-dynload/../../libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;/opt/miniconda3/envs/echem/bin/../lib/libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;/usr/local/lib/libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;/usr/lib/libcint.3.0.13.dylib&#39;</span> <span class="p">(</span><span class="n">no</span> <span class="n">such</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can print a summary of the results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adc_results</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># Or plot the absorbtion spectrum</span>
<span class="n">adc_results</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;adc(1)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------------+
| adc1                          singlet ,  converged |
+----------------------------------------------------+
|  #        excitation energy     osc str    |v1|^2  |
|          (au)           (eV)                       |
|  0     0.1654741      4.502781   0.0027         1  |
|  1     0.2281949        6.2095   0.2522         1  |
|  2     0.2281949        6.2095   0.2522         1  |
|  3      0.715084      19.45843   0.0042         1  |
|  4      2.092884      56.95026   0.0689         1  |
|  5      2.152797      58.58059   0.1225         1  |
|  6      2.152797      58.58059   0.1225         1  |
|  7      2.614337      71.13974   0.0000         1  |
+----------------------------------------------------+
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f17f9596bb0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f17f958ab20&gt;]
</pre></div>
</div>
<img alt="../_images/adc-exercises_18_2.png" src="../_images/adc-exercises_18_2.png" />
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare the two results for the excitation energies</span>
<span class="c1"># Gator saves them in the member variable &quot;excitation_energy&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closed-shell ADC(1)/STO-3G eigenvalues:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ADC(1)/STO-3G singlet excitation energies:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare the two results for the excitation energies</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closed-shell ADC(1)/STO-3G eigenvalues:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc1_eigvals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ADC(1)/STO-3G singlet excitation energies:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Closed-shell ADC(1)/STO-3G eigenvalues:
 [0.16547 0.22819 0.22819 0.71508 2.09288 2.1528  2.1528  2.61434]

ADC(1)/STO-3G singlet excitation energies:
 [0.16547 0.22819 0.22819 0.71508 2.09288 2.1528  2.1528  2.61434]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>You should see that the two results are identical</p></li>
</ul>
</div>
<div class="section" id="obtain-and-diagonalize-the-full-adc-1-matrix">
<h2>Obtain and diagonalize the full ADC(1) matrix<a class="headerlink" href="#obtain-and-diagonalize-the-full-adc-1-matrix" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>One can get the full ADC(1) matrix in spin-orbital basis from Gator</p></li>
<li><p>Confirm that it is four times as large as the closed-shell restricted one (having <span class="math notranslate nohighlight">\(\alpha\alpha, \alpha\beta, \beta\alpha\)</span>, and <span class="math notranslate nohighlight">\(\beta\beta\)</span> blocks)</p></li>
<li><p>The next task is to diagonalize it and have a look at the excitation energies and their degeneracies</p></li>
<li><p>Can you assign term symbols (singlet or triplet, <span class="math notranslate nohighlight">\(\Sigma\)</span> or <span class="math notranslate nohighlight">\(\Pi\)</span> state) to the respective excited states?</p>
<ul>
<li><p>Hint: the symmetry labels of the orbitals and degeneracies should be able to help you</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is the full matrix</span>
<span class="n">gator_adc_matrix</span> <span class="o">=</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">()</span>
<span class="c1"># Print the matrix and its shape</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gator_adc_matrix</span> <span class="o">=</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gator_adc_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gator_adc_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(32, 32)
[[ 2.07311 -0.      -0.      ...  0.       0.      -0.01296]
 [-0.       2.14264  0.      ... -0.00831  0.       0.     ]
 [-0.       0.       2.14264 ...  0.      -0.00831 -0.     ]
 ...
 [ 0.      -0.00831  0.      ...  0.20128  0.       0.     ]
 [ 0.       0.      -0.00831 ...  0.       0.20128 -0.     ]
 [-0.01296  0.      -0.      ...  0.      -0.       0.59268]]
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Diagonalize the ADC(1) matrix from Gator to obtain excitation energies and vectors</span>
<span class="n">gator_adc1_eigvals</span><span class="p">,</span> <span class="n">gator_adc1_eigvecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Excitation energies from spin-orbital ADC(1)/STO-3G matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Diagonalize the ADC(1) matrix from Gator to obtain excitation energies and vectors</span>
<span class="n">gator_adc1_eigvals</span><span class="p">,</span> <span class="n">gator_adc1_eigvecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">gator_adc_matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Excitation energies from spin-orbital ADC(1)/STO-3G matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">gator_adc1_eigvals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Excitation energies from spin-orbital ADC(1)/STO-3G matrix:
 [0.13954 0.13954 0.13954 0.16547 0.17408 0.17408 0.17408 0.17408 0.17408
 0.17408 0.22819 0.22819 0.47721 0.47721 0.47721 0.71508 2.05306 2.05306
 2.05306 2.09288 2.13277 2.13277 2.13277 2.13277 2.13277 2.13277 2.1528
 2.1528  2.60108 2.60108 2.60108 2.61434]
</pre></div>
</div>
</div>
</div>
<div class="toggle docutils container">
<ul class="simple">
<li><p>The first excited state is triply (spin) degenerate: <span class="math notranslate nohighlight">\(^3\Sigma\)</span></p></li>
<li><p>The second one is singly degenerate: <span class="math notranslate nohighlight">\(^1\Sigma\)</span></p></li>
<li><p>The third one is six (two spatial and three spin) times degenerate: <span class="math notranslate nohighlight">\(^3\Pi\)</span></p></li>
<li><p>The fourth one is doubly (spatial) degenerate: <span class="math notranslate nohighlight">\(^1\Pi\)</span></p></li>
<li><p>The fifth one is again triply degenerate: <span class="math notranslate nohighlight">\(^3\Sigma\)</span></p></li>
<li><p>The sixth one is again singly degenerate: <span class="math notranslate nohighlight">\(^1\Sigma\)</span></p></li>
<li><p>This pattern then repeats for the following (core-excited) states</p></li>
<li><p><span class="math notranslate nohighlight">\(\Sigma\)</span> states (<span class="math notranslate nohighlight">\(\Lambda = 0\)</span>) arise from <span class="math notranslate nohighlight">\(\sigma \to \sigma^*\)</span> transitions, <span class="math notranslate nohighlight">\(\Pi\)</span> states (<span class="math notranslate nohighlight">\(\Lambda = \pm 1\)</span>) from <span class="math notranslate nohighlight">\(\sigma \to \pi^*\)</span> transitions</p></li>
</ul>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># With gator, one can also look at the excitation vectors ...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ph vector shape:&quot;</span><span class="p">,</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">excitation_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ph</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># ... and have it print out the most important vector amplitudes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adc_results</span><span class="o">.</span><span class="n">describe_amplitudes</span><span class="p">())</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># With gator, one can also look at the excitation vectors ...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ph vector shape:&quot;</span><span class="p">,</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">excitation_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ph</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># ... and have it print out the most important vector amplitudes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adc_results</span><span class="o">.</span><span class="n">describe_amplitudes</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ph vector shape: (4, 8)
+-----------------------------------+
| State   0 ,     0.1654741 au      |
+-----------------------------------+
| HOMO   -&gt; LUMO    a-&gt;a     +0.707 |
| HOMO   -&gt; LUMO+3  a-&gt;a    -0.0118 |

+-----------------------------------+
| State   1 ,     0.2281949 au      |
+-----------------------------------+
| HOMO   -&gt; LUMO+2  a-&gt;a     +0.596 |
| HOMO   -&gt; LUMO+1  a-&gt;a      -0.38 |

+-----------------------------------+
| State   2 ,     0.2281949 au      |
+-----------------------------------+
| HOMO   -&gt; LUMO+1  a-&gt;a     +0.596 |
| HOMO   -&gt; LUMO+2  a-&gt;a      +0.38 |

+-----------------------------------+
| State   3 ,      0.715084 au      |
+-----------------------------------+
| HOMO   -&gt; LUMO+3  a-&gt;a     +0.707 |
| HOMO   -&gt; LUMO    a-&gt;a    +0.0117 |

+-----------------------------------+
| State   4 ,      2.092884 au      |
+-----------------------------------+
| HOMO-1 -&gt; LUMO    a-&gt;a     -0.707 |

+-----------------------------------+
| State   5 ,      2.152797 au      |
+-----------------------------------+
| HOMO-1 -&gt; LUMO+2  a-&gt;a     -0.585 |
| HOMO-1 -&gt; LUMO+1  a-&gt;a     +0.397 |

+-----------------------------------+
| State   6 ,      2.152797 au      |
+-----------------------------------+
| HOMO-1 -&gt; LUMO+1  a-&gt;a     +0.585 |
| HOMO-1 -&gt; LUMO+2  a-&gt;a     +0.397 |

+-----------------------------------+
| State   7 ,      2.614337 au      |
+-----------------------------------+
| HOMO-1 -&gt; LUMO+3  a-&gt;a     -0.707 |
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>You can also calculate the triplet states to confirm that your assignments were correct</p></li>
<li><p>Info: setting <code class="docutils literal notranslate"><span class="pre">states=...</span></code> calculates both singlet and triplet states</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate triplet excited states</span>
<span class="n">adc_triplet_results</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_adc</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;adc1&#39;</span><span class="p">,</span>
                            <span class="n">triplets</span><span class="o">=</span><span class="n">nexc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="c1"># Print the triplet excitation energies and compare </span>
<span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adc_triplet_results</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_adc</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;adc1&#39;</span><span class="p">,</span>
                            <span class="n">triplets</span><span class="o">=</span><span class="n">nexc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">frozen_core</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frozen_virtual</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">adc_triplet_results</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="n">adc1_eigvals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adc_results</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adc_triplet_results</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting adc1 triplet Jacobi-Davidson ...
Niter n_ss  max_residual  time  Ritz values
  1     8    3.2231e-30   55ms  [0.13954 0.17408 0.17408 0.47721 2.05306 2.13277 2.13277]
=== Converged ===
    Number of matrix applies:    8
    Total solver time:           60.217ms
+----------------------------------------------------+
| adc1                          triplet ,  converged |
+----------------------------------------------------+
|  #        excitation energy     osc str    |v1|^2  |
|          (au)           (eV)                       |
|  0     0.1395385      3.797035   0.0000         1  |
|  1     0.1740783      4.736913   0.0000         1  |
|  2     0.1740783      4.736913   0.0000         1  |
|  3     0.4772148      12.98568   0.0000         1  |
|  4      2.053065      55.86674   0.0000         1  |
|  5      2.132768      58.03556   0.0000         1  |
|  6      2.132768      58.03556   0.0000         1  |
|  7      2.601084       70.7791   0.0000         1  |
+----------------------------------------------------+

[0.16547 0.22819 0.22819 0.71508 2.09288 2.1528  2.1528  2.61434]
[0.16547 0.22819 0.22819 0.71508 2.09288 2.1528  2.1528  2.61434]
[0.13954 0.17408 0.17408 0.47721 2.05306 2.13277 2.13277 2.60108]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Note that you can calculate 8 triplet states (at most), but they are all triply degenerate, so in total this corresponds to 24 states</p></li>
<li><p>Together with the 8 singlets this gives 32 states, the dimension of the full ADC(1)/STO-3G matrix for LiH</p></li>
</ul>
</div>
<div class="section" id="core-excited-states-and-core-valence-separation-cvs-approximation">
<h2>Core-excited states and core-valence separation (CVS) approximation<a class="headerlink" href="#core-excited-states-and-core-valence-separation-cvs-approximation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>From the above results for the (singlet or triplet) excitation energies, you see that they can be divided into two groups (consisting of 4 excited states each):</p>
<ul>
<li><p>Those with an excitation energy <span class="math notranslate nohighlight">\(&lt;\)</span>0.75 Hartree (singlets) or <span class="math notranslate nohighlight">\(&lt;\)</span>0.5 Hartree (triplets)</p></li>
<li><p>Those with an excitation energy <span class="math notranslate nohighlight">\(&gt;\)</span>2 Hartree</p></li>
</ul>
</li>
<li><p>The first group can be considered <strong>valence excitations</strong> (from the filled bonding orbital), the second group are <strong>core excitations</strong> (from the Li 1s orbital)</p></li>
<li><p><strong>Core-excited states</strong> can also be targeted directly by employing the CVS approximation</p></li>
<li><p>Perform a CVS-ADC(1) calculation with Gator by setting the corresponding method, adjusting the number of states, and setting <code class="docutils literal notranslate"><span class="pre">core_orbitals=1</span></code></p></li>
<li><p>Compare the excitation energies with the corresponding ones from the previous calculation</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run CVS-ADC(1) calculation with Gator</span>
<span class="o">...</span>

<span class="c1"># Compare the CVS-ADC(1) results with the core-excitation energies from the full (singlet) diagonalization (convert to eV)</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cvsadc_results</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_adc</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cvs-adc1&#39;</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">singlets</span><span class="o">=</span><span class="n">nvir</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">cvsadc_results</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CVS-ADC(1)/STO-3G excitation energies:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cvsadc_results</span><span class="o">.</span><span class="n">excitation_energy</span> <span class="o">*</span> <span class="n">au2ev</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ADC(1)/STO-3G core excitation energies:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="o">-</span><span class="n">nvir</span><span class="p">:]</span> <span class="o">*</span> <span class="n">au2ev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting cvs-adc1 singlet Jacobi-Davidson ...
Niter n_ss  max_residual  time  Ritz values
  1     4    3.1083e-31   15ms  [2.09256 2.15253 2.15253 2.61433]
=== Converged ===
    Number of matrix applies:    4
    Total solver time:           17.265ms
+----------------------------------------------------+
| cvs-adc1                      singlet ,  converged |
+----------------------------------------------------+
|  #        excitation energy     osc str    |v1|^2  |
|          (au)           (eV)                       |
|  0       2.09256      56.94145   0.0683         1  |
|  1      2.152531      58.57335   0.1135         1  |
|  2      2.152531      58.57335   0.1135         1  |
|  3      2.614332       71.1396   0.0000         1  |
+----------------------------------------------------+

CVS-ADC(1)/STO-3G excitation energies:	 [56.94145 58.57335 58.57335 71.1396 ]
ADC(1)/STO-3G core excitation energies:	 [56.95026 58.58059 58.58059 71.13974]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Repeat the SCF calculation with the NaH molecule (just replace Li by Na in the molecule string)</p></li>
<li><p>Diagonalize the ADC(1) matrix for all singlets (with Gator or your own implementation)</p></li>
<li><p>Compare the core-excitation energies to the results from a corresponding CVS-ADC(1) calculation</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sodium hydride xyz string and molecule object</span>
<span class="o">...</span>

<span class="c1"># Basis set</span>
<span class="o">...</span>

<span class="c1"># Run SCF through Gator</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sodium hydride molecule</span>
<span class="n">nah_xyz</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;2</span>

<span class="s2">Na  0.000000   0.000000   0.000000</span>
<span class="s2">H   0.000000   0.000000   1.000000</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">nah</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">nah_xyz</span><span class="p">)</span>

<span class="c1"># Basis set</span>
<span class="n">basis_nah</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nah</span><span class="p">,</span> <span class="n">basis_set_label</span><span class="p">)</span>

<span class="c1"># Run SCF through Gator</span>
<span class="n">scf_nah</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_scf</span><span class="p">(</span><span class="n">nah</span><span class="p">,</span> <span class="n">basis_nah</span><span class="p">,</span> <span class="n">conv_thresh</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-10                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 5.8209493199 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.03 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.04 sec.                                                                   
                                                                                                                          
* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
* Info * SAD initial guess computed in 0.08 sec.                                                                          
                                                                                                                          
* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -160.043202498295 a.u. Time: 0.29 sec.                                 
                                                                                                                          
* Info * Overlap matrix computed in 0.02 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1      -160.043202851425    0.0000000000      0.00035040      0.00007941      0.00000000                
                  2      -160.043202902323   -0.0000000509      0.00002701      0.00000449      0.00045186                
                  3      -160.043202902395   -0.0000000001      0.00000490      0.00000079      0.00000902                
                  4      -160.043202902399   -0.0000000000      0.00000053      0.00000010      0.00000234                
                  5      -160.043202902399   -0.0000000000      0.00000002      0.00000000      0.00000040                
                  6      -160.043202902399   -0.0000000000      0.00000000      0.00000000      0.00000001                
                  7      -160.043202902399    0.0000000000      0.00000000      0.00000000      0.00000000                
                                                                                                                          
               *** SCF converged in 7 iterations. Time: 0.19 sec.                                                         
                                                                                                                          
               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :     -160.0432029024 a.u.                                              
               Electronic Energy                  :     -165.8641522223 a.u.                                              
               Nuclear Repulsion Energy           :        5.8209493199 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000000001 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -2.68087 a.u.                                                                  
               (   1 Na  1s  :    -0.30) (   1 Na  2s  :     1.00)                                                        
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.35112 a.u.                                                                  
               (   1 Na  1p0 :     0.88) (   1 Na  2p0 :     0.18)                                                        
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.30986 a.u.                                                                  
               (   1 Na  1p+1:    -0.15) (   1 Na  1p-1:     0.88) (   1 Na  2p-1:     0.19)                              
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.30986 a.u.                                                                  
               (   1 Na  1p+1:     0.88) (   1 Na  1p-1:     0.15) (   1 Na  2p+1:     0.19)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.08826 a.u.                                                                  
               (   1 Na  2s  :     0.46) (   1 Na  3s  :    -0.36) (   1 Na  1p0 :     0.29)                              
               (   2 H   1s  :    -0.81)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.57076 a.u.                                                                  
               (   1 Na  2s  :    -0.38) (   1 Na  3s  :     0.99) (   1 Na  1p0 :     0.48)                              
               (   1 Na  2p0 :    -0.51) (   2 H   1s  :    -0.48)                                                        
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.77169 a.u.                                                                  
               (   1 Na  1p-1:     0.68) (   1 Na  2p+1:     0.19) (   1 Na  2p-1:    -1.09)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.77169 a.u.                                                                  
               (   1 Na  1p+1:    -0.68) (   1 Na  2p+1:     1.09) (   1 Na  2p-1:     0.19)                              
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.28603 a.u.                                                                  
               (   1 Na  3s  :     1.20) (   1 Na  1p0 :    -0.47) (   1 Na  2p0 :     1.56)                              
               (   2 H   1s  :    -1.64)                                                                                  
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of MOs, occupied and virtual orbitals, and excited states for NaH</span>
<span class="c1"># How many excited states are there?</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of orbitals and excited states</span>
<span class="n">nocc_nah</span> <span class="o">=</span> <span class="n">nah</span><span class="o">.</span><span class="n">number_of_alpha_electrons</span><span class="p">()</span>
<span class="n">norb_nah</span> <span class="o">=</span> <span class="n">scf_nah</span><span class="o">.</span><span class="n">scf_tensors</span><span class="p">[</span><span class="s1">&#39;C_alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nvir_nah</span> <span class="o">=</span> <span class="n">norb_nah</span> <span class="o">-</span> <span class="n">nocc_nah</span>
<span class="n">nexc_nah</span> <span class="o">=</span> <span class="n">nocc_nah</span> <span class="o">*</span> <span class="n">nvir_nah</span> <span class="c1"># number of excited (singlet or triplet) states in ADC(1)</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate all possible singlet excited states with ADC(1)</span>
<span class="o">...</span>

<span class="c1"># Print the excitation energies</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adc_results_nah</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_adc</span><span class="p">(</span><span class="n">nah</span><span class="p">,</span> <span class="n">basis_nah</span><span class="p">,</span> <span class="n">scf_nah</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;adc1&#39;</span><span class="p">,</span>
                            <span class="n">singlets</span><span class="o">=</span><span class="n">nexc_nah</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ADC(1)/cc-pVDZ singlet excitation energies:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc_results_nah</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting adc1 singlet Jacobi-Davidson ...
Niter n_ss  max_residual  time  Ritz values
  1    24    3.9973e-27  159ms  [0.39324 0.52704 0.52704 1.02922 1.33518 1.33518 1.40744]
=== Converged ===
    Number of matrix applies:    24
    Total solver time:           182.452ms

ADC(1)/cc-pVDZ singlet excitation energies:
 [ 0.39324  0.52704  0.52704  1.02922  1.33518  1.33518  1.40744  1.50255
  1.50876  1.50876  1.5536   1.5536   1.86846  2.08246  2.08246  2.21844
  2.75043  2.89832  2.89832  3.45754 39.9343  40.08268 40.08268 40.74604]
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate all possible core-excited states with CVS-ADC(1)</span>
<span class="c1"># How many are there?</span>
<span class="o">...</span>

<span class="c1"># Compare the results of the core-excitation energies</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Since there is only one core orbital to excite from, the number of core-excited states</span>
<span class="c1"># corresponds to the number of virtual orbitals in NaH</span>
<span class="n">cvsadc_results_nah</span> <span class="o">=</span> <span class="n">gator</span><span class="o">.</span><span class="n">run_adc</span><span class="p">(</span><span class="n">nah</span><span class="p">,</span> <span class="n">basis_nah</span><span class="p">,</span> <span class="n">scf_nah</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cvs-adc1&#39;</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">singlets</span><span class="o">=</span><span class="n">nvir_nah</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CVS-ADC(1)/STO-3G excitation energies:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cvsadc_results_nah</span><span class="o">.</span><span class="n">excitation_energy</span> <span class="o">*</span> <span class="n">au2ev</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ADC(1)/STO-3G core excitation energies:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc_results_nah</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="o">-</span><span class="n">nvir_nah</span><span class="p">:]</span> <span class="o">*</span> <span class="n">au2ev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting cvs-adc1 singlet Jacobi-Davidson ...
Niter n_ss  max_residual  time  Ritz values
  1     4    4.9437e-28   13ms  [39.93425 40.08263 40.08263 40.74602]
=== Converged ===
    Number of matrix applies:    4
    Total solver time:           14.804ms
CVS-ADC(1)/STO-3G excitation energies:	 [1086.66624 1090.70401 1090.70401 1108.75557]
ADC(1)/STO-3G core excitation energies:	 [1086.6677  1090.70529 1090.70529 1108.75617]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>You should see that the CVS approximation is even better for NaH than for LiH, which is due to the larger energy separation of the core and valence orbitals</p></li>
</ul>
</div>
<div class="section" id="transition-moments-and-oscillator-strengths">
<h2>Transition moments and oscillator strengths<a class="headerlink" href="#transition-moments-and-oscillator-strengths" title="Permalink to this headline">¶</a></h2>
<p>In order to simulate a UV/vis or X-ray spectrum, apart from the excitation energies
also the spectral intensity is required. This is done by means of so-called <em>oscillator strengths</em>,
which are available from the excitation energies and the <em>transition dipole moments</em>.
In order to obtain the latter, the ground- to excited-state transition density matrices
<span class="math notranslate nohighlight">\(\mathbf{x} = \mathbf{Y}^\dagger \mathbf{f}\)</span> are needed.
Through first order in perturbation theory, the non-vanishing part is given by</p>
<div class="math notranslate nohighlight">
\[
x_{ia} = Y_{ia} - \sum_{jb} Y_{jb} \, t_{ijab} \, ,
\]</div>
<p>where <span class="math notranslate nohighlight">\(Y_{ia}\)</span> denotes an element of the excitation vector,
and the <a class="reference internal" href="wft-exercises.html#sec-calc-mp-t-amplitudes"><span class="std std-ref"><span class="math notranslate nohighlight">\(t\)</span>-amplitudes</span></a> are <span class="math notranslate nohighlight">\(t_{ijab} = \frac{\langle ab || ij \rangle}{\varepsilon_{a} + \varepsilon_{b} - \varepsilon_{i} - \varepsilon_{j}}\)</span>.</p>
<p>The transition dipole moment <span class="math notranslate nohighlight">\(T_{m}\)</span> for the component <span class="math notranslate nohighlight">\(m \in \{ x,y,z \}\)</span> is obtained
by contracting the transition density matrix with the corresponding dipole integrals <span class="math notranslate nohighlight">\(\mu_{ia}^{m}\)</span>,</p>
<div class="math notranslate nohighlight">
\[
T_{m} = \sum_{ia} x_{ia} \, \mu_{ia}^{m} \, ,
\]</div>
<p>and the dimensionless <em>oscillator strength</em> <span class="math notranslate nohighlight">\(f\)</span>, commonly used for relative intensities in the simulation
of electronic spectra, is obtained from quantities in atomic units as</p>
<div class="math notranslate nohighlight">
\[
f = \frac23 \omega \, \sum_{m} T_{m}^2 \, ,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega\)</span> is the excitation energy of the corresponding excited state.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The transition density matrices <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> are not symmetric, meaning that <span class="math notranslate nohighlight">\(x_{ia} \neq x_{ai}\)</span>. However, due to the symmetry of the dipole integrals, we could put <span class="math notranslate nohighlight">\(x_{ai}\)</span> into <span class="math notranslate nohighlight">\(x_{ia}\)</span>.</p></li>
<li><p>In the CIS scheme, <span class="math notranslate nohighlight">\(x_{ia} = Y_{ia}\)</span> is correct through zeroth order only. As a matter of fact, this is the only place where the ADC(1) and CIS methods differ.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">adcc</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Could not import adcc. Please install.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Get the desired eigenvector and the <span class="math notranslate nohighlight">\(t\)</span>-amplitudes:</p></li>
</ul>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose excited state</span>
<span class="n">n_excstate</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Eigenvector from Gator results</span>
<span class="n">adc_eigenvector</span> <span class="o">=</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">excitation_vector</span><span class="p">[</span><span class="n">n_excstate</span><span class="p">][</span><span class="s1">&#39;ph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">()</span>

<span class="c1"># t-amplitudes from adcc reference state</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">LazyMp</span><span class="p">(</span><span class="n">adc_results</span><span class="o">.</span><span class="n">reference_state</span><span class="p">)</span><span class="o">.</span><span class="n">t2</span><span class="p">(</span><span class="s2">&quot;o1o1v1v1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Calculate transition moment (transition density matrix) by adding zeroth- and first-order terms:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transmom</span> <span class="o">=</span> <span class="n">adc_eigenvector</span> <span class="o">-</span> <span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transmom</span> <span class="o">=</span> <span class="n">adc_eigenvector</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;jb,ijab-&gt;ia&#39;</span><span class="p">,</span> <span class="n">adc_eigenvector</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;transmom:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">transmom</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">transmom</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>transmom:
 (4, 8) 
 [[ 0.0064   0.       0.      -0.00181  0.       0.       0.       0.     ]
 [ 0.69874  0.       0.      -0.02647  0.       0.       0.       0.     ]
 [ 0.       0.       0.       0.       0.0064   0.       0.      -0.00181]
 [ 0.       0.       0.       0.       0.69874  0.       0.      -0.02647]]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Get the dipole integrals and transform them to MO basis</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dipole integrals in AO basis</span>
<span class="n">dipole_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">veloxchemlib</span><span class="o">.</span><span class="n">ElectricDipoleIntegralsDriver</span><span class="p">()</span>
<span class="n">dipole_mats</span> <span class="o">=</span> <span class="n">dipole_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">lih</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">dipole_ints_ao</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">dipole_mats</span><span class="o">.</span><span class="n">x_to_numpy</span><span class="p">(),</span> <span class="n">dipole_mats</span><span class="o">.</span><span class="n">y_to_numpy</span><span class="p">(),</span>
               <span class="n">dipole_mats</span><span class="o">.</span><span class="n">z_to_numpy</span><span class="p">()))</span>

<span class="c1"># Transform them to MO basis</span>
<span class="n">mo</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">scf_tensors</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="c1"># MO coefficients</span>
<span class="n">dipole_ints_mo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">([</span><span class="n">mo</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dipole_ints_ao</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">mo</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="n">dipole_ints_ov</span> <span class="o">=</span> <span class="n">dipole_ints_mo</span><span class="p">[:,</span> <span class="p">:</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Calculate the transition dipole moment <span class="math notranslate nohighlight">\(\mathbf{T}\)</span></p>
<ul>
<li><p>One problem arises since the ADC eigenvectors and <span class="math notranslate nohighlight">\(t\)</span>-amplitudes (and thus the transition moments <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>) are given in a spin-orbital basis, but the dipole integrals in a basis of spatial orbitals</p></li>
<li><p>However, same-spin blocks blocks of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> are equal, while opposite-spin blocks vanish</p></li>
<li><p>This means we can contract the <span class="math notranslate nohighlight">\(\alpha\)</span>-only block of the transition moments with the dipole integrals and multiply the result by 2 to account for the <span class="math notranslate nohighlight">\(\beta\)</span>-only block</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trans_dip_mom</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trans_dip_mom</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ia,xia-&gt;x&#39;</span><span class="p">,</span> <span class="n">transmom</span><span class="p">[:</span><span class="n">nocc</span><span class="p">,</span> <span class="p">:</span><span class="n">nvir</span><span class="p">],</span> <span class="n">dipole_ints_ov</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trans_dip_mom:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">trans_dip_mom</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>trans_dip_mom:
 [ 0.      -0.       0.15736]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Get the corresponding excitation energy and calculate the oscillator strength</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Excitation energy</span>
<span class="n">excitation_energy</span> <span class="o">=</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="n">n_excstate</span><span class="p">]</span>

<span class="c1"># Oscillator strength</span>
<span class="n">osc</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Compare to the result from Gator</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Osc. str. from Gator:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="n">n_excstate</span><span class="p">])</span>
</pre></div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">excitation_energy</span> <span class="o">=</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="n">n_excstate</span><span class="p">]</span>

<span class="n">osc</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span> <span class="o">*</span> <span class="n">excitation_energy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">trans_dip_mom</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">trans_dip_mom</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Oscillator strength:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">osc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Osc. str. from Gator:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">adc_results</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="n">n_excstate</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Oscillator strength:
 0.0027315991535243533

Osc str from Gator:
 0.0027315991535243507
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="adc-hpc.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">HPC-QC implementation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="excoupl.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exciton coupling model</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The eChem team<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>