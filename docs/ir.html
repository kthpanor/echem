
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IR spectrum calculation &#8212; Computational Chemistry from  Laptop to HPC</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Raman spectrum calculation" href="raman.html" />
    <link rel="prev" title="Vibrational spectroscopies" href="vibrational.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Chemistry from  Laptop to HPC</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Getting started
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials and workflows
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="uv-vis.html">
   UV/vis absorption/emission
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uv-vis_rec.html">
     Recommendations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reactivity.html">
   Catalysis and reactivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dichroism.html">
   Optical activity and dichroism
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="vibrational.html">
   Vibrational spectroscopies
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     IR spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="raman.html">
     Raman spectrum calculation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="magnetic.html">
   Magnetic resonances
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="xray.html">
   X-ray spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="xray_rec.html">
     Recommendations
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Electronic structure theory
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="elecstruct-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="orbitals.html">
     Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basis.html">
     Basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="slater.html">
     Slater determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="secondquant.html">
     Second quantization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="wft.html">
   Wave function theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="wft-general.html">
     General aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hartree-fock.html">
     Hartree–Fock theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ci.html">
     Configuration interaction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mp2.html">
     Møller–Plesset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mcscf.html">
     Multiconfigurational methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dft.html">
   Density functional theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hohenberg.html">
     Hohenberg–Kohn theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kohn-sham.html">
     Kohn–Sham method
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Potential energy surfaces
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="pes-general.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="coordinates.html">
     Choice of coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gradients.html">
     Gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hessians.html">
     Hessians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="forcefields.html">
     Force fields
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="structopt.html">
   Molecular structure optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tst.html">
   Transition-state theory
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="moldyn.html">
   Molecular dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="md_ffs.html">
     Force fields
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_setup.html">
     Ensembles and time integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_run.html">
     Running a simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_biased.html">
     Biased molecular dynamics
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Properties
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="response.html">
   Response theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="exact-response.html">
     Exact states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="scf-response.html">
     SCF states
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="adc.html">
   Algebraic diagrammatic construction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="excoupl.html">
   Exciton coupling model
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="localprop.html">
   Localized properties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="esp.html">
     ESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="resp.html">
     RESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="loprop.html">
     LoProp charges and polarizabilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pe.html">
   Polarizable embedding
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Visualization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="visual-orbitals.html">
   Molecular orbitals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visual-densities.html">
   Reduced particle densities
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="refs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/ir.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kthpanor/echem"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/ir.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kthpanor/echem/master?urlpath=tree/docs/docs/ir.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="ir-spectrum-calculation">
<h1>IR spectrum calculation<a class="headerlink" href="#ir-spectrum-calculation" title="Permalink to this headline">¶</a></h1>
<p id="sec-ir-tutorial">The infrared (IR) absorption process involves the absorption of light with low photon energy (from approx. 800 nm to approx. 1000 <span class="math notranslate nohighlight">\(\mu\)</span>m) which promotes the excitation of molecular vibrations. Of the entire IR photon energy range, the photons which excite fundamental vibrations of covalent bonds have energies in the range 2.5-25 <span class="math notranslate nohighlight">\(\mu\)</span>m <span id="id1">[<a class="reference internal" href="refs.html#id154">Cen15</a>, <a class="reference internal" href="refs.html#id47">NRS18</a>]</span>. The absorbed photon energies (i.e. IR absorption peak positions) correspond to the molecular vibrational freqencies, while the IR intensities are related to the IR linear absorption cross-section <span id="id2">[<a class="reference internal" href="refs.html#id47">NRS18</a>]</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-00e1c63c-3d00-4b84-bf7c-58ac6e7027ab">
<span class="eqno">(1)<a class="headerlink" href="#equation-00e1c63c-3d00-4b84-bf7c-58ac6e7027ab" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\sigma(\omega)= to\,\,be\,\,added
\end{equation}\]</div>
<p>These molecular vibrations constitute fingerprints of different functional groups present in the system and thus are very important for chemical characterization and molecular identification <strong>to be refined, to add examples</strong>.</p>
<p>The first step in an IR spectrum calculation is to determine the normal modes and frequencies which are obtained from the eigenstates and eigenvalues of the Hessian matrix. The Hessian collects all the second order derivatives of the energy (<span class="math notranslate nohighlight">\(E\)</span>) with respect to all nuclear coordinates (as exemplified below for a diatomic molecule AB where the atomic coordinates are denoted <span class="math notranslate nohighlight">\(A_x\)</span>, <span class="math notranslate nohighlight">\(A_y\)</span>, etc. <strong>maybe remove?</strong>):</p>
<div class="amsmath math notranslate nohighlight" id="equation-4a9a512e-d7b1-4f0e-8f54-629688afe3a9">
<span class="eqno">(2)<a class="headerlink" href="#equation-4a9a512e-d7b1-4f0e-8f54-629688afe3a9" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathbf{H}= \begin{bmatrix}
\frac{\mathrm{d}^2E}{\mathrm{d}A^2_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_x\mathrm{d}A_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_x\mathrm{d}A_z} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_x\mathrm{d}B_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_x\mathrm{d}B_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_x\mathrm{d}B_z} \\
\frac{\mathrm{d}^2E}{\mathrm{d}A_y\mathrm{d}A_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A^2_y} &amp;  \frac{\mathrm{d}^2E}{\mathrm{d}A_y\mathrm{d}A_z} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_y\mathrm{d}B_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_y\mathrm{d}B_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_y\mathrm{d}B_z} \\
\frac{\mathrm{d}^2E}{\mathrm{d}A_z\mathrm{d}A_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_z\mathrm{d}A_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A^2_z} &amp;  \frac{\mathrm{d}^2E}{\mathrm{d}A_x\mathrm{d}B_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_x\mathrm{d}B_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}A_x\mathrm{d}B_z} \\
\frac{\mathrm{d}^2E}{\mathrm{d}B_x\mathrm{d}A_x} &amp;  \frac{\mathrm{d}^2E}{\mathrm{d}B_x\mathrm{d}A_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B_x\mathrm{d}A_z} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B^2_x} &amp;  \frac{\mathrm{d}^2E}{\mathrm{d}B_x\mathrm{d}B_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B_x\mathrm{d}B_z} \\
\frac{\mathrm{d}^2E}{\mathrm{d}B_y\mathrm{d}A_x} &amp;  \frac{\mathrm{d}^2E}{\mathrm{d}B_y\mathrm{d}A_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B_y\mathrm{d}A_z} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B_y\mathrm{d}B_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B^2_y} &amp;  \frac{\mathrm{d}^2E}{\mathrm{d}B_y\mathrm{d}B_z} \\
\frac{\mathrm{d}^2E}{\mathrm{d}B_z\mathrm{d}A_x} &amp;  \frac{\mathrm{d}^2E}{\mathrm{d}B_z\mathrm{d}A_y} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B_z\mathrm{d}A_z} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B_z\mathrm{d}B_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B_z\mathrm{d}B_x} &amp; \frac{\mathrm{d}^2E}{\mathrm{d}B^2_z} \\
\end{bmatrix}
\end{equation}\]</div>
<p>The first step in a IR spectrum calculation is thus to determine the Hessian matrix. For the ground state, the Hessian can be determined <a class="reference internal" href="hessians.html#hessians-label"><span class="std std-ref">analytically</span></a>, or numerically based on the analytical gradient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import section</span>
<span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the molecule and basis set</span>
<span class="n">molecule_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  O 0 0 0</span>
<span class="s2">  H 0 0 1.795239827225189</span>
<span class="s2">  H 1.693194615993441 0 -0.599043184453037&quot;&quot;&quot;</span>
<span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;au&quot;</span>
<span class="n">basis_set_label</span> <span class="o">=</span> <span class="s1">&#39;def2-svp&#39;</span>

<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_str</span><span class="p">(</span><span class="n">molecule_string</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis_set_label</span><span class="p">)</span>
<span class="n">ostream</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OutputStream</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="n">ostream</span><span class="o">.</span><span class="n">print_block</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">get_string</span><span class="p">())</span> <span class="c1">#TODO: show the molecular structure instead</span>
<span class="n">ostream</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                              Molecular Geometry (Angstroms)                                              
                                             ================================                                             
                                                                                                                          
                          Atom         Coordinate X          Coordinate Y          Coordinate Z                           
                                                                                                                          
                           O           0.000000000000        0.000000000000        0.000000000000                         
                           H           0.000000000000        0.000000000000        0.950000004673                         
                           H           0.896000004407        0.000000000000       -0.317000001559                         
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the scf calculation</span>
<span class="n">method_settings</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">scfdrv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">scfdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 9.2514792692 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.02 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -75.916440647145 a.u. Time: 0.04 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -75.959833036531    0.0000000000      0.09234869      0.01099918      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -75.960709636402   -0.0008765999      0.01671860      0.00248033      0.02357521                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -75.960744345211   -0.0000347088      0.00347436      0.00061888      0.00448968                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -75.960746198780   -0.0000018536      0.00204897      0.00033265      0.00143280                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -75.960746599257   -0.0000004005      0.00019959      0.00003424      0.00048577                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -75.960746609076   -0.0000000098      0.00003116      0.00000533      0.00010793                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -75.960746609321   -0.0000000002      0.00000371      0.00000055      0.00001791                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8       -75.960746609325   -0.0000000000      0.00000094      0.00000015      0.00000234                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * SCF tensors written to file: scf.tensors.h5                                                                      
                                                                                                                          
               *** SCF converged in 8 iterations. Time: 0.92 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :      -75.9607466093 a.u.                                              
               Electronic Energy                  :      -85.2122258786 a.u.                                              
               Nuclear Repulsion Energy           :        9.2514792692 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000009408 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.0 Energy:  -20.54181 a.u.                                                                    
               (   1 O   1s  :     0.99)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.0 Energy:   -1.31839 a.u.                                                                    
               (   1 O   1s  :     0.28) (   1 O   2s  :     0.55) (   1 O   3s  :     0.29)                              
               (   2 H   1s  :     0.19) (   3 H   1s  :     0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.0 Energy:   -0.71659 a.u.                                                                    
               (   1 O   1p+1:    -0.28) (   1 O   1p0 :     0.40) (   1 O   2p0 :     0.18)                              
               (   2 H   1s  :     0.33) (   3 H   1s  :    -0.33)                                                        
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.0 Energy:   -0.55953 a.u.                                                                    
               (   1 O   2s  :     0.19) (   1 O   3s  :     0.32) (   1 O   1p+1:    -0.45)                              
               (   1 O   1p0 :    -0.32) (   1 O   2p+1:    -0.31) (   1 O   2p0 :    -0.22)                              
               (   2 H   1s  :    -0.19) (   3 H   1s  :    -0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.0 Energy:   -0.49673 a.u.                                                                    
               (   1 O   1p-1:     0.63) (   1 O   2p-1:     0.50)                                                        
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.0 Energy:    0.17821 a.u.                                                                    
               (   1 O   3s  :     1.12) (   1 O   2p+1:     0.29) (   1 O   2p0 :     0.20)                              
               (   2 H   2s  :    -0.91) (   3 H   2s  :    -0.91)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.0 Energy:    0.25586 a.u.                                                                    
               (   1 O   1p+1:    -0.16) (   1 O   1p0 :     0.23) (   1 O   2p+1:    -0.38)                              
               (   1 O   2p0 :     0.54) (   2 H   2s  :    -1.42) (   3 H   2s  :     1.42)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.0 Energy:    0.81974 a.u.                                                                    
               (   1 O   1p+1:     0.17) (   1 O   1p0 :    -0.23) (   1 O   2p+1:     0.31)                              
               (   1 O   2p0 :    -0.44) (   2 H   1s  :     0.97) (   2 H   2s  :    -0.63)                              
               (   3 H   1s  :    -0.98) (   3 H   2s  :     0.63)                                                        
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.0 Energy:    0.85362 a.u.                                                                    
               (   1 O   2s  :     0.36) (   1 O   3s  :    -0.28) (   1 O   1p+1:     0.24)                              
               (   1 O   1p0 :     0.17) (   2 H   1s  :    -0.87) (   2 H   2s  :     0.55)                              
               (   2 H   1p0 :    -0.21) (   3 H   1s  :    -0.85) (   3 H   2s  :     0.54)                              
               (   3 H   1p+1:    -0.16) (   3 H   1p0 :     0.18)                                                        
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.0 Energy:    1.18380 a.u.                                                                    
               (   1 O   2s  :     0.43) (   1 O   3s  :     0.20) (   1 O   1p+1:    -0.67)                              
               (   1 O   1p0 :    -0.47) (   1 O   2p+1:     0.99) (   1 O   2p0 :     0.70)                              
               (   2 H   1s  :    -0.38) (   2 H   1p0 :     0.16) (   3 H   1s  :    -0.38)                              
               (   3 H   1p+1:     0.17)                                                                                  
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the Hessian Driver and use it to compute an analytical SCF Hessian</span>
<span class="n">hessian_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;numerical&#39;</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">}</span>
<span class="n">cphf_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;use_subspace_solver&#39;</span><span class="p">:</span><span class="s1">&#39;no&#39;</span><span class="p">}</span>
<span class="n">hessian_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">scfhessiandriver</span><span class="o">.</span><span class="n">ScfHessianDriver</span><span class="p">(</span><span class="n">scfdrv</span><span class="p">,</span> <span class="n">scfdrv</span><span class="o">.</span><span class="n">comm</span><span class="p">,</span> <span class="n">ostream</span><span class="p">)</span>
<span class="n">hessian_drv</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">method_settings</span><span class="p">,</span> <span class="n">hessian_settings</span><span class="p">,</span> <span class="n">cphf_settings</span><span class="p">)</span>
<span class="n">hessian_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                    SCF Hessian Driver                                                    
                                                   ====================                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                       Coupled-Perturbed Hartree-Fock Solver Setup                                        
                                      =============================================                                       
                                                                                                                          
                          Solver Type                     : Conjugate Gradient                                            
                          Max. Number of Iterations       : 150                                                           
                          Convergence Threshold           : 1.0e-04                                                       
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Coupled-Perturbed Hartree-Fock converged in 10 iterations. Time: 1.13 sec                              
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                   *** Time spent in Hessian calculation: 11.18 sec ***                                   
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hessian_drv</span><span class="o">.</span><span class="n">print_hessian</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                           Analytical Hessian (Hartree/Bohr**2)                                           
                                          --------------------------------------                                          
                                                                                                                          
  Coord.       1 O(x)          1 O(y)          1 O(z)          2 H(x)          2 H(y)          2 H(z)          
                                                                                                                          
  1 O(x)       0.60158556      0.00000000     -0.15207252     -0.05695861     -0.00000000      0.02086391
  1 O(y)       0.00000000     -0.00252875     -0.00000000      0.00000000      0.00140155      0.00000000
  1 O(z)      -0.15207252     -0.00000000      0.71123729     -0.04125608      0.00000000     -0.60022186
  2 H(x)      -0.05695861      0.00000000     -0.04125608      0.05366250      0.00000000     -0.00981460
  2 H(y)      -0.00000000      0.00140155      0.00000000      0.00000000      0.00294554     -0.00000000
  2 H(z)       0.02086391      0.00000000     -0.60022186     -0.00981460     -0.00000000      0.61106383
  3 H(x)      -0.54462695     -0.00000000      0.19332860      0.00329611      0.00000000     -0.01104931
  3 H(y)      -0.00000000      0.00112721      0.00000000     -0.00000000     -0.00434709      0.00000000
  3 H(z)       0.13120861      0.00000000     -0.11101543      0.05107068      0.00000000     -0.01084197
                                                                                                                          
                                                                                                                          
  Coord.       3 H(x)          3 H(y)          3 H(z)          
                                                                                                                          
  1 O(x)      -0.54462695     -0.00000000      0.13120861
  1 O(y)      -0.00000000      0.00112721      0.00000000
  1 O(z)       0.19332860      0.00000000     -0.11101543
  2 H(x)       0.00329611     -0.00000000      0.05107068
  2 H(y)       0.00000000     -0.00434709      0.00000000
  2 H(z)      -0.01104931      0.00000000     -0.01084197
  3 H(x)       0.54133084      0.00000000     -0.18227929
  3 H(y)       0.00000000      0.00321988     -0.00000000
  3 H(z)      -0.18227929     -0.00000000      0.12185740
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>The normal modes and frequencies are then determined by diagonalizing the Hessian. First, the transation and rotational modes mut be projected out, leaving 3N-6 (or 3N-5 for a linear molecule) vibrational modes. This is done under the hood with the help of geomeTRIC. <strong>add comparison vib-rot removed vs. included?</strong></p>
<p>The IR intensities are determined as discussed in more details in <strong>add link</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hessian_drv</span><span class="o">.</span><span class="n">vibrational_analysis</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                   Vibrational Analysis                                                   
                                                  ======================                                                  
                                                                                                                          
                 Harmonic frequencies (in cm**-1), force constants (in mdyne/A), reduced masses (in amu),                 
                                                IR intensities (in km/mol),                                               
                                         and Cartesian normal mode displacements.                                         
                                                                                                                          
                                                                                                                          
  Index:                        1                              2                              3               
  Frequency:                 1703.02                        4054.01                        4185.87            
  Force constant:            1.8536                         10.1053                        11.2203            
  Reduced mass:              1.0847                         1.0436                         1.0869             
  IR intensity:              92.4868                        25.5570                        94.7798            
  Normal mode:       X         Y         Z     |    X         Y         Z     |    X         Y         Z     |
  1 O             -0.0584    0.0000   -0.0413  |  0.0407    0.0000    0.0268  | -0.0409   -0.0000    0.0599  |
  2 H              0.7053   -0.0000   -0.0139  |  0.0254    0.0000   -0.6900  |  0.0005    0.0000   -0.7214  |
  3 H              0.2222   -0.0000    0.6692  | -0.6715   -0.0000    0.2645  |  0.6495    0.0000   -0.2292  |
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_broadening</span><span class="p">(</span><span class="n">list_ex_energy</span><span class="p">,</span> <span class="n">list_osci_strength</span><span class="p">,</span> <span class="n">line_profile</span><span class="o">=</span><span class="s1">&#39;Lorentzian&#39;</span><span class="p">,</span> <span class="n">line_param</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">list_ex_energy</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">list_ex_energy</span><span class="p">)</span> <span class="o">+</span> <span class="mi">50</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="c1">#print(x)</span>
        <span class="c1">#print(y)</span>

        <span class="c1"># go through the frames and calculate the spectrum for each frame</span>
        <span class="k">for</span> <span class="n">xp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list_ex_energy</span><span class="p">,</span> <span class="n">list_osci_strength</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">line_profile</span> <span class="o">==</span> <span class="s1">&#39;Gaussian&#39;</span><span class="p">:</span>
                    <span class="n">y</span><span class="p">[</span><span class="n">xp</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">xp</span><span class="p">])</span> <span class="o">/</span> <span class="n">line_param</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">line_profile</span> <span class="o">==</span> <span class="s1">&#39;Lorentzian&#39;</span><span class="p">:</span>
                    <span class="n">y</span><span class="p">[</span><span class="n">xp</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">line_param</span> <span class="o">*</span> <span class="n">f</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">xp</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">line_param</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the IR spectrum</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="c1"># Spectrum from -CHF </span>
<span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">hessian_drv</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">hessian_drv</span><span class="o">.</span><span class="n">ir_intensities</span>
<span class="n">x1i</span><span class="p">,</span> <span class="n">y1i</span> <span class="o">=</span> <span class="n">add_broadening</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">line_profile</span><span class="o">=</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span><span class="n">line_param</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1i</span><span class="p">,</span><span class="n">y1i</span><span class="p">)</span>
<span class="c1">#plt.plot(x1,y1,&#39;x&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;wavenumber (cm**-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;IR intensity (km/mol)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Calculated IR sepctrum of the water molecule&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># TODO: add comparison to expriment</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ir_9_0.png" src="../_images/ir_9_0.png" />
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="vibrational.html" title="previous page">Vibrational spectroscopies</a>
    <a class='right-next' id="next-link" href="raman.html" title="next page">Raman spectrum calculation</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The eChem team<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>