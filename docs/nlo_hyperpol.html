

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>(Hyper)polarizabilities &#8212; Computational Chemistry from  Laptop to HPC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-TX4YJ1J5XE"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/nlo_hyperpol';</script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="title.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="intro.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics_notebook.html">Using Jupyter notebooks</a></li>







<li class="toctree-l2"><a class="reference internal" href="units_notation.html">Units and notation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronic ground states</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="elec_struct/elstruct_gen.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/orbitals.html">Orbitals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/slater.html">Many-electron wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/operators.html">Operators and matrix elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/reduced_density.html">Reduced particle densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/natural_orbitals.html">Natural orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/spin.html">Electron spin</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/correlation.html">Electron correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/dispersion.html">Dispersion interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/pt.html">Rayleigh–Schrödinger perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/second_quant.html">Second quantization</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/group_theory.html">Group theory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="elec_struct/wft.html">Wave function theory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="elec_struct/hartree-fock.html">Hartree–Fock</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="elec_struct/hf_theory.html">Hartree–Fock theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="elec_struct/hf_scf.html">SCF optimization</a></li>

<li class="toctree-l3"><a class="reference internal" href="elec_struct/hf_example.html">HF in VeloxChem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/ci.html">Configuration interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/mp2.html">Møller–Plesset</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/mcscf.html">Multiconfigurational methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/wft_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="elec_struct/dft.html">Density functional theory</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/hohenberg.html">Hohenberg–Kohn theorems</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/kohn-sham.html">Kohn–Sham method</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/kernel_int.html">Kernel integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/dft_scf.html">SCF optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/dft_prop.html">First-order properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="elec_struct/available_xcfun.html">Available XC functionals</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular structure and dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="mol_struct/molstruct_gen.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/coordinates.html">Choice of coordinates</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mol_struct/gradients.html">Gradients</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/energy_grad.html">Energy gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/property_grad.html">Property gradients</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mol_struct/hessians_vib.html">Hessians and vibrations</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/hessians.html">Molecular Hessians</a></li>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/vibrations.html">Vibrational analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mol_struct/opt.html">Structure optimization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/opt_struct.html">Optimization methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/opt_gs.html">Ground-state structure optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mol_struct/tst.html">Transition-state theory</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/tst_gen.html">Transition state geometry optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mol_struct/impes.html">PES interpolation techniques</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/impes_calc.html">Constructing the PES by interpolation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mol_struct/md.html">Molecular dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/forcefields.html">Force fields</a></li>


<li class="toctree-l2"><a class="reference internal" href="mol_struct/reparameterize.html">Reparameterize force fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/md_setup.html">Ensembles and time integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="mol_struct/md_run.html">Running a simulation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spectra and properties</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="spec_prop/spectra_aspects.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/resp_external.html">Responses to external fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/mol_prop.html">Molecular properties</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="spec_prop/elec_nuc.html">Electronic and nuclear contributions</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="spec_prop/rovib.html">Rovibronic states</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/selection_rules.html">Selection rules</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="spec_prop/expt_theory.html">From experiment to theory</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/opa.html">One-photon absorption (OPA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/dichroism.html">Dichroism</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/tpa.html">Two-photon absorption (TPA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/birefring.html">Birefringence</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="spec_prop/tddft.html">TDDFT</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/tddft_basics.html">Foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/tddft_rpa.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/tddft_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="spec_prop/mr_response.html">Multireference response</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/ci_response.html">CI response</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/sa_mcscf.html">State-averaged MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/mclr.html">Multiconfigurational linear response</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/mr_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="spec_prop/adc.html">ADC</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/adc_pp.html">Polarization propagator</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/adc_isr.html">Intermediate state representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/adc_cvs.html">Core-valence separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/adc_hpc.html">HPC-QC implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/adc_exercises_new.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="spec_prop/excoupl.html">Exciton coupling model</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="spec_prop/excoupl_impl.html">Implementation of the exciton coupling model</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="env/localprop.html">Localized properties</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="env/esp.html">ESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="env/resp.html">RESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="env/loprop.html">LoProp charges and polarisabilities</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="env/embedding.html">Embedding potentials</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="env/nonpol_emb.html">Non-polarizable embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="env/pol_emb.html">Polarizable embedding</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="visualize/mol_struct.html">Molecular structure and dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="visualize/struct_vis.html">Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualize/md_vis.html">MD trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualize/opt_vib_vis.html">Optimization and normal modes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="visualize/elec_struct.html">Electronic structure</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="visualize/orb_vis.html">Orbitals and densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualize/exc_vis.html">Excited states</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="visualize/spec_prop.html">Spectra and properties</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="visualize/broadening.html">Spectrum broadening</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials and workflows</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorials/workflow.html">Constructing workflows</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/wf_build.html">Building the system</a></li>

<li class="toctree-l2"><a class="reference internal" href="tutorials/wf_struct.html">Optimizing molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/wf_scf.html">Optimizing electronic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/wf_construct.html">Assembling a full workflow</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorials/uv_vis.html">UV/vis spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/uv_vis_absorption.html">Absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/uv_vis_fluorescence.html">Fluorescence</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/uv_vis_analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/uv_vis_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/uv_vis_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorials/vib_ir.html">Vibrational spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/vib_ir_calc.html">IR spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/vib_ir_raman.html">Raman spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/vib_ir_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorials/openshells.html">Open shells</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/rest_unrest.html">Restricted versus unrestricted</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/correlation.html">Static versus dynamic correlation correlation</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorials/xray.html">X-ray spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/xray_calc.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/xray_analysis.html">Spectrum analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/xray_aspects.html">Special aspects</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/xray_large.html">Larger systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/xray_nonstandard.html">Non-standard calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/xray_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/xray_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/xray_cheatsheet.html">Cheat sheet</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cite.html">How to cite and contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kthpanor/echem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/nlo_hyperpol.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/nlo_hyperpol.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>(Hyper)polarizabilities</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hyper-polarizabilities">
<h1>(Hyper)polarizabilities<a class="headerlink" href="#hyper-polarizabilities" title="Permalink to this heading">#</a></h1>
<p>Antonio</p>
<p>Antonio 2</p>
<ul class="simple">
<li><p>Method of calculation - residue/CPP</p></li>
<li><p>Example: TPA versus OPA for XAS of water and atom</p></li>
<li><p>Poynting vector to TPA</p></li>
</ul>
<p>Within the appropriate limits of validity of perturbation theory, the total energy <span class="math notranslate nohighlight">\(E\)</span> of a molecule in static fields can be expanded in terms of multipole moments, defining static properties, as follows <span id="id1">[]</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
E=E^{(0)} -\mu_\alpha E_\alpha -\frac{1}{2} \alpha_{\alpha \beta} E_\alpha E_\beta -\frac{1}{6} \beta_{\alpha \beta \gamma} E_\alpha E_\beta E_\gamma -\frac{1}{24} \gamma_{\alpha \beta \gamma \delta} E_\alpha E_\beta E_\gamma E_\delta +\cdots  -\frac{1}{3} \Theta_{\alpha \beta} \nabla_\beta E_{\alpha}  -\frac{1}{3} A_{\alpha , \beta \gamma} E_\alpha \nabla_\gamma E_{\beta} -\frac{1}{6} C_{\alpha \beta , \gamma \delta} \nabla_\beta E_{\alpha} \nabla_\delta E_{\gamma} +\cdots -\frac{1}{2} \xi_{\alpha \beta} B_\alpha B_\beta  -\frac{1}{2} \chi_{\gamma , \alpha \beta} B_\alpha B_\beta E_\gamma -\frac{1}{4} \eta_{\gamma \delta ,\alpha \beta} B_\alpha B_\beta E_\gamma E_\delta +\cdots
\end{equation*}\]</div>
<p>Einstein implicit summation over repeater indices is assumed. Above <span class="math notranslate nohighlight">\(E^{(0)}\)</span>, a scalar, rank 0 tensor, is the energy in the absence of external fields; the electric (<span class="math notranslate nohighlight">\(\mathbf{E}\)</span>, rank 1 tensor, polar, even time-reversality, indicated here in short as <span class="math notranslate nohighlight">\(PE^1\)</span>) and magnetic induction (<span class="math notranslate nohighlight">\(\mathbf{B}\)</span>, rank 1 tensor, axial, odd time-reversality, indicated here as <span class="math notranslate nohighlight">\(AO^1\)</span>) fields have cartesian components <span class="math notranslate nohighlight">\(E_\rho\)</span> and <span class="math notranslate nohighlight">\(B_\rho\)</span>, respectively (<span class="math notranslate nohighlight">\(\rho = x,y,z\)</span>), and the remaining elements of the equation above are (cartesian) tensor components of different rank, representing the molecular response to the applied fields. From the above equation it is evident that molecular multipoles in the static limit correspond to energy derivatives.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Defines</p></th>
<th class="head"><p>Tensor properties</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mu\)</span></p></td>
<td><p>induced electric dipole moment</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
<td><p>electric dipole polarizability</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^2\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
<td><p>electric dipole first hyperpolarizability</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^3\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\gamma\)</span></p></td>
<td><p>electric dipole second hyperpolarizability</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^4\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Theta\)</span></p></td>
<td><p>induced electric quadrupole moment</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(A\)</span></p></td>
<td><p>electric dipole - quadrupole polarizability</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^3\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C\)</span></p></td>
<td><p>electric quadrupole - quadrupole  polarizability</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^4\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\xi\)</span></p></td>
<td><p>induced magnetizability</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^2\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\chi\)</span></p></td>
<td><p>electric first hypermagnetizability</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^3\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\eta\)</span></p></td>
<td><p>electric second hypermagnetizability</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^4\)</span></p></td>
</tr>
</tbody>
</table>
<p>The table just above classifies the lowest order molecular response moments in terms of their spatial symmetries. Time reversality classifies them with respect to time inversion and it is relevant only for frequency dependent fields/properties (the related tensor vanishes in the static limit). More below on the importance of this tensor classification of molecules multipoles.</p>
<p>When the molecule interacts with a radiation field of wavelength <span class="math notranslate nohighlight">\(\lambda = \frac{2 \pi c_0}{\omega}\)</span>, <span class="math notranslate nohighlight">\(c_0\)</span> being the speed of light in vacuo, one can define the frequency-dependent properties by connecting them to the induced (in general also frequency-dependent) multipole moments. For a small harmonic perturbation of angular frequency <span class="math notranslate nohighlight">\(\omega\)</span> and keeping only <em>linear</em> terms in the perturbative expansion (only single photon processes) we can introduce the induced electric dipole moment <span class="math notranslate nohighlight">\(\mathbf{\mu}\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\mu_\alpha &amp; = &amp; \alpha_{\alpha \beta}(-\omega;\omega) E_\beta^\omega + \frac{1}{\omega} G^\prime_{\alpha \beta}(-\omega;\omega)\dot{B}_\beta^\omega +\frac{1}{3} A_{\alpha, \beta \gamma}(-\omega;\omega) \nabla_\gamma E_{\beta} + \cdots \\ 
&amp; &amp; + \frac{1}{\omega} \alpha^\prime(-\omega;\omega) \dot{E}_\beta^\omega + G_{\alpha \beta}(-\omega;\omega) B_\beta^\omega + \frac{1}{3 \omega} A^\prime_{\alpha, \beta \gamma}(-\omega;\omega) \nabla_\gamma \dot{E}_{\beta}^\omega + \cdots \ ;
\end{eqnarray*}\]</div>
<p>the induced electric quadrupole moment <span class="math notranslate nohighlight">\(\mathbf{\Theta}\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\Theta_{\alpha \beta} &amp; = &amp; A_{\gamma,\alpha \beta}(-\omega;\omega) E_\gamma^\omega - 
\frac{1}{\omega} D^\prime_{\gamma,\alpha \beta}(-\omega;\omega)\dot{B}_\gamma^\omega +
C_{\alpha \beta, \gamma \delta}(-\omega;\omega) \nabla_\delta E_{\gamma} + \cdots \\
&amp; &amp; - \frac{1}{\omega} A^\prime_{\gamma, \alpha \beta}(-\omega;\omega) \dot{E}_\gamma^\omega + D_{\gamma,\alpha \beta}(-\omega;\omega) B_\gamma + \frac{1}{\omega}
C^\prime_{\alpha \beta,\gamma \delta} \nabla_\delta \dot{E}_{\gamma}^\omega + \cdots \ ;
\end{eqnarray*}\]</div>
<p>and the induced magnetic dipole moment <span class="math notranslate nohighlight">\(\mathbf{m}^\prime\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
m_\alpha^\prime &amp; = &amp; \xi_{\alpha, \beta}(-\omega;\omega) B_\beta^\omega + 
\frac{1}{3 \omega} D^\prime_{\alpha,\beta \gamma}(-\omega;\omega)\nabla_\gamma \dot{E}_{\beta}^\omega -
\frac{1}{\omega} G^\prime_{\beta \alpha}(-\omega;\omega) \dot{E}_{\beta} + \cdots \\
&amp; &amp; + \frac{1}{\omega} \xi^\prime_{\alpha \beta}(-\omega;\omega) \dot{B}_\beta^\omega + \frac{1}{3} D_{\alpha,\beta \gamma}(-\omega;\omega) \nabla_\gamma E_{\beta} + G_{\beta \alpha}(-\omega;\omega) E_{\beta}^\omega + \cdots \ .
\end{eqnarray*}\]</div>
<p>Above we have made the dependence of the external fields on the angular frequency <span class="math notranslate nohighlight">\(\omega\)</span> explicit in the symbols <span class="math notranslate nohighlight">\(E_\alpha^\omega\)</span> and <span class="math notranslate nohighlight">\(B_\alpha^\omega\)</span>. <span class="math notranslate nohighlight">\(\dot{X} = \partial X / \partial t\)</span>, where <span class="math notranslate nohighlight">\(t\)</span> is the time variable, whereas <span class="math notranslate nohighlight">\(\nabla_\alpha X_\beta\)</span> indicates the spatial derivative along coordinate <span class="math notranslate nohighlight">\(\alpha\)</span> of the component <span class="math notranslate nohighlight">\(\beta\)</span> of the field <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>. As far as the molecular properties are concerned, they correspond to a generalization to the dynamical regime of the static properties defined in the expansion of the molecular energy above. In short, f.ex., <span class="math notranslate nohighlight">\(\alpha_{\alpha \beta}\)</span> in the energy expansion corresponds to <span class="math notranslate nohighlight">\(\alpha_{\alpha \beta}(0;0)\)</span> in the expansion of the induced electric dipole moment. The notation is chosen to specify the nature of the single photon interaction: a positive sign of the frequency <span class="math notranslate nohighlight">\(\omega\)</span> shows an incoming (absorbed) photon, whereas a negative sign indicates an outgoing (scattered, emitted) photon. In a general <span class="math notranslate nohighlight">\(n\)</span>-photon process the molecular response property <span class="math notranslate nohighlight">\(X(-\omega_\sigma;\omega_n, \cdot , \omega_2, \omega_1)\)</span> described a process implying the combination of absorption and emission of photons which, obeying to the law of energy conservation, leave the molecule in its stationary state and with <span class="math notranslate nohighlight">\(\omega_\sigma = \omega_1+\omega_2+\cdots+\omega_n\)</span>. A convenient way of representing this process is through Ward’s graphs.</p>
<p>Tensors with a prime <span class="math notranslate nohighlight">\(X^\prime\)</span> vanish in the static limit (<span class="math notranslate nohighlight">\(\omega \rightarrow 0\)</span>), whereas tensors in the second rows of the three equation vanish for closed shell non-degenerate systems (described by real wavefunctions).</p>
<p>An equivalent (alternative) way to represent the induced multipole moments introduced just above is through the formalism of response theory. The second rank tensor representing the response to the perturbation represented by the one electron operator <span class="math notranslate nohighlight">\(\hat{B}\)</span> in the expansion of the induced moment represented by operator <span class="math notranslate nohighlight">\(\hat{A}\)</span> in our equations above is associated to linear response functions as follows</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
X(-\omega;\omega) \propto \langle \langle \hat{A} ; \hat{B} \rangle \rangle_{\omega}
\end{equation*}\]</div>
<p>The operators <span class="math notranslate nohighlight">\(\hat{A}\)</span> and <span class="math notranslate nohighlight">\(\hat{B}\)</span> are better characterized in the following. Just as an example, the electric dipole polarizability is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\alpha(-\omega;\omega)_{\alpha \beta} = -\langle \langle \hat{\mu}_\alpha ; \hat{\mu}_\beta \rangle \rangle_{\omega}
\end{equation*}\]</div>
<p>This is because the perturbation to the electric dipole moment <span class="math notranslate nohighlight">\(\mu\)</span> by the electric field <span class="math notranslate nohighlight">\(E_\omega\)</span> is, in the dipole approximation, <span class="math notranslate nohighlight">\(-{\mathbf{\mu}} \cdot {\mathbf{E}}\)</span>. The tensors introduced above can therefore be connected to the corresponding response functions as indicated in the following Table</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Tensor</p></th>
<th class="head"><p>Response function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{\mu}_\alpha ; \hat{\mu}_\beta \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha^\prime_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Im{\langle \langle \hat{\mu}_\alpha ; \hat{\mu}_\beta \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(G_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{\mu}_\alpha ; \hat{m}_\beta \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(G^\prime_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Im{\langle \langle \hat{\mu}_\alpha ; \hat{m}_\beta \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(A_{\alpha,\beta \gamma}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{\mu}_\alpha ; \hat{\Theta}_{\beta \gamma} \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(A^\prime_{\alpha,\beta \gamma}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Im{\langle \langle \hat{\mu}_\alpha ; \hat{\Theta}_{\beta \gamma} \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C_{\alpha\beta,\gamma \delta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{\Theta}_{\alpha \beta} ; \hat{\Theta}_{\gamma \delta} \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(C^\prime_{\alpha\beta,\gamma \delta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Im{\langle \langle \hat{\Theta}_{\alpha \beta} ; \hat{\Theta}_{\gamma \delta} \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(D_{\alpha, \beta \gamma}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{m}_{\alpha} ; \hat{\Theta}_{\beta \gamma} \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(D^\prime_{\alpha, \beta \gamma}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Im{\langle \langle \hat{m}_{\alpha} ; \hat{\Theta}_{\beta \gamma} \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\xi_{\alpha, \beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{m}_{\alpha} ; \hat{m}_{\beta} \rangle \rangle_{\omega}} + \sum_i \frac{q_i^2}{4 m_i} \langle n \mid r_{i \alpha} r_{i \beta} - r_i^2 \delta_{\alpha \beta} \mid \rangle\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\xi^\prime_{\alpha, \beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\Im{\langle \langle \hat{m}_{\alpha} ; \hat{m}_{\beta} \rangle \rangle_{\omega}}\)</span></p></td>
</tr>
</tbody>
</table>
<p>In this section nevertheless we will be interested in <em>nonlinear</em> molecular response, and will discuss molecular properties of order higher than linear in most cases. Some of these appear, in their static (<span class="math notranslate nohighlight">\(\omega_j = 0\)</span>) form, in the perturbative expansion of the energy at the top of this section</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Tensor</p></th>
<th class="head"><p></p></th>
<th class="text-right head"><p>Response function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_{\alpha\beta\gamma}\)</span></p></td>
<td><p></p></td>
<td class="text-right"><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{\mu}_\alpha ; \hat{\mu}_\beta, \hat{\mu}_\gamma \rangle \rangle_{\omega_1,\omega_2}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\gamma_{\alpha\beta\gamma\delta}\)</span></p></td>
<td><p></p></td>
<td class="text-right"><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{\mu}_\alpha ; \hat{\mu}_\beta, \hat{\mu}_\gamma, \hat{\mu}_\delta \rangle\rangle_{\omega_1,\omega_2,\omega_3}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\eta_{\alpha\beta,\gamma\delta}\)</span></p></td>
<td><p></p></td>
<td class="text-right"><p><span class="math notranslate nohighlight">\(\Re{\langle \langle \hat{\mu}_\alpha ; \hat{\mu}_\beta, \hat{m}_\gamma, \hat{m}_\delta \rangle \rangle_{\omega_1,\omega_2,\omega_3}}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The dependence on the angular frequencies above multiplies the number of possible molecular response properties as the order of the process increases. In the following we will connect these molecular response properties to the appropriate response functions and find and describe the connection to physical observables, showing how the tools of analytical response theory, that led in the last few decades to the development of highly efficient computational codes, allow us to confirm and in several case predict with increasing accuracy the outcome of experiments involving intense radiation impinging on molecules, aggregates, materials.</p>
<p>The operators involved in the definitions of the response
functions are the electric dipole (<span class="math notranslate nohighlight">\({\mu}\)</span>), magnetic dipole
(<span class="math notranslate nohighlight">\({m}\)</span>), traced electric quadrupole (<span class="math notranslate nohighlight">\({q}\)</span>) and diamagnetic
susceptibility (<span class="math notranslate nohighlight">\(\xi^{dia}\)</span>) operators,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
{\mu}_\alpha &amp; = &amp; \sum_i q_i {r}_{i\alpha} \label{dodici} \\
{m}_\alpha   &amp; = &amp; \sum_i \frac{q_i}{2m_i} (r_i \times p_i)_\alpha
= \sum_i \frac{q_i}{2m_i} \varepsilon_{\alpha\beta\gamma}
{r}_{i\beta}{p}_{i\gamma}
               = \sum_i \frac{q_i}{2m_i} {l}_{i\alpha} \label{tredici} \\
{q}_{\alpha\beta} &amp; = &amp; \sum_i q_i {r}_{i\alpha}{r}_{i\beta}
\label{quattordici} \\
\xi_{\beta \gamma}^{dia} &amp; = &amp; \frac{1}{4} \sum_i
\frac{q_i^2}{m_i}(r_{i \beta} r_{i \gamma} - r_{i \delta} r_{i
\delta} \delta_{\beta\gamma})
\\
\mu_\alpha^p &amp; = &amp; \sum_i \frac{q_i}{m_i} p_{i\alpha}
\end{eqnarray*}\]</div>
<p>with the standard notation for charges (<span class="math notranslate nohighlight">\(q_i\)</span>), masses (<span class="math notranslate nohighlight">\(m_i\)</span>) and
cartesian components of the position (<span class="math notranslate nohighlight">\({r}_{i\alpha}\)</span>), angular
momentum (<span class="math notranslate nohighlight">\({l}_{i\alpha}\)</span>) and linear momentum (<span class="math notranslate nohighlight">\({p}_{i\alpha}\)</span>)
operators. We have included above also the definition of the
dipole velocity operator (<span class="math notranslate nohighlight">\(\mu^p\)</span>). For one electron the operators simplify to
(electrons, <span class="math notranslate nohighlight">\(q_i = -1\)</span>, <span class="math notranslate nohighlight">\(m_i = 1\)</span>)</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\mu_\alpha &amp; = &amp; -r_{\alpha} \\
m_\alpha &amp; = &amp; -\frac{1}{2} (r \times p)_\alpha = -\frac{1}{2}
\epsilon_{\alpha\beta\gamma} r_\beta
p_\gamma \\
q_{\alpha\beta} &amp; = &amp; -r_{\alpha} r_{\beta} \\
\xi_{\beta \gamma}^{dia} &amp; = &amp; \frac{1}{4} (r_{\beta} r_{\gamma} -
r_{\delta} r_{\delta} \delta_{\beta\gamma}) \\
\mu_\alpha^p &amp; = &amp; -p_{\alpha}
\end{eqnarray*}\]</div>
<p>Some other definitions (au)</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\mathcal{L}_\alpha &amp; = &amp;i [-(r \times \nabla)_\alpha] =
i[-\epsilon_{\alpha\beta\gamma} r_\beta
\nabla_\gamma] \\
m_\alpha &amp; = &amp; -\frac{\mathcal{L}_\alpha}{2} = -\frac{i}{2} [-(r
\times \nabla)_\alpha] = -\frac{i}{2}
[-\epsilon_{\alpha\beta\gamma} r_\beta
\nabla_\gamma] \\
p_\alpha &amp; = &amp; -i \nabla_\alpha \ \ \ \ \ \Rightarrow \ \ \ \ \
\nabla_\alpha = i p_\alpha = -i \mu_\alpha^p \label{pi2}
\end{eqnarray*}\]</div>
<p>In this section wide use will be made of the concepts of space and
time inversion symmetry in determining the form of the tensors
introduced in the previous sections. Heavy reference will both
explicitly and implicitly be made to Chapter 4 of the book by
Laurence Barron  <span id="id2">[]</span> and to the fundamental work of Birss on
macroscopic symmetry in space-time <span id="id3">[]</span>.</p>
<p>A given scalar, vector or tensor can be classified according to
its behavior under space inversion and time reversal. Restricting
our attention to vectors first, it is well known that they can be
classified as <em>polar</em> or <em>axial</em> if they change (or do
not change, respectively) their direction upon inversion of all
coordinates (space inversion). Typical polar vectors are the
position <span class="math notranslate nohighlight">\(\vec{r}\)</span> or the velocity vectors <span class="math notranslate nohighlight">\(\vec{v}\)</span> (and
correspondingly the <span class="math notranslate nohighlight">\({{\mathbf{\mu}}}\)</span> and <span class="math notranslate nohighlight">\({{\mathbf{\mu}}}^p\)</span>
operators), whereas a typical axial vector is the angular momentum
vector <span class="math notranslate nohighlight">\(\vec{l}\)</span> (and the corresponding <span class="math notranslate nohighlight">\({{\mathbf{m}}}\)</span>
operator). Vectors can also be classified on the basis of their
behavior upon time reversal, i.e. a change reversing the arrow of
time. Vectors that do not change their direction upon time
reversal are said to be <em>time even</em>, whereas those changing
their direction are said to be <em>time odd</em>. An example of a
time even (or simply <em>even</em> vector is the position vector
<span class="math notranslate nohighlight">\(\vec{r}\)</span>, whereas both the velocity <span class="math notranslate nohighlight">\(\vec{v}\)</span> and the angular
momentum <span class="math notranslate nohighlight">\(\vec{l}\)</span> operators are time odd. Particular examples of
vectors whose symmetry characteristics upon space inversion and
time reversal are of relevance here are the electric <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> and
magnetic induction <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> fields (and their space and time
derivatives). Their labels can be determined by examining the
symmetry of the physical set-up generating them. If we indicate by
<span class="math notranslate nohighlight">\(P\)</span> or <span class="math notranslate nohighlight">\(A\)</span> the condition of being a polar or axial vector,
respectively, by <span class="math notranslate nohighlight">\(E\)</span> or <span class="math notranslate nohighlight">\(O\)</span> the condition of behaving as
time-even or time-odd upon time reversality, and add a superscript
<span class="math notranslate nohighlight">\(1\)</span> to refer to the particular rank of the vector as a special
case of tensor (so that a superscript <span class="math notranslate nohighlight">\(n\)</span> indicates a tensor
of rank <span class="math notranslate nohighlight">\(n\)</span>, the symmetry relationships given in Table below
(summarizing the spatial and time reversal symmetry properties of some
relevant operators, fields and their time and space derivatives)
can be obtained for the vectors we discussed in this paragraph.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Tensor properties</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vec{r}\)</span>,<span class="math notranslate nohighlight">\(\mathbf{\mu}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PE^1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\vec{v}\)</span>,<span class="math notranslate nohighlight">\(\mathbf{\mu}^p\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PO^1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vec{l}\)</span>,<span class="math notranslate nohighlight">\(\mathbf{m}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AO^1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mathbf{E}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PE^1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathbf{\nabla E}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PE^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mathbf{\dot{E}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PO^1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathbf{\nabla \dot{E}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PO^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mathbf{B}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AO^1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathbf{\nabla B}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AO^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mathbf{\dot{B}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AE^1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathbf{\nabla \dot{B}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AE^2\)</span></p></td>
</tr>
</tbody>
</table>
<p>The definitions of polar/axial, even/odd can be extended to
tensors of any rank. One way to determine the labels of a given
tensor is to employ relationships that connect it to quantities
whose symmetry behavior is known. Thus, f.ex., from the
relationship</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\mu_\alpha &amp; = &amp; \alpha_{\alpha\beta} E_\beta \\
PE^1 &amp; = &amp; PE^2 \times PE^1
\end{eqnarray*}\]</div>
<p>we can determine that the electric dipole polarizability is a
PE<span class="math notranslate nohighlight">\(^2\)</span> (polar, time-even, second rank) tensor. As a general rule,
we can apparently use the following: the product of two polar or
axial tensors yields a polar tensor, whereas the product of an
axial with a polar tensor yields an axial tensor. The product of
two even or of two odd tensors yield a time-even tensor, whereas
the product of an even times an odd tensor yields a time-odd
tensor. By further recognizing that the quadrupole tensor is polar
even (PE<span class="math notranslate nohighlight">\(^2\)</span>), the use of Buckingham’s classical expressions for
the real induced oscillating electric and magnetic multipole
moments</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\mu_\alpha &amp; = &amp; \alpha_{\alpha\beta} E_\beta +
\frac{1}{\omega} \alpha^\prime_{\alpha\beta} {\dot{E}}_\beta
+\frac{1}{3}
A_{\alpha\beta\gamma} {\nabla E}_{\beta\gamma} +\\
&amp; &amp; + \frac{1}{3\omega} A^\prime_{\alpha\beta\gamma} {\nabla
\dot{E}}_{\beta\gamma} +G_{\alpha\beta} {B}_{\beta} +
\frac{1}{\omega} G^\prime_{\alpha\beta}
B_{\beta} + \cdots \\
\Theta_{\alpha\beta} &amp; = &amp; A_{\gamma\alpha\beta} {{E}}_{\gamma} -
\frac{1}{\omega} A^\prime_{\gamma\alpha\beta} {{\dot{E}}}_{\gamma}
+ C_{\alpha\beta\gamma\delta} {{\nabla E}}_{\gamma\delta} +
\frac{1}{\omega} C^\prime_{\alpha\beta\gamma\delta}
{{\nabla\dot{ E}}}_{\gamma\delta} +  \\
&amp; &amp; D_{\gamma\alpha\beta} {{B}}_\gamma -\frac{1}{\omega}
D^\prime_{\gamma\alpha\beta} {{\dot{B}}}_\gamma + \cdots \\
m^\prime_{\alpha} &amp; = &amp; \xi_{\alpha\beta} {{B}}_{\beta} +
\frac{1}{\omega} \xi^\prime_{\alpha\beta} {{\dot{B}}}_{\beta} +
\frac{1}{3} D_{\alpha\beta\gamma} {{\nabla E}}_{\beta\gamma} +
\frac{1}{3\omega} D^\prime_{\alpha\beta\gamma}
{{\nabla\dot{E}}}_{\beta\gamma} +  \\
&amp; &amp; G_{\beta\alpha} {{E}}_\beta -\frac{1}{\omega}
G^\prime_{\beta\alpha} {{\dot{E}}}_\beta + \cdots
\end{eqnarray*}\]</div>
<p>allows us to build the list in the following Table</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Tensor properties</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PE^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha^\prime_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PO^2\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(A_{\alpha\beta\gamma}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PE^3\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(A^\prime_{\alpha\beta\gamma}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PO^3\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(G_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AO^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(G^\prime_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AE^2\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C_{\alpha\beta\gamma\delta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PE^4\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(C^\prime_{\alpha\beta\gamma\delta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PO^4\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(D_{\alpha\beta\gamma}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AO^3\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(D^\prime_{\alpha\beta\gamma}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(AE^3\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\xi_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PE^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\xi^\prime_{\alpha\beta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(PO^2\)</span></p></td>
</tr>
</tbody>
</table>
<p>A good rule of thumbs to determine the symmetry labels of the tensors
consists in obtaining the
label by taking the product of the labels of the individual
operators, according to the prescription given just above. Thus
f.ex., for the tensor <span class="math notranslate nohighlight">\(\langle\langle{\mu}_\alpha;
{m}_\beta,{\mu}^p_\alpha\rangle\rangle\)</span>, we take</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\langle\langle{\mu}_\alpha; {m}_\beta,{\mu}^p_\alpha\rangle\rangle \nonumber \\
{\mu}_\alpha \otimes {m}_\beta \otimes
{\mu}^p_\alpha \nonumber \\
PE^1 \otimes AO^1 \otimes PO^1 \Rightarrow AE^3 \nonumber
\end{eqnarray*}\]</div>
<p>With the information in our hand we can then resort to the Tables
published by Birss and reproduced also in Barron’s book, to
determine the tensors which survive for the different molecular symmetries.
For example, for atoms, centrosymmetric linear molecules and
etheronuclear diatomics, according to Birss, see Table 4 therein.
For non centrosymmetric linear molecules (C<span class="math notranslate nohighlight">\(_{\infty v}\)</span>, cf.
magnetic point group 6mm) centrosymmetric linear molecules
(D<span class="math notranslate nohighlight">\(_{\infty h}\)</span>, cf. magnetic point group 6/mmm) and for atoms
(S<span class="math notranslate nohighlight">\(_3\)</span>, cf. magnetic point group m3m), the nonvanishing tensors
are (<span class="math notranslate nohighlight">\(n=0,1,2,\cdots\)</span>)</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Point group</p></th>
<th class="head"><p>Tensor properties</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>C<span class="math notranslate nohighlight">\(_{\infty v}\)</span> (6mm)</p></td>
<td><p>All tensors</p></td>
</tr>
<tr class="row-odd"><td><p>D<span class="math notranslate nohighlight">\(_{\infty h}\)</span> (6/mmm)</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^{2n}\)</span>, <span class="math notranslate nohighlight">\(AE^{2n+1}\)</span>, <span class="math notranslate nohighlight">\(PO^{2n}\)</span>, <span class="math notranslate nohighlight">\(AO^{2n+1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>S<span class="math notranslate nohighlight">\(_3\)</span> (m3m)</p></td>
<td><p><span class="math notranslate nohighlight">\(PE^{2n}\)</span>, <span class="math notranslate nohighlight">\(AE^{2n+1}\)</span>, <span class="math notranslate nohighlight">\(PO^{2n}\)</span>, <span class="math notranslate nohighlight">\(AO^{2n+1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>———–</p></td>
<td><p>———–</p></td>
</tr>
</tbody>
</table>
<p>Note that Birss’s Tables also specify the
relationships between the various tensor components, and it is to
these relationships that one can resort to introduce
simplifications.</p>
<p><strong>Anisotropic and Isotropic Molecular Orientation: Laboratory frame vs molecular frame</strong></p>
<p>When stydying physical processes as the interaction of radiation with matter, in a vast majority of cases experiments are performed on fluids. To connect theory and the results of such experiments and to derive expression for the observables, it is necessary to take into account the random orientation of the molecules. This is usually done by deriving results for for a system with fixed orientation and then carry on ann orientartional average. The general expression of the observable <span class="math notranslate nohighlight">\(T\)</span> has the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
T = A_{i_1 \cdots i_n} P_{i_1 \cdots i_n}
\end{equation*}\]</div>
<p>where the tensor <span class="math notranslate nohighlight">\(P_{i_1 \cdots i_n}\)</span> contains the response of a molecule subject to the external conditions represented by the tensor <span class="math notranslate nohighlight">\(A_{i_1 \cdots i_n}\)</span>. In one-photon absorption for instance, the transition rate (observable, out <span class="math notranslate nohighlight">\(T\)</span> here) is connected with two second order tensors, say <span class="math notranslate nohighlight">\({\mathbf A}\)</span> containing information on the polarization of the radiation and say <span class="math notranslate nohighlight">\(\mathbf P\)</span>, relates to the square of the transition moment. The tensor components of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> are usually given in a common frame, f.ex. and most commonly a space-fixed frame, chosen often in a way that the polarization information in <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> might be expressed straighforwardly. For a randomly oriented system then the components of <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> are re-xpressed with respect to the space-fixed frame by employing the director cosines of the angle betwen the spac-fixed and the molecule-fix angles <span class="math notranslate nohighlight">\(l_{i_p \lambda_p}\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
P_{i_1 \cdots i_n} = l_{i_1 \lambda_1} \cdots l_{i_n \lambda_n} P_{\lambda_1 \cdots \lambda_n}
\end{equation*}\]</div>
<p>and the task of obtaining rotationally-averaged results for the observable reduces to the calculation of rotationally averaged products of direction cosines <span class="math notranslate nohighlight">\(l_{i_1 \lambda_1} \cdots l_{i_n \lambda_n}\)</span>. One resorts to Euler angle matrices, with <span class="math notranslate nohighlight">\(l_{i_1 \lambda_1} \cdots l_{i_n \lambda_n}\)</span> standing for the <span class="math notranslate nohighlight">\((i_p,\lambda_p)\)</span> element of the matrix and to compute the rotationally averaged observable one needs to compute the integral <span class="math notranslate nohighlight">\(I^{(n)}_{i_1 \cdots i_n ; \lambda_1 \cdots \lambda_n}\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
I^{(n)}_{i_1 \cdots i_n ; \lambda_1 \cdots \lambda_n} = \frac{1}{8 \pi^2} \int_{0}^{2 \pi} \int_{0}^{\pi} \int_{0}^{2 \pi} l_{i_1 \lambda_1} \cdots l_{i_n \lambda_n} \sin \theta
 d \phi d \theta d \psi
\end{equation*}\]</div>
<p>Often we encounter processes where the general expression of the molecular contribution to the induced moments can be cast in to the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\sum_j 
\sum_k 
\cdots
\sum_l
\sum_m 
\frac{
(\mathbf{A}_{f j}  \cdot \mathbf{R}_{-\omega_\sigma})
(\mathbf{B}_{j k}  \cdot \mathbf{S}_{\omega_n})
\cdots 
(\mathbf{L}_{l m} \cdot \mathbf{W}_{\omega_2})
(\mathbf{M}_{m n} \cdot \mathbf{Z}_{\omega_1})
}{
(E_{j f}+\omega_\sigma) 
(E_{k j}-\omega_n) 
\cdots 
(E_{m l}-\omega_2)  
(E_{n m}-\omega_1)
}
\end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>,<span class="math notranslate nohighlight">\(\mathbf{B} \cdots \mathbf{M}\)</span> are vectors (rank one cartesian tensors) associated to the molecule-fixed transition moments
<span class="math notranslate nohighlight">\(\mathbf{\mu}, \mathbf{m}\)</span> etc., whereas vectors <span class="math notranslate nohighlight">\(\mathbf{R}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{S} \cdots \mathbf{W}, \mathbf{Z}\)</span> are vectors representing field quantities, aligned with laboratory fixed frames. The denominators are scalars mixing excitation (transition) energies and angular frequencies of the radiation. Sums run over all states of the molecule. Denominators are inessential for our discussion here, and the core of the discussion is the collection of numerators, where the vectors representing field quantities are usually reduced to the product of a scalar (connected in space to the intensity of the field) and a unit vector, member of the triad <span class="math notranslate nohighlight">\(\mathbf{i}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{j}\)</span> <span class="math notranslate nohighlight">\(\mathbf{k}\)</span>. A possible element of this combination is f.ex.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
(\mathbf{A}  \cdot \mathbf{i})
(\mathbf{B}  \cdot \mathbf{i})
\cdots 
(\mathbf{L} \cdot \mathbf{j})
(\mathbf{M} \cdot \mathbf{k}) = A_x B_x \cdots L_y M_z
\end{equation*}\]</div>
<p>Under rotation this product transforms as a tensor of rank equal to the number of dot products (left) or components (right). The problem of isotropically averaging quantities that transform like higher-rank Cartesian tensors has been treated often, in numerous papers by various approaches <span id="id4">[]</span>. Results for tensors from rank two up to rank five are (<span class="math notranslate nohighlight">\(\mathbf{N} \cdots \mathbf{R} = \mathbf{i}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{j}, \mathbf{k}\)</span>)</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\langle(\mathbf{A}  \cdot \mathbf{N})
(\mathbf{B}  \cdot \mathbf{O}) \rangle
 = \frac{1}{3} (\mathbf{A}  \cdot \mathbf{B})
(\mathbf{N}  \cdot \mathbf{O})
\end{equation*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\langle(\mathbf{A}  \cdot \mathbf{N})
(\mathbf{B}  \cdot \mathbf{O}) (\mathbf{C}  \cdot \mathbf{P}) \rangle
 = \frac{1}{6} (\mathbf{A}  \cdot \mathbf{B} \times \mathbf{C} )
(\mathbf{N}  \cdot \mathbf{O} \times \mathbf{P})
\end{equation*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\langle(\mathbf{A}  \cdot \mathbf{N})
(\mathbf{B}  \cdot \mathbf{O}) (\mathbf{C}  \cdot \mathbf{P}) (\mathbf{D}  \cdot \mathbf{Q}) \rangle
&amp; = &amp; \Big [ \frac{2}{15} (\mathbf{A}  \cdot \mathbf{B}) (\mathbf{C} \cdot \mathbf{D}) -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{C}) (\mathbf{B} \cdot \mathbf{D}) -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{D}) (\mathbf{B} \cdot \mathbf{C}) \Big ] 
(\mathbf{M}  \cdot \mathbf{N}) (\mathbf{P} \cdot \mathbf{Q}) \\
&amp; &amp; \Big [ -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{B}) (\mathbf{C} \cdot \mathbf{D}) +\frac{2}{15} (\mathbf{A}  \cdot \mathbf{C}) (\mathbf{B} \cdot \mathbf{D}) -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{D}) (\mathbf{B} \cdot \mathbf{C}) \Big ] 
(\mathbf{M}  \cdot \mathbf{P}) (\mathbf{N} \cdot \mathbf{Q}) \\
&amp; &amp; \Big [ -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{B}) (\mathbf{C} \cdot \mathbf{D}) -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{C}) (\mathbf{B} \cdot \mathbf{D}) +\frac{2}{15} (\mathbf{A}  \cdot \mathbf{D}) (\mathbf{B} \cdot \mathbf{C}) \Big ] 
(\mathbf{M}  \cdot \mathbf{Q}) (\mathbf{N} \cdot \mathbf{P})
\end{eqnarray*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\langle(\mathbf{A}  \cdot \mathbf{N})
(\mathbf{B}  \cdot \mathbf{O}) (\mathbf{C}  \cdot \mathbf{P}) (\mathbf{D}  \cdot \mathbf{Q}) (\mathbf{E}  \cdot \mathbf{R})\rangle
&amp; = \frac{1}{30} \Big [ &amp; 
+(\mathbf{A}  \cdot \mathbf{B}) (\mathbf{C} \cdot \mathbf{D} \times \mathbf{E} )
(\mathbf{M}  \cdot \mathbf{N}) (\mathbf{P} \cdot \mathbf{Q} \times \mathbf{R} )
+ (\mathbf{A}  \cdot \mathbf{C}) (\mathbf{B} \cdot \mathbf{D} \times \mathbf{E} )
(\mathbf{M}  \cdot \mathbf{P}) (\mathbf{N} \cdot \mathbf{Q} \times \mathbf{R} ) \\
&amp; &amp; +(\mathbf{A}  \cdot \mathbf{D}) (\mathbf{B} \cdot \mathbf{C} \times \mathbf{E} )
(\mathbf{M}  \cdot \mathbf{Q}) (\mathbf{N} \cdot \mathbf{P} \times \mathbf{R} )
+ (\mathbf{A}  \cdot \mathbf{E}) (\mathbf{B} \cdot \mathbf{C} \times \mathbf{D} )
(\mathbf{M}  \cdot \mathbf{R}) (\mathbf{N} \cdot \mathbf{P} \times \mathbf{Q} ) \\
&amp; &amp; +(\mathbf{B}  \cdot \mathbf{C}) (\mathbf{A} \cdot \mathbf{D} \times \mathbf{E} )
(\mathbf{N}  \cdot \mathbf{P}) (\mathbf{M} \cdot \mathbf{Q} \times \mathbf{R} )
+ (\mathbf{B}  \cdot \mathbf{D}) (\mathbf{A} \cdot \mathbf{C} \times \mathbf{E} )
(\mathbf{N}  \cdot \mathbf{Q}) (\mathbf{M} \cdot \mathbf{P} \times \mathbf{R} ) \\
&amp; &amp; +(\mathbf{B}  \cdot \mathbf{E}) (\mathbf{A} \cdot \mathbf{C} \times \mathbf{D})(\mathbf{N}  \cdot \mathbf{R}) (\mathbf{M} \cdot \mathbf{P} \times \mathbf{Q}) +(\mathbf{C}  \cdot \mathbf{D}) (\mathbf{A} \cdot \mathbf{B} \times \mathbf{E})(\mathbf{P}  \cdot \mathbf{Q}) (\mathbf{M} \cdot \mathbf{N} \times \mathbf{R}) \\
&amp; &amp; +(\mathbf{C}  \cdot \mathbf{E}) (\mathbf{A} \cdot \mathbf{B} \times \mathbf{D})(\mathbf{P}  \cdot \mathbf{R}) (\mathbf{M} \cdot \mathbf{N} \times \mathbf{Q}) +(\mathbf{D}  \cdot \mathbf{E}) (\mathbf{A} \cdot \mathbf{B} \times \mathbf{C}) (\mathbf{Q}  \cdot \mathbf{R}) (\mathbf{M} \cdot \mathbf{N} \times \mathbf{P})  \Big ]
\end{eqnarray*}\]</div>
<p>Expressions for tensors of higher rank are available in the literature. Rotational averages of even rank up to ten are given in Ref. <span id="id5">[]</span>, where simple relationships between averages of different ranks are given and it is shown that averages of odd rank are easily obtained from averages of even rank.</p>
<p><strong>Electric properties</strong></p>
<p>Here we consider molecular properties
which characterize the interactions
with static and/or frequency-dependent electric fields.
The electric properties of a molecule determine the
electric properties of the bulk sample, such as the relative
permittivity (dielectric constant) and the refractive
index. In
addition, the electric properties can be used to describe
intermolecular forces.</p>
<p>Only static and dynamic molecular properties involving electric
dipole and quadrupole operators will be discussed
below.</p>
<p>Most theoretical results are obtained in atomic units (a.u.), whereas
experimental data often are given in SI or esu units.  In
Here you find some useful conversion factors are given.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>1 a.u.</p></th>
<th class="head"><p>SI</p></th>
<th class="head"><p>esu</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(F\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(E_h e^{-1}a_0^{-1}\)</span></p></td>
<td><p>5.104206 <span class="math notranslate nohighlight">\(\times 10^{11}\)</span> Vm<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>1.7153 <span class="math notranslate nohighlight">\(\times 10^{7}\)</span> statvolt cm<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mu\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(e a_0\)</span></p></td>
<td><p>8.478353 <span class="math notranslate nohighlight">\( \times 10^{-30} \)</span> C m</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>2.5417 <span class="math notranslate nohighlight">\(\times 10^{-18}\)</span></p></td>
<td><p>statvolt cm<span class="math notranslate nohighlight">\(^{2}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Theta\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(e a_0^2\)</span></p></td>
<td><p>4.486551 <span class="math notranslate nohighlight">\(\times 10^{-40}\)</span> C m<span class="math notranslate nohighlight">\(^2\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1.3450 <span class="math notranslate nohighlight">\( \times 10^{-26}\)</span> statvolt cm<span class="math notranslate nohighlight">\(^3\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(e^2 a_0^{2} E_h^{-1}\)</span></p></td>
<td><p>1.648777 <span class="math notranslate nohighlight">\(\times 10^{-41}\)</span> C<span class="math notranslate nohighlight">\(^2\)</span> m<span class="math notranslate nohighlight">\(^2\)</span> J<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1.4818 <span class="math notranslate nohighlight">\( \times 10^{-25}\)</span> &amp; cm<span class="math notranslate nohighlight">\(^{3}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(e^3 a_0^{3} E_h^{-2}\)</span></p></td>
<td><p>3.206362 $ \times</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>10^{-53}<span class="math notranslate nohighlight">\( C\)</span>^3<span class="math notranslate nohighlight">\( m\)</span>^3<span class="math notranslate nohighlight">\( J\)</span>^{-2}$</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>8.6392 <span class="math notranslate nohighlight">\( \times 10^{-33}\)</span> statvolt<span class="math notranslate nohighlight">\(^{-1}\)</span> cm<span class="math notranslate nohighlight">\(^{4}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\gamma\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(e^4 a_0^{4} E_h^{-3}\)</span></p></td>
<td><p>6.235381 $ \times</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>10^{-65}<span class="math notranslate nohighlight">\( C\)</span>^4<span class="math notranslate nohighlight">\( m\)</span>^4<span class="math notranslate nohighlight">\( J\)</span>^{-3}$</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>5.0367 <span class="math notranslate nohighlight">\( \times 10^{-40}\)</span> statvolt<span class="math notranslate nohighlight">\(^{-2}\)</span> cm<span class="math notranslate nohighlight">\(^{5}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p><strong>The origin of the frequency-dependent electric dipole polarizability and hyperpolarizabilities</strong></p>
<p>The electric dipole moment <span class="math notranslate nohighlight">\(\tilde{\mu}\)</span> in the presence of an
applied spatially homogeneous non-monochromatic electric field
<span class="math notranslate nohighlight">\( \sum_{i} \mathbf{F}^{\omega_{i}}\)</span> (where <span class="math notranslate nohighlight">\(\omega_{i}\)</span> indicates the
circular frequency) can be written as</p>
<div class="amsmath math notranslate nohighlight" id="equation-191fbb7f-b988-43b5-8eb9-13552d64ec79">
<span class="eqno">()<a class="headerlink" href="#equation-191fbb7f-b988-43b5-8eb9-13552d64ec79" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\tilde{\mu}_\alpha^{\omega_{\sigma}} &amp; = &amp; \mu_\alpha \delta(\omega_{\sigma}=0) +
\alpha_{\alpha\beta}(-\omega_{\sigma};\omega_1)F_\beta(\omega_1)
 \\ &amp; + &amp;
\frac{1}{2} \sum_{\omega_1,\omega_2}
\beta_{\alpha\beta\gamma}(-\omega_{\sigma};\omega_1,\omega_2)
F_\beta(\omega_1)F_\gamma(\omega_2)
\\  &amp; + &amp;
\frac{1}{6} \sum_{\omega_1,\omega_2,\omega_3}
\gamma_{\alpha\beta\gamma\delta}(-\omega_{\sigma};\omega_1,\omega_2,\omega_3)
F_\beta(\omega_1)F_\gamma(\omega_2)F_\delta(\omega_3) + \cdots, 
\end{eqnarray}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_\alpha\)</span> is the unperturbed electric dipole moment.  In this
phenomenological expansion (which we use to describe elastic light
scattering processes) the summations over optical frequencies will
be restricted in order to preserve a constant <span class="math notranslate nohighlight">\(\omega_{\sigma}\)</span>
equal to the sum of optical frequencies</p>
<div class="amsmath math notranslate nohighlight" id="equation-9e50444f-2a0a-4812-b13f-376e656b3d44">
<span class="eqno">()<a class="headerlink" href="#equation-9e50444f-2a0a-4812-b13f-376e656b3d44" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\omega_{\sigma} = \sum_{i}\omega_i.
\end{eqnarray}\]</div>
<p>The equation above defines the components of the dynamic
electric dipole polarizability
tensor,
<span class="math notranslate nohighlight">\(\alpha_{\mu\nu}(-\omega_{\sigma};\omega_1)\)</span>, those of the first
electric dipole
hyperpolarizability,
<span class="math notranslate nohighlight">\(\beta_{\mu\nu\eta}(-\omega_{\sigma};\omega_1,\omega_2)\)</span> and those
of the second electric dipole
hyperpolarizability
<span class="math notranslate nohighlight">\(\gamma_{\mu\nu\eta\xi}(-\omega_{\sigma};\omega_1,\omega_2,\omega_3)\)</span>.
The combination of frequencies and the presence or absence of static fields
characterize various nonlinear processes.  The calculations can be
done for any combination of frequencies satisfying
the condition <span class="math notranslate nohighlight">\(\omega_{\sigma} = \sum_{i}\omega_i\)</span>.</p>
<p>The Figure shows
how some of these processes can be interpreted in terms of
electronic transitions between ground and excited states. The
excited states can be treated as virtual states, but if one of the
excitation energies is close to the frequency of the light, the
contribution of that state is often dominant.
Simplified models that include in the analysis only a few excited
states can be used when these computed states describe well the
real, physical states of the molecule which are relevant for the
property studied. However, it is important to emphasize that even
though these few-states models in many cases may give qualitative
insight into the electronic processes, the
convergence of the
sum-over-states expansion for the (hyper)polarizabilities<br />
with respect to the number of excited states included in the
summation is in general very slow.</p>
<p>We should also keep in mind that if
an excitation energy equals a frequency, we have a very
different situation in which we have to consider the finite lifetime
of the excited state and also deal with the absorption
process.</p>
<p><img alt="filemjarkr-fig2.png" src="docs/attachment:00b05e02-ad33-4f56-ab2a-2c9183648b3f.png" /></p>
<p>In experiment, the molecule is often perturbed by a combination of
a static and a dynamic electric field. We then have, assuming a
monochromatic dynamic field,</p>
<div class="amsmath math notranslate nohighlight" id="equation-0bf5d3c8-e0e5-4fba-a5ae-124981190005">
<span class="eqno">()<a class="headerlink" href="#equation-0bf5d3c8-e0e5-4fba-a5ae-124981190005" title="Permalink to this equation">#</a></span>\[\begin{equation}
F_\alpha(t) = F_\alpha^0 + F_\alpha^{\omega}\cos(\omega t),
\end{equation}\]</div>
<p>and therefore the time dependence of the polarization can be described as</p>
<div class="amsmath math notranslate nohighlight" id="equation-eedb2b2e-35ca-4034-aedc-5c8e0da96794">
<span class="eqno">()<a class="headerlink" href="#equation-eedb2b2e-35ca-4034-aedc-5c8e0da96794" title="Permalink to this equation">#</a></span>\[\begin{equation}
\mu_\alpha(t) = \mu_\alpha^0 + \mu_\alpha^{\omega}\cos(\omega t) +
\mu_\alpha^{2\omega}\cos(2\omega t)+\mu_\alpha^{3\omega}\cos(3\omega t) +
\cdots,
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_\alpha^{n\omega}\)</span> are the Fourier
amplitudes to be determined.
In order to compare
the measured polarization at a certain frequency to the
theoretical expressions, we insert the expression of the dynamic field into
the expression of the electric dipole moment <span class="math notranslate nohighlight">\(\mu\)</span> and use the relations between
<span class="math notranslate nohighlight">\(\cos^n(\omega t)\)</span> and <span class="math notranslate nohighlight">\(\cos(n\omega t)\)</span>.
We obtain</p>
<div class="amsmath math notranslate nohighlight" id="equation-c5cb16ae-ab90-4175-9094-d321a37aa479">
<span class="eqno">()<a class="headerlink" href="#equation-c5cb16ae-ab90-4175-9094-d321a37aa479" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\mu^0_\alpha &amp; = &amp;
\mu_\alpha + \alpha_{\alpha\beta} (0;0) F_\beta^0 +
\frac{1}{2} \beta_{\alpha\beta\gamma}(0;0,0) F_\beta^0F_\gamma^0 +
\frac{1}{6} \gamma_{\alpha\beta\gamma\delta}(0;0,0,0) F_\beta^0D_\gamma^0F_\delta^0
\\ &amp; + &amp;
\frac{1}{4} \beta_{\alpha\beta\gamma}(0;-\omega,\omega) F_\beta^{\omega}F_\gamma^{\omega} +
\frac{1}{4} \gamma_{\alpha\beta\gamma\delta}(0;0,-\omega,\omega)
F_\beta^0F_\gamma^{\omega}F_\delta^{\omega},
\\
\mu^{\omega}_\alpha &amp; = &amp;
\alpha_{\alpha\beta}(-\omega;\omega) F_\beta^{\omega} +
\beta_{\alpha\beta\gamma}(-\omega;\omega,0) F_\beta^{\omega}F_\gamma^0
 \\ &amp; + &amp;
\frac{1}{2} \gamma_{\alpha\beta\gamma\delta}(-\omega;\omega,0,0)F_\beta^{\omega}F_\gamma^0F_\delta^0 +
\frac{1}{8} \gamma_{\alpha\beta\gamma\delta}(-\omega;\omega,-\omega,\omega)
F_\beta^{\omega}F_\gamma^{\omega}F_\delta^{\omega},
\\
\mu^{2\omega}_\alpha &amp; = &amp;
\frac{1}{4} \beta_{\alpha\beta\gamma}(-2\omega;\omega,\omega)
F_\beta^{\omega}F_\gamma^{\omega} +
\frac{1}{4} \gamma_{\alpha\beta\gamma\delta}(-2\omega;\omega,\omega,0)
F_\beta^{\omega}F_\gamma^{\omega}F_\delta^0,
\\
\mu^{3\omega}_\alpha &amp; = &amp;
\frac{1}{24} \gamma_{\alpha\beta\gamma\delta}(-3\omega;\omega,\omega,\omega)
F_\beta^{\omega}F_\gamma^{\omega}F_\delta^{\omega},
\end{eqnarray}\]</div>
<p>where we have truncated the expansions at <span class="math notranslate nohighlight">\(\cos(3\omega t)\)</span>.
Using the expansions given above and the
expansion of <span class="math notranslate nohighlight">\(\mu\)</span>  we can compare the experimentally measured polarization
and the theoretical estimates.</p>
<p><strong>First electric dipole hyperpolarizability</strong></p>
<p>The first electric dipole hyperpolarizability, given by the
quadratic response function</p>
<div class="amsmath math notranslate nohighlight" id="equation-ed889e41-1597-425a-813b-ee77103f24ef">
<span class="eqno">()<a class="headerlink" href="#equation-ed889e41-1597-425a-813b-ee77103f24ef" title="Permalink to this equation">#</a></span>\[\begin{equation}
\beta_{\alpha \beta \gamma}(-\omega_\sigma; \omega_1, \omega_2)=
-\langle\langle \hat{\mu}_\alpha ;\hat{\mu}_\beta ,\hat{\mu}_\gamma
\rangle\rangle_{\omega_1,\omega_2},
\end{equation}\]</div>
<p>has physical meaning only when <span class="math notranslate nohighlight">\(\omega_\sigma = \omega_1 + \omega_2\)</span>.</p>
<p>The static dipole hyperpolarizability <span class="math notranslate nohighlight">\(\beta\)</span>(0;0,0) can be
obtained evaluating the third derivative of the energy. When
we consider dynamic fields, the processes of particular interest
are</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Process</p></th>
<th class="head"><p></p></th>
<th class="head"><p>RF</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Second Harmonic Generation (SHG)</p></td>
<td><p><span class="math notranslate nohighlight">\(\beta^{\rm SHG}_{\mu\nu\eta}(-2\omega;\omega,\omega)\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>= <span class="math notranslate nohighlight">\(-\langle\langle \hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta} \rangle\rangle_{\omega,\omega}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>dc-Pockels Effect (dc-P) or</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Electro-Optic Pockels Effect (EOPE)</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta^{\rm EOPE}_{\mu\nu\eta}(-\omega;\omega,0)\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>=<span class="math notranslate nohighlight">\(- \langle\langle\hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta}\rangle\rangle_{\omega,0}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Optical Rectification (OR)</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta^{\rm OR}_{\mu\nu\eta}(0;\omega,-\omega)\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>=<span class="math notranslate nohighlight">\(- \langle\langle\hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta}\rangle\rangle_{\omega,-\omega}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>In these processes
we deal with a perturbation of frequency <span class="math notranslate nohighlight">\(\omega\)</span> (and a static field in the
Pockels effect) and we consider the resulting dipole moment oscillating
with frequency <span class="math notranslate nohighlight">\(2\omega\)</span>, frequency <span class="math notranslate nohighlight">\(\omega\)</span> or static,
respectively.</p>
<p>The general definition  of the quadratic response function, indicates its symmetry with respect
to permutation of operators. Thus, for
all the dipole
hyperpolarizabilities we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-986e8c31-c58e-4d65-8cb8-2b8c556da031">
<span class="eqno">()<a class="headerlink" href="#equation-986e8c31-c58e-4d65-8cb8-2b8c556da031" title="Permalink to this equation">#</a></span>\[\begin{equation}
\beta_{\mu\nu\eta} (-\omega_\sigma; \omega_1, \omega_2)  =
\beta_{\mu\eta\nu} (-\omega_\sigma; \omega_2, \omega_1).
\end{equation}\]</div>
<p>Also the relation</p>
<div class="amsmath math notranslate nohighlight" id="equation-f3c5fe8c-4f09-4fec-9a64-7280838cfbd9">
<span class="eqno">()<a class="headerlink" href="#equation-f3c5fe8c-4f09-4fec-9a64-7280838cfbd9" title="Permalink to this equation">#</a></span>\[\begin{equation}
\beta_{\mu\nu\eta} (-\omega_\sigma; \omega_1, \omega_2)  =
\beta_{\nu\mu\eta} (\omega_1; -\omega_\sigma, \omega_2)
\end{equation}\]</div>
<p>holds,
and we have, for instance,
<span class="math notranslate nohighlight">\(\beta^{\rm OR}_{\mu\nu\eta}(0;\omega,-\omega)\)</span> =
<span class="math notranslate nohighlight">\(\beta^{\rm EOPE}_{\eta\nu\mu}(-\omega;\omega,0)\)</span>. We note that this relation does not hold for macroscopic samples due to the differences in the local fields experienced by the molecule in these two different experimental set-ups.</p>
<p>In the case of the first
hyperpolarizability, the measured
quantity is the vector component of <span class="math notranslate nohighlight">\(\beta\)</span> in the direction of
the permanent dipole moment <span class="math notranslate nohighlight">\(\mu\)</span>, defining the molecular <span class="math notranslate nohighlight">\(z\)</span> axis.
The relevant averages are given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-02f37f95-881c-43f7-a0b2-92e3e7bfbe8e">
<span class="eqno">()<a class="headerlink" href="#equation-02f37f95-881c-43f7-a0b2-92e3e7bfbe8e" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\beta_{\parallel} &amp; = &amp; \frac{1}{5}
(\beta_{z\eta\eta}+
\beta_{\eta z\eta}+\beta_{\eta\eta z}),
\\
\beta_{\perp} &amp; = &amp; \frac{1}{5}
(2\beta_{z\eta\eta}
-3\beta_{\eta z\eta}+2\beta_{\eta\eta z}),
\end{eqnarray}\]</div>
<p>where the same sequence of optical frequencies (not given
explicitly) is used for the laboratory axes and the molecular
axes.</p>
<p>The number of independent non-zero tensor elements depends on the
non-linear optical process and on the symmetry of the
molecule.  For example,
<span class="math notranslate nohighlight">\(\beta^{\rm SHG}\)</span> is symmetric with respect to the
permutation of the second and third indices and this
can be used to simplify the equations for the parallel and
perpendicular components.  For non-zero frequencies, the number of
independent tensor components to be computed
decreases when Kleinman’s symmetry is
assumed, that is, we assume that we can permute the indices of
the incoming light without changing the corresponding frequencies,</p>
<div class="amsmath math notranslate nohighlight" id="equation-6a0c935f-2b6b-45d8-998c-4a27d3e852ce">
<span class="eqno">()<a class="headerlink" href="#equation-6a0c935f-2b6b-45d8-998c-4a27d3e852ce" title="Permalink to this equation">#</a></span>\[\begin{equation}
\beta_{\mu\nu\eta} (-\omega_\sigma; \omega_1, \omega_2)  \approx
\beta_{\mu\eta\nu} (-\omega_\sigma; \omega_1, \omega_2).
\end{equation}\]</div>
<p>Although for  <span class="math notranslate nohighlight">\(\omega_1 \neq \omega_2\)</span> this is only an approximation
and these two tensor components are not equal,
Kleinman’s symmetry is often applied for low frequencies, where it
it is usually found to be a reasonable approximation.</p>
<p>The basis set requirements for the calculation of first
hyperpolarizabilities
are much the same as for the linear
polarizability. However, as the first hyperpolarizability probes
even higher-order electric-field-perturbed densities of the
molecule, care should be exercised to ensure that the basis set is
sufficiently saturated with respect to diffuse polarizing
functions. Special basis sets have been developed for the
calculation of hyperpolarizabilities by Pluta and
Sadlej, though the same basis sets that can be
used for polarizabilities in most cases give reliable estimates
also for first hyperpolarizabilities.</p>
<p>Due to the fact that the first hyperpolarizability involves multiple
virtual excited states, the property has proven to be more sensitive
to electron correlation effects than the
polarizability.
Molecules with push-pull conjugated structures
are often characterized by large first hyperpolarizabilities. Due to the
problems facing many commonly used local exchange-correlation
functionals, DFT has been shown to have difficulties describing
correctly nonlinear optical properties such as the first
hyperpolarizability for extended
systems}. The Coulomb-attenuated B3LYP
functional
(CAM-B3LYP) has, in contrast, shown quite good performance
also for rather extended
systems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Warning * Environment variable OMP_NUM_THREADS not set.
* Warning * Setting OMP_NUM_THREADS to 4.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;3</span>

<span class="s2">O    0.000000000000        0.000000000000        0.000000000000</span>
<span class="s2">H    0.000000000000        0.740848095288        0.582094932012</span>
<span class="s2">H    0.000000000000       -0.740848095288        0.582094932012</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz_string</span><span class="p">(</span><span class="n">mol_str</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="s2">&quot;6-31G&quot;</span><span class="p">)</span>

<span class="n">scf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">scf_drv</span><span class="o">.</span><span class="n">xcfun</span> <span class="o">=</span> <span class="s2">&quot;b3lyp&quot;</span>
<span class="n">scf_results</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /home/thomas/miniconda3/envs/echem/lib/python3.11/site-packages/veloxchem/basis/6-31G
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: 6-31G                                                                               
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                O   (3S,2P)                   (10S,4P)                                                    
                                H   (2S)                      (4S)                                                        
                                                                                                                          
                               Contracted Basis Functions : 13                                                            
                               Primitive Basis Functions  : 30                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Kohn-Sham                                            
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                   Exchange-Correlation Functional : B3LYP                                                                
                   Molecular Grid Level            : 4                                                                    
                                                                                                                          
* Info * Nuclear repulsion energy: 9.3436381577 a.u.                                                                      
                                                                                                                          
* Info * Molecular grid with 40720 points generated in 0.03 sec.                                                          
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -75.983338616414 a.u. Time: 0.04 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. |    Kohn-Sham Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -76.382699812798    0.0000000000      0.05670614      0.01048321      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -76.382539139974    0.0001606728      0.07129485      0.01319488      0.03018475                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -76.382991972334   -0.0004528324      0.00030928      0.00007978      0.01573173                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -76.382991994855   -0.0000000225      0.00006836      0.00001797      0.00025274                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -76.382991995457   -0.0000000006      0.00000182      0.00000048      0.00002698                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -76.382991995458   -0.0000000000      0.00000011      0.00000002      0.00000200                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 6 iterations. Time: 0.80 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Kohn-Sham:                                                                                 
               --------------------------                                                                                 
               Total Energy                       :      -76.3829919955 a.u.                                              
               Electronic Energy                  :      -85.7266301531 a.u.                                              
               Nuclear Repulsion Energy           :        9.3436381577 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000001103 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -19.13088 a.u.                                                                  
               (   1 O   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.02755 a.u.                                                                  
               (   1 O   1s  :     0.21) (   1 O   2s  :    -0.46) (   1 O   3s  :    -0.44)                              
               (   1 O   1p0 :    -0.16) (   2 H   1s  :    -0.16) (   3 H   1s  :    -0.16)                              
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.53552 a.u.                                                                  
               (   1 O   1p-1:     0.52) (   1 O   2p-1:     0.23) (   2 H   1s  :     0.27)                              
               (   3 H   1s  :    -0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.35839 a.u.                                                                  
               (   1 O   2s  :     0.20) (   1 O   3s  :     0.38) (   1 O   1p0 :    -0.55)                              
               (   1 O   2p0 :    -0.38)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.29367 a.u.                                                                  
               (   1 O   1p+1:     0.65) (   1 O   2p+1:     0.51)                                                        
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.06144 a.u.                                                                  
               (   1 O   2s  :     0.15) (   1 O   3s  :     1.12) (   1 O   1p0 :     0.28)                              
               (   1 O   2p0 :     0.44) (   2 H   2s  :    -0.95) (   3 H   2s  :    -0.95)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.15273 a.u.                                                                  
               (   1 O   1p-1:     0.41) (   1 O   2p-1:     0.76) (   2 H   2s  :    -1.33)                              
               (   3 H   2s  :     1.33)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.81454 a.u.                                                                  
               (   1 O   1p-1:     0.17) (   1 O   2p-1:     0.63) (   2 H   1s  :    -0.98)                              
               (   2 H   2s  :     0.60) (   3 H   1s  :     0.98) (   3 H   2s  :    -0.60)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.88885 a.u.                                                                  
               (   1 O   1p+1:     0.96) (   1 O   2p+1:    -1.04)                                                        
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.89357 a.u.                                                                  
               (   1 O   3s  :     0.25) (   1 O   1p0 :    -0.89) (   1 O   2p0 :     0.69)                              
               (   2 H   1s  :     0.57) (   2 H   2s  :    -0.54) (   3 H   1s  :     0.57)                              
               (   3 H   2s  :    -0.54)                                                                                  
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hartree–Fock energy: </span><span class="si">{</span><span class="n">scf_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="si">:</span><span class="s1">14.10f</span><span class="si">}</span><span class="s1"> a.u.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dictionary keys:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">scf_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Orbital energies:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">scf_results</span><span class="p">[</span><span class="s1">&#39;E_alpha&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hartree–Fock energy: -76.3829919955 a.u.

Dictionary keys:
 dict_keys([&#39;eri_thresh&#39;, &#39;qq_type&#39;, &#39;scf_type&#39;, &#39;scf_energy&#39;, &#39;restart&#39;, &#39;S&#39;, &#39;C_alpha&#39;, &#39;C_beta&#39;, &#39;E_alpha&#39;, &#39;E_beta&#39;, &#39;D_alpha&#39;, &#39;D_beta&#39;, &#39;F_alpha&#39;, &#39;F_beta&#39;, &#39;C&#39;, &#39;E&#39;, &#39;D&#39;, &#39;F&#39;, &#39;xcfun&#39;])

Orbital energies:
 [-19.13088263  -1.02755218  -0.53552036  -0.35838601  -0.29367302
   0.06144299   0.15272611   0.81453913   0.88885085   0.89356993
   0.96591292   1.07211661   1.42710542]
</pre></div>
</div>
</div>
</div>
<p><strong>Quadratic response</strong>¶</p>
<p>Computing <span class="math notranslate nohighlight">\(\beta_{Z,Z,Z}^{SHG}(\omega=\ 0.1 {\rm {au}};\omega=\ 0.1 {\rm {au}})\)</span> for an isolated water molecule, 6-31G, B3LYP</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rsp_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;damping&quot;</span><span class="p">:</span> <span class="mf">0.004556</span><span class="p">,</span> <span class="c1"># 1000 cm-1</span>
    <span class="s2">&quot;a_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;b_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;c_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;b_frequencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="s2">&quot;c_frequencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">qrf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">QuadraticResponseDriver</span><span class="p">()</span>
<span class="n">qrf_drv</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">rsp_settings</span><span class="p">)</span>
<span class="n">qrf_results</span> <span class="o">=</span> <span class="n">qrf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                             Quadratic Response Driver Setup                                              
                                            =================================                                             
                                                                                                                          
                               ERI Screening Threshold         : 1.0e-12                                                  
                               Convergance Threshold           : 1.0e-04                                                  
                               Max. Number of Iterations       : 150                                                      
                               Damping Parameter               : 4.556000e-03                                             
                               Exchange-Correlation Functional : B3LYP                                                    
                               Molecular Grid Level            : 4                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                              Complex Response Solver Setup                                               
                                             ===============================                                              
                                                                                                                          
                               Number of Frequencies           : 1                                                        
                               Max. Number of Iterations       : 150                                                      
                               Convergence Threshold           : 1.0e-04                                                  
                               ERI Screening Scheme            : Cauchy Schwarz + Density                                 
                               ERI Screening Threshold         : 1.0e-12                                                  
                               Exchange-Correlation Functional : B3LYP                                                    
                               Molecular Grid Level            : 4                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Molecular grid with 40720 points generated in 0.03 sec.                                                          
                                                                                                                          
* Info * Processing Fock builds... (batch size: 6)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 3 gerade trial vectors in reduced space                                                                          
* Info * 3 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 11.48 kB of memory used for subspace procedure on the master node                                                
* Info * 4.92 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   1 * Residuals (Max,Min): 7.86e-01 and 6.57e-01                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 6)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 6 gerade trial vectors in reduced space                                                                          
* Info * 6 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 15.32 kB of memory used for subspace procedure on the master node                                                
* Info * 4.92 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   2 * Residuals (Max,Min): 3.10e-02 and 2.65e-02                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 6)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 9 gerade trial vectors in reduced space                                                                          
* Info * 9 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 19.16 kB of memory used for subspace procedure on the master node                                                
* Info * 4.92 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   3 * Residuals (Max,Min): 7.46e-04 and 6.76e-04                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 6)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 12 gerade trial vectors in reduced space                                                                         
* Info * 12 ungerade trial vectors in reduced space                                                                       
                                                                                                                          
* Info * 23.00 kB of memory used for subspace procedure on the master node                                                
* Info * 4.92 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   4 * Residuals (Max,Min): 2.52e-05 and 2.39e-05                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Complex response converged in 4 iterations. Time: 1.48 sec                                             
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Molecular grid with 40720 points generated in 0.03 sec.                                                          
                                                                                                                          
                                                 Fock Matrix Computation                                                  
                                                =========================                                                 
                                                                                                                          
* Info * Processing Fock builds... (batch size: 2)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Time spent in Fock matrices: 0.59 sec                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                   Quadratic response function: &lt;&lt; z;z,z &gt;&gt;  (0.1,0.1)                                    
                                  =====================================================                                   
                                                                                                                          
                                   Component                 Real             Imaginary                                   
                                   ----------------------------------------------------                                   
                                   X2                 30.68360561           1.09402191j                                   
                                   A2                  9.17087291           0.05050114j                                   
                                   E3                -10.85147759          -0.33819604j                                   
                                   beta               29.00300093           0.80632701j                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                              *** Time spent in quadratic response calculation: 2.14 sec ***                              
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rsp_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;damping&quot;</span><span class="p">:</span> <span class="mf">0.004556</span><span class="p">,</span> <span class="c1"># 1000 cm-1</span>
    <span class="s2">&quot;a_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;b_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;c_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;b_frequencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="s2">&quot;c_frequencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">qrf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">QuadraticResponseDriver</span><span class="p">()</span>
<span class="n">qrf_drv</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">rsp_settings</span><span class="p">)</span>
<span class="n">qrf_results</span> <span class="o">=</span> <span class="n">qrf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                             Quadratic Response Driver Setup                                              
                                            =================================                                             
                                                                                                                          
                               ERI Screening Threshold         : 1.0e-12                                                  
                               Convergance Threshold           : 1.0e-04                                                  
                               Max. Number of Iterations       : 150                                                      
                               Damping Parameter               : 4.556000e-03                                             
                               Exchange-Correlation Functional : B3LYP                                                    
                               Molecular Grid Level            : 4                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                              Complex Response Solver Setup                                               
                                             ===============================                                              
                                                                                                                          
                               Number of Frequencies           : 1                                                        
                               Max. Number of Iterations       : 150                                                      
                               Convergence Threshold           : 1.0e-04                                                  
                               ERI Screening Scheme            : Cauchy Schwarz + Density                                 
                               ERI Screening Threshold         : 1.0e-12                                                  
                               Exchange-Correlation Functional : B3LYP                                                    
                               Molecular Grid Level            : 4                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Molecular grid with 40720 points generated in 0.03 sec.                                                          
                                                                                                                          
* Info * Processing Fock builds... (batch size: 10)                                                                       
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 5 gerade trial vectors in reduced space                                                                          
* Info * 5 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 26.53 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   1 * Residuals (Max,Min): 7.06e-01 and 1.02e-01                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 10)                                                                       
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 10 gerade trial vectors in reduced space                                                                         
* Info * 10 ungerade trial vectors in reduced space                                                                       
                                                                                                                          
* Info * 32.93 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   2 * Residuals (Max,Min): 2.36e-02 and 3.60e-03                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 10)                                                                       
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 15 gerade trial vectors in reduced space                                                                         
* Info * 15 ungerade trial vectors in reduced space                                                                       
                                                                                                                          
* Info * 39.54 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   3 * Residuals (Max,Min): 3.22e-04 and 1.06e-05                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 4)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 17 gerade trial vectors in reduced space                                                                         
* Info * 17 ungerade trial vectors in reduced space                                                                       
                                                                                                                          
* Info * 41.89 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   4 * Residuals (Max,Min): 5.80e-05 and 1.19e-06                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Complex response converged in 4 iterations. Time: 1.93 sec                                             
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Molecular grid with 40720 points generated in 0.08 sec.                                                          
                                                                                                                          
                                                 Fock Matrix Computation                                                  
                                                =========================                                                 
                                                                                                                          
* Info * Processing Fock builds... (batch size: 6)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Time spent in Fock matrices: 0.71 sec                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                   Quadratic response function: &lt;&lt; z;z,z &gt;&gt;  (0.1,0.1)                                    
                                  =====================================================                                   
                                                                                                                          
                                   Component                 Real             Imaginary                                   
                                   ----------------------------------------------------                                   
                                   X2                 30.68364682           1.09402296j                                   
                                   A2                  9.17088929           0.05050132j                                   
                                   E3                -10.85148094          -0.33819609j                                   
                                   beta               29.00305516           0.80632819j                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                   Quadratic response function: &lt;&lt; z;z,z &gt;&gt;  (0.2,0.2)                                    
                                  =====================================================                                   
                                                                                                                          
                                   Component                 Real             Imaginary                                   
                                   ----------------------------------------------------                                   
                                   X2               -223.58682707          27.96836404j                                   
                                   A2                 11.22864892           0.15490220j                                   
                                   E3                 63.64238342          -8.05882335j                                   
                                   beta             -148.71579474          20.06444289j                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                   Quadratic response function: &lt;&lt; z;z,z &gt;&gt;  (0.3,0.3)                                    
                                  =====================================================                                   
                                                                                                                          
                                   Component                 Real             Imaginary                                   
                                   ----------------------------------------------------                                   
                                   X2                -45.50684513          -0.63091452j                                   
                                   A2                 17.99960346           0.55062331j                                   
                                   E3                  1.82582543          -0.95694746j                                   
                                   beta              -25.68141623          -1.03723868j                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                              *** Time spent in quadratic response calculation: 2.74 sec ***                              
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p><strong>Second electric dipole hyperpolarizability</strong></p>
<p>The second dipole hyperpolarizability is described by the cubic response
function</p>
<div class="amsmath math notranslate nohighlight" id="equation-354c15d0-4dcd-44cf-86b1-4c37e29cece8">
<span class="eqno">()<a class="headerlink" href="#equation-354c15d0-4dcd-44cf-86b1-4c37e29cece8" title="Permalink to this equation">#</a></span>\[\begin{equation}
\gamma_{\alpha\beta\gamma\delta}(-\omega_\sigma;\omega_1,\omega_2,\omega_3)  =
-\langle\langle \hat{\mu}_\alpha ;\hat{\mu}_\beta ,\hat{\mu}_\gamma
,\hat{\mu}_\delta \rangle\rangle_{\omega_1,\omega_2,\omega_3},
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega_\sigma = \omega_1 + \omega_2 + \omega_3\)</span>.</p>
<p>Similarly to the lower-order static polarizabilities, the
hyperpolarizability <span class="math notranslate nohighlight">\(\gamma\)</span>(0;0,0,0) corresponds to an energy
derivative and it can be computed using the finite-field
approach.
Among the possible frequency-dependent third-order processes, the
most relevant are:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Process</p></th>
<th class="head"><p></p></th>
<th class="head"><p>RF</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Electric Field Induced Second Harmonic Generation</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>(dc-SHG, ESHG, EFISH)</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\gamma^{\rm ESHG}_{\mu\nu\eta\xi}(-2\omega;\omega,\omega,0)\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>= <span class="math notranslate nohighlight">\(- \langle\langle \hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta},\hat{\mu}_{\xi} \rangle\rangle_{\omega,\omega,0}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Third Harmonic Generation (THG)</p></td>
<td><p><span class="math notranslate nohighlight">\(\gamma^{\rm THG}_{\mu\nu\eta\xi}(-3\omega;\omega,\omega,\omega)\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>= <span class="math notranslate nohighlight">\(- \langle\langle \hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta},\hat{\mu}_{\xi} \rangle\rangle_{\omega,\omega,\omega}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Electro-optical or dc-Kerr effect (EOKE, dc-Kerr)</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\gamma^{\rm dc-Kerr}_{\mu\nu\eta\xi}(-\omega;\omega,0,0)\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>= <span class="math notranslate nohighlight">\(- \langle\langle \hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta},\hat{\mu}_{\xi}\rangle\rangle_{\omega,0,0}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Optical or ac-Kerr effect (OKE, ac-Kerr)</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\gamma^{\rm ac-Kerr}_{\mu\nu\eta\xi}(-\omega_1;\omega_1,\omega_2,-\omega_2)\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>= <span class="math notranslate nohighlight">\(- \langle\langle \hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta},\hat{\mu}_{\xi}\rangle\rangle_{\omega_1,\omega_2,-\omega_2}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Intensity Dependent Refractive Index or</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Degenerate Four Wave Mixing (IDRI or DFWM)</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\gamma^{\rm IDRI}_{\mu\nu\eta\xi}(-\omega;\omega,\omega,-\omega)\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>= <span class="math notranslate nohighlight">\(- \langle\langle \hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta},\hat{\mu}_{\xi}\rangle\rangle_{\omega,\omega,-\omega}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>dc Optical Rectification (dc-OR, EFIOR)</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\gamma^{\rm dc-OR}_{\mu\nu\eta\xi}(0;\omega,-\omega,0)\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>= <span class="math notranslate nohighlight">\(- \langle\langle \hat{\mu}_{\mu};\hat{\mu}_{\nu},\hat{\mu}_{\eta},\hat{\mu}_{\xi} \rangle\rangle_{\omega,-\omega,0}\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>The experimentally measured quantities in isotropic fluids are
usually the scalar components of the tensor <span class="math notranslate nohighlight">\(\gamma\)</span> given by the
isotropic average:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d0cfa157-c3ac-4017-8af1-03b52788a2db">
<span class="eqno">()<a class="headerlink" href="#equation-d0cfa157-c3ac-4017-8af1-03b52788a2db" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\gamma_{\parallel} &amp; = &amp; \frac{1}{15}
(\gamma_{\xi\eta\eta\xi}
+\gamma_{\xi\eta\xi\eta}+\gamma_{\xi\xi\eta\eta}),
\\
\gamma_{\perp} &amp; = &amp; \frac{1}{15}
(2\gamma_{\xi\eta\eta\xi}
-\gamma_{\xi\xi\eta\eta}), 
\end{eqnarray}\]</div>
<p>where the same sequence of optical frequencies, not given
explicitly above, is used for the laboratory axes and the
molecular axes.</p>
<p>As for the first hyperpolarizability, the number of independent
non-zero tensor elements depends on the optical process and on the
symmetry of the molecule. For example, <span class="math notranslate nohighlight">\(\gamma^{\rm THG}\)</span> is symmetric
with respect to the second, third, and fourth indices,
and this can be used to simplify
the expression given for <span class="math notranslate nohighlight">\(\gamma_{\perp}\)</span>.
For instance, the average value that should be
compared with the experimental THG  parallel component  becomes</p>
<div class="amsmath math notranslate nohighlight" id="equation-453d2be2-dbf8-497b-a6de-c6f85f9b5f6d">
<span class="eqno">()<a class="headerlink" href="#equation-453d2be2-dbf8-497b-a6de-c6f85f9b5f6d" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\gamma^{\rm THG}_{\|} = 
\frac{1}{5} 
\gamma^{\rm THG}_{\xi\xi\eta\eta}.
\end{eqnarray}\]</div>
<p>Experimentally, if all fields have parallel polarization, one can
measure the parallel components of the first and second
hyperpolarizablities, which take into account the classical
orientational averaging. In the case of ESHG, with the optical
field polarized perpendicular to the static field, one measures
the perpendicular components, and in the case of a dc-Kerr
experiment, the differences between the parallel and perpendicular
components.</p>
<p>In the ESHG experiment a laser beam passes through the sample
in a static electric field
and a weak, collinear, frequency-doubled beam is detected.<br />
Absolute values for the hyperpolarizabilities cannot be extracted;
the signal from the sample is compared to that of a known buffer
gas (ultimately helium, for which there are accurate theoretical
values) or a solid.  In analogy with the derivation for
<span class="math notranslate nohighlight">\(\tilde{\alpha}\)</span>, the classical thermal averaging yields</p>
<div class="amsmath math notranslate nohighlight" id="equation-e65abe50-5163-4175-8d35-7938e236faa1">
<span class="eqno">()<a class="headerlink" href="#equation-e65abe50-5163-4175-8d35-7938e236faa1" title="Permalink to this equation">#</a></span>\[\begin{equation}
\tilde{\gamma}^{\rm ESHG} =
\left( \tilde{\beta}_{ZZZ}^{F}/{F} \right)_{{F}{\rightarrow}0} =
\langle \gamma_{ZZZZ} \rangle_\Omega + \mu_z \langle \beta_{ZZZ}
\rangle_\Omega /3kT.
\end{equation}\]</div>
<p>The molecular hyperpolarizabilities <span class="math notranslate nohighlight">\(\gamma^{\rm ESHG}\)</span> and
<span class="math notranslate nohighlight">\(\beta^{\rm SHG}\)</span> can be obtained in this experiment. For
non-centrosymmetric molecules a series of measurements over a
range of temperatures has to be performed, whereas for
centrosymmetric molecules <span class="math notranslate nohighlight">\(\beta = 0 \)</span> and thus a single
measurement at one temperature is sufficient.</p>
<p>The majority of existing experimental data on
hyperpolarizabilities are derived from ESHG and dc-Kerr
measurements. The dc-Kerr effect
differs from the other nonlinear optical processes as it allows
for absolute measurements without the need for a reference
measurement.  The measured molar Kerr constant is</p>
<div class="amsmath math notranslate nohighlight" id="equation-4d9a623c-f6fa-4109-8414-be4455713320">
<span class="eqno">()<a class="headerlink" href="#equation-4d9a623c-f6fa-4109-8414-be4455713320" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
A^{\rm dc-Kerr} &amp;=&amp;  \frac{N_A}{81\epsilon_0}
\left[
\frac{3}{2}
(\langle \gamma_{ZZZZ} \rangle_\Omega-\langle \gamma_{ZXXZ} \rangle_\Omega)
+\mu_z (\langle \beta_{ZZZ} \rangle_\Omega - \langle \beta_{XXZ} \rangle_\Omega ) /kT
\right.  
\\ 
&amp;+&amp; \left. \frac{3}{10kT}
\left(
\alpha_{\alpha\beta}\alpha_{\alpha\beta}^0 - \langle \alpha_{ZZ} \rangle_\Omega
\langle \alpha_{ZZ}^0 \rangle_\Omega +
\frac{1}{kT}
\mu_z^2 ( \alpha_{zz} - \langle \alpha_{ZZ} \rangle_\Omega )
\right) \right],
\end{eqnarray}\]</div>
<p>where <span class="math notranslate nohighlight">\(N_A\)</span> is Avogadro’s number,
and it involves both dynamic hyperpolarizabilities
(<span class="math notranslate nohighlight">\(\gamma^{\rm dc-Kerr}\)</span> and <span class="math notranslate nohighlight">\(\beta^{\rm EOPE}\)</span>) as well as static
(superscript 0) and dynamic polarizabilities.</p>
<p>The computational requirements for the second hyperpolarizability
are more or less the same as for the first hyperpolarizability.
Although the number of studies that analyze the importance
of electron correlation effects (not including here DFT) is rather
limited, the available results confirm in general the findings made for
the first hyperpolarizabilities.</p>
<p><strong>Cubic response</strong></p>
<p>Computing <span class="math notranslate nohighlight">\(\gamma_{Z,Z,Z;Z}^{IDRI}(\omega=\ 0.1 {\rm {au}},\omega=\ -0.1 {\rm {au}},\omega=\ 0.1 {\rm {au}})\)</span> for an isolated water molecule, 6-31G, B3LYP</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rsp_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;damping&quot;</span><span class="p">:</span> <span class="mf">0.004556</span><span class="p">,</span> <span class="c1"># 1000 cm-1</span>
    <span class="s2">&quot;a_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;b_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;c_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;d_components&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;b_frequencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="s2">&quot;c_frequencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="s2">&quot;d_frequencies&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">crf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">CubicResponseDriver</span><span class="p">()</span>
<span class="n">crf_drv</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">rsp_settings</span><span class="p">)</span>
<span class="n">crf_results</span> <span class="o">=</span> <span class="n">crf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                               Cubic Response Driver Setup                                                
                                              =============================                                               
                                                                                                                          
                               ERI Screening Threshold         : 1.0e-12                                                  
                               Convergance Threshold           : 1.0e-04                                                  
                               Max. Number of Iterations       : 150                                                      
                               Damping Parameter               : 4.556000e-03                                             
                               Exchange-Correlation Functional : B3LYP                                                    
                               Molecular Grid Level            : 4                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                              Complex Response Solver Setup                                               
                                             ===============================                                              
                                                                                                                          
                               Number of Frequencies           : 1                                                        
                               Max. Number of Iterations       : 150                                                      
                               Convergence Threshold           : 1.0e-04                                                  
                               ERI Screening Scheme            : Cauchy Schwarz + Density                                 
                               ERI Screening Threshold         : 1.0e-12                                                  
                               Exchange-Correlation Functional : B3LYP                                                    
                               Molecular Grid Level            : 4                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Molecular grid with 40720 points generated in 0.02 sec.                                                          
                                                                                                                          
* Info * Processing Fock builds... (batch size: 4)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 2 gerade trial vectors in reduced space                                                                          
* Info * 2 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 11.64 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   1 * Residuals (Max,Min): 9.09e-01 and 9.09e-01                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 4)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 4 gerade trial vectors in reduced space                                                                          
* Info * 4 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 14.20 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   2 * Residuals (Max,Min): 3.98e-02 and 3.98e-02                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 4)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 6 gerade trial vectors in reduced space                                                                          
* Info * 6 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 16.76 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   3 * Residuals (Max,Min): 4.69e-04 and 4.69e-04                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 4)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 8 gerade trial vectors in reduced space                                                                          
* Info * 8 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 19.32 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   4 * Residuals (Max,Min): 2.62e-05 and 2.62e-05                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Complex response converged in 4 iterations. Time: 1.45 sec                                             
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Molecular grid with 40720 points generated in 0.04 sec.                                                          
                                                                                                                          
                                                 Fock Matrix Computation                                                  
                                                =========================                                                 
                                                                                                                          
* Info * Processing Fock builds... (batch size: 2)                                                                        
* Info *   batch 1/4                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   batch 2/4                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   batch 3/4                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   batch 4/4                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Time spent in Fock matrices: 4.35 sec                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                              Complex Response Solver Setup                                               
                                             ===============================                                              
                                                                                                                          
                               Number of Frequencies           : 1                                                        
                               Max. Number of Iterations       : 150                                                      
                               Convergence Threshold           : 1.0e-04                                                  
                               ERI Screening Scheme            : Cauchy Schwarz + Density                                 
                               ERI Screening Threshold         : 1.0e-12                                                  
                               Exchange-Correlation Functional : B3LYP                                                    
                               Molecular Grid Level            : 4                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Molecular grid with 40720 points generated in 0.02 sec.                                                          
                                                                                                                          
* Info * Processing Fock builds... (batch size: 6)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 3 gerade trial vectors in reduced space                                                                          
* Info * 3 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 11.82 kB of memory used for subspace procedure on the master node                                                
* Info * 4.90 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   1 * Residuals (Max,Min): 7.65e-02 and 5.37e-02                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 6)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 6 gerade trial vectors in reduced space                                                                          
* Info * 6 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 15.66 kB of memory used for subspace procedure on the master node                                                
* Info * 4.92 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   2 * Residuals (Max,Min): 5.65e-03 and 3.67e-03                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 6)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 9 gerade trial vectors in reduced space                                                                          
* Info * 9 ungerade trial vectors in reduced space                                                                        
                                                                                                                          
* Info * 19.50 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   3 * Residuals (Max,Min): 2.82e-04 and 2.00e-04                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Processing Fock builds... (batch size: 5)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * 11 gerade trial vectors in reduced space                                                                         
* Info * 12 ungerade trial vectors in reduced space                                                                       
                                                                                                                          
* Info * 22.70 kB of memory used for subspace procedure on the master node                                                
* Info * 4.91 GB of memory available for the solver on the master node                                                    
                                                                                                                          
               *** Iteration:   4 * Residuals (Max,Min): 3.92e-06 and 3.27e-06                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               *** Complex response converged in 4 iterations. Time: 1.50 sec                                             
                                                                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                 Fock Matrix Computation                                                  
                                                =========================                                                 
                                                                                                                          
* Info * Processing Fock builds... (batch size: 2)                                                                        
* Info *   batch 1/1                                                                                                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Time spent in Fock matrices: 0.66 sec                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                  Cubic response function: &lt;&lt; z;z,z,z &gt;&gt;  (0.1,-0.1,0.1)                                  
                                 ========================================================                                 
                                                                                                                          
                                   Component                 Real             Imaginary                                   
                                   ----------------------------------------------------                                   
                                   E3                124.16389003           3.19617906j                                   
                                   T4                  8.88245728           0.11129738j                                   
                                   X2               -240.52723819          -8.51062281j                                   
                                   X3                 74.72560354           1.07388480j                                   
                                   A2               -240.83167370          -2.37159436j                                   
                                   A3                 24.91894293           0.09461438j                                   
                                   gamma            -248.66801810          -6.40624155j                                   
                                                                                                                          
                                *** Time spent in cubic response calculation: 8.02 sec ***                                
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crf_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([(&#39;E3&#39;, 0.1, -0.1, 0.1), (&#39;T4&#39;, 0.1, -0.1, 0.1), (&#39;X3&#39;, 0.1, -0.1, 0.1), (&#39;X2&#39;, 0.1, -0.1, 0.1), (&#39;A3&#39;, 0.1, -0.1, 0.1), (&#39;A2&#39;, 0.1, -0.1, 0.1), (&#39;gamma&#39;, 0.1, -0.1, 0.1)])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crf_results</span><span class="p">[(</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-248.66801810251846-6.406241549128367j)
</pre></div>
</div>
</div>
</div>
<p><strong>Cauchy Moments</strong></p>
<p>Response functions for a system in its electronic ground
state\index{ground state} are
analytic functions of the frequency arguments, except at the poles
that occur when a frequency or a sum of frequencies is equal to an
excitation energy. Thus, for frequencies below the first pole, the
linear, quadratic or cubic response functions can be expanded in
power series.</p>
<p>Let us consider in more detail the simplest case when only
electric dipole operators are involved and the frequency
dependence of the (hyper)polarizabilities is of interest.  The
Cauchy series - that is, the power series expansion of the
frequency-dependent
polarizability - is usually written
as</p>
<div class="amsmath math notranslate nohighlight" id="equation-da0f073f-3c95-45dc-ad8d-254198d887f5">
<span class="eqno">()<a class="headerlink" href="#equation-da0f073f-3c95-45dc-ad8d-254198d887f5" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \alpha(-\omega ; \omega) =  \sum_{k=0}^{\infty} \omega^{2k} S(-2k-2)
            = S(-2)   + \omega^2 S(-4) + \omega^4 S(-6) + \cdots,
\end{equation}\]</div>
<p>where  <span class="math notranslate nohighlight">\(S(-2) = \alpha(0;0)\)</span>.  This expansion is valid also for
purely imaginary frequency arguments.</p>
<p>Similar expansions may be applied to describe the dispersion
effects for
hyperpolarizabilities.
Often, the power series
expansion in the frequency arguments may be truncated at second
order leading to:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7dcade30-d025-4a57-acbe-fd1a5313ce18">
<span class="eqno">()<a class="headerlink" href="#equation-7dcade30-d025-4a57-acbe-fd1a5313ce18" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\alpha_{\rm iso}(-\omega_\sigma;\omega_1) &amp;=&amp;
\alpha_{\rm iso}(0;0)\Big[1+{\cal A}^{\alpha}
(\omega_\sigma^2+\omega_1^2)+{\cal{O}}(\omega_i^4)\Big], \\
\beta_{\parallel}(-\omega_\sigma;\omega_1,\omega_2) &amp;= &amp;
\beta_\parallel (0;0,0)\Big[1+{\cal A}^{\beta}  (\omega_\sigma^2+\omega_1^2+\omega_2^2)
+ {\cal{O}}(\omega_i^4)\Big], \\
\gamma_{\parallel}(-\omega_\sigma;\omega_1,\omega_2,\omega_3)
&amp;= &amp; \gamma_\parallel(0;0,0,0)
\Big[1+{\cal A}^{\gamma}  (\omega_\sigma^2+\omega_1^2+\omega_2^2+\omega_3^2) \\
&amp;+&amp;{\cal{O}}(\omega_i^4)\Big].
\end{eqnarray}\]</div>
<p>Each expansion contains only a single second-order dispersion
coefficient <span class="math notranslate nohighlight">\({\cal A}\)</span>.  Since these coefficients for different
optical processes of a given order are equivalent, they  express
the dispersion of frequency-dependent properties in a way that is
transferable between different optical processes, for instance
<span class="math notranslate nohighlight">\({\cal A}^{\beta}\)</span> describes  both the second-harmonic generation and
the (dc-)Electro-Optic Pockels effect.</p>
<p><strong>Two-photon absorption</strong></p>
<p>In experimental studies of two- and multi-photon absorption processes,
the multiphoton transition strength, a function of all the
frequencies of all photons absorbed, is analyzed. For two
laser sources of circular frequency <span class="math notranslate nohighlight">\(\omega_1\)</span> and <span class="math notranslate nohighlight">\(\omega_2\)</span> with
associated wave lengths <span class="math notranslate nohighlight">\(\lambda_1\)</span> and <span class="math notranslate nohighlight">\(\lambda_2\)</span>,
the
two-photon transition strength <span class="math notranslate nohighlight">\(\delta (\omega_1,\omega_2)\)</span>
for the transition between states <span class="math notranslate nohighlight">\(\mid 0 \rangle \)</span> and <span class="math notranslate nohighlight">\( \mid n \rangle \)</span>
in isotropic samples
is given by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d842f246-10e7-4ea7-8542-bfbada1c0f0d">
<span class="eqno">()<a class="headerlink" href="#equation-d842f246-10e7-4ea7-8542-bfbada1c0f0d" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\delta^{\rm TPA}_{0n}(\omega_1,\omega_2) &amp; = &amp; {\sf F} {\mathcal{S}}_{\alpha\alpha}^{0n}(\omega_1,\omega_2)
{\mathcal{S}}_{\beta\beta}^{on, *}(\omega_1,\omega_2) + {\sf G} {\mathcal{S}}_{\alpha\beta}^{0n}(\omega_1,\omega_2)
{\mathcal{S}}_{\alpha\beta}^{0n, *}(\omega_1,\omega_2)+ \\ &amp; &amp; + {\sf H} {\mathcal{S}}_{\alpha\beta}^{0n}(\omega_1,\omega_2)
{\mathcal{S}}_{\beta\alpha}^{0n, *}(\omega_1,\omega_2),
\end{eqnarray}\]</div>
<p>where <span class="math notranslate nohighlight">\({\sf F}\)</span>, <span class="math notranslate nohighlight">\({\sf G}\)</span> and <span class="math notranslate nohighlight">\({\sf H}\)</span> are numbers depending on the polarization
state of the two photons and on the geometrical set-up (mutual
direction of the laser beams)
and,
in the dipole approximation,</p>
<div class="amsmath math notranslate nohighlight" id="equation-3eae613f-7c88-44c1-9f54-621a311ccfa1">
<span class="eqno">()<a class="headerlink" href="#equation-3eae613f-7c88-44c1-9f54-621a311ccfa1" title="Permalink to this equation">#</a></span>\[\begin{equation}
{\mathcal{S}}_{\alpha\beta}^{0n}(\omega_1,\omega_2) = \frac{1}{\hbar} \sum_{m} \Big \{
\frac{(\hat{\mu}_{\alpha})_{0m} (\hat{\mu}_{\beta})_{mn} } {\omega_{m0} - \omega_1}
+ \frac{(\hat{\mu}_{\beta})_{0m} (\hat{\mu}_{\alpha})_{mn} } {\omega_{m0} - \omega_2} \Big \} 
\end{equation}\]</div>
<p>is the second-rank, two-photon tensor.
In the equation for <span class="math notranslate nohighlight">\(\delta^{\rm TPA}_{0n}(\omega_1,\omega_2)\)</span> the summation runs over the whole set of
excited states, the energy conservation
relation <span class="math notranslate nohighlight">\(\omega_1+\omega_2=\omega_{n0}\)</span> applies,
and off-resonance conditions  are implied - that is,
the frequencies <span class="math notranslate nohighlight">\(\omega_1\)</span> and <span class="math notranslate nohighlight">\(\omega_2\)</span> are sufficiently far off the
values at which the denominators vanish.
The tensor is non-symmetric in the exchange of the two
frequencies except for <span class="math notranslate nohighlight">\(\omega_1=\omega_2\)</span>.
For the special case of  a one-colour beam - that is, a monochromatic light source
the  transition matrix is symmetric and (using  <span class="math notranslate nohighlight">\(\omega=\omega_1=\omega_2\)</span>)</p>
<div class="amsmath math notranslate nohighlight" id="equation-eb06d00a-63a0-4281-bf7f-862cd0b833ad">
<span class="eqno">()<a class="headerlink" href="#equation-eb06d00a-63a0-4281-bf7f-862cd0b833ad" title="Permalink to this equation">#</a></span>\[\begin{equation}
\delta^{\rm TPA}_{0n}(\omega) =  {\mathcal{S}}_{\lambda\lambda}^{0n}(\omega)
{\mathcal{S}}_{\mu\mu}^{0n, *}(\omega) + 2 {\mathcal{S}}_{\lambda\mu}^{0n}(\omega)
{\mathcal{S}}_{\lambda\mu}^{0n, *}(\omega)
\end{equation}\]</div>
<p>for linear polarization of the incident light and</p>
<div class="amsmath math notranslate nohighlight" id="equation-c686311d-6e00-46a1-bd61-820b5217d396">
<span class="eqno">()<a class="headerlink" href="#equation-c686311d-6e00-46a1-bd61-820b5217d396" title="Permalink to this equation">#</a></span>\[\begin{equation}
\delta^{\rm TPA}_{0n}(\omega) =  - {\mathcal{S}}_{\lambda\lambda}^{0n}(\omega)
{\mathcal{S}}_{\mu\mu}^{0n, *}(\omega) + 3 {\mathcal{S}}_{\lambda\mu}^{0n}(\omega)
{\mathcal{S}}_{\lambda\mu}^{0n, *}(\omega)
\end{equation}\]</div>
<p>for circular polarization, respectively.</p>
<p>It can be shown that the two-photon absorption
transition rate
(cross section) can be obtained from the single residue of the
cubic response
function.</p>
<p>Two-photon absorption transition amplitudes
<span class="math notranslate nohighlight">\({\mathcal{S}}_{\alpha\beta}^{0n}(\omega_1,\omega_2)\)</span>,
can also be extracted
from the single residue of a quadratic response function.</p>
<p>The following relations hold
for the matrix elements of the two-photon transition tensor</p>
<div class="amsmath math notranslate nohighlight" id="equation-21ff0e05-29ec-4ba9-9ceb-f6d3007c6d84">
<span class="eqno">()<a class="headerlink" href="#equation-21ff0e05-29ec-4ba9-9ceb-f6d3007c6d84" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
 S_{\alpha\beta}^{0n}(\omega) &amp; = &amp; S_{\beta\alpha}^{0n}(\omega_{n0} - \omega), \\
 S_{\alpha\beta}^{0n}(\omega) &amp; = &amp; S_{\alpha\beta}^{n0}(- \omega)^\ast.
\end{eqnarray}\]</div>
<p>For methods which do not fulfill this last equation (such as the
coupled cluster approach), one can instead use
the two-photon transition strength</p>
<div class="amsmath math notranslate nohighlight" id="equation-7539b703-3dfa-426d-ac52-d851a2ed9047">
<span class="eqno">()<a class="headerlink" href="#equation-7539b703-3dfa-426d-ac52-d851a2ed9047" title="Permalink to this equation">#</a></span>\[\begin{equation}
{F}^{0n}_{\alpha\beta,\gamma\delta}(\omega) = \frac{1}{2} \{ S_{\alpha\beta}^{0n}(-\omega) S_{\gamma\delta}^{n0}(\omega)
              +S_{\gamma\delta}^{0n, *}(-\omega) S_{\alpha\beta}^{0n, *}(\omega)\},
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{\alpha\beta}^{0n}(\omega)\)</span> and <span class="math notranslate nohighlight">\(S_{\alpha\beta}^{n0}(\omega)\)</span> are the
left and right transition moments.</p>
<p>Three-photon
absorption has been described through the
single residue of the cubic response function.
Similarly to two-photon absorption, one can discuss the
third-order (left and right) transition moments and strengths
and define the three-photon transition
strengths in this manner for
nonvariational wave functions.</p>
<p>In general, the computational requirements for the calculation of
molecular properties from the residues of the response functions
inherit the requirements from the response functions themselves; that
is, the selection of the basis sets has to be done considering the
operators appearing in the expression for the transition moments and
excited-state properties. However, as the residues are connected to
specific excited states, the nature of the probed excited state
also needs to considered</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The eChem team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>