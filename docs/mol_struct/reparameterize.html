
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Reparameterize force fields &#8212; Computational Chemistry from  Laptop to HPC</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Ensembles and time integration" href="md_setup.html" />
    <link rel="prev" title="Force fields" href="forcefields.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Chemistry from  Laptop to HPC</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Getting started
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials and workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/openshells.html">
   Open shells
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/rest_unrest.html">
     Restricted versus unrestricted
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/correlation.html">
     Static versus dynamic correlation correlation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/vib_ir.html">
   Vibrational spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/vib_ir_calc.html">
     IR spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/vib_ir_raman.html">
     Raman spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/vib_ir_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/uv_vis.html">
   UV/vis spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_rec.html">
     Recommendations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/xray.html">
   X-ray spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_nonstandard.html">
     Non-standard calculations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_rec.html">
     Recommendations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_exercises.html">
     Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_cheatsheet.html">
     Cheat sheet
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Electronic ground states
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../elec_struct/elstruct_gen.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/orbitals.html">
     Orbitals and basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/slater.html">
     Many-electron wave functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/operators.html">
     Operators and matrix elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/reduced_density.html">
     Reduced particle densities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/integrals.html">
     Integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/spin.html">
     Electron spin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/correlation.html">
     Electron correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/dispersion.html">
     Dispersion interactions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/pt.html">
     Rayleigh–Schrödinger perturbation theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/second_quant.html">
     Second quantization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../elec_struct/wft.html">
   Wave function theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/hartree-fock.html">
     Hartree–Fock theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/ci.html">
     Configuration interaction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/mp2.html">
     Møller–Plesset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/mcscf.html">
     Multiconfigurational methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/wft_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../elec_struct/dft.html">
   Density functional theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/hohenberg.html">
     Hohenberg–Kohn theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/kohn-sham.html">
     Kohn–Sham method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/kernel_int.html">
     Kernel integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/dft_scf.html">
     SCF optimization of a closed-shell state
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Molecular structure and dynamics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="molstruct_gen.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="coordinates.html">
     Choice of coordinates
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="gradients.html">
   Gradients
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="energy_grad.html">
     Energy gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="property_grad.html">
     Property gradients
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="hessians_vib.html">
   Hessians and vibrations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hessians.html">
     Molecular Hessians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vibrations.html">
     Vibrational analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="opt.html">
   Structure optimization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="opt_struct.html">
     Optimization methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="opt_gs.html">
     Ground-state structure optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tst.html">
   Transition-state theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="tst_gen.html">
     Transition state geometry optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="impes.html">
   PES interpolation techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="impes_calc.html">
     Constructing the PES by interpolation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="md.html">
   Molecular dynamics
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="forcefields.html">
     Force fields
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Reparameterize force fields
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_setup.html">
     Ensembles and time integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_run.html">
     Running a simulation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Spectra and properties
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/spectra_aspects.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/vibrot.html">
     Rovibronic states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/response.html">
     Responses to external fields
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/tddft.html">
   TDDFT
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/tddft_basics.html">
     Foundations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/tddft_rpa.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/tddft_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/mr_response.html">
   Multireference response
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/ci_response.html">
     CI response
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/sa_mcscf.html">
     State-averaged MCSCF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/mclr.html">
     Multiconfigurational linear response
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/mr_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/adc.html">
   ADC
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_pp.html">
     Polarization propagator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_isr.html">
     Intermediate state representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_cvs.html">
     Core-valence separation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_hpc.html">
     HPC-QC implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/excoupl.html">
   Exciton coupling model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/excoupl_impl.html">
     Implementation of the exciton coupling model
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../env/localprop.html">
   Localized properties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/esp.html">
     ESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/resp.html">
     RESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/loprop.html">
     LoProp charges and polarisabilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../env/embedding.html">
   Embedding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/nonpol_emb.html">
     Non-polarizable embedding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/pol_emb.html">
     Polarizable embedding
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Visualization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../visualize/mol_struct.html">
   Molecular structure and dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/struct_vis.html">
     Molecular structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/md_vis.html">
     MD trajectories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/opt_vib_vis.html">
     Optimization and normal modes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../visualize/elec_struct.html">
   Electronic structure
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
  <label for="toctree-checkbox-23">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/orb_vis.html">
     Orbitals and densities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/exc_vis.html">
     Excited states
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bibliography
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../cite.html">
   How to cite
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../refs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/kthpanor/echem/master?urlpath=tree/docs/docs/mol_struct/reparameterize.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/kthpanor/echem"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/mol_struct/reparameterize.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/docs/mol_struct/reparameterize.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dihedral-angles">
   Dihedral angles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaff-force-field">
   GAFF force field
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-to-qm-potential">
   Fitting to QM potential
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#weighted-fitting">
   Weighted fitting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#excluding-tricky-angles">
   Excluding tricky angles
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Reparameterize force fields</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dihedral-angles">
   Dihedral angles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaff-force-field">
   GAFF force field
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-to-qm-potential">
   Fitting to QM potential
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#weighted-fitting">
   Weighted fitting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#excluding-tricky-angles">
   Excluding tricky angles
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="reparameterize-force-fields">
<h1>Reparameterize force fields<a class="headerlink" href="#reparameterize-force-fields" title="Permalink to this headline">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ForceFieldGenerator</span></code> class in <code class="docutils literal notranslate"><span class="pre">VeloxChem</span></code> provides a number of functions to interact with <code class="docutils literal notranslate"><span class="pre">OpenMM</span></code> and manipulate topology files. As an example, we consider the optimization of the force field for two dihedral angles of a thiophene-based optical ligand named HS-276.</p>
<section id="dihedral-angles">
<h2>Dihedral angles<a class="headerlink" href="#dihedral-angles" title="Permalink to this headline">#</a></h2>
<p>We here consider two dihedral angles, <span class="math notranslate nohighlight">\(\phi_1\)</span> and <span class="math notranslate nohighlight">\(\phi_2\)</span>:</p>
<figure class="align-default" id="fig-hs">
<a class="reference internal image-reference" href="../../_images/hs276.png"><img alt="../../_images/hs276.png" src="../../_images/hs276.png" style="width: 600px;" /></a>
</figure>
<p>The dihedral potential curves will be plotted using force field parameters from the general amber forcefield (GAFF) database, as compared to QM results. The force field will then be changed to better fit this potential.</p>
<p>Load the required modules and the equilibrium geometry, and initialize a (empty) force field object:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span> <span class="k">as</span> <span class="nn">p3d</span>

<span class="c1"># load B3LYP optimized geometry in the xyz format</span>
<span class="n">xyz_filename</span> <span class="o">=</span> <span class="s2">&quot;../../data/md/hs276.xyz&quot;</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="n">xyz_filename</span><span class="p">)</span>
<span class="n">ff_gen</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ForceFieldGenerator</span><span class="p">()</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">scan_dih_angles</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">scan_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">scan_geometries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">target_dihedrals</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p>The QM scans of the two dihedrals is read and put in the <code class="docutils literal notranslate"><span class="pre">ff_gen</span></code> object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ff_gen</span><span class="o">.</span><span class="n">read_qm_scan_xyz_files</span><span class="p">([</span><span class="s1">&#39;../../data/md/1_14_15_16.xyz&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;../../data/md/27_22_21_16.xyz&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The optimized structure and the two scans is visualized as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read xyz-files</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="n">opt_xyz</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;../../data/md/hs276.xyz&quot;</span><span class="p">)</span>
<span class="n">dihedral1_xyzs</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;../../data/md/1_14_15_16.xyz&#39;</span><span class="p">)</span>
<span class="n">dihedral2_xyzs</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;../../data/md/27_22_21_16.xyz&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Optimized structure:&#39;</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">opt_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Rotation around </span><span class="se">\u03C6\u2081</span><span class="s1"> and </span><span class="se">\u03C6\u2082</span><span class="s1">:&#39;</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">viewergrid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">linked</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="n">dihedral1_xyzs</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">animate</span><span class="p">({</span><span class="s2">&quot;loop&quot;</span><span class="p">:</span> <span class="s2">&quot;BackAndForth&quot;</span><span class="p">},</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="n">dihedral2_xyzs</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">animate</span><span class="p">({</span><span class="s2">&quot;loop&quot;</span><span class="p">:</span> <span class="s2">&quot;BackAndForth&quot;</span><span class="p">},</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimized structure:
</pre></div>
</div>
<div class="output text_html"><div id="3dmolviewer_1670577658843622"  style="position: relative; width: 400px; height: 250px">
        <p id="3dmolwarning_1670577658843622" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdn.jsdelivr.net/npm/3dmol@latest/build/3Dmol-min.min.js');
}

var viewer_1670577658843622 = null;
var warn = document.getElementById("3dmolwarning_1670577658843622");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1670577658843622 = $3Dmol.createViewer($("#3dmolviewer_1670577658843622"),{backgroundColor:"white"});
viewer_1670577658843622.zoomTo();
	viewer_1670577658843622.addModel("35\n generated by VMD\n  C       4.373000        0.283000       -0.025000\n  C       4.415000        1.595000       -0.512000\n  H       3.512000        2.197000       -0.625000\n  N       5.570000        2.158000       -0.868000\n  C       6.709000        1.437000       -0.751000\n  H       7.623000        1.952000       -1.052000\n  C       6.768000        0.125000       -0.292000\n  H       7.720000       -0.402000       -0.234000\n  C       5.560000       -0.488000        0.083000\n  C       5.181000       -1.787000        0.570000\n  H       5.834000       -2.627000        0.778000\n  C       3.821000       -1.767000        0.740000\n  H       3.152000       -2.538000        1.110000\n  N       3.307000       -0.521000        0.391000\n  C       1.957000       -0.159000        0.437000\n  S       0.730000       -1.238000       -0.213000\n  C       1.403000        1.005000        0.911000\n  H       1.989000        1.800000        1.365000\n  C      -0.012000        1.036000        0.774000\n  H      -0.623000        1.870000        1.113000\n  C      -0.550000       -0.103000        0.208000\n  C      -1.939000       -0.434000       -0.042000\n  C      -2.470000       -1.612000       -0.545000\n  H      -1.859000       -2.469000       -0.822000\n  C      -3.881000       -1.591000       -0.658000\n  H      -4.487000       -2.414000       -1.028000\n  S      -3.211000        0.726000        0.293000\n  C      -4.440000       -0.400000       -0.246000\n  C      -5.874000       -0.081000       -0.247000\n  O      -6.746000       -0.844000       -0.616000\n  O      -6.116000        1.171000        0.215000\n  C      -7.501000        1.564000        0.245000\n  H      -8.073000        0.894000        0.899000\n  H      -7.504000        2.584000        0.637000\n  H      -7.928000        1.534000       -0.765000\n","xyz");
	viewer_1670577658843622.setStyle({"stick": {}});
	viewer_1670577658843622.zoomTo();
viewer_1670577658843622.render();
});
</script></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rotation around φ₁ and φ₂:
</pre></div>
</div>
<div class="output text_html"><div id="3dmolviewer_1670577658845361"  style="position: relative; width: 600px; height: 250px">
        <p id="3dmolwarning_1670577658845361" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdn.jsdelivr.net/npm/3dmol@latest/build/3Dmol-min.min.js');
}

var viewer_1670577658845361 = null;
var warn = document.getElementById("3dmolwarning_1670577658845361");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_1670577658845361 = null;
viewergrid_1670577658845361 = $3Dmol.createViewerGrid($("#3dmolviewer_1670577658845361"),{rows: 1, cols: 2, control_all: false},{backgroundColor:"white"});
viewer_1670577658845361 = viewergrid_1670577658845361[0][0];
viewergrid_1670577658845361[0][0].zoomTo();viewergrid_1670577658845361[0][1].zoomTo();	viewergrid_1670577658845361[0][0].addModelsAsFrames("35\nScan Cycle 1/19 ; Dihedral 1-14-15-16 = 0.00 ; Iteration 20 Energy -1711.49967\nC  28.450  22.882  24.823\nC  27.597  21.790  24.601\nH  26.514  21.886  24.560\nN  28.080  20.558  24.427\nC  29.415  20.364  24.464\nH  29.746  19.334  24.315\nC  30.345  21.376  24.676\nH  31.413  21.160  24.696\nC  29.856  22.677  24.861\nC  30.469  23.954  25.099\nH  31.528  24.169  25.188\nC  29.458  24.868  25.195\nH  29.519  25.934  25.369\nN  28.216  24.250  25.030\nC  27.008  24.955  25.086\nS  25.450  24.171  24.887\nC  26.853  26.311  25.294\nH  27.676  27.002  25.442\nC  25.494  26.721  25.295\nH  25.190  27.756  25.444\nC  24.592  25.699  25.089\nC  23.148  25.739  25.025\nC  22.260  24.694  24.806\nH  22.579  23.666  24.647\nC  20.904  25.098  24.808\nH  20.058  24.432  24.655\nS  22.283  27.250  25.239\nC  20.738  26.449  25.028\nC  19.454  27.157  25.086\nO  18.369  26.625  24.943\nO  19.616  28.484  25.318\nC  18.400  29.253  25.389\nH  17.764  28.886  26.204\nH  18.719  30.281  25.578\nH  17.850  29.184  24.443\n35\nScan Cycle 2/19 ; Dihedral 1-14-15-16 = 10.00 ; Iteration 20 Energy -1711.499915\nC  28.455  22.895  24.764\nC  27.617  21.840  24.371\nH  26.547  21.965  24.217\nN  28.101  20.616  24.155\nC  29.423  20.394  24.315\nH  29.756  19.372  24.125\nC  30.339  21.371  24.688\nH  31.398  21.135  24.793\nC  29.849  22.665  24.919\nC  30.450  23.914  25.298\nH  31.497  24.104  25.506\nC  29.443  24.835  25.362\nH  29.491  25.882  25.634\nN  28.217  24.250  25.036\nC  27.009  24.956  25.068\nS  25.448  24.155  24.999\nC  26.857  26.324  25.164\nH  27.686  27.025  25.202\nC  25.498  26.732  25.189\nH  25.195  27.775  25.258\nC  24.594  25.695  25.104\nC  23.147  25.729  25.085\nC  22.256  24.669  24.993\nH  22.572  23.630  24.921\nC  20.900  25.072  25.002\nH  20.050  24.395  24.939\nS  22.286  27.254  25.187\nC  20.738  26.437  25.102\nC  19.454  27.148  25.137\nO  18.366  26.606  25.080\nO  19.620  28.491  25.240\nC  18.405  29.264  25.281\nH  17.797  28.973  26.146\nH  18.727  30.305  25.366\nH  17.825  29.110  24.363\n35\nScan Cycle 3/19 ; Dihedral 1-14-15-16 = 20.00 ; Iteration 20 Energy -1711.500603\nC  28.464  22.912  24.721\nC  27.649  21.905  24.183\nH  26.600  22.070  23.938\nN  28.131  20.687  23.934\nC  29.431  20.430  24.199\nH  29.765  19.414  23.976\nC  30.326  21.364  24.711\nH  31.368  21.100  24.889\nC  29.836  22.651  24.979\nC  30.417  23.867  25.479\nH  31.444  24.027  25.789\nC  29.417  24.800  25.513\nH  29.443  25.825  25.861\nN  28.219  24.254  25.047\nC  27.011  24.958  25.047\nS  25.454  24.150  25.114\nC  26.859  26.328  25.023\nH  27.691  27.024  24.953\nC  25.500  26.735  25.065\nH  25.194  27.779  25.046\nC  24.598  25.692  25.106\nC  23.151  25.725  25.126\nC  22.260  24.661  25.132\nH  22.577  23.619  25.120\nC  20.904  25.062  25.151\nH  20.055  24.383  25.157\nS  22.290  27.253  25.149\nC  20.742  26.432  25.163\nC  19.458  27.143  25.185\nO  18.370  26.597  25.196\nO  19.623  28.490  25.191\nC  18.408  29.262  25.213\nH  17.826  29.033  26.113\nH  18.730  30.307  25.215\nH  17.802  29.045  24.325\n35\nScan Cycle 4/19 ; Dihedral 1-14-15-16 = 30.00 ; Iteration 20 Energy -1711.501358\nC  28.473  22.922  24.706\nC  27.680  21.951  24.078\nH  26.644  22.139  23.796\nN  28.169  20.745  23.790\nC  29.454  20.467  24.104\nH  29.796  19.463  23.846\nC  30.327  21.368  24.706\nH  31.358  21.087  24.920\nC  29.830  22.644  25.017\nC  30.387  23.832  25.604\nH  31.397  23.973  25.973\nC  29.386  24.766  25.636\nH  29.390  25.774  26.035\nN  28.214  24.245  25.086\nC  27.007  24.949  25.044\nS  25.454  24.148  25.225\nC  26.855  26.311  24.915\nH  27.688  26.993  24.766\nC  25.495  26.722  24.962\nH  25.186  27.760  24.861\nC  24.597  25.685  25.109\nC  23.151  25.721  25.155\nC  22.259  24.660  25.225\nH  22.575  23.619  25.253\nC  20.904  25.064  25.252\nH  20.054  24.387  25.303\nS  22.291  27.250  25.126\nC  20.743  26.433  25.204\nC  19.460  27.146  25.216\nO  18.373  26.603  25.273\nO  19.626  28.491  25.157\nC  18.413  29.267  25.165\nH  17.847  29.080  26.086\nH  18.735  30.310  25.113\nH  17.790  29.009  24.300\n35\nScan Cycle 5/19 ; Dihedral 1-14-15-16 = 40.00 ; Iteration 20 Energy -1711.501909\nC  28.483  22.929  24.700\nC  27.714  21.990  24.000\nH  26.686  22.193  23.696\nN  28.216  20.800  23.668\nC  29.491  20.511  24.013\nH  29.844  19.521  23.717\nC  30.340  21.381  24.689\nH  31.363  21.090  24.925\nC  29.830  22.640  25.046\nC  30.358  23.800  25.710\nH  31.354  23.927  26.121\nC  29.351  24.729  25.750\nH  29.332  25.718  26.193\nN  28.203  24.228  25.137\nC  26.998  24.931  25.051\nS  25.450  24.150  25.339\nC  26.844  26.279  24.822\nH  27.678  26.942  24.604\nC  25.486  26.695  24.866\nH  25.173  27.722  24.686\nC  24.592  25.673  25.114\nC  23.146  25.716  25.182\nC  22.253  24.662  25.310\nH  22.567  23.622  25.373\nC  20.899  25.072  25.341\nH  20.048  24.400  25.433\nS  22.291  27.246  25.105\nC  20.742  26.438  25.240\nC  19.461  27.156  25.243\nO  18.374  26.620  25.338\nO  19.631  28.497  25.125\nC  18.419  29.276  25.120\nH  17.868  29.130  26.057\nH  18.745  30.315  25.020\nH  17.782  28.985  24.276\n35\nScan Cycle 6/19 ; Dihedral 1-14-15-16 = 50.00 ; Iteration 20 Energy -1711.502162\nC  28.495  22.935  24.689\nC  27.753  22.036  23.913\nH  26.732  22.252  23.595\nN  28.274  20.871  23.527\nC  29.541  20.569  23.895\nH  29.911  19.601  23.552\nC  30.361  21.402  24.649\nH  31.378  21.101  24.900\nC  29.831  22.635  25.063\nC  30.326  23.759  25.812\nH  31.307  23.869  26.262\nC  29.309  24.677  25.871\nH  29.265  25.642  26.364\nN  28.187  24.201  25.195\nC  26.985  24.905  25.072\nS  25.442  24.153  25.456\nC  26.829  26.232  24.750\nH  27.662  26.873  24.471\nC  25.473  26.655  24.790\nH  25.158  27.666  24.539\nC  24.583  25.657  25.132\nC  23.138  25.711  25.225\nC  22.243  24.671  25.433\nH  22.554  23.635  25.550\nC  20.892  25.089  25.464\nH  20.040  24.429  25.611\nS  22.288  27.238  25.073\nC  20.739  26.448  25.284\nC  19.461  27.172  25.267\nO  18.374  26.648  25.416\nO  19.634  28.502  25.066\nC  18.426  29.286  25.037\nH  17.892  29.200  25.991\nH  18.754  30.316  24.868\nH  17.772  28.948  24.225\n35\nScan Cycle 7/19 ; Dihedral 1-14-15-16 = 60.00 ; Iteration 20 Energy -1711.502123\nC  28.510  22.943  24.671\nC  27.803  22.093  23.812\nH  26.790  22.325  23.477\nN  28.347  20.961  23.368\nC  29.603  20.645  23.760\nH  29.996  19.705  23.366\nC  30.389  21.429  24.599\nH  31.398  21.117  24.867\nC  29.833  22.628  25.077\nC  30.286  23.703  25.919\nH  31.248  23.791  26.413\nC  29.257  24.606  26.000\nH  29.185  25.540  26.548\nN  28.168  24.166  25.252\nC  26.967  24.871  25.100\nS  25.431  24.158  25.576\nC  26.810  26.171  24.684\nH  27.641  26.785  24.345\nC  25.456  26.603  24.720\nH  25.138  27.593  24.400\nC  24.571  25.636  25.156\nC  23.128  25.708  25.277\nC  22.233  24.693  25.583\nH  22.542  23.666  25.771\nC  20.885  25.121  25.614\nH  20.034  24.480  25.830\nS  22.283  27.225  25.031\nC  20.736  26.464  25.336\nC  19.461  27.193  25.295\nO  18.375  26.689  25.507\nO  19.636  28.503  24.991\nC  18.432  29.292  24.930\nH  17.920  29.280  25.900\nH  18.761  30.303  24.677\nH  17.757  28.898  24.160\n35\nScan Cycle 8/19 ; Dihedral 1-14-15-16 = 70.00 ; Iteration 20 Energy -1711.50188\nC  28.531  22.954  24.653\nC  27.872  22.157  23.711\nH  26.873  22.405  23.346\nN  28.447  21.059  23.221\nC  29.686  20.727  23.651\nH  30.106  19.818  23.217\nC  30.423  21.459  24.578\nH  31.421  21.135  24.874\nC  29.835  22.622  25.105\nC  30.232  23.641  26.039\nH  31.168  23.706  26.584\nC  29.192  24.531  26.124\nH  29.084  25.430  26.722\nN  28.147  24.133  25.294\nC  26.947  24.836  25.115\nS  25.420  24.176  25.691\nC  26.780  26.090  24.582\nH  27.606  26.666  24.171\nC  25.428  26.528  24.608\nH  25.103  27.485  24.205\nC  24.554  25.611  25.158\nC  23.114  25.704  25.312\nC  22.221  24.718  25.704\nH  22.527  23.702  25.944\nC  20.877  25.161  25.744\nH  20.027  24.542  26.020\nS  22.276  27.210  24.995\nC  20.731  26.484  25.387\nC  19.462  27.222  25.332\nO  18.378  26.742  25.604\nO  19.639  28.508  24.941\nC  18.440  29.303  24.862\nH  17.954  29.358  25.843\nH  18.770  30.293  24.536\nH  17.742  28.868  24.137\n35\nScan Cycle 9/19 ; Dihedral 1-14-15-16 = 80.00 ; Iteration 20 Energy -1711.501617\nC  28.560  22.980  24.621\nC  27.964  22.263  23.577\nH  26.991  22.544  23.169\nN  28.572  21.205  23.041\nC  29.780  20.835  23.526\nH  30.230  19.962  23.050\nC  30.452  21.486  24.557\nH  31.426  21.134  24.894\nC  29.827  22.606  25.135\nC  30.154  23.542  26.177\nH  31.050  23.559  26.789\nC  29.109  24.427  26.261\nH  28.960  25.278  26.918\nN  28.130  24.106  25.324\nC  26.928  24.806  25.129\nS  25.417  24.209  25.807\nC  26.744  25.995  24.470\nH  27.559  26.525  23.980\nC  25.393  26.437  24.489\nH  25.056  27.350  24.001\nC  24.537  25.585  25.160\nC  23.104  25.706  25.359\nC  22.220  24.766  25.865\nH  22.527  23.771  26.180\nC  20.881  25.224  25.915\nH  20.037  24.639  26.274\nS  22.265  27.188  24.944\nC  20.732  26.514  25.451\nC  19.466  27.256  25.377\nO  18.390  26.812  25.729\nO  19.637  28.502  24.870\nC  18.441  29.298  24.765\nH  17.992  29.443  25.755\nH  18.766  30.253  24.343\nH  17.714  28.809  24.106\n35\nScan Cycle 10/19 ; Dihedral 1-14-15-16 = 90.00 ; Iteration 20 Energy -1711.501565\nC  28.592  23.021  24.575\nC  28.076  22.420  23.422\nH  27.142  22.757  22.969\nN  28.714  21.408  22.835\nC  29.876  20.972  23.376\nH  30.355  20.142  22.851\nC  30.466  21.504  24.518\nH  31.404  21.100  24.898\nC  29.806  22.571  25.154\nC  30.049  23.385  26.315\nH  30.889  23.324  26.998\nC  29.009  24.276  26.402\nH  28.814  25.058  27.128\nN  28.118  24.080  25.350\nC  26.917  24.782  25.153\nS  25.426  24.251  25.924\nC  26.709  25.894  24.377\nH  27.507  26.371  23.812\nC  25.358  26.338  24.393\nH  25.005  27.201  23.831\nC  24.526  25.563  25.179\nC  23.104  25.720  25.427\nC  22.241  24.855  26.083\nH  22.560  23.903  26.501\nC  20.908  25.327  26.138\nH  20.080  24.797  26.603\nS  22.251  27.148  24.874\nC  20.741  26.552  25.528\nC  19.474  27.291  25.423\nO  18.415  26.900  25.874\nO  19.625  28.464  24.762\nC  18.427  29.252  24.615\nH  18.024  29.519  25.599\nH  18.735  30.146  24.066\nH  17.670  28.692  24.053\n35\nScan Cycle 11/19 ; Dihedral 1-14-15-16 = 100.00 ; Iteration 20 Energy -1711.501752\nC  28.624  23.053  24.545\nC  28.191  22.552  23.313\nH  27.288  22.928  22.826\nN  28.870  21.590  22.689\nC  29.992  21.105  23.271\nH  30.508  20.321  22.713\nC  30.497  21.535  24.493\nH  31.406  21.096  24.904\nC  29.793  22.547  25.169\nC  29.947  23.253  26.413\nH  30.736  23.128  27.148\nC  28.903  24.138  26.502\nH  28.655  24.856  27.278\nN  28.095  24.045  25.372\nC  26.895  24.745  25.163\nS  25.427  24.291  26.022\nC  26.662  25.773  24.285\nH  27.442  26.192  23.653\nC  25.312  26.219  24.298\nH  24.944  27.027  23.669\nC  24.506  25.532  25.186\nC  23.097  25.730  25.475\nC  22.255  24.941  26.244\nH  22.583  24.029  26.738\nC  20.929  25.432  26.309\nH  20.116  24.959  26.854\nS  22.233  27.109  24.824\nC  20.746  26.596  25.591\nC  19.482  27.335  25.466\nO  18.439  27.003  25.995\nO  19.615  28.438  24.689\nC  18.419  29.222  24.515\nH  18.058  29.587  25.485\nH  18.710  30.056  23.871\nH  17.634  28.620  24.041\n35\nScan Cycle 12/19 ; Dihedral 1-14-15-16 = 110.00 ; Iteration 20 Energy -1711.502083\nC  28.648  23.070  24.512\nC  28.299  22.685  23.213\nH  27.425  23.099  22.706\nN  29.027  21.789  22.546\nC  30.115  21.257  23.151\nH  30.674  20.532  22.556\nC  30.536  21.571  24.439\nH  31.420  21.097  24.866\nC  29.778  22.510  25.160\nC  29.842  23.091  26.475\nH  30.583  22.897  27.244\nC  28.785  23.958  26.581\nH  28.483  24.598  27.403\nN  28.054  23.975  25.396\nC  26.864  24.684  25.181\nS  25.412  24.299  26.098\nC  26.622  25.661  24.247\nH  27.391  26.035  23.575\nC  25.279  26.127  24.269\nH  24.908  26.907  23.608\nC  24.487  25.510  25.219\nC  23.094  25.755  25.542\nC  22.283  25.075  26.439\nH  22.629  24.229  27.029\nC  20.964  25.584  26.502\nH  20.175  25.191  27.138\nS  22.207  27.051  24.764\nC  20.754  26.653  25.656\nC  19.490  27.385  25.497\nO  18.470  27.130  26.109\nO  19.593  28.384  24.587\nC  18.394  29.153  24.372\nH  18.080  29.637  25.304\nH  18.660  29.899  23.618\nH  17.586  28.506  24.009\n35\nScan Cycle 13/19 ; Dihedral 1-14-15-16 = 120.00 ; Iteration 20 Energy -1711.502404\nC  28.662  23.072  24.481\nC  28.399  22.805  23.134\nH  27.548  23.250  22.615\nN  29.183  21.987  22.431\nC  30.244  21.417  23.047\nH  30.853  20.760  22.422\nC  30.582  21.613  24.383\nH  31.448  21.113  24.817\nC  29.763  22.468  25.141\nC  29.738  22.917  26.508\nH  30.436  22.661  27.297\nC  28.659  23.755  26.632\nH  28.300  24.311  27.492\nN  27.997  23.875  25.413\nC  26.822  24.602  25.192\nS  25.381  24.282  26.150\nC  26.584  25.555  24.232\nH  27.347  25.894  23.536\nC  25.253  26.054  24.268\nH  24.890  26.828  23.594\nC  24.468  25.493  25.257\nC  23.093  25.789  25.608\nC  22.322  25.238  26.621\nH  22.693  24.475  27.303\nC  21.010  25.765  26.679\nH  20.251  25.466  27.399\nS  22.174  26.981  24.709\nC  20.765  26.718  25.714\nC  19.499  27.439  25.523\nO  18.507  27.276  26.208\nO  19.563  28.313  24.488\nC  18.359  29.062  24.233\nH  18.092  29.664  25.109\nH  18.594  29.703  23.379\nH  17.532  28.383  23.994\n35\nScan Cycle 14/19 ; Dihedral 1-14-15-16 = 130.00 ; Iteration 20 Energy -1711.502597\nC  28.677  23.064  24.462\nC  28.490  22.870  23.088\nH  27.649  23.313  22.553\nN  29.337  22.123  22.380\nC  30.387  21.552  23.013\nH  31.049  20.957  22.381\nC  30.650  21.676  24.374\nH  31.510  21.178  24.821\nC  29.765  22.455  25.139\nC  29.657  22.813  26.527\nH  30.324  22.529  27.334\nC  28.545  23.606  26.649\nH  28.128  24.096  27.523\nN  27.936  23.779  25.408\nC  26.768  24.512  25.172\nS  25.350  24.269  26.183\nC  26.525  25.425  24.175\nH  27.277  25.723  23.448\nC  25.207  25.955  24.225\nH  24.843  26.706  23.527\nC  24.438  25.461  25.260\nC  23.081  25.803  25.636\nC  22.341  25.344  26.717\nH  22.730  24.633  27.444\nC  21.039  25.894  26.782\nH  20.305  25.665  27.551\nS  22.143  26.933  24.679\nC  20.769  26.773  25.754\nC  19.507  27.497  25.555\nO  18.540  27.403  26.286\nO  19.543  28.287  24.453\nC  18.340  29.033  24.185\nH  18.114  29.704  25.022\nH  18.550  29.603  23.276\nH  17.496  28.350  24.030\n35\nScan Cycle 15/19 ; Dihedral 1-14-15-16 = 140.00 ; Iteration 20 Energy -1711.502545\nC  28.689  23.053  24.444\nC  28.572  22.916  23.056\nH  27.736  23.344  22.501\nN  29.483  22.242  22.353\nC  30.528  21.685  23.006\nH  31.244  21.150  22.378\nC  30.723  21.751  24.382\nH  31.581  21.266  24.847\nC  29.771  22.453  25.140\nC  29.584  22.731  26.539\nH  30.226  22.431  27.360\nC  28.435  23.469  26.648\nH  27.964  23.898  27.526\nN  27.872  23.680  25.391\nC  26.711  24.416  25.140\nS  25.321  24.257  26.205\nC  26.459  25.291  24.111\nH  27.194  25.547  23.352\nC  25.154  25.853  24.175\nH  24.786  26.579  23.453\nC  24.406  25.425  25.253\nC  23.068  25.811  25.653\nC  22.361  25.435  26.785\nH  22.765  24.766  27.543\nC  21.070  26.009  26.859\nH  20.360  25.841  27.666\nS  22.112  26.893  24.657\nC  20.776  26.825  25.788\nC  19.518  27.555  25.586\nO  18.575  27.523  26.355\nO  19.527  28.275  24.437\nC  18.326  29.022  24.164\nH  18.138  29.748  24.964\nH  18.512  29.532  23.214\nH  17.467  28.345  24.080\n35\nScan Cycle 16/19 ; Dihedral 1-14-15-16 = 150.00 ; Iteration 20 Energy -1711.502171\nC  28.698  23.040  24.426\nC  28.652  22.962  23.029\nH  27.822  23.372  22.452\nN  29.624  22.363  22.340\nC  30.662  21.821  23.015\nH  31.429  21.349  22.397\nC  30.788  21.825  24.400\nH  31.643  21.354  24.884\nC  29.772  22.449  25.143\nC  29.510  22.644  26.543\nH  30.126  22.326  27.377\nC  28.326  23.326  26.635\nH  27.801  23.689  27.512\nN  27.809  23.578  25.365\nC  26.653  24.318  25.103\nS  25.297  24.243  26.218\nC  26.389  25.157  24.046\nH  27.106  25.372  23.258\nC  25.100  25.752  24.126\nH  24.727  26.456  23.385\nC  24.376  25.390  25.243\nC  23.059  25.819  25.665\nC  22.389  25.525  26.844\nH  22.813  24.901  27.628\nC  21.109  26.123  26.928\nH  20.429  26.018  27.769\nS  22.081  26.850  24.637\nC  20.787  26.875  25.818\nC  19.532  27.611  25.617\nO  18.618  27.642  26.420\nO  19.508  28.258  24.425\nC  18.308  29.005  24.149\nH  18.160  29.782  24.909\nH  18.466  29.451  23.164\nH  17.438  28.338  24.139\n35\nScan Cycle 17/19 ; Dihedral 1-14-15-16 = 160.00 ; Iteration 20 Energy -1711.501458\nC  28.710  23.035  24.413\nC  28.727  22.996  23.013\nH  27.904  23.377  22.409\nN  29.754  22.463  22.350\nC  30.788  21.948  23.050\nH  31.601  21.532  22.453\nC  30.854  21.912  24.440\nH  31.707  21.461  24.947\nC  29.779  22.465  25.154\nC  29.452  22.596  26.548\nH  30.046  22.272  27.396\nC  28.237  23.222  26.613\nH  27.664  23.528  27.482\nN  27.758  23.496  25.332\nC  26.599  24.228  25.058\nS  25.292  24.257  26.234\nC  26.302  25.003  23.960\nH  26.984  25.163  23.132\nC  25.025  25.622  24.054\nH  24.630  26.279  23.282\nC  24.342  25.345  25.219\nC  23.047  25.814  25.663\nC  22.406  25.576  26.871\nH  22.841  24.971  27.665\nC  21.140  26.199  26.969\nH  20.482  26.136  27.833\nS  22.056  26.826  24.627\nC  20.797  26.916  25.842\nC  19.550  27.666  25.650\nO  18.661  27.742  26.477\nO  19.502  28.269  24.436\nC  18.308  29.027  24.167\nH  18.195  29.834  24.901\nH  18.443  29.433  23.161\nH  17.426  28.376  24.207\n35\nScan Cycle 18/19 ; Dihedral 1-14-15-16 = 170.00 ; Iteration 20 Energy -1711.500542\nC  28.730  23.046  24.401\nC  28.822  23.068  23.002\nH  28.025  23.451  22.367\nN  29.896  22.592  22.371\nC  30.907  22.071  23.100\nH  31.761  21.703  22.527\nC  30.902  21.975  24.488\nH  31.739  21.525  25.020\nC  29.778  22.469  25.167\nC  29.384  22.528  26.548\nH  29.945  22.179  27.408\nC  28.152  23.119  26.583\nH  27.533  23.363  27.439\nN  27.723  23.443  25.294\nC  26.557  24.161  25.012\nS  25.316  24.312  26.251\nC  26.204  24.843  23.870\nH  26.832  24.926  22.991\nC  24.937  25.481  23.978\nH  24.502  26.066  23.170\nC  24.313  25.309  25.194\nC  23.040  25.816  25.659\nC  22.436  25.636  26.896\nH  22.886  25.053  27.698\nC  21.182  26.281  27.010\nH  20.551  26.261  27.895\nS  22.033  26.803  24.617\nC  20.814  26.958  25.867\nC  19.571  27.718  25.684\nO  18.710  27.841  26.534\nO  19.492  28.273  24.448\nC  18.299  29.037  24.187\nH  18.222  29.875  24.890\nH  18.408  29.401  23.162\nH  17.411  28.401  24.282\n35\nScan Cycle 19/19 ; Dihedral 1-14-15-16 = 180.00 ; Iteration 20 Energy -1711.50001\nC  28.769  23.100  24.398\nC  29.001  23.328  23.034\nH  28.307  23.873  22.398\nN  30.105  22.881  22.433\nC  31.015  22.196  23.155\nH  31.896  21.857  22.606\nC  30.884  21.915  24.511\nH  31.652  21.357  25.045\nC  29.729  22.378  25.159\nC  29.238  22.296  26.507\nH  29.716  21.815  27.353\nC  28.037  22.946  26.529\nH  27.361  23.100  27.362\nN  27.720  23.448  25.266\nC  26.551  24.160  24.982\nS  25.393  24.457  26.275\nC  26.114  24.707  23.796\nH  26.654  24.655  22.859\nC  24.857  25.362  23.917\nH  24.365  25.849  23.077\nC  24.315  25.329  25.182\nC  23.071  25.882  25.671\nC  22.549  25.836  26.957\nH  23.055  25.348  27.787\nC  21.298  26.486  27.080\nH  20.725  26.561  28.001\nS  21.989  26.747  24.595\nC  20.851  27.033  25.896\nC  19.592  27.766  25.712\nO  18.785  27.978  26.598\nO  19.429  28.184  24.432\nC  18.216  28.912  24.167\nH  18.175  29.821  24.780\nH  18.256  29.164  23.104\nH  17.341  28.289  24.386\n");
	viewergrid_1670577658845361[0][0].animate({"loop": "BackAndForth"});
	viewergrid_1670577658845361[0][1].addModelsAsFrames("35\nScan Cycle 1/19 ; Dihedral 27-22-21-16 = 0.00 ; Iteration 20 Energy -1711.501152\nC  28.968  24.452  24.123\nC  29.594  24.564  25.370\nH  29.032  24.525  26.304\nN  30.914  24.733  25.462\nC  31.643  24.797  24.325\nH  32.718  24.931  24.463\nC  31.112  24.711  23.042\nH  31.758  24.782  22.167\nC  29.723  24.538  22.924\nC  28.796  24.429  21.829\nH  29.025  24.447  20.769\nC  27.548  24.283  22.377\nH  26.585  24.149  21.895\nN  27.626  24.289  23.768\nC  26.540  24.167  24.640\nS  25.076  25.100  24.366\nC  26.443  23.405  25.780\nH  27.237  22.745  26.121\nC  25.190  23.548  26.433\nH  24.930  23.007  27.340\nC  24.316  24.409  25.797\nC  22.954  24.737  26.175\nC  22.249  24.267  27.276\nH  22.669  23.569  27.997\nC  20.937  24.783  27.364\nH  20.224  24.539  28.149\nS  21.969  25.841  25.238\nC  20.621  25.651  26.339\nC  19.338  26.342  26.162\nO  18.388  26.227  26.913\nO  19.332  27.128  25.057\nC  18.107  27.844  24.811\nH  17.883  28.514  25.650\nH  18.284  28.415  23.896\nH  17.276  27.142  24.677\n35\nScan Cycle 2/19 ; Dihedral 27-22-21-16 = 10.00 ; Iteration 20 Energy -1711.501321\nC  28.974  24.433  24.125\nC  29.603  24.442  25.376\nH  29.038  24.360  26.306\nN  30.927  24.559  25.478\nC  31.659  24.672  24.346\nH  32.738  24.760  24.492\nC  31.127  24.688  23.061\nH  31.775  24.794  22.192\nC  29.732  24.570  22.933\nC  28.803  24.565  21.835\nH  29.034  24.644  20.779\nC  27.550  24.426  22.374\nH  26.585  24.357  21.885\nN  27.627  24.339  23.762\nC  26.537  24.197  24.626\nS  25.107  25.197  24.417\nC  26.414  23.365  25.713\nH  27.183  22.656  26.008\nC  25.163  23.505  26.373\nH  24.878  22.907  27.236\nC  24.321  24.436  25.796\nC  22.969  24.783  26.194\nC  22.313  24.407  27.359\nH  22.774  23.793  28.129\nC  20.996  24.914  27.448\nH  20.317  24.737  28.280\nS  21.934  25.783  25.197\nC  20.632  25.683  26.362\nC  19.335  26.346  26.175\nO  18.415  26.288  26.968\nO  19.281  27.034  25.008\nC  18.039  27.716  24.747\nH  17.836  28.453  25.534\nH  18.176  28.208  23.781\nH  17.212  26.997  24.703\n35\nScan Cycle 3/19 ; Dihedral 27-22-21-16 = 20.00 ; Iteration 20 Energy -1711.501442\nC  28.981  24.411  24.128\nC  29.605  24.318  25.377\nH  29.035  24.196  26.299\nN  30.932  24.382  25.487\nC  31.672  24.542  24.366\nH  32.752  24.584  24.517\nC  31.144  24.659  23.084\nH  31.798  24.799  22.223\nC  29.746  24.599  22.948\nC  28.821  24.696  21.851\nH  29.057  24.835  20.802\nC  27.562  24.567  22.379\nH  26.596  24.563  21.886\nN  27.632  24.388  23.758\nC  26.535  24.229  24.611\nS  25.142  25.291  24.468\nC  26.380  23.333  25.642\nH  27.123  22.578  25.889\nC  25.132  23.471  26.307\nH  24.816  22.822  27.121\nC  24.325  24.466  25.791\nC  22.986  24.835  26.209\nC  22.379  24.557  27.426\nH  22.884  24.031  28.233\nC  21.057  25.052  27.519\nH  20.413  24.945  28.389\nS  21.899  25.726  25.164\nC  20.644  25.718  26.384\nC  19.332  26.349  26.189\nO  18.442  26.350  27.018\nO  19.225  26.934  24.970\nC  17.966  27.577  24.699\nH  17.782  28.377  25.426\nH  18.061  27.986  23.689\nH  17.147  26.848  24.748\n35\nScan Cycle 4/19 ; Dihedral 27-22-21-16 = 30.00 ; Iteration 20 Energy -1711.501448\nC  28.988  24.389  24.131\nC  29.601  24.204  25.375\nH  29.021  24.048  26.286\nN  30.929  24.221  25.495\nC  31.680  24.422  24.388\nH  32.760  24.420  24.547\nC  31.165  24.629  23.113\nH  31.828  24.796  22.265\nC  29.767  24.620  22.967\nC  28.852  24.808  21.873\nH  29.099  24.999  20.835\nC  27.587  24.689  22.387\nH  26.624  24.744  21.891\nN  27.642  24.430  23.754\nC  26.535  24.258  24.592\nS  25.179  25.373  24.506\nC  26.344  23.308  25.566\nH  27.060  22.515  25.771\nC  25.095  23.447  26.233\nH  24.748  22.760  27.002\nC  24.326  24.495  25.771\nC  23.001  24.893  26.213\nC  22.445  24.707  27.470\nH  22.994  24.262  28.297\nC  21.119  25.190  27.571\nH  20.510  25.150  28.472\nS  21.862  25.674  25.137\nC  20.654  25.754  26.401\nC  19.326  26.352  26.207\nO  18.468  26.409  27.066\nO  19.167  26.836  24.950\nC  17.888  27.440  24.676\nH  17.719  28.294  25.343\nH  17.940  27.767  23.634\nH  17.083  26.708  24.814\n35\nScan Cycle 5/19 ; Dihedral 27-22-21-16 = 40.00 ; Iteration 20 Energy -1711.501167\nC  28.997  24.367  24.134\nC  29.591  24.098  25.372\nH  28.998  23.911  26.268\nN  30.917  24.067  25.504\nC  31.686  24.303  24.416\nH  32.764  24.260  24.584\nC  31.190  24.592  23.149\nH  31.867  24.783  22.317\nC  29.794  24.634  22.990\nC  28.897  24.907  21.901\nH  29.160  25.145  20.876\nC  27.623  24.800  22.397\nH  26.667  24.911  21.896\nN  27.657  24.468  23.749\nC  26.537  24.288  24.568\nS  25.219  25.450  24.533\nC  26.305  23.291  25.485\nH  26.993  22.465  25.649\nC  25.055  23.434  26.149\nH  24.676  22.720  26.877\nC  24.324  24.529  25.737\nC  23.016  24.957  26.204\nC  22.513  24.862  27.491\nH  23.103  24.491  28.327\nC  21.182  25.331  27.607\nH  20.609  25.355  28.531\nS  21.820  25.628  25.113\nC  20.662  25.791  26.415\nC  19.318  26.355  26.228\nO  18.492  26.467  27.114\nO  19.101  26.737  24.946\nC  17.803  27.300  24.677\nH  17.645  28.201  25.282\nH  17.809  27.545  23.611\nH  17.017  26.570  24.904\n35\nScan Cycle 6/19 ; Dihedral 27-22-21-16 = 50.00 ; Iteration 20 Energy -1711.50055\nC  29.007  24.342  24.137\nC  29.576  23.990  25.367\nH  28.965  23.775  26.245\nN  30.899  23.911  25.514\nC  31.689  24.179  24.449\nH  32.762  24.093  24.627\nC  31.220  24.549  23.192\nH  31.914  24.762  22.380\nC  29.828  24.643  23.019\nC  28.954  25.001  21.935\nH  29.239  25.283  20.927\nC  27.671  24.908  22.409\nH  26.726  25.075  21.903\nN  27.676  24.505  23.742\nC  26.540  24.320  24.538\nS  25.263  25.526  24.554\nC  26.264  23.282  25.395\nH  26.921  22.425  25.520\nC  25.010  23.432  26.053\nH  24.599  22.696  26.741\nC  24.321  24.570  25.693\nC  23.030  25.028  26.182\nC  22.581  25.025  27.492\nH  23.213  24.728  28.327\nC  21.246  25.480  27.628\nH  20.711  25.569  28.570\nS  21.776  25.585  25.093\nC  20.670  25.834  26.426\nC  19.307  26.359  26.253\nO  18.518  26.527  27.163\nO  19.029  26.632  24.955\nC  17.709  27.149  24.699\nH  17.559  28.093  25.237\nH  17.665  27.308  23.618\nH  16.948  26.426  25.017\n35\nScan Cycle 7/19 ; Dihedral 27-22-21-16 = 60.00 ; Iteration 20 Energy -1711.499657\nC  29.017  24.318  24.142\nC  29.555  23.884  25.360\nH  28.922  23.643  26.215\nN  30.871  23.753  25.521\nC  31.687  24.050  24.483\nH  32.754  23.920  24.673\nC  31.251  24.500  23.241\nH  31.964  24.732  22.451\nC  29.866  24.649  23.053\nC  29.021  25.091  21.976\nH  29.331  25.415  20.988\nC  27.729  25.016  22.426\nH  26.798  25.240  21.917\nN  27.699  24.545  23.736\nC  26.545  24.355  24.505\nS  25.312  25.604  24.577\nC  26.219  23.279  25.295\nH  26.843  22.393  25.378\nC  24.962  23.437  25.947\nH  24.517  22.681  26.591\nC  24.320  24.617  25.645\nC  23.041  25.101  26.155\nC  22.649  25.197  27.478\nH  23.321  24.976  28.304\nC  21.311  25.639  27.634\nH  20.815  25.796  28.590\nS  21.730  25.540  25.079\nC  20.677  25.879  26.434\nC  19.295  26.362  26.280\nO  18.543  26.593  27.206\nO  18.955  26.518  24.977\nC  17.614  26.987  24.738\nH  17.466  27.971  25.201\nH  17.520  27.052  23.651\nH  16.884  26.280  25.150\n35\nScan Cycle 8/19 ; Dihedral 27-22-21-16 = 70.00 ; Iteration 20 Energy -1711.498665\nC  29.026  24.290  24.146\nC  29.526  23.766  25.344\nH  28.870  23.497  26.174\nN  30.834  23.581  25.519\nC  31.678  23.910  24.514\nH  32.737  23.732  24.712\nC  31.280  24.447  23.294\nH  32.015  24.700  22.531\nC  29.904  24.655  23.093\nC  29.095  25.188  22.031\nH  29.433  25.559  21.069\nC  27.792  25.132  22.455\nH  26.879  25.418  21.945\nN  27.724  24.586  23.734\nC  26.550  24.392  24.473\nS  25.365  25.681  24.610\nC  26.171  23.282  25.186\nH  26.760  22.369  25.221\nC  24.912  23.448  25.834\nH  24.431  22.673  26.427\nC  24.321  24.668  25.602\nC  23.053  25.173  26.127\nC  22.716  25.387  27.451\nH  23.427  25.250  28.263\nC  21.376  25.817  27.627\nH  20.918  26.052  28.585\nS  21.687  25.487  25.076\nC  20.685  25.930  26.439\nC  19.286  26.367  26.304\nO  18.571  26.670  27.239\nO  18.884  26.389  25.010\nC  17.522  26.805  24.791\nH  17.370  27.825  25.164\nH  17.378  26.763  23.708\nH  16.830  26.125  25.302\n35\nScan Cycle 9/19 ; Dihedral 27-22-21-16 = 80.00 ; Iteration 20 Energy -1711.497867\nC  29.031  24.259  24.151\nC  29.490  23.637  25.317\nH  28.810  23.337  26.116\nN  30.788  23.391  25.498\nC  31.660  23.755  24.530\nH  32.708  23.525  24.732\nC  31.303  24.389  23.345\nH  32.061  24.666  22.612\nC  29.940  24.662  23.138\nC  29.169  25.297  22.103\nH  29.537  25.719  21.174\nC  27.858  25.260  22.503\nH  26.964  25.615  22.001\nN  27.748  24.632  23.740\nC  26.554  24.433  24.447\nS  25.421  25.757  24.667\nC  26.120  23.290  25.072\nH  26.672  22.353  25.046\nC  24.861  23.462  25.718\nH  24.342  22.667  26.251\nC  24.328  24.721  25.578\nC  23.065  25.240  26.111\nC  22.780  25.595  27.415\nH  23.525  25.556  28.207\nC  21.438  26.017  27.602\nH  21.013  26.343  28.549\nS  21.651  25.418  25.092\nC  20.696  25.985  26.440\nC  19.280  26.372  26.322\nO  18.599  26.763  27.249\nO  18.823  26.242  25.053\nC  17.443  26.600  24.851\nH  17.280  27.652  25.116\nH  17.254  26.434  23.787\nH  16.791  25.968  25.465\n35\nScan Cycle 10/19 ; Dihedral 27-22-21-16 = 90.00 ; Iteration 20 Energy -1711.49758\nC  29.031  24.226  24.154\nC  29.446  23.495  25.273\nH  28.742  23.161  26.037\nN  30.730  23.184  25.452\nC  31.632  23.589  24.528\nH  32.667  23.302  24.725\nC  31.320  24.328  23.392\nH  32.099  24.630  22.693\nC  29.971  24.670  23.189\nC  29.243  25.414  22.197\nH  29.642  25.894  21.310\nC  27.925  25.399  22.576\nH  27.054  25.827  22.091\nN  27.770  24.680  23.757\nC  26.559  24.477  24.431\nS  25.482  25.827  24.751\nC  26.068  23.307  24.956\nH  26.579  22.353  24.860\nC  24.811  23.482  25.607\nH  24.253  22.670  26.069\nC  24.340  24.772  25.577\nC  23.079  25.302  26.110\nC  22.837  25.818  27.368\nH  23.611  25.889  28.129\nC  21.493  26.236  27.554\nH  21.096  26.665  28.471\nS  21.629  25.335  25.130\nC  20.710  26.043  26.436\nC  19.280  26.379  26.330\nO  18.624  26.870  27.228\nO  18.777  26.077  25.109\nC  17.380  26.376  24.921\nH  17.199  27.449  25.054\nH  17.154  26.069  23.897\nH  16.771  25.815  25.640\n35\nScan Cycle 11/19 ; Dihedral 27-22-21-16 = 100.00 ; Iteration 20 Energy -1711.497942\nC  29.030  24.194  24.159\nC  29.397  23.361  25.223\nH  28.667  22.998  25.948\nN  30.664  22.984  25.393\nC  31.597  23.422  24.516\nH  32.615  23.077  24.702\nC  31.333  24.260  23.437\nH  32.136  24.583  22.775\nC  30.003  24.673  23.244\nC  29.322  25.523  22.305\nH  29.755  26.053  21.463\nC  27.999  25.533  22.664\nH  27.154  26.034  22.203\nN  27.795  24.731  23.783\nC  26.566  24.527  24.423\nS  25.542  25.893  24.840\nC  26.018  23.341  24.845\nH  26.491  22.376  24.678\nC  24.762  23.517  25.497\nH  24.165  22.695  25.887\nC  24.351  24.826  25.577\nC  23.095  25.365  26.106\nC  22.884  26.036  27.295\nH  23.681  26.216  28.014\nC  21.538  26.445  27.478\nH  21.160  26.975  28.350\nS  21.613  25.256  25.179\nC  20.721  26.097  26.423\nC  19.278  26.382  26.332\nO  18.643  26.969  27.185\nO  18.740  25.912  25.181\nC  17.330  26.151  25.012\nH  17.124  27.228  25.015\nH  17.076  25.710  24.045\nH  16.763  25.672  25.820\n35\nScan Cycle 12/19 ; Dihedral 27-22-21-16 = 110.00 ; Iteration 20 Energy -1711.498816\nC  29.030  24.165  24.165\nC  29.341  23.240  25.168\nH  28.584  22.854  25.852\nN  30.589  22.797  25.330\nC  31.555  23.259  24.504\nH  32.555  22.858  24.681\nC  31.348  24.187  23.488\nH  32.176  24.525  22.865\nC  30.040  24.670  23.306\nC  29.413  25.616  22.423\nH  29.884  26.188  21.631\nC  28.085  25.655  22.759\nH  27.271  26.225  22.324\nN  27.826  24.780  23.811\nC  26.577  24.582  24.412\nS  25.597  25.955  24.905\nC  25.976  23.391  24.742\nH  26.416  22.423  24.517\nC  24.717  23.570  25.384\nH  24.083  22.747  25.708\nC  24.356  24.887  25.554\nC  23.106  25.437  26.078\nC  22.919  26.238  27.189\nH  23.734  26.516  27.854\nC  21.569  26.632  27.376\nH  21.207  27.246  28.197\nS  21.598  25.193  25.223\nC  20.725  26.144  26.401\nC  19.272  26.375  26.337\nO  18.650  27.043  27.140\nO  18.707  25.757  25.272\nC  17.284  25.937  25.134\nH  17.044  27.001  25.017\nH  17.008  25.376  24.237\nH  16.763  25.543  26.014\n35\nScan Cycle 13/19 ; Dihedral 27-22-21-16 = 120.00 ; Iteration 20 Energy -1711.499895\nC  29.032  24.142  24.175\nC  29.285  23.148  25.127\nH  28.496  22.749  25.767\nN  30.511  22.651  25.291\nC  31.515  23.127  24.519\nH  32.495  22.680  24.695\nC  31.366  24.121  23.557\nH  32.222  24.466  22.977\nC  30.082  24.661  23.373\nC  29.512  25.681  22.534\nH  30.023  26.283  21.791\nC  28.177  25.748  22.840\nH  27.395  26.371  22.420\nN  27.860  24.821  23.829\nC  26.589  24.632  24.386\nS  25.644  26.008  24.935\nC  25.939  23.446  24.628\nH  26.351  22.477  24.356\nC  24.671  23.631  25.249\nH  24.003  22.813  25.512\nC  24.351  24.949  25.490\nC  23.111  25.511  26.014\nC  22.944  26.406  27.055\nH  23.775  26.762  27.661\nC  21.592  26.779  27.263\nH  21.244  27.454  28.041\nS  21.578  25.151  25.248\nC  20.724  26.179  26.374\nC  19.264  26.362  26.354\nO  18.653  27.084  27.118\nO  18.675  25.630  25.377\nC  17.243  25.756  25.285\nH  16.964  26.797  25.080\nH  16.948  25.106  24.457\nH  16.771  25.432  26.221\n35\nScan Cycle 14/19 ; Dihedral 27-22-21-16 = 130.00 ; Iteration 20 Energy -1711.500918\nC  29.034  24.122  24.185\nC  29.225  23.067  25.085\nH  28.405  22.660  25.680\nN  30.429  22.520  25.255\nC  31.471  23.003  24.540\nH  32.430  22.513  24.717\nC  31.384  24.055  23.633\nH  32.267  24.402  23.098\nC  30.124  24.648  23.444\nC  29.613  25.733  22.650\nH  30.166  26.358  21.958\nC  28.273  25.829  22.922\nH  27.525  26.502  22.516\nN  27.896  24.859  23.846\nC  26.603  24.682  24.355\nS  25.683  26.059  24.945\nC  25.909  23.508  24.514\nH  26.300  22.541  24.205\nC  24.629  23.701  25.107\nH  23.932  22.890  25.312\nC  24.342  25.015  25.404\nC  23.110  25.588  25.929\nC  22.957  26.560  26.903\nH  23.799  26.986  27.445\nC  21.604  26.906  27.140\nH  21.267  27.632  27.876\nS  21.559  25.120  25.264\nC  20.719  26.209  26.344\nC  19.254  26.344  26.375\nO  18.652  27.107  27.105\nO  18.650  25.515  25.489\nC  17.211  25.588  25.453\nH  16.888  26.599  25.176\nH  16.904  24.862  24.695\nH  16.792  25.329  26.432\n35\nScan Cycle 15/19 ; Dihedral 27-22-21-16 = 140.00 ; Iteration 20 Energy -1711.501731\nC  29.034  24.103  24.196\nC  29.165  22.995  25.042\nH  28.315  22.583  25.588\nN  30.346  22.402  25.218\nC  31.424  22.891  24.563\nH  32.362  22.362  24.742\nC  31.397  23.992  23.714\nH  32.308  24.340  23.226\nC  30.162  24.634  23.519\nC  29.710  25.777  22.772\nH  30.304  26.421  22.132\nC  28.365  25.900  23.007\nH  27.651  26.618  22.617\nN  27.930  24.893  23.865\nC  26.617  24.730  24.322\nS  25.716  26.104  24.947\nC  25.885  23.570  24.401\nH  26.258  22.608  24.059\nC  24.592  23.773  24.960\nH  23.868  22.973  25.106\nC  24.329  25.081  25.307\nC  23.104  25.661  25.831\nC  22.959  26.698  26.738\nH  23.807  27.190  27.212\nC  21.606  27.019  27.010\nH  21.277  27.788  27.705\nS  21.542  25.093  25.278\nC  20.712  26.235  26.311\nC  19.247  26.324  26.398\nO  18.650  27.123  27.093\nO  18.635  25.410  25.607\nC  17.195  25.433  25.630\nH  16.824  26.409  25.294\nH  16.881  24.642  24.944\nH  16.827  25.237  26.645\n35\nScan Cycle 16/19 ; Dihedral 27-22-21-16 = 150.00 ; Iteration 20 Energy -1711.502254\nC  29.032  24.086  24.209\nC  29.105  22.931  24.997\nH  28.227  22.516  25.494\nN  30.263  22.296  25.177\nC  31.374  22.787  24.583\nH  32.291  22.222  24.762\nC  31.406  23.932  23.794\nH  32.340  24.280  23.354\nC  30.195  24.620  23.597\nC  29.799  25.813  22.898\nH  30.431  26.472  22.313\nC  28.451  25.963  23.098\nH  27.771  26.720  22.725\nN  27.961  24.925  23.886\nC  26.630  24.775  24.291\nS  25.744  26.143  24.952\nC  25.866  23.633  24.290\nH  26.225  22.679  23.914\nC  24.559  23.845  24.813\nH  23.813  23.057  24.897\nC  24.316  25.143  25.210\nC  23.095  25.728  25.732\nC  22.950  26.824  26.568\nH  23.797  27.378  26.968\nC  21.600  27.120  26.875\nH  21.273  27.929  27.524\nS  21.532  25.066  25.296\nC  20.706  26.257  26.276\nC  19.244  26.305  26.420\nO  18.647  27.133  27.081\nO  18.633  25.314  25.725\nC  17.195  25.292  25.810\nH  16.776  26.227  25.419\nH  16.882  24.441  25.198\nH  16.877  25.160  26.851\n35\nScan Cycle 17/19 ; Dihedral 27-22-21-16 = 160.00 ; Iteration 20 Energy -1711.502501\nC  29.027  24.069  24.221\nC  29.048  22.873  24.947\nH  28.145  22.454  25.394\nN  30.184  22.199  25.127\nC  31.325  22.693  24.595\nH  32.222  22.096  24.771\nC  31.409  23.878  23.871\nH  32.365  24.224  23.479\nC  30.223  24.605  23.675\nC  29.878  25.845  23.031\nH  30.543  26.518  22.503\nC  28.528  26.018  23.198\nH  27.878  26.812  22.846\nN  27.988  24.952  23.912\nC  26.642  24.814  24.268\nS  25.767  26.170  24.968\nC  25.851  23.694  24.184\nH  26.200  22.751  23.771\nC  24.533  23.913  24.672\nH  23.767  23.140  24.688\nC  24.305  25.198  25.122\nC  23.084  25.784  25.640\nC  22.931  26.937  26.395\nH  23.771  27.552  26.713\nC  21.584  27.212  26.733\nH  21.253  28.061  27.327\nS  21.531  25.035  25.327\nC  20.699  26.276  26.241\nC  19.243  26.288  26.438\nO  18.642  27.145  27.056\nO  18.642  25.226  25.845\nC  17.210  25.165  25.989\nH  16.744  26.053  25.545\nH  16.905  24.260  25.457\nH  16.936  25.103  27.049\n35\nScan Cycle 18/19 ; Dihedral 27-22-21-16 = 170.00 ; Iteration 20 Energy -1711.50258\nC  29.022  24.053  24.233\nC  28.995  22.816  24.887\nH  28.071  22.393  25.283\nN  30.110  22.106  25.059\nC  31.278  22.603  24.589\nH  32.156  21.975  24.754\nC  31.409  23.826  23.939\nH  32.383  24.172  23.596\nC  30.245  24.592  23.753\nC  29.946  25.874  23.175\nH  30.642  26.562  22.707\nC  28.597  26.070  23.314\nH  27.975  26.898  22.991\nN  28.012  24.976  23.948\nC  26.653  24.850  24.255\nS  25.786  26.186  24.999\nC  25.842  23.753  24.089\nH  26.183  22.825  23.637\nC  24.514  23.978  24.545\nH  23.731  23.224  24.488\nC  24.297  25.244  25.051\nC  23.073  25.830  25.559\nC  22.901  27.039  26.217\nH  23.725  27.714  26.443\nC  21.558  27.298  26.578\nH  21.215  28.186  27.104\nS  21.539  25.001  25.377\nC  20.692  26.292  26.203\nC  19.244  26.274  26.447\nO  18.632  27.162  27.009\nO  18.662  25.146  25.969\nC  17.239  25.050  26.168\nH  16.727  25.879  25.665\nH  16.950  24.091  25.728\nH  17.001  25.074  27.238\n35\nScan Cycle 19/19 ; Dihedral 27-22-21-16 = 180.00 ; Iteration 20 Energy -1711.502613\nC  29.016  24.038  24.244\nC  28.945  22.765  24.824\nH  28.001  22.340  25.168\nN  30.041  22.023  24.985\nC  31.231  22.522  24.578\nH  32.091  21.867  24.731\nC  31.405  23.778  24.006\nH  32.396  24.123  23.711\nC  30.262  24.577  23.832\nC  30.006  25.898  23.323\nH  30.729  26.596  22.915\nC  28.657  26.114  23.434\nH  28.061  26.972  23.143\nN  28.032  24.998  23.986\nC  26.663  24.882  24.246\nS  25.799  26.194  25.036\nC  25.837  23.813  23.997\nH  26.173  22.905  23.504\nC  24.499  24.042  24.421\nH  23.702  23.313  24.290\nC  24.290  25.285  24.986\nC  23.062  25.870  25.485\nC  22.865  27.127  26.038\nH  23.666  27.852  26.165\nC  21.524  27.370  26.420\nH  21.164  28.291  26.871\nS  21.557  24.971  25.438\nC  20.686  26.306  26.165\nC  19.246  26.261  26.454\nO  18.619  27.174  26.956\nO  18.693  25.076  26.094\nC  17.280  24.950  26.345\nH  16.724  25.715  25.790\nH  17.013  23.948  25.998\nH  17.073  25.058  27.416\n");
	viewergrid_1670577658845361[0][1].animate({"loop": "BackAndForth"});
	viewergrid_1670577658845361[0][0].setStyle({"stick": {}});
	viewergrid_1670577658845361[0][1].setStyle({"stick": {}});
	viewergrid_1670577658845361[0][0].zoomTo();
	viewergrid_1670577658845361[0][1].zoomTo();
viewergrid_1670577658845361[0][1].render();
viewergrid_1670577658845361[0][0].render();
});
</script></div></div>
</div>
<p>Furthermore, <a class="reference internal" href="../env/resp.html"><span class="doc std std-doc">RESP charges</span></a> are provided:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp_chg</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.014967</span><span class="p">,</span> <span class="mf">0.224409</span><span class="p">,</span> <span class="mf">0.089489</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.551618</span><span class="p">,</span> <span class="mf">0.153050</span><span class="p">,</span> <span class="mf">0.106847</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.315042</span><span class="p">,</span>
    <span class="mf">0.165854</span><span class="p">,</span> <span class="mf">0.206441</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.425163</span><span class="p">,</span> <span class="mf">0.225816</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.039099</span><span class="p">,</span> <span class="mf">0.179377</span><span class="p">,</span> <span class="mf">0.002119</span><span class="p">,</span>
    <span class="mf">0.014483</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.043666</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.230202</span><span class="p">,</span> <span class="mf">0.165960</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.071404</span><span class="p">,</span> <span class="mf">0.188598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.044661</span><span class="p">,</span>
    <span class="mf">0.088786</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.173586</span><span class="p">,</span> <span class="mf">0.175730</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.089376</span><span class="p">,</span> <span class="mf">0.164515</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.118573</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.150541</span><span class="p">,</span>
    <span class="mf">0.736497</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.570770</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.273724</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.144051</span><span class="p">,</span> <span class="mf">0.112846</span><span class="p">,</span> <span class="mf">0.112846</span><span class="p">,</span> <span class="mf">0.112846</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we provide atom types and (initial) force field files and topology:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ff_gen</span><span class="o">.</span><span class="n">molecule_name</span> <span class="o">=</span> <span class="s1">&#39;hs276&#39;</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">molecule</span> <span class="o">=</span> <span class="n">molecule</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">atom_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;h4&#39;</span><span class="p">,</span> <span class="s1">&#39;nb&#39;</span><span class="p">,</span> <span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;h4&#39;</span><span class="p">,</span> <span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">,</span> <span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="s1">&#39;h4&#39;</span><span class="p">,</span> <span class="s1">&#39;na&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span> <span class="s1">&#39;ss&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;ha&#39;</span><span class="p">,</span> <span class="s1">&#39;cd&#39;</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">,</span> <span class="s1">&#39;ss&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;os&#39;</span><span class="p">,</span> <span class="s1">&#39;c3&#39;</span><span class="p">,</span> <span class="s1">&#39;h1&#39;</span><span class="p">,</span> <span class="s1">&#39;h1&#39;</span><span class="p">,</span> <span class="s1">&#39;h1&#39;</span><span class="p">]</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">force_field_data</span> <span class="o">=</span> <span class="s1">&#39;../../data/md/gaff-2.11.dat&#39;</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">force_field_data_extension</span> <span class="o">=</span> <span class="s1">&#39;../../data/md/gaff-2.11_extension.dat&#39;</span>

<span class="n">original_itp_file</span> <span class="o">=</span> <span class="s1">&#39;../../data/md/hs276_00.itp&#39;</span>
<span class="n">original_top_file</span> <span class="o">=</span> <span class="s1">&#39;../../data/md/hs276_00.top&#39;</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">write_original_itp</span><span class="p">(</span><span class="n">original_itp_file</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">ff_gen</span><span class="o">.</span><span class="n">atom_types</span><span class="p">),</span> <span class="n">resp_chg</span><span class="p">)</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">write_top</span><span class="p">(</span><span class="n">original_top_file</span><span class="p">,</span> <span class="n">original_itp_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond length 10-12 (cd-cd) to 0.137 nm                                                                    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond angle 1-9-10 (ca-ca-cd) to 107.2 deg                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond angle 1-14-15 (ca-na-cc) to 126.6 deg                                                               
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond angle 2-1-14 (ca-ca-na) to 131.7 deg                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond angle 7-9-10 (ca-ca-cd) to 135.3 deg                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond angle 9-1-14 (ca-ca-na) to 107.6 deg                                                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond angle 14-15-17 (na-cc-cd) to 128.3 deg                                                              
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond angle 19-21-22 (cd-cc-cc) to 129.2 deg                                                              
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Updated bond angle 21-22-23 (cc-cc-cd) to 128.6 deg                                                              
</pre></div>
</div>
</div>
</div>
</section>
<section id="gaff-force-field">
<h2>GAFF force field<a class="headerlink" href="#gaff-force-field" title="Permalink to this headline">#</a></h2>
<p>The performance of the original GAFF force field is evaluated by calculating the energy at each dihedral angle from the scan:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res_phi1</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">validate_force_field</span><span class="p">(</span><span class="n">original_top_file</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">res_phi2</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">validate_force_field</span><span class="p">(</span><span class="n">original_top_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Note:</em> These calculations are not executed in the compilation of the book, and the results are instead loaded below.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_phi1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dihedral_indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">&#39;dihedral_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">10.0</span><span class="p">,</span>  <span class="mf">20.0</span><span class="p">,</span>  <span class="mf">30.0</span><span class="p">,</span>  <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">50.0</span><span class="p">,</span>  <span class="mf">60.0</span><span class="p">,</span>  <span class="mf">70.0</span><span class="p">,</span>  <span class="mf">80.0</span><span class="p">,</span>  <span class="mf">90.0</span><span class="p">,</span>
                      <span class="mf">100.0</span><span class="p">,</span>  <span class="mf">110.0</span><span class="p">,</span>  <span class="mf">120.0</span><span class="p">,</span>  <span class="mf">130.0</span><span class="p">,</span>  <span class="mf">140.0</span><span class="p">,</span>  <span class="mf">150.0</span><span class="p">,</span>  <span class="mf">160.0</span><span class="p">,</span>  <span class="mf">170.0</span><span class="p">,</span>  <span class="mf">180.0</span><span class="p">],</span>
 <span class="s1">&#39;mm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.38636858</span><span class="p">,</span>  <span class="mf">0.48247293</span><span class="p">,</span>  <span class="mf">1.27570957</span><span class="p">,</span>  <span class="mf">3.36342458</span><span class="p">,</span>  <span class="mf">6.98809449</span><span class="p">,</span>
        <span class="mf">12.13142224</span><span class="p">,</span> <span class="mf">18.5303525</span> <span class="p">,</span> <span class="mf">25.62885098</span><span class="p">,</span> <span class="mf">32.54192822</span><span class="p">,</span> <span class="mf">37.58017715</span><span class="p">,</span>
        <span class="mf">31.99637207</span><span class="p">,</span> <span class="mf">25.07828961</span><span class="p">,</span> <span class="mf">17.94691688</span><span class="p">,</span> <span class="mf">11.36067857</span><span class="p">,</span>  <span class="mf">5.91695371</span><span class="p">,</span>
         <span class="mf">2.06323565</span><span class="p">,</span>  <span class="mf">0.07655332</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.51503683</span><span class="p">]),</span>
 <span class="s1">&#39;qm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.68483744</span><span class="p">,</span> <span class="mf">7.04159003</span><span class="p">,</span> <span class="mf">5.23524628</span><span class="p">,</span> <span class="mf">3.25299405</span><span class="p">,</span> <span class="mf">1.80634375</span><span class="p">,</span>
        <span class="mf">1.14209234</span><span class="p">,</span> <span class="mf">1.24448683</span><span class="p">,</span> <span class="mf">1.88248324</span><span class="p">,</span> <span class="mf">2.57298965</span><span class="p">,</span> <span class="mf">2.70951563</span><span class="p">,</span>
        <span class="mf">2.2185472</span> <span class="p">,</span> <span class="mf">1.34950681</span><span class="p">,</span> <span class="mf">0.50672143</span><span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.13652598</span><span class="p">,</span>
        <span class="mf">1.11846285</span><span class="p">,</span> <span class="mf">2.99044409</span><span class="p">,</span> <span class="mf">5.39540176</span><span class="p">,</span> <span class="mf">6.79216757</span><span class="p">])}</span>
<span class="n">res_phi2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dihedral_indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">27</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">&#39;dihedral_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">10.0</span><span class="p">,</span>  <span class="mf">20.0</span><span class="p">,</span>  <span class="mf">30.0</span><span class="p">,</span>  <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">50.0</span><span class="p">,</span>  <span class="mf">60.0</span><span class="p">,</span>  <span class="mf">70.0</span><span class="p">,</span>  <span class="mf">80.0</span><span class="p">,</span>
  <span class="mf">90.0</span><span class="p">,</span>  <span class="mf">100.0</span><span class="p">,</span>  <span class="mf">110.0</span><span class="p">,</span>  <span class="mf">120.0</span><span class="p">,</span>  <span class="mf">130.0</span><span class="p">,</span>  <span class="mf">140.0</span><span class="p">,</span>  <span class="mf">150.0</span><span class="p">,</span>  <span class="mf">160.0</span><span class="p">,</span>  <span class="mf">170.0</span><span class="p">,</span>  <span class="mf">180.0</span><span class="p">],</span>
 <span class="s1">&#39;mm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>  <span class="mf">6.73698578</span><span class="p">,</span>   <span class="mf">8.89934543</span><span class="p">,</span>  <span class="mf">15.06049153</span><span class="p">,</span>  <span class="mf">24.88538725</span><span class="p">,</span>
         <span class="mf">37.83422214</span><span class="p">,</span>  <span class="mf">53.18780112</span><span class="p">,</span>  <span class="mf">70.07821906</span><span class="p">,</span>  <span class="mf">87.530094</span>  <span class="p">,</span>
        <span class="mf">104.49431502</span><span class="p">,</span> <span class="mf">115.61424453</span><span class="p">,</span>  <span class="mf">99.4539796</span> <span class="p">,</span>  <span class="mf">81.95008328</span><span class="p">,</span>
         <span class="mf">64.11898505</span><span class="p">,</span>  <span class="mf">46.92700085</span><span class="p">,</span>  <span class="mf">31.30870369</span><span class="p">,</span>  <span class="mf">18.13606105</span><span class="p">,</span>
          <span class="mf">8.16882884</span><span class="p">,</span>   <span class="mf">1.99828301</span><span class="p">,</span>   <span class="mf">0.</span>        <span class="p">]),</span>
 <span class="s1">&#39;qm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.83585497</span><span class="p">,</span>  <span class="mf">3.39214553</span><span class="p">,</span>  <span class="mf">3.07446008</span><span class="p">,</span>  <span class="mf">3.05870708</span><span class="p">,</span>  <span class="mf">3.79647248</span><span class="p">,</span>
         <span class="mf">5.41640576</span><span class="p">,</span>  <span class="mf">7.76097693</span><span class="p">,</span> <span class="mf">10.36547258</span><span class="p">,</span> <span class="mf">12.46062129</span><span class="p">,</span> <span class="mf">13.21413969</span><span class="p">,</span>
        <span class="mf">12.26370882</span><span class="p">,</span>  <span class="mf">9.96902213</span><span class="p">,</span>  <span class="mf">7.13610802</span><span class="p">,</span>  <span class="mf">4.45022189</span><span class="p">,</span>  <span class="mf">2.31569068</span><span class="p">,</span>
         <span class="mf">0.94255437</span><span class="p">,</span>  <span class="mf">0.29405596</span><span class="p">,</span>  <span class="mf">0.08664149</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">])}</span>
<span class="n">res_phi1_fit</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dihedral_indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">&#39;dihedral_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">10.0</span><span class="p">,</span>  <span class="mf">20.0</span><span class="p">,</span>  <span class="mf">30.0</span><span class="p">,</span>  <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">50.0</span><span class="p">,</span>  <span class="mf">60.0</span><span class="p">,</span>  <span class="mf">70.0</span><span class="p">,</span>  <span class="mf">80.0</span><span class="p">,</span>  <span class="mf">90.0</span><span class="p">,</span>
                       <span class="mf">100.0</span><span class="p">,</span>  <span class="mf">110.0</span><span class="p">,</span>  <span class="mf">120.0</span><span class="p">,</span>  <span class="mf">130.0</span><span class="p">,</span>  <span class="mf">140.0</span><span class="p">,</span>  <span class="mf">150.0</span><span class="p">,</span>  <span class="mf">160.0</span><span class="p">,</span>  <span class="mf">170.0</span><span class="p">,</span>  <span class="mf">180.0</span><span class="p">],</span>
 <span class="s1">&#39;mm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">8.85550424</span><span class="p">,</span> <span class="mf">6.54628496</span><span class="p">,</span> <span class="mf">3.92072292</span><span class="p">,</span> <span class="mf">2.18977189</span><span class="p">,</span> <span class="mf">1.42619785</span><span class="p">,</span>
        <span class="mf">1.39217696</span><span class="p">,</span> <span class="mf">1.69310874</span><span class="p">,</span> <span class="mf">1.93478451</span><span class="p">,</span> <span class="mf">1.92300116</span><span class="p">,</span> <span class="mf">1.69520266</span><span class="p">,</span>
        <span class="mf">1.40178731</span><span class="p">,</span> <span class="mf">1.13081008</span><span class="p">,</span> <span class="mf">0.84304392</span><span class="p">,</span> <span class="mf">0.45899866</span><span class="p">,</span> <span class="mf">0.0506388</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.9624034</span> <span class="p">,</span> <span class="mf">3.60078571</span><span class="p">,</span> <span class="mf">9.49198035</span><span class="p">]),</span>
 <span class="s1">&#39;qm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.68483744</span><span class="p">,</span> <span class="mf">7.04159003</span><span class="p">,</span> <span class="mf">5.23524628</span><span class="p">,</span> <span class="mf">3.25299405</span><span class="p">,</span> <span class="mf">1.80634375</span><span class="p">,</span>
        <span class="mf">1.14209234</span><span class="p">,</span> <span class="mf">1.24448683</span><span class="p">,</span> <span class="mf">1.88248324</span><span class="p">,</span> <span class="mf">2.57298965</span><span class="p">,</span> <span class="mf">2.70951563</span><span class="p">,</span>
        <span class="mf">2.2185472</span> <span class="p">,</span> <span class="mf">1.34950681</span><span class="p">,</span> <span class="mf">0.50672143</span><span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.13652598</span><span class="p">,</span>
        <span class="mf">1.11846285</span><span class="p">,</span> <span class="mf">2.99044409</span><span class="p">,</span> <span class="mf">5.39540176</span><span class="p">,</span> <span class="mf">6.79216757</span><span class="p">])}</span>
<span class="n">res_phi2_fit</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dihedral_indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">27</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">&#39;dihedral_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">10.0</span><span class="p">,</span>  <span class="mf">20.0</span><span class="p">,</span>  <span class="mf">30.0</span><span class="p">,</span>  <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">50.0</span><span class="p">,</span>  <span class="mf">60.0</span><span class="p">,</span>  <span class="mf">70.0</span><span class="p">,</span>  <span class="mf">80.0</span><span class="p">,</span>
                       <span class="mf">90.0</span><span class="p">,</span>  <span class="mf">100.0</span><span class="p">,</span>  <span class="mf">110.0</span><span class="p">,</span>  <span class="mf">120.0</span><span class="p">,</span>  <span class="mf">130.0</span><span class="p">,</span>  <span class="mf">140.0</span><span class="p">,</span>  <span class="mf">150.0</span><span class="p">,</span>  <span class="mf">160.0</span><span class="p">,</span>
                       <span class="mf">170.0</span><span class="p">,</span>  <span class="mf">180.0</span><span class="p">],</span>
 <span class="s1">&#39;mm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.77011661</span><span class="p">,</span>  <span class="mf">3.4340386</span> <span class="p">,</span>  <span class="mf">2.92616752</span><span class="p">,</span>  <span class="mf">2.82307531</span><span class="p">,</span>  <span class="mf">3.59515264</span><span class="p">,</span>
         <span class="mf">5.37149162</span><span class="p">,</span>  <span class="mf">7.85506128</span><span class="p">,</span> <span class="mf">10.40900493</span><span class="p">,</span> <span class="mf">12.28767184</span><span class="p">,</span> <span class="mf">12.91265169</span><span class="p">,</span>
        <span class="mf">12.0771715</span> <span class="p">,</span>  <span class="mf">9.9999376</span> <span class="p">,</span>  <span class="mf">7.22496312</span><span class="p">,</span>  <span class="mf">4.41920009</span><span class="p">,</span>  <span class="mf">2.14773038</span><span class="p">,</span>
         <span class="mf">0.71490743</span><span class="p">,</span>  <span class="mf">0.09502842</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.07651008</span><span class="p">]),</span>
 <span class="s1">&#39;qm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.83585497</span><span class="p">,</span>  <span class="mf">3.39214553</span><span class="p">,</span>  <span class="mf">3.07446008</span><span class="p">,</span>  <span class="mf">3.05870708</span><span class="p">,</span>  <span class="mf">3.79647248</span><span class="p">,</span>
         <span class="mf">5.41640576</span><span class="p">,</span>  <span class="mf">7.76097693</span><span class="p">,</span> <span class="mf">10.36547258</span><span class="p">,</span> <span class="mf">12.46062129</span><span class="p">,</span> <span class="mf">13.21413969</span><span class="p">,</span>
        <span class="mf">12.26370882</span><span class="p">,</span>  <span class="mf">9.96902213</span><span class="p">,</span>  <span class="mf">7.13610802</span><span class="p">,</span>  <span class="mf">4.45022189</span><span class="p">,</span>  <span class="mf">2.31569068</span><span class="p">,</span>
         <span class="mf">0.94255437</span><span class="p">,</span>  <span class="mf">0.29405596</span><span class="p">,</span>  <span class="mf">0.08664149</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">])}</span>
<span class="n">res_phi1_fit_imp1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dihedral_indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">&#39;dihedral_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">10.0</span><span class="p">,</span>  <span class="mf">20.0</span><span class="p">,</span>  <span class="mf">30.0</span><span class="p">,</span>  <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">50.0</span><span class="p">,</span>  <span class="mf">60.0</span><span class="p">,</span>  <span class="mf">70.0</span><span class="p">,</span>  <span class="mf">80.0</span><span class="p">,</span>
                     <span class="mf">90.0</span><span class="p">,</span>  <span class="mf">100.0</span><span class="p">,</span>  <span class="mf">110.0</span><span class="p">,</span>  <span class="mf">120.0</span><span class="p">,</span>  <span class="mf">130.0</span><span class="p">,</span>  <span class="mf">140.0</span><span class="p">,</span>  <span class="mf">150.0</span><span class="p">,</span>  <span class="mf">160.0</span><span class="p">,</span>
                       <span class="mf">170.0</span><span class="p">,</span>  <span class="mf">180.0</span><span class="p">],</span>
 <span class="s1">&#39;mm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.50209112</span><span class="p">,</span>  <span class="mf">8.02223957</span><span class="p">,</span>  <span class="mf">4.94590657</span><span class="p">,</span>  <span class="mf">2.64652847</span><span class="p">,</span>  <span class="mf">1.39729309</span><span class="p">,</span>
         <span class="mf">1.11813384</span><span class="p">,</span>  <span class="mf">1.46934483</span><span class="p">,</span>  <span class="mf">1.98405593</span><span class="p">,</span>  <span class="mf">2.2847002</span> <span class="p">,</span>  <span class="mf">2.21777892</span><span class="p">,</span>
         <span class="mf">1.82680422</span><span class="p">,</span>  <span class="mf">1.2450606</span> <span class="p">,</span>  <span class="mf">0.62448599</span><span class="p">,</span>  <span class="mf">0.12913038</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
         <span class="mf">0.61013567</span><span class="p">,</span>  <span class="mf">2.4092184</span> <span class="p">,</span>  <span class="mf">5.72247507</span><span class="p">,</span> <span class="mf">11.88358653</span><span class="p">]),</span>
 <span class="s1">&#39;qm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.68483744</span><span class="p">,</span> <span class="mf">7.04159003</span><span class="p">,</span> <span class="mf">5.23524628</span><span class="p">,</span> <span class="mf">3.25299405</span><span class="p">,</span> <span class="mf">1.80634375</span><span class="p">,</span>
        <span class="mf">1.14209234</span><span class="p">,</span> <span class="mf">1.24448683</span><span class="p">,</span> <span class="mf">1.88248324</span><span class="p">,</span> <span class="mf">2.57298965</span><span class="p">,</span> <span class="mf">2.70951563</span><span class="p">,</span>
        <span class="mf">2.2185472</span> <span class="p">,</span> <span class="mf">1.34950681</span><span class="p">,</span> <span class="mf">0.50672143</span><span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.13652598</span><span class="p">,</span>
        <span class="mf">1.11846285</span><span class="p">,</span> <span class="mf">2.99044409</span><span class="p">,</span> <span class="mf">5.39540176</span><span class="p">,</span> <span class="mf">6.79216757</span><span class="p">])}</span>
<span class="n">res_phi2_fit_imp1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dihedral_indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">27</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">&#39;dihedral_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">10.0</span><span class="p">,</span>  <span class="mf">20.0</span><span class="p">,</span>  <span class="mf">30.0</span><span class="p">,</span>  <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">50.0</span><span class="p">,</span>  <span class="mf">60.0</span><span class="p">,</span>  <span class="mf">70.0</span><span class="p">,</span>  <span class="mf">80.0</span><span class="p">,</span>  <span class="mf">90.0</span><span class="p">,</span>
                       <span class="mf">100.0</span><span class="p">,</span>  <span class="mf">110.0</span><span class="p">,</span>  <span class="mf">120.0</span><span class="p">,</span>  <span class="mf">130.0</span><span class="p">,</span>  <span class="mf">140.0</span><span class="p">,</span>  <span class="mf">150.0</span><span class="p">,</span>  <span class="mf">160.0</span><span class="p">,</span>  <span class="mf">170.0</span><span class="p">,</span>  <span class="mf">180.0</span><span class="p">],</span>
 <span class="s1">&#39;mm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.77380665</span><span class="p">,</span>  <span class="mf">3.45659839</span><span class="p">,</span>  <span class="mf">2.97075626</span><span class="p">,</span>  <span class="mf">2.89168948</span><span class="p">,</span>  <span class="mf">3.68036836</span><span class="p">,</span>
         <span class="mf">5.45413796</span><span class="p">,</span>  <span class="mf">7.90762789</span><span class="p">,</span> <span class="mf">10.40597509</span><span class="p">,</span> <span class="mf">12.22095797</span><span class="p">,</span> <span class="mf">12.80156411</span><span class="p">,</span>
        <span class="mf">11.96438867</span><span class="p">,</span>  <span class="mf">9.93400376</span><span class="p">,</span>  <span class="mf">7.23618755</span><span class="p">,</span>  <span class="mf">4.5020705</span> <span class="p">,</span>  <span class="mf">2.26598738</span><span class="p">,</span>
         <span class="mf">0.81664548</span><span class="p">,</span>  <span class="mf">0.14546155</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.06206884</span><span class="p">]),</span>
 <span class="s1">&#39;qm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.83585497</span><span class="p">,</span>  <span class="mf">3.39214553</span><span class="p">,</span>  <span class="mf">3.07446008</span><span class="p">,</span>  <span class="mf">3.05870708</span><span class="p">,</span>  <span class="mf">3.79647248</span><span class="p">,</span>
         <span class="mf">5.41640576</span><span class="p">,</span>  <span class="mf">7.76097693</span><span class="p">,</span> <span class="mf">10.36547258</span><span class="p">,</span> <span class="mf">12.46062129</span><span class="p">,</span> <span class="mf">13.21413969</span><span class="p">,</span>
        <span class="mf">12.26370882</span><span class="p">,</span>  <span class="mf">9.96902213</span><span class="p">,</span>  <span class="mf">7.13610802</span><span class="p">,</span>  <span class="mf">4.45022189</span><span class="p">,</span>  <span class="mf">2.31569068</span><span class="p">,</span>
         <span class="mf">0.94255437</span><span class="p">,</span>  <span class="mf">0.29405596</span><span class="p">,</span>  <span class="mf">0.08664149</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">])}</span>
<span class="n">res_phi1_fit_imp2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dihedral_indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">&#39;dihedral_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span>  <span class="mf">30.0</span><span class="p">,</span>  <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">50.0</span><span class="p">,</span>  <span class="mf">60.0</span><span class="p">,</span>  <span class="mf">70.0</span><span class="p">,</span>  <span class="mf">80.0</span><span class="p">,</span>  <span class="mf">90.0</span><span class="p">,</span>  <span class="mf">100.0</span><span class="p">,</span>
                       <span class="mf">110.0</span><span class="p">,</span>  <span class="mf">120.0</span><span class="p">,</span>  <span class="mf">130.0</span><span class="p">,</span>  <span class="mf">140.0</span><span class="p">,</span>  <span class="mf">150.0</span><span class="p">,</span>  <span class="mf">160.0</span><span class="p">,</span>  <span class="mf">170.0</span><span class="p">],</span>
 <span class="s1">&#39;mm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.4234754</span> <span class="p">,</span> <span class="mf">2.89034555</span><span class="p">,</span> <span class="mf">1.44738438</span><span class="p">,</span> <span class="mf">1.07147175</span><span class="p">,</span> <span class="mf">1.42615159</span><span class="p">,</span>
        <span class="mf">2.00013673</span><span class="p">,</span> <span class="mf">2.36625897</span><span class="p">,</span> <span class="mf">2.32952195</span><span class="p">,</span> <span class="mf">1.92383912</span><span class="p">,</span> <span class="mf">1.30083734</span><span class="p">,</span>
        <span class="mf">0.63897763</span><span class="p">,</span> <span class="mf">0.1232948</span> <span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.63355979</span><span class="p">,</span> <span class="mf">2.46041641</span><span class="p">,</span>
        <span class="mf">5.81462796</span><span class="p">]),</span>
 <span class="s1">&#39;qm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.23524628</span><span class="p">,</span> <span class="mf">3.25299405</span><span class="p">,</span> <span class="mf">1.80634375</span><span class="p">,</span> <span class="mf">1.14209234</span><span class="p">,</span> <span class="mf">1.24448683</span><span class="p">,</span>
        <span class="mf">1.88248324</span><span class="p">,</span> <span class="mf">2.57298965</span><span class="p">,</span> <span class="mf">2.70951563</span><span class="p">,</span> <span class="mf">2.2185472</span> <span class="p">,</span> <span class="mf">1.34950681</span><span class="p">,</span>
        <span class="mf">0.50672143</span><span class="p">,</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.13652598</span><span class="p">,</span> <span class="mf">1.11846285</span><span class="p">,</span> <span class="mf">2.99044409</span><span class="p">,</span>
        <span class="mf">5.39540176</span><span class="p">])}</span>
<span class="n">res_phi2_fit_imp2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dihedral_indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">27</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">&#39;dihedral_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">10.0</span><span class="p">,</span>  <span class="mf">20.0</span><span class="p">,</span>  <span class="mf">30.0</span><span class="p">,</span>  <span class="mf">40.0</span><span class="p">,</span>  <span class="mf">50.0</span><span class="p">,</span>  <span class="mf">60.0</span><span class="p">,</span>  <span class="mf">70.0</span><span class="p">,</span>  <span class="mf">80.0</span><span class="p">,</span>
                       <span class="mf">90.0</span><span class="p">,</span>  <span class="mf">100.0</span><span class="p">,</span>  <span class="mf">110.0</span><span class="p">,</span>  <span class="mf">120.0</span><span class="p">,</span>  <span class="mf">130.0</span><span class="p">,</span>  <span class="mf">140.0</span><span class="p">,</span>  <span class="mf">150.0</span><span class="p">,</span>  <span class="mf">160.0</span><span class="p">,</span>
                       <span class="mf">170.0</span><span class="p">,</span>  <span class="mf">180.0</span><span class="p">],</span>
 <span class="s1">&#39;mm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.76614678</span><span class="p">,</span>  <span class="mf">3.44072374</span><span class="p">,</span>  <span class="mf">2.93298698</span><span class="p">,</span>  <span class="mf">2.82649038</span><span class="p">,</span>  <span class="mf">3.59577269</span><span class="p">,</span>
         <span class="mf">5.37198654</span><span class="p">,</span>  <span class="mf">7.8574572</span> <span class="p">,</span> <span class="mf">10.41314745</span><span class="p">,</span> <span class="mf">12.29166455</span><span class="p">,</span> <span class="mf">12.91538952</span><span class="p">,</span>
        <span class="mf">12.07832096</span><span class="p">,</span> <span class="mf">10.00124395</span><span class="p">,</span>  <span class="mf">7.22794208</span><span class="p">,</span>  <span class="mf">4.42314879</span><span class="p">,</span>  <span class="mf">2.15221843</span><span class="p">,</span>
         <span class="mf">0.71672128</span><span class="p">,</span>  <span class="mf">0.09418956</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.08373556</span><span class="p">]),</span>
 <span class="s1">&#39;qm_scan_kJpermol&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.83585497</span><span class="p">,</span>  <span class="mf">3.39214553</span><span class="p">,</span>  <span class="mf">3.07446008</span><span class="p">,</span>  <span class="mf">3.05870708</span><span class="p">,</span>  <span class="mf">3.79647248</span><span class="p">,</span>
         <span class="mf">5.41640576</span><span class="p">,</span>  <span class="mf">7.76097693</span><span class="p">,</span> <span class="mf">10.36547258</span><span class="p">,</span> <span class="mf">12.46062129</span><span class="p">,</span> <span class="mf">13.21413969</span><span class="p">,</span>
        <span class="mf">12.26370882</span><span class="p">,</span>  <span class="mf">9.96902213</span><span class="p">,</span>  <span class="mf">7.13610802</span><span class="p">,</span>  <span class="mf">4.45022189</span><span class="p">,</span>  <span class="mf">2.31569068</span><span class="p">,</span>
         <span class="mf">0.94255437</span><span class="p">,</span>  <span class="mf">0.29405596</span><span class="p">,</span>  <span class="mf">0.08664149</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">])}</span>
</pre></div>
</div>
</div>
</div>
<p>The resulting potentials can be visualized as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ff_gen</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">res_phi1</span><span class="p">)</span>
<span class="n">ff_gen</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">res_phi2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/reparameterize_11_0.png" src="../../_images/reparameterize_11_0.png" />
<img alt="../../_images/reparameterize_11_1.png" src="../../_images/reparameterize_11_1.png" />
</div>
</div>
<p>Alternatively, we can construct custom plotting scripts by first checking the contents of the results dictionaries:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_phi1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;dihedral_indices&#39;: [1, 14, 15, 16], &#39;dihedral_angles&#39;: [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130.0, 140.0, 150.0, 160.0, 170.0, 180.0], &#39;mm_scan_kJpermol&#39;: array([ 0.38636858,  0.48247293,  1.27570957,  3.36342458,  6.98809449,
       12.13142224, 18.5303525 , 25.62885098, 32.54192822, 37.58017715,
       31.99637207, 25.07828961, 17.94691688, 11.36067857,  5.91695371,
        2.06323565,  0.07655332,  0.        ,  1.51503683]), &#39;qm_scan_kJpermol&#39;: array([7.68483744, 7.04159003, 5.23524628, 3.25299405, 1.80634375,
       1.14209234, 1.24448683, 1.88248324, 2.57298965, 2.70951563,
       2.2185472 , 1.34950681, 0.50672143, 0.        , 0.13652598,
       1.11846285, 2.99044409, 5.39540176, 6.79216757])}
</pre></div>
</div>
</div>
</div>
<p>And then defining our own plotting routines:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">custom_plot</span><span class="p">(</span><span class="n">res1</span><span class="p">,</span> <span class="n">title1</span><span class="p">,</span> <span class="n">res2</span><span class="p">,</span> <span class="n">title2</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res1</span><span class="p">[</span><span class="s2">&quot;dihedral_angles&quot;</span><span class="p">],</span> <span class="n">res1</span><span class="p">[</span><span class="s2">&quot;qm_scan_kJpermol&quot;</span><span class="p">],</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res1</span><span class="p">[</span><span class="s2">&quot;dihedral_angles&quot;</span><span class="p">],</span> <span class="n">res1</span><span class="p">[</span><span class="s2">&quot;mm_scan_kJpermol&quot;</span><span class="p">],</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s2">&quot;QM&quot;</span><span class="p">,</span> <span class="s2">&quot;MM&quot;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;E in kJ/mol&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Dihedral angle: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">res1</span><span class="p">[</span><span class="s2">&quot;dihedral_indices&quot;</span><span class="p">])))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res2</span><span class="p">[</span><span class="s2">&quot;dihedral_angles&quot;</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="s2">&quot;qm_scan_kJpermol&quot;</span><span class="p">],</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res2</span><span class="p">[</span><span class="s2">&quot;dihedral_angles&quot;</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="s2">&quot;mm_scan_kJpermol&quot;</span><span class="p">],</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Dihedral angle: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">res2</span><span class="p">[</span><span class="s2">&quot;dihedral_indices&quot;</span><span class="p">])))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="n">custom_plot</span><span class="p">(</span><span class="n">res_phi1</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_1$&quot;</span><span class="p">,</span> <span class="n">res_phi2</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_2$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/reparameterize_15_0.png" src="../../_images/reparameterize_15_0.png" />
</div>
</div>
<p>The potential energy surfaces of the original force field is very poor, and we will now improve this by refitting to the QM results.</p>
</section>
<section id="fitting-to-qm-potential">
<h2>Fitting to QM potential<a class="headerlink" href="#fitting-to-qm-potential" title="Permalink to this headline">#</a></h2>
<p>Correct original GAFF force field by fitting to the (full) QM potential;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">target_top_file</span> <span class="o">=</span> <span class="n">original_top_file</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ff_gen</span><span class="o">.</span><span class="n">target_dihedrals</span><span class="p">)):</span>
    <span class="n">target_top_file</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">dihedral_correction</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

<span class="n">res_phi1_fit</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">validate_force_field</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">res_phi2_fit</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">validate_force_field</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">custom_plot</span><span class="p">(</span><span class="n">res_phi1</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_1$, original&quot;</span><span class="p">,</span> <span class="n">res_phi1_fit</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_1$, fitted&quot;</span><span class="p">)</span>
<span class="n">custom_plot</span><span class="p">(</span><span class="n">res_phi2</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_2$, original&quot;</span><span class="p">,</span> <span class="n">res_phi2_fit</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_2$, fitted&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/reparameterize_17_0.png" src="../../_images/reparameterize_17_0.png" />
<img alt="../../_images/reparameterize_17_1.png" src="../../_images/reparameterize_17_1.png" />
</div>
</div>
<p>This leads to substantial improvement, but there are still some discrepancies, in particular for <span class="math notranslate nohighlight">\(\phi_1\)</span>. We will now consider two different improvements on this.</p>
</section>
<section id="weighted-fitting">
<h2>Weighted fitting<a class="headerlink" href="#weighted-fitting" title="Permalink to this headline">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">target_top_file</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">dihedral_correction</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kT</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">target_top_file</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">dihedral_correction</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kT</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="n">res_phi1_fit_imp1</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">validate_force_field</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">res_phi2_fit_imp1</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">validate_force_field</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">custom_plot</span><span class="p">(</span><span class="n">res_phi1_fit</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_1$, fitted&quot;</span><span class="p">,</span> <span class="n">res_phi1_fit_imp1</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_1$, improved&quot;</span><span class="p">)</span>
<span class="n">custom_plot</span><span class="p">(</span><span class="n">res_phi2_fit</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_2$, fitted&quot;</span><span class="p">,</span> <span class="n">res_phi2_fit_imp1</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_2$, improved&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/reparameterize_20_0.png" src="../../_images/reparameterize_20_0.png" />
<img alt="../../_images/reparameterize_20_1.png" src="../../_images/reparameterize_20_1.png" />
</div>
</div>
</section>
<section id="excluding-tricky-angles">
<h2>Excluding tricky angles<a class="headerlink" href="#excluding-tricky-angles" title="Permalink to this headline">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ff_gen</span><span class="o">.</span><span class="n">update_dihedral_range</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">170</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ff_gen</span><span class="o">.</span><span class="n">scan_dih_angles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">([</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">110.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span> <span class="mf">140.0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">,</span> <span class="mf">160.0</span><span class="p">,</span> <span class="mf">170.0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130.0, 140.0, 150.0, 160.0, 170.0]
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ff_gen</span><span class="o">.</span><span class="n">target_dihedrals</span><span class="p">)):</span>
    <span class="n">target_top_file</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">dihedral_correction</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

<span class="n">res_phi1_fit_imp2</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">validate_force_field</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">res_phi2_fit_imp2</span> <span class="o">=</span> <span class="n">ff_gen</span><span class="o">.</span><span class="n">validate_force_field</span><span class="p">(</span><span class="n">target_top_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">custom_plot</span><span class="p">(</span><span class="n">res_phi1_fit</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_1$, fitted&quot;</span><span class="p">,</span> <span class="n">res_phi1_fit_imp2</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_1$, improved&quot;</span><span class="p">)</span>
<span class="n">custom_plot</span><span class="p">(</span><span class="n">res_phi2_fit</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_2$, fitted&quot;</span><span class="p">,</span> <span class="n">res_phi2_fit_imp2</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\phi_2$, improved&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/reparameterize_25_0.png" src="../../_images/reparameterize_25_0.png" />
<img alt="../../_images/reparameterize_25_1.png" src="../../_images/reparameterize_25_1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs/mol_struct"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="forcefields.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Force fields</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="md_setup.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ensembles and time integration</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The eChem team<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>