
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Force fields &#8212; Computational Chemistry from  Laptop to HPC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-TX4YJ1J5XE"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/mol_struct/forcefields';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reparameterize force fields" href="reparameterize.html" />
    <link rel="prev" title="Molecular dynamics" href="md.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../title.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Computational Chemistry from  Laptop to HPC - Home"/>
    <img src="../../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Computational Chemistry from  Laptop to HPC - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro.html">Getting started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics_notebook.html">Using Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../units_notation.html">Units and notation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronic ground states</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/elstruct_gen.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/orbitals.html">Orbitals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/slater.html">Many-electron wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/operators.html">Operators and matrix elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/reduced_density.html">Reduced particle densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/natural_orbitals.html">Natural orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/spin.html">Electron spin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/correlation.html">Electron correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dispersion.html">Dispersion interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/pt.html">Rayleigh–Schrödinger perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/second_quant.html">Second quantization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/group_theory.html">Symmetry</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/wft.html">Wave function theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../elec_struct/hartree-fock.html">Hartree–Fock</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_theory.html">Hartree–Fock theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/fock_diagonalize.html">Fock matrix diagonalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_scf.html">SCF optimization</a></li>

<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_example.html">HF in VeloxChem</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../elec_struct/mp2.html">Møller–Plesset</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/mp2_theory.html">Møller–Plesset partitioning</a></li>


<li class="toctree-l3"><a class="reference internal" href="../elec_struct/mp2_advanced.html">Other partitionings</a></li>


</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/ci.html">Configuration interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/wft_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/dft.html">Density functional theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/hohenberg.html">Hohenberg–Kohn theorems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kohn-sham.html">Kohn–Sham method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kernel_int.html">Kernel integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_scf.html">SCF optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_prop.html">First-order properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/available_xcfun.html">Available XC functionals</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/multiref.html">Multireference methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcscf.html">MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcpdft.html">MC-PDFT</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular structure and dynamics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="molstruct_gen.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="coordinates.html">Choice of coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="symmetry.html">Molecular symmetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="tst.html">Transition-state theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="opt_struct.html">Optimization methods</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="gradients.html">Gradients</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="energy_grad.html">Energy gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="property_grad.html">Property gradients</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="hessians_vib.html">Hessians and vibrations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="hessians.html">Molecular Hessians</a></li>
<li class="toctree-l2"><a class="reference internal" href="vibrations.html">Vibrational analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="opt.html">Structure optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="opt_gs.html">Ground state</a></li>
<li class="toctree-l2"><a class="reference internal" href="opt_constrained.html">Constrained coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="conformer.html">Conformer search</a></li>
<li class="toctree-l2"><a class="reference internal" href="tst_gen.html">Transition state</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="impes.html">PES interpolation techniques</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="impes_calc.html">Constructing the PES by interpolation</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="md.html">Molecular dynamics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Force fields</a></li>


<li class="toctree-l2"><a class="reference internal" href="reparameterize.html">Reparameterize force fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="md_setup.html">Ensembles and time integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="md_run.html">Running a simulation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spectra and properties</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/spectra_aspects.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/resp_external.html">Responses to external fields</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/mol_prop.html">Molecular properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/first_order.html">First-order properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/linear_resp.html">Linear Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/quad_resp.html">Quadratic response</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/cubic_resp.html">Cubic response</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/elec_nuc.html">Electronic and nuclear contributions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/rovib.html">Rovibronic states</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/dipole_equiv.html">Dipole equivalence relations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/finite_field.html">Finite field method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/nto.html">Natural transition orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/selection_rules.html">Selection rules</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/excoupl.html">Exciton coupling model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/excoupl_impl.html">Implementation</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/expt_theory.html">Experiment to theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/uv_vis.html">UV/vis absorption</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/opa.html">One-photon absorption</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tpa.html">Two-photon absorption</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/optact.html">Optical activity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/ecd.html">Electronic Circular Dichroism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/or.html">Optical Rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tpcd.html">Two-photon circular dichroism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tpor.html">Two-photon optical rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/more_optact.html">More birefringences &amp; dichroisms</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/wavefunction.html">Wave function methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/hf.html">Hartree–Fock</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/orb_rot.html">Orbital rotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/kappa_expansion.html">Time-dependence of observables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/orb_param_field.html">Field-dependence of parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/hf_param_energy.html">Energy determination of parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/hf_quasienergy.html">Quasi-energy determination of parameters</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/ci.html">Configuration interaction</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/adc.html">Algebraic-diagrammatic construction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_pp.html">Polarization propagator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_isr.html">Intermediate state representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_cvs.html">Core-valence separation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_hpc.html">HPC-QC implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_exercises_new.html">Exercises</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/tddft.html">Time-dependent DFT</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/tddft_foundation.html">Foundations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_quasienergy.html">Quasi-energy</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/tddft_linear_response.html">Linear response</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_lr_theory.html">Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_lr_implementation.html">Implementation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/tddft_excited_states.html">Excited states</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_rpa.html">RPA equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_tda.html">Tamm–Dancoff approximation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_cvs.html">Core-valence separation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_triplet_inst.html">Triplet instability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_spin_flip.html">Spin-flip</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_charge_transfer.html">Charge transfer</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/mr_response.html">Multireference methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/sa_mcscf.html">State-averaged MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/mr_exercises.html">Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/localprop.html">Localized properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/esp.html">ESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/chelpg.html">CHELPG charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/resp.html">RESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/loprop.html">LoProp charges and polarisabilities</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/embedding.html">Embedding potentials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/nonpol_emb.html">Non-polarizable embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/pol_emb.html">Polarizable embedding</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/mol_struct.html">Molecular structure and dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/struct_vis.html">Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/md_vis.html">MD trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/opt_vib_vis.html">Optimization and normal modes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/elec_struct.html">Electronic structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/orb_vis.html">Orbitals and densities</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/spec_prop.html">Spectra and properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/exc_vis.html">Excited states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/broadening.html">Spectrum broadening</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials and workflows</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/workflow.html">Constructing workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_build.html">Building systems</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_struct.html">Optimizing molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_scf.html">Optimizing electronic structure</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorials/wf_construct.html">Assembling a full workflow</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_methane.html">Methane combustion energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_gwp.html">Global warming potential</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_spectra.html">From structure to spectrum</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/uv_vis.html">UV/vis spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_absorption.html">Absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_fluorescence.html">Fluorescence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/vib_ir.html">Vibrational spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_calc.html">IR spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_raman.html">Raman spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/openshells.html">Open shells</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rest_unrest.html">Restricted versus unrestricted</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/correlation.html">Static versus dynamic correlation correlation</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/xray.html">X-ray spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_calc.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_analysis.html">Spectrum analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_aspects.html">Special aspects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/dire_xps.html">Core-hole localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_large.html">Larger systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_nonstandard.html">Non-standard calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_cheatsheet.html">Cheat sheet</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/colab.html">Google Colab notebooks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite and contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kthpanor/echem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/mol_struct/forcefields.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/mol_struct/forcefields.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Force fields</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Force fields</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bonded-terms">Bonded terms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bond-stretching">Bond stretching</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonic-fit">Harmonic fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anharmonic-fit">Anharmonic fit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#angle-bending">Angle bending</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Harmonic fit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#torsion">Torsion</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#non-bonded-terms">Non-bonded terms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-interactions">van der Waals interactions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#electrostatic-interaction">Electrostatic interaction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-interaction">Van der Waals interaction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-terms">Additional terms</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="force-fields">
<h1>Force fields<a class="headerlink" href="#force-fields" title="Link to this heading">#</a></h1>
<p>In electronic structure theory, the <a class="reference external" href="https://en.wikipedia.org/wiki/Born%E2%80%93Oppenheimer_approximation">Born-Oppenheimer</a> approximation is utilized to separate the Schrödinger equation into electronic and nuclear parts that can be solved separately. The electrons are approximated as responding instantly to any changes in the nuclear coordinates, allowing the electronic distribution to be found around stationary nuclei, after which the problem is solved for the nuclei moving in the effective potential generated by the electrons. <a class="reference external" href="https://en.wikipedia.org/wiki/Molecular_mechanics">Molecular mechanics (MM)</a> takes this one step further and combines nuclei and electrons into a single unit, unsurprisingly referred to as atoms.</p>
<p>The potential energy of the molecular system is determined from the atomic coordinates, using a <a class="reference external" href="https://kthpanor.github.io/echem/docs/mol_struct/forcefields.html">force field</a> to describe the energy associated with changes in bond configurations, Coulombic interactions, dispersion, and more. A simple energy function can look like</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
 E &amp;= E_{\mathrm{bond}} +E_{\mathrm{angle}} +E_{\mathrm{dihedral}} +E_{\mathrm{vdW}} + E_{\mathrm{electrostatic}} \\ &amp;= E_{\mathrm{bonded}} + E_{\mathrm{nonbonded}},
\end{align*}\]</div>
<p>where we make a general distinction between terms associated with atoms bonded to each other, and those that are not. The force field is used to calculate the forces acting on each atom, model the dynamics of the system, and produce trajectories.</p>
<p>The included interactions and the functional form that they take can differ depending on the requirements of the force field, with some focused on describing specific groups of molecules well and some sacrificing accuracy for computational efficiency. Furthermore, the potential energy function of the system has as its variables the atomic coordinates, but it also depends parametrically on how the atoms are bonded and the types of the involved atoms. Creating accurate parameters can be a difficult and time-consuming process, with fittings made either to experimental data or higher level quantum mechanical calculations. A larger number of atom types makes it possible to give a more nuanced description of the interactions in the system, but it also strips away the transferability advantages. With more atom types the number of parameters quickly increases, and with them the likelihood that some of them will have to be created when studying a new system.</p>
<p>We will now consider the construction of force fields, using simple functional forms (primarily harmonic functions), and optimize functional parameter by fitting to quantum mechanical results. Focus will be on ethane, with equilibrium structure and SCF:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">py3Dmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">p3d</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">veloxchem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vlx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bonded-terms">
<h1>Bonded terms<a class="headerlink" href="#bonded-terms" title="Link to this heading">#</a></h1>
<p>The bonded interactions are relatively fast to evaluate, as they are local interactions and thus only affect a few atoms. The main bonded terms include bond stretch, angle bending, and dihedral angle bending, but more complex force field forms are also used. This include cross-terms, which can account for more complicated couplings between atoms, improper torsion, and more.</p>
<section id="bond-stretching">
<h2>Bond stretching<a class="headerlink" href="#bond-stretching" title="Link to this heading">#</a></h2>
<p>Stretching or contracting a bond from its equilibrium position causes the energy of the system to rise.</p>
<figure class="align-default" id="fig-bondstretch">
<a class="reference internal image-reference" href="../../_images/MM_stretch.svg"><img alt="../../_images/MM_stretch.svg" src="../../_images/MM_stretch.svg" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Bond stretching.</span><a class="headerlink" href="#fig-bondstretch" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>This change in energy is approximated by the bond stretch terms, usually represented by a simple harmonic oscillator of the form</p>
<div class="math notranslate nohighlight" id="eq-bond-stretch-harm">
\[
{E_\mathrm{s}} = \frac{k_\text{s}}{2} (l - l_0)^2
\]</div>
<p>Where <span class="math notranslate nohighlight">\(l\)</span> is the bond distance, <span class="math notranslate nohighlight">\(l_0\)</span> the equilibrium length, and <span class="math notranslate nohighlight">\(k_l\)</span> a force constant. Note that both <span class="math notranslate nohighlight">\(l_0\)</span> and <span class="math notranslate nohighlight">\(k_l\)</span> are constants specific to the combination of atom types involved in the interaction, and that <span class="math notranslate nohighlight">\(l_0\)</span> is the distance that minimize the full potential (so not necessarily the molecular equilibrium distance). This harmonic form is incapable of considering bond breaking, and it is only approximately correct for relatively small distortions, but it is often sufficiently accurate for practical calculations.</p>
<p>We will now calculate the B3LYP potential energy surface of CO, and see how different fitted force fields can replicate the reference potential.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will here consider a larger bond distance, in order to more clearly see how different choices of force field fittings affect the general shape of the resulting potential. For practical studies, these large distortions of the CO bond will not be sampled, as 10 kJ/mol corresponds to a temperatuer of about 1200 K. Any regions of the PES above this will thus hardly be sampled for most simulations.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">co_base</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">O       0.0       0.0       0.0</span>
<span class="s2">C         x       0.0       0.0</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">bond_e</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bond_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">bond_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">bond_l</span><span class="p">:</span>
    <span class="c1"># Change C position</span>
    <span class="n">co_tmp</span> <span class="o">=</span> <span class="n">co_base</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
    <span class="n">mol_vlx</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_molecule_string</span><span class="p">(</span><span class="n">co_tmp</span><span class="p">)</span>
    <span class="n">bas_vlx</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mol_vlx</span><span class="p">,</span> <span class="s2">&quot;6-31G&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate B3LYP energy</span>
    <span class="n">scf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
    <span class="n">scf_drv</span><span class="o">.</span><span class="n">xcfun</span> <span class="o">=</span> <span class="s2">&quot;b3lyp&quot;</span>
    <span class="n">scf_results</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">mol_vlx</span><span class="p">,</span> <span class="n">bas_vlx</span><span class="p">)</span>
    <span class="n">bond_e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scf_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">())</span>
    <span class="n">bond_xyz</span> <span class="o">+=</span> <span class="n">mol_vlx</span><span class="o">.</span><span class="n">get_xyz_string</span><span class="p">()</span>

<span class="c1"># index for minimal energy</span>
<span class="n">bond_indx</span> <span class="o">=</span> <span class="n">bond_e</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">bond_e</span><span class="p">))</span>

<span class="c1"># Convert to kJ/mol and calculate the relative energy</span>
<span class="n">bond_e</span> <span class="o">=</span> <span class="mf">2600.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bond_e</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">bond_e</span><span class="p">))</span>
</pre></div>
</div>
<p>Structures and B3LYP potential energy surface:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bond_l</span><span class="p">,</span> <span class="n">bond_e</span><span class="p">,</span> <span class="s2">&quot;o--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bond distance [Å]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy [kJ/mol]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="n">bond_xyz</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">animate</span><span class="p">({</span><span class="s2">&quot;loop&quot;</span><span class="p">:</span> <span class="s2">&quot;backAndForth&quot;</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s2">&quot;stick&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;sphere&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d0340dd419eec06e8d884a6f185ebfbd032de2c7573b0f10ba99ad5eb36d916c.png" src="../../_images/d0340dd419eec06e8d884a6f185ebfbd032de2c7573b0f10ba99ad5eb36d916c.png" />
<div class="output text_html"><div id="3dmolviewer_1739455562128594"  style="position: relative; width: 550px; height: 300px;">
        <p id="3dmolwarning_1739455562128594" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.2/3Dmol-min.js');
}

var viewer_1739455562128594 = null;
var warn = document.getElementById("3dmolwarning_1739455562128594");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1739455562128594 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1739455562128594"),{backgroundColor:"white"});
viewer_1739455562128594.zoomTo();
	viewer_1739455562128594.setViewStyle({"style": "outline", "color": "black", "width": 0.1});
	viewer_1739455562128594.addModelsAsFrames("2\n*\nO       0.0       0.0       0.0\nC         1.05       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.06       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.07       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.08       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.09       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.1       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.11       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.12       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.1300000000000001       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.1400000000000001       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.1500000000000001       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.1600000000000001       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.1700000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.1800000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.1900000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2000000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2100000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2200000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2300000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2400000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2500000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2600000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2700000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2800000000000002       0.0       0.0\n2\n*\nO       0.0       0.0       0.0\nC         1.2900000000000003       0.0       0.0\n");
	viewer_1739455562128594.animate({"loop": "backAndForth"});
	viewer_1739455562128594.setStyle({"stick": {}, "sphere": {"scale": 0.25}});
viewer_1739455562128594.render();
});
</script></div></div>
</div>
<section id="harmonic-fit">
<h3>Harmonic fit<a class="headerlink" href="#harmonic-fit" title="Link to this heading">#</a></h3>
<p>This will now be fitted using the using three different approaches:</p>
<ol class="arabic simple">
<li><p>Using the full energy curve,</p></li>
<li><p>Using an interval symmetric around the minima in terms of <strong>distance</strong>,</p></li>
<li><p>Using an interval symmetric around the minima in terms of <strong>energy</strong>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function to be fitted to</span>
<span class="k">def</span><span class="w"> </span><span class="nf">harm_func</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l0</span><span class="p">,</span> <span class="n">ks</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ks</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">l0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>


<span class="c1"># Feed with equilibrium distance and a stiff force constant</span>
<span class="c1"># Fit the full curve</span>
<span class="n">opt_harm1</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">harm_func</span><span class="p">,</span> <span class="n">bond_l</span><span class="p">,</span> <span class="n">bond_e</span><span class="p">,</span> <span class="p">[</span><span class="n">bond_l</span><span class="p">[</span><span class="n">bond_indx</span><span class="p">],</span> <span class="mi">1000</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;l_0 / k_s from fit #1: </span><span class="si">{:04.3f}</span><span class="s2"> / </span><span class="si">{:06.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">opt_harm1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_harm1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># fitting for minima +/-0.025 Å</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bond_l</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">bond_l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">bond_l</span><span class="p">[</span><span class="n">bond_indx</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.025</span><span class="p">:</span>
        <span class="n">i_min_d</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">if</span> <span class="n">bond_l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">bond_l</span><span class="p">[</span><span class="n">bond_indx</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.025</span><span class="p">:</span>
        <span class="n">i_max_d</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">opt_harm2</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
    <span class="n">harm_func</span><span class="p">,</span>
    <span class="n">bond_l</span><span class="p">[</span><span class="n">i_min_d</span><span class="p">:</span><span class="n">i_max_d</span><span class="p">],</span>
    <span class="n">bond_e</span><span class="p">[</span><span class="n">i_min_d</span><span class="p">:</span><span class="n">i_max_d</span><span class="p">],</span>
    <span class="p">[</span><span class="n">bond_l</span><span class="p">[</span><span class="n">bond_indx</span><span class="p">],</span> <span class="mi">1000</span><span class="p">],</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;l_0 / k_s from fit #2: </span><span class="si">{:04.3f}</span><span class="s2"> / </span><span class="si">{:06.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">opt_harm2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_harm2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Fit around the minimum +10 kJ/mol</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bond_e</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">bond_e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">10.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">bond_indx</span><span class="p">):</span>
        <span class="n">i_min_e</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">bond_e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">10.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">bond_indx</span><span class="p">):</span>
        <span class="n">i_max_e</span> <span class="o">=</span> <span class="n">i</span>
<span class="n">opt_harm3</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
    <span class="n">harm_func</span><span class="p">,</span>
    <span class="n">bond_l</span><span class="p">[</span><span class="n">i_min_e</span><span class="p">:</span><span class="n">i_max_e</span><span class="p">],</span>
    <span class="n">bond_e</span><span class="p">[</span><span class="n">i_min_e</span><span class="p">:</span><span class="n">i_max_e</span><span class="p">],</span>
    <span class="p">[</span><span class="n">bond_l</span><span class="p">[</span><span class="n">bond_indx</span><span class="p">],</span> <span class="mi">1000</span><span class="p">],</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;l_0 / k_s from fit #3: </span><span class="si">{:04.3f}</span><span class="s2"> Å / </span><span class="si">{:06.1f}</span><span class="s2"> kJ/mol/Å&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">opt_harm3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_harm3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B3LYP bond distance: </span><span class="si">{:04.3f}</span><span class="s2"> Å&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bond_l</span><span class="p">[</span><span class="n">bond_indx</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.06</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">bond_l</span><span class="p">,</span> <span class="n">bond_e</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># splined B3LYP results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">harm_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">opt_harm1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_harm1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">harm_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">opt_harm2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_harm2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">harm_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">opt_harm3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_harm3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.275</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;Distance symm.&quot;</span><span class="p">,</span> <span class="s2">&quot;Energy symm.&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bond distance [Å]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy [kJ/mol]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l_0 / k_s from fit #1: 1.167 / 9888.5
l_0 / k_s from fit #2: 1.157 / 10094.0
l_0 / k_s from fit #3: 1.158 Å / 10536.4 kJ/mol/Å
B3LYP bond distance: 1.160 Å
</pre></div>
</div>
<img alt="../../_images/8dd47150c91b2b08ce8d05292a5927fa5cf370c89e5f10d722b114a6b2f62b38.png" src="../../_images/8dd47150c91b2b08ce8d05292a5927fa5cf370c89e5f10d722b114a6b2f62b38.png" />
</div>
</div>
<p>It is clear that using the full SCF curve we calculated yield unrealistic fits, as it puts weight on parts of the PES that will no be sampled by most dynamics. Using fits with intervals symmetric in either energy or bond distance yield similar results, especially within the region of most interest (<span class="math notranslate nohighlight">\(&lt;10\)</span> kJ/mol).</p>
</section>
<section id="anharmonic-fit">
<h3>Anharmonic fit<a class="headerlink" href="#anharmonic-fit" title="Link to this heading">#</a></h3>
<p>Generally, contracting a bond produces a steeper rise in energy than stretching it. This is accounted for in some force fields, for example by introducing anharmonicity into the bond energy expression by including higher order terms based on the <a class="reference external" href="https://en.wikipedia.org/wiki/Morse_potential">Morse potential</a>, which takes the form.</p>
<div class="math notranslate nohighlight">
\[
V_{\mathrm{Morse}}(r) = D_e \left( 1 - e^{-\alpha (r -r_0)^2} \right)
\]</div>
<p>Where <span class="math notranslate nohighlight">\(D_e\)</span> is the depth of the potential well, <span class="math notranslate nohighlight">\(\alpha\)</span> the width, and <span class="math notranslate nohighlight">\(r_0\)</span> the location of the minima. This form provides an improved description, in particular over larger bond deviations in which anharmonicity becomes substantial.</p>
</section>
</section>
<section id="angle-bending">
<h2>Angle bending<a class="headerlink" href="#angle-bending" title="Link to this heading">#</a></h2>
<p>Distorting an angle formed between two atoms bound to a common third atom from its equilibrium also causes the energy of the system to rise:</p>
<figure class="align-default" id="fig-mm-bend">
<a class="reference internal image-reference" href="../../_images/MM_bend.svg"><img alt="../../_images/MM_bend.svg" src="../../_images/MM_bend.svg" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Angle bending.</span><a class="headerlink" href="#fig-mm-bend" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>This can again be most easily be described by a harmonic function:</p>
<div class="math notranslate nohighlight">
\[
E_{\theta} = \frac{k_{\theta}}{2} \left( \theta - \theta_0 \right)^2
\]</div>
<p>Here <span class="math notranslate nohighlight">\(\theta\)</span> is the bond angle, <span class="math notranslate nohighlight">\(\theta_0\)</span> the equilibrium bond angle, and <span class="math notranslate nohighlight">\(k_{\theta}\)</span> a force constant. This form is again overly simplistic for large distortions, but sufficiently good for many practical considerations.</p>
<p>Scanning over bond lengths and angles are then achieved by introducing constraints in geometry optimizations, in order to get structures and energies along the scans. We here perform the fitting for the bond angle of water. As a scan creates output files which are then to be read, we instead “scan” one angle at a time and save the results. Constraining an angle is done with <code class="docutils literal notranslate"><span class="pre">opt_drv.constraints</span> <span class="pre">=</span> <span class="pre">[&quot;scan</span> <span class="pre">angle</span> <span class="pre">2</span> <span class="pre">1</span> <span class="pre">3</span> <span class="pre">60</span> <span class="pre">180</span> <span class="pre">24&quot;]</span></code>.</p>
<blockquote>
<div><p>Here the angle is defined by three atom indices (2, 1, and 3). Then, we need to specify the starting angle (60 deg), the final angle (180 deg) and the total number of angles we would like to scan over (24).</p>
</div></blockquote>
<blockquote>
<div><p><em>Note:</em> Running this notebook will produce a number of temporary <code class="docutils literal notranslate"><span class="pre">.hd5</span></code>, <code class="docutils literal notranslate"><span class="pre">.pdb</span></code>, <code class="docutils literal notranslate"><span class="pre">.xyz</span></code>, and <code class="docutils literal notranslate"><span class="pre">.txt</span></code> files. They contain information on optimization settings, iterations, and more, and can safely be discarded.</p>
</div></blockquote>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the molecule and basis set</span>
<span class="n">water_mol_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">O       0.0000000000     0.0000000000     0.1178336003</span>
<span class="s2">H      -0.7595754146    -0.0000000000    -0.4713344012</span>
<span class="s2">H       0.7595754146     0.0000000000    -0.4713344012</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Create veloxchem mol and basis objects</span>
<span class="n">mol_vlx</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_molecule_string</span><span class="p">(</span><span class="n">water_mol_str</span><span class="p">)</span>
<span class="n">bas_vlx</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mol_vlx</span><span class="p">,</span> <span class="s2">&quot;6-31G&quot;</span><span class="p">)</span>

<span class="n">scf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">scf_drv</span><span class="o">.</span><span class="n">xcfun</span> <span class="o">=</span> <span class="s2">&quot;b3lyp&quot;</span>
<span class="n">scf_results</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">mol_vlx</span><span class="p">,</span> <span class="n">bas_vlx</span><span class="p">)</span>

<span class="c1"># Set up the gradient and optimization dirvers:</span>
<span class="n">grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">(</span><span class="n">scf_drv</span><span class="p">)</span>
<span class="n">opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">grad_drv</span><span class="p">)</span>

<span class="c1"># Define the constraints: scan angle atom1 atom2 atom3 </span>
<span class="c1"># start_angle stop_angle number_of_angles</span>
<span class="n">opt_drv</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scan angle 2 1 3 60 180 24&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Kohn-Sham                                            
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                   Exchange-Correlation Functional : B3LYP                                                                
                   Molecular Grid Level            : 4                                                                    
                                                                                                                          
* Info * Nuclear repulsion energy: 9.1561447194 a.u.                                                                      
                                                                                                                          
* Info * Using the B3LYP functional and the Libxc library (v7.0.0).                                                       
                                                                                                                          
         P. J. Stephens, F. J. Devlin, C. F. Chabalowski, and M. J. Frisch.,  J. Phys. Chem. 98, 11623 (1994)
                                                                                                                          
         S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
                                                                                                                          
* Info * Molecular grid with 40792 points generated in 0.01 sec.                                                          
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -75.983870205310 a.u. Time: 0.01 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. |    Kohn-Sham Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -76.384872592259    0.0000000000      0.05814060      0.01079184      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -76.384686594376    0.0001859979      0.07420221      0.01375784      0.03127402                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -76.385180742153   -0.0004941478      0.00038519      0.00008834      0.01650959                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -76.385180774173   -0.0000000320      0.00007657      0.00002027      0.00029092                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -76.385180774932   -0.0000000008      0.00000194      0.00000051      0.00002929                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -76.385180774934   -0.0000000000      0.00000014      0.00000003      0.00000214                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 6 iterations. Time: 0.11 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Kohn-Sham:                                                                                 
               --------------------------                                                                                 
               Total Energy                       :      -76.3851807749 a.u.                                              
               Electronic Energy                  :      -85.5413254944 a.u.                                              
               Nuclear Repulsion Energy           :        9.1561447194 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000001389 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1                                                                         
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -19.13379 a.u.                                                                  
               (   1 O   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.01751 a.u.                                                                  
               (   1 O   1s  :     0.21) (   1 O   2s  :    -0.46) (   1 O   3s  :    -0.45)                              
               (   1 O   1p0 :     0.15) (   2 H   1s  :    -0.15) (   3 H   1s  :    -0.15)                              
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.52917 a.u.                                                                  
               (   1 O   1p+1:     0.52) (   1 O   2p+1:     0.23) (   2 H   1s  :    -0.27)                              
               (   2 H   2s  :    -0.15) (   3 H   1s  :     0.27) (   3 H   2s  :     0.15)                              
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.35661 a.u.                                                                  
               (   1 O   2s  :     0.20) (   1 O   3s  :     0.37) (   1 O   1p0 :     0.54)                              
               (   1 O   2p0 :     0.38)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.29214 a.u.                                                                  
               (   1 O   1p-1:     0.65) (   1 O   2p-1:     0.50)                                                        
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.05639 a.u.                                                                  
               (   1 O   2s  :    -0.15) (   1 O   3s  :    -1.09) (   1 O   1p0 :     0.29)                              
               (   1 O   2p0 :     0.44) (   2 H   2s  :     0.94) (   3 H   2s  :     0.94)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.14625 a.u.                                                                  
               (   1 O   1p+1:    -0.42) (   1 O   2p+1:    -0.75) (   2 H   2s  :    -1.28)                              
               (   3 H   2s  :     1.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.80982 a.u.                                                                  
               (   1 O   1p+1:     0.20) (   1 O   2p+1:     0.53) (   2 H   1s  :     0.97)                              
               (   2 H   2s  :    -0.67) (   3 H   1s  :    -0.97) (   3 H   2s  :     0.67)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.87513 a.u.                                                                  
               (   1 O   2s  :     0.18) (   1 O   3s  :    -0.28) (   1 O   1p0 :    -0.78)                              
               (   1 O   2p0 :     0.50) (   2 H   1s  :    -0.71) (   2 H   2s  :     0.59)                              
               (   3 H   1s  :    -0.71) (   3 H   2s  :     0.59)                                                        
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.88918 a.u.                                                                  
               (   1 O   1p-1:    -0.96) (   1 O   2p-1:     1.04)                                                        
                                                                                                                          
                                                                                                                          
                                                Ground State Dipole Moment                                                
                                               ----------------------------                                               
                                                                                                                          
                                   X   :        -0.000000 a.u.        -0.000000 Debye                                     
                                   Y   :         0.000000 a.u.         0.000000 Debye                                     
                                   Z   :        -0.968145 a.u.        -2.460780 Debye                                     
                                 Total :         0.968145 a.u.         2.460780 Debye                                     
                                                                                                                          
</pre></div>
</div>
</div>
</details>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the scan and save the results</span>
<span class="n">opt_results</span> <span class="o">=</span> <span class="n">opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">mol_vlx</span><span class="p">,</span> <span class="n">bas_vlx</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scan_energies</span> <span class="o">=</span> <span class="n">opt_results</span><span class="p">[</span><span class="s1">&#39;scan_energies&#39;</span><span class="p">]</span>
<span class="n">scan_geometries</span> <span class="o">=</span> <span class="n">opt_results</span><span class="p">[</span><span class="s1">&#39;scan_geometries&#39;</span><span class="p">]</span>

<span class="c1"># Transform to kJ/mol and calculte the relative energy</span>
<span class="n">angle_e</span> <span class="o">=</span> <span class="mi">2600</span> <span class="o">*</span> <span class="p">(</span> <span class="n">scan_energies</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">scan_energies</span><span class="p">)</span> <span class="p">)</span>

<span class="n">angle_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">angle_a</span><span class="p">,</span> <span class="n">angle_e</span><span class="p">,</span> <span class="s2">&quot;o--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bond angle&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy [kJ/mol]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">vlx2py3d</span><span class="p">(</span><span class="n">geometries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Converts the array of xyz coordinates from a scan to</span>
<span class="sd">        a string which can be read py py3Dmol.</span>

<span class="sd">        :param geometries: the scan geometries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">geometry</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">:</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="n">geometry</span>
    <span class="k">return</span> <span class="n">txt</span>

<span class="n">structure</span> <span class="o">=</span> <span class="n">vlx2py3d</span><span class="p">(</span><span class="n">scan_geometries</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">animate</span><span class="p">({</span><span class="s2">&quot;loop&quot;</span><span class="p">:</span> <span class="s2">&quot;backAndFirth&quot;</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s2">&quot;stick&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;sphere&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9134ff54f815a97071a8a127bd1bb51a3f4d20acd5755ba5a38bb4717608b445.png" src="../../_images/9134ff54f815a97071a8a127bd1bb51a3f4d20acd5755ba5a38bb4717608b445.png" />
<div class="output text_html"><div id="3dmolviewer_1739455562408562"  style="position: relative; width: 550px; height: 300px;">
        <p id="3dmolwarning_1739455562408562" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.2/3Dmol-min.js');
}

var viewer_1739455562408562 = null;
var warn = document.getElementById("3dmolwarning_1739455562408562");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1739455562408562 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1739455562408562"),{backgroundColor:"white"});
viewer_1739455562408562.zoomTo();
	viewer_1739455562408562.setViewStyle({"style": "outline", "color": "black", "width": 0.1});
	viewer_1739455562408562.addModelsAsFrames("3\n\nO             -0.000000003853         0.000000000017         0.326287724553\nH             -0.520682524450         0.000000000230        -0.575560859493\nH              0.520682520056         0.000000001104        -0.575560857709\n3\n\nO             -0.000000002030        -0.000000001085         0.302823125664\nH             -0.554431902544         0.000000001108        -0.563828069202\nH              0.554431904107         0.000000001792        -0.563828065562\n3\n\nO              0.000000001100        -0.000000001186         0.279989639508\nH             -0.587572441359        -0.000000002490        -0.552410872691\nH              0.587572443650         0.000000001265        -0.552410872639\n3\n\nO              0.000000000983         0.000000001317         0.257241374714\nH             -0.619790039917         0.000000001838        -0.541036369862\nH              0.619790040794         0.000000001228        -0.541036370760\n3\n\nO              0.000000003026         0.000000003004         0.234259792552\nH             -0.650849125703         0.000000005618        -0.529545406221\nH              0.650849129974         0.000000005582        -0.529545407662\n3\n\nO              0.000000003573         0.000000004157         0.210908374227\nH             -0.680630792757         0.000000005483        -0.517869253713\nH              0.680630794466         0.000000007122        -0.517869258720\n3\n\nO              0.000000003728         0.000000006179         0.187106290812\nH             -0.709034405575         0.000000010937        -0.505967813674\nH              0.709034412738         0.000000007226        -0.505967813942\n3\n\nO              0.000000005165         0.000000007661         0.162801995557\nH             -0.735958651394         0.000000011105        -0.493815421876\nH              0.735958662518         0.000000007896        -0.493815420917\n3\n\nO              0.000000002616         0.000000006943         0.137997472547\nH             -0.761357760291         0.000000009508        -0.481413015878\nH              0.761357770543         0.000000005205        -0.481413009745\n3\n\nO              0.000000002551         0.000000008702         0.112659734124\nH             -0.785099074287         0.000000012848        -0.468744141679\nH              0.785099083874         0.000000002083        -0.468744135658\n3\n\nO              0.000000002522         0.000000007525         0.086825563526\nH             -0.807155583477         0.000000014840        -0.455827249580\nH              0.807155593795        -0.000000002446        -0.455827241925\n3\n\nO              0.000000002030         0.000000005169         0.060524958359\nH             -0.827480986017         0.000000016346        -0.442677383165\nH              0.827480994915        -0.000000008710        -0.442677375192\n3\n\nO              0.000000001502         0.000000006278         0.033780328451\nH             -0.845996478177         0.000000018797        -0.429305783736\nH              0.845996485465        -0.000000009195        -0.429305775854\n3\n\nO             -0.000000000222         0.000000004551         0.006636441442\nH             -0.862664045728         0.000000017792        -0.415734830888\nH              0.862664052553        -0.000000011641        -0.415734816060\n3\n\nO             -0.000000001560         0.000000006005        -0.020848487262\nH             -0.877484018932         0.000000019406        -0.401993590243\nH              0.877484021450        -0.000000010564        -0.401993577158\n3\n\nO             -0.000000001483         0.000000004002        -0.048626482165\nH             -0.890427874560         0.000000018042        -0.388105989515\nH              0.890427878609        -0.000000012603        -0.388105970875\n3\n\nO              0.000000000838         0.000000001195        -0.076624726895\nH             -0.901574137085         0.000000012830        -0.374108948890\nH              0.901574144526        -0.000000012615        -0.374108931430\n3\n\nO              0.000000001487         0.000000002805        -0.104777150189\nH             -0.911023686166         0.000000012921        -0.360034026519\nH              0.911023694329        -0.000000008882        -0.360034008124\n3\n\nO              0.000000000677         0.000000003844        -0.133031258543\nH             -0.918889069256         0.000000016132        -0.345908108752\nH              0.918889074847        -0.000000009746        -0.345908090336\n3\n\nO              0.000000000210         0.000000004340        -0.161356937303\nH             -0.925214244382         0.000000017593        -0.331746192026\nH              0.925214248194        -0.000000009891        -0.331746173859\n3\n\nO              0.000000002010         0.000000002236        -0.189726537033\nH             -0.930072598094         0.000000017070        -0.317562082576\nH              0.930072604587        -0.000000009964        -0.317562064744\n3\n\nO              0.000000003711         0.000000002708        -0.218110242347\nH             -0.933515302649         0.000000020995        -0.303371860253\nH              0.933515311276        -0.000000004887        -0.303371846662\n3\n\nO              0.000000004062         0.000000005767        -0.246506867401\nH             -0.935583665653         0.000000008760        -0.289174320483\nH              0.935583674605         0.000000006320        -0.289174302464\n3\n\nO              0.000000004861         0.000000006977        -0.274924293209\nH             -0.936276013670         0.000000015953        -0.274965736672\nH              0.936276023403        -0.000000000052        -0.274965723067\n");
	viewer_1739455562408562.animate({"loop": "backAndFirth"});
	viewer_1739455562408562.setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewer_1739455562408562.rotate(-90,"x");
viewer_1739455562408562.render();
});
</script></div></div>
</div>
<section id="id1">
<h3>Harmonic fit<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Now we will fit the potential energy curve using a a harmonic function and focusing on an interval with equal energy end-points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle_indx</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Fit around the minimum +20 kJ/mol</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">angle_e</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">angle_e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">20.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">angle_indx</span><span class="p">):</span>
        <span class="n">i_min_a</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">angle_e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">20.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">angle_indx</span><span class="p">):</span>
        <span class="n">i_max_a</span> <span class="o">=</span> <span class="n">i</span>
<span class="n">opt_harm_angle</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
    <span class="n">harm_func</span><span class="p">,</span> <span class="n">angle_a</span><span class="p">[</span><span class="n">i_min_a</span><span class="p">:</span><span class="n">i_max_a</span><span class="p">],</span> <span class="n">angle_e</span><span class="p">[</span><span class="n">i_min_a</span><span class="p">:</span><span class="n">i_max_a</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;l_0 / k_s from fit: </span><span class="si">{:04.3f}</span><span class="s2"> / </span><span class="si">{:7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">opt_harm_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_harm_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B3LYP angle: </span><span class="si">{:04.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">angle_a</span><span class="p">[</span><span class="n">angle_indx</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">angle_a</span><span class="p">,</span> <span class="n">angle_e</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># Plot spline B3LYP results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">harm_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">opt_harm_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opt_harm_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="s2">&quot;Harmonic fit&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Angle&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy [kJ/mol]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l_0 / k_s from fit: 108.814 / 0.126546
B3LYP angle: 110.0
</pre></div>
</div>
<img alt="../../_images/8adc125eb29d7ad33aec4964739111a0a5ee291b2ec88166655c65269ea7ef0b.png" src="../../_images/8adc125eb29d7ad33aec4964739111a0a5ee291b2ec88166655c65269ea7ef0b.png" />
</div>
</div>
<p>The real angle bending interaction is clearly not a harmonic oscillator, as exemplified by the potential energy curve in below Figure, showing the change in energy when distorting the H-O-H angle found in water. Compressing the angle causes the two hydrogen atoms to come close together, leading to a steep curve near <span class="math notranslate nohighlight">\(\theta = 0^\circ\)</span>, while increasing the angle leads to a cusp at <span class="math notranslate nohighlight">\(\theta = 180^\circ\)</span> due to symmetry. Again, some force fields account for this anharmonicity with additional terms, such as the angle bending term:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\begin{split}
{E_\theta} = \frac{k_\theta}{2} (\theta - \theta_0)^2 \bigl( 1 &amp;- \alpha (\theta - \theta_0) + \beta (\theta - \theta_0)^2  \\
 &amp; - \gamma (\theta - \theta_0)^3 + \delta (\theta - \theta_0)^4 \bigr)
\end{split}
\end{equation*} \]</div>
<p>where the constants have been fitted to experimental data but are the same for all bending interactions. This gives a better agreement with the actual angle bending behaviour, but again, for lower temperatures the harmonic oscillator is still a valid and computationally efficient approximation.</p>
</section>
</section>
<section id="torsion">
<h2>Torsion<a class="headerlink" href="#torsion" title="Link to this heading">#</a></h2>
<p>When two atoms are bonded to atoms on opposite sides of a central bond, as for the opposing hydrogen atoms in ethane, then twisting these around the central bond can cause a change in the potential energy. The torsional energy is thus a function of the dihedral angle, <span class="math notranslate nohighlight">\(\omega\)</span>, formed between the first and fourth atom, while looking through the bond between the second and third atoms:</p>
<figure class="align-default" id="fig-mm-torsion">
<a class="reference internal image-reference" href="../../_images/MM_torsion.svg"><img alt="../../_images/MM_torsion.svg" src="../../_images/MM_torsion.svg" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Torsion.</span><a class="headerlink" href="#fig-mm-torsion" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The torsion energy term is usually expressed in terms of a Fourier expansion of the form</p>
<div class="math notranslate nohighlight">
\[
{E_\omega} = k_\omega \left(1 + \cos(n\omega -\delta)\right)
\]</div>
<p>where <span class="math notranslate nohighlight">\(k_\omega\)</span> is a force constant, <span class="math notranslate nohighlight">\(n\)</span> is the periodicity and <span class="math notranslate nohighlight">\(\delta\)</span> is a phase shift. Typically, several such terms are included for each set of four atoms in order to combine different multiplicities. The MM3 force field always includes terms of multiplicity 1, 2 and 3, with <span class="math notranslate nohighlight">\(\delta\)</span> set to zero for each, while the CHARMM force field allows a more varied combination of terms.</p>
<p>It should be noted that the torsional energy of the force field does not come from a single interaction in this case, but several. It is easy to see that torsional interactions can quickly become very complicated when there are many atom types involved. This is further complicated by the fact that most force field also include non-bonded interactions between atoms separated by more than two bonds, meaning that the true rotational barrier will be a sum of all torsional and non-bonded interactions. For calculations where both the conformations themselves as well as the transitions between them are important, it is necessary to recreate the full potential energy curve and not just focus on the regions around the minima, as was done for bond stretching and angle bending terms.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the molecule and basis set</span>
<span class="n">ethane_mol_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C       0.0000000000     0.0000000000     0.7616375820</span>
<span class="s2">C       0.0000000000     0.0000000000    -0.7616375820</span>
<span class="s2">H       1.0145603421     0.0000000000     1.1557300969</span>
<span class="s2">H      -0.5072801711    -0.8786350299     1.1557300969</span>
<span class="s2">H      -0.5072801711     0.8786350299     1.1557300969</span>
<span class="s2">H       0.5072801711    -0.8786350299    -1.1557300969</span>
<span class="s2">H       0.5072801711     0.8786350299    -1.1557300969</span>
<span class="s2">H      -1.0145603421    -0.0000000000    -1.1557300969</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Create veloxchem mol and basis objects</span>
<span class="n">mol_vlx</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_molecule_string</span><span class="p">(</span><span class="n">ethane_mol_str</span><span class="p">)</span>
<span class="n">bas_vlx</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mol_vlx</span><span class="p">,</span> <span class="s2">&quot;STO-3G&quot;</span><span class="p">)</span>

<span class="n">scf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">scf_results</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">mol_vlx</span><span class="p">,</span> <span class="n">bas_vlx</span><span class="p">)</span>

<span class="c1"># Set up the gradient and optimization dirvers:</span>
<span class="n">grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">(</span><span class="n">scf_drv</span><span class="p">)</span>
<span class="n">opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">grad_drv</span><span class="p">)</span>

<span class="c1"># Set up the constraints: scan dihedral atom1 atom2 atom3 atom4</span>
<span class="c1"># start_dihedral stop_dihedral number_of_dihedrals</span>
<span class="n">opt_drv</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scan dihedral 3 1 2 6 0 60 13&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 42.3718802228 a.u.                                                                     
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.01 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * ...done. SCF energy in reduced basis set: -78.305954692119 a.u. Time: 0.03 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.01 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -78.305954700854    0.0000000000      0.00003950      0.00000731      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -78.305954701202   -0.0000000003      0.00000313      0.00000059      0.00002844                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -78.305954701204   -0.0000000000      0.00000063      0.00000014      0.00000205                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 3 iterations. Time: 0.03 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :      -78.3059547012 a.u.                                              
               Electronic Energy                  :     -120.6778349240 a.u.                                              
               Nuclear Repulsion Energy           :       42.3718802228 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000006270 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1                                                                         
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.57174 a.u.                                                                  
               (   1 C   1p+1:    -0.40) (   2 C   1p+1:    -0.40) (   3 H   1s  :    -0.31)                              
               (   4 H   1s  :     0.16) (   5 H   1s  :     0.16) (   6 H   1s  :    -0.16)                              
               (   7 H   1s  :    -0.16) (   8 H   1s  :     0.31)                                                        
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.57174 a.u.                                                                  
               (   1 C   1p-1:     0.40) (   2 C   1p-1:     0.40) (   4 H   1s  :    -0.27)                              
               (   5 H   1s  :     0.27) (   6 H   1s  :    -0.27) (   7 H   1s  :     0.27)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.47749 a.u.                                                                  
               (   1 C   1p0 :    -0.54) (   2 C   1p0 :     0.54)                                                        
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.45750 a.u.                                                                  
               (   1 C   1p+1:    -0.41) (   2 C   1p+1:     0.41) (   3 H   1s  :    -0.39)                              
               (   4 H   1s  :     0.20) (   5 H   1s  :     0.20) (   6 H   1s  :     0.20)                              
               (   7 H   1s  :     0.20) (   8 H   1s  :    -0.39)                                                        
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.45750 a.u.                                                                  
               (   1 C   1p-1:     0.41) (   2 C   1p-1:    -0.41) (   4 H   1s  :    -0.34)                              
               (   5 H   1s  :     0.34) (   6 H   1s  :     0.34) (   7 H   1s  :    -0.34)                              
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.64857 a.u.                                                                  
               (   1 C   1p-1:     0.72) (   2 C   1p-1:     0.72) (   4 H   1s  :     0.62)                              
               (   5 H   1s  :    -0.62) (   6 H   1s  :     0.62) (   7 H   1s  :    -0.62)                              
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.64857 a.u.                                                                  
               (   1 C   1p+1:     0.72) (   2 C   1p+1:     0.72) (   3 H   1s  :    -0.72)                              
               (   4 H   1s  :     0.36) (   5 H   1s  :     0.36) (   6 H   1s  :    -0.36)                              
               (   7 H   1s  :    -0.36) (   8 H   1s  :     0.72)                                                        
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.70241 a.u.                                                                  
               (   1 C   2s  :     0.55) (   1 C   1p0 :    -1.00) (   2 C   2s  :    -0.55)                              
               (   2 C   1p0 :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.73866 a.u.                                                                  
               (   1 C   2s  :    -0.97) (   1 C   1p0 :    -0.45) (   2 C   2s  :    -0.97)                              
               (   2 C   1p0 :     0.45) (   3 H   1s  :     0.52) (   4 H   1s  :     0.52)                              
               (   5 H   1s  :     0.52) (   6 H   1s  :     0.52) (   7 H   1s  :     0.52)                              
               (   8 H   1s  :     0.52)                                                                                  
                                                                                                                          
               Molecular Orbital No.  14:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.78040 a.u.                                                                  
               (   1 C   1s  :     0.18) (   1 C   2s  :    -1.15) (   1 C   1p0 :    -0.18)                              
               (   2 C   1s  :    -0.18) (   2 C   2s  :     1.15) (   2 C   1p0 :    -0.18)                              
               (   3 H   1s  :     0.54) (   4 H   1s  :     0.54) (   5 H   1s  :     0.54)                              
               (   6 H   1s  :    -0.54) (   7 H   1s  :    -0.54) (   8 H   1s  :    -0.54)                              
                                                                                                                          
                                                                                                                          
                                                Ground State Dipole Moment                                                
                                               ----------------------------                                               
                                                                                                                          
                                   X   :        -0.000000 a.u.        -0.000000 Debye                                     
                                   Y   :         0.000000 a.u.         0.000000 Debye                                     
                                   Z   :        -0.000000 a.u.        -0.000000 Debye                                     
                                 Total :         0.000000 a.u.         0.000000 Debye                                     
                                                                                                                          
</pre></div>
</div>
</div>
</details>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the scan</span>
<span class="n">opt_results</span> <span class="o">=</span> <span class="n">opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">mol_vlx</span><span class="p">,</span> <span class="n">bas_vlx</span><span class="p">)</span>
<span class="n">scan_energies</span> <span class="o">=</span> <span class="n">opt_results</span><span class="p">[</span><span class="s1">&#39;scan_energies&#39;</span><span class="p">]</span>
<span class="n">scan_geometries</span> <span class="o">=</span> <span class="n">opt_results</span><span class="p">[</span><span class="s1">&#39;scan_geometries&#39;</span><span class="p">]</span>
<span class="n">dihed_e</span> <span class="o">=</span> <span class="mi">2600</span> <span class="o">*</span> <span class="p">(</span> <span class="n">scan_energies</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">scan_energies</span><span class="p">)</span> <span class="p">)</span>
<span class="n">dihed_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dihed_a</span><span class="p">,</span> <span class="n">dihed_e</span><span class="p">,</span> <span class="s2">&quot;o--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1f77b4&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">dihed_a</span><span class="p">,</span> <span class="n">dihed_e</span><span class="p">,</span> <span class="s2">&quot;o--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1f77b4&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Dihedral angle&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy [kJ/mol]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">structure</span> <span class="o">=</span> <span class="n">vlx2py3d</span><span class="p">(</span><span class="n">scan_geometries</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">animate</span><span class="p">({</span><span class="s2">&quot;loop&quot;</span><span class="p">:</span> <span class="s2">&quot;backAndForth&quot;</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s2">&quot;stick&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;sphere&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/af8347abc92a60e534aeed0c905503459134f4c15629be0900953b89940e13cf.png" src="../../_images/af8347abc92a60e534aeed0c905503459134f4c15629be0900953b89940e13cf.png" />
<div class="output text_html"><div id="3dmolviewer_1739455562599819"  style="position: relative; width: 600px; height: 300px;">
        <p id="3dmolwarning_1739455562599819" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.2/3Dmol-min.js');
}

var viewer_1739455562599819 = null;
var warn = document.getElementById("3dmolwarning_1739455562599819");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1739455562599819 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1739455562599819"),{backgroundColor:"white"});
viewer_1739455562599819.zoomTo();
	viewer_1739455562599819.setViewStyle({"style": "outline", "color": "black", "width": 0.1});
	viewer_1739455562599819.addModelsAsFrames("8\n\nC              0.000010987849        -0.000003149702         0.774037867726\nC             -0.000011390781        -0.000029755825        -0.774037928140\nH              0.876831672208        -0.506146665398         1.165421165573\nH             -0.876704417713        -0.506326417768         1.165428622288\nH             -0.000118018611         1.012415105067         1.165423435726\nH              0.876731099698        -0.506302561397        -1.165429175727\nH              0.000114994200         1.012391595823        -1.165424064210\nH             -0.876857134241        -0.506127225610        -1.165420164791\n8\n\nC              0.000638809808         0.001252448818         0.773935166159\nC             -0.000791806926        -0.001211543944        -0.773935233115\nH              0.899052039837        -0.465708126108         1.165082284562\nH             -0.850271816792        -0.547606171082         1.165247227816\nH             -0.049157968654         1.012384282694         1.165246207872\nH              0.852813209830        -0.545775360594        -1.165091543925\nH              0.049073198104         1.010130243664        -1.165242451415\nH             -0.901357918879        -0.463651996472        -1.165241929079\n8\n\nC              0.001069981491         0.002476466213         0.773625723178\nC             -0.001644935347        -0.002207030090        -0.773625806247\nH              0.919528830562        -0.424391537264         1.164100272979\nH             -0.822221030685        -0.587416600395         1.164674917312\nH             -0.097880999257         1.010018329380         1.164720811134\nH              0.827260738548        -0.584176511021        -1.164112867334\nH              0.097565462212         1.005733463481        -1.164669183271\nH             -0.923680345326        -0.420283163534        -1.164714215555\n8\n\nC              0.001312178119         0.003610521585         0.773160314336\nC             -0.002521637839        -0.002998003082        -0.773160325859\nH              0.938129478135        -0.382449692954         1.162616593826\nH             -0.792841822565        -0.625465815257         1.163761334591\nH             -0.145849719004         1.005348425061         1.163965178040\nH              0.800220257481        -0.621268275576        -1.162637577928\nH              0.145187480888         0.999302586206        -1.163752936487\nH             -0.943638909732        -0.376419173285        -1.163952685071\n8\n\nC              0.001322184115         0.004458261129         0.772571029805\nC             -0.003263425264        -0.003439714863        -0.772571010305\nH              0.954721386565        -0.340226414503         1.160755808624\nH             -0.762732095145        -0.661398055937         1.162627660381\nH             -0.192396122314         0.998428260085         1.162942088882\nH              0.771934882005        -0.656756154503        -1.160784920691\nH              0.191344469997         0.991185621287        -1.162617448718\nH             -0.960934433597        -0.332656929247        -1.162923259920\n8\n\nC              0.001174387912         0.005015825504         0.771909763923\nC             -0.003833054955        -0.003597738516        -0.771909739864\nH              0.969324232654        -0.297763491719         1.158718138656\nH             -0.732039253221        -0.695222970993         1.161250886522\nH             -0.237384575580         0.989438682184         1.161800919820\nH              0.742446879388        -0.690638944768        -1.158756743308\nH              0.235967082349         0.981512332318        -1.161239183277\nH             -0.975659557737        -0.289207209275        -1.161774184451\n8\n\nC              0.000909472161         0.005217990781         0.771228580449\nC             -0.004157438358        -0.003476647455        -0.771228512088\nH              0.981916091986        -0.255204449093         1.156684232111\nH             -0.700977253018        -0.726972332305         1.159791241695\nH             -0.280666552839         0.978518712269         1.160545630256\nH              0.711865059304        -0.722827136243        -1.156736406748\nH              0.278970913721         0.970482605070        -1.159777763996\nH             -0.987865105900        -0.246269772916        -1.160507126385\n8\n\nC              0.000600985619         0.005067336818         0.770573888221\nC             -0.004199143139        -0.003139058569        -0.770573761410\nH              0.992511639407        -0.212595801324         1.154854968207\nH             -0.669633743860        -0.756713421256         1.158300039977\nH             -0.322214733698         0.965843502219         1.159250248932\nH              0.680240308842        -0.753308400969        -1.154922947472\nH              0.320374202657         0.958207964728        -1.158285410931\nH             -0.997685747870        -0.203953524306        -1.159197101532\n8\n\nC              0.000309557482         0.004575203504         0.769986262315\nC             -0.003936967249        -0.002642944499        -0.769986076255\nH              1.001122031131        -0.169984898802         1.153391432319\nH             -0.638035647324        -0.784560358040         1.156887421972\nH             -0.362082934299         0.951551232166         1.157938409961\nH              0.647619980797        -0.782068794161        -1.153476632603\nH              0.360263459757         0.944768795628        -1.156872683273\nH             -1.005267168566        -0.162280665182        -1.157868138769\n8\n\nC              0.000091479103         0.003778598705         0.769497659067\nC             -0.003373990815        -0.002055427750        -0.769497436033\nH              1.007764800446        -0.127393212083         1.152419852733\nH             -0.606142841734        -0.810634203213         1.155644519414\nH             -0.400383150652         0.935755422026         1.156637437877\nH              0.614032350527        -0.809112902494        -1.152522721512\nH              0.398764879578         0.930190757229        -1.155631046280\nH             -1.010762574634        -0.121210792392        -1.156548203799\n8\n\nC             -0.000010042789         0.002731223933         0.769132144195\nC             -0.002534887486        -0.001440848044        -0.769131921956\nH              1.012457671987        -0.084830264681         1.152018854595\nH             -0.573863353254        -0.835052243477         1.154655677327\nH             -0.437264981290         0.918536043006         1.155376614312\nH              0.579494719199        -0.834451469750        -1.152139392505\nH              0.436026446299         0.914452629299        -1.154645000469\nH             -1.014315657446        -0.080654342124        -1.155266856582\n8\n\nC              0.000031013206         0.001500225557         0.768905803824\nC             -0.001464734945        -0.000855299228        -0.768905648159\nH              1.015217261553        -0.042297123184         1.152213511437\nH             -0.541065458368        -0.857919081590         1.153992632265\nH             -0.472899812640         0.899936911225         1.154192738678\nH              0.544016300164        -0.858098324484        -1.152351516164\nH              0.472204711134         0.897492579879        -1.153986403494\nH             -1.016049926096        -0.040484738426        -1.154061002566\n8\n\nC              0.000219162892         0.000163338045         0.768830537958\nC             -0.000224711115        -0.000343450029        -0.768830514205\nH              1.016052865154         0.000212241112         1.152986090680\nH             -0.507589757676        -0.879318868635         1.153713452330\nH             -0.507471522572         0.879963984239         1.153139709077\nH              0.507602188414        -0.880067458958        -1.153136254632\nH              0.507458005348         0.879211618870        -1.153713419085\nH             -1.016056676377        -0.000548638584        -1.152989507629\n");
	viewer_1739455562599819.animate({"loop": "backAndForth"});
	viewer_1739455562599819.setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewer_1739455562599819.rotate(25,"x");
	viewer_1739455562599819.rotate(25,"y");
viewer_1739455562599819.render();
});
</script></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="non-bonded-terms">
<h1>Non-bonded terms<a class="headerlink" href="#non-bonded-terms" title="Link to this heading">#</a></h1>
<p>The non-bonding terms include electrostatic interaction and van der Waals dispersion, resulting from charge distributions in the molecules and induced dipole-dipole interactions, respectively. As these interactions couple all atoms in the molecule, the evaluation of these terms can easily be the most costly part of an MD simulation, leading to a cut-off radius being applied for many cases. Note that atoms connected by chemical bonds are normally excluded from non-bonded terms, with the bonded terms accounting for these interactions.</p>
<section id="van-der-waals-interactions">
<h2>van der Waals interactions<a class="headerlink" href="#van-der-waals-interactions" title="Link to this heading">#</a></h2>
<p>The van der Waals interactions can be  modeled using a Lennard-Jones potential:</p>
<div class="math notranslate nohighlight">
\[
{E_\mathrm{LJ}} = 4\epsilon \left[ \left( \frac{\sigma}{r} \right)^{12} - \left( \frac{\sigma}{r} \right)^6 \right].
\]</div>
<p>The first (<span class="math notranslate nohighlight">\(r^{-12}\)</span>) term is due to exchange interaction, resulting in strong repulsion at short distances, and the second (<span class="math notranslate nohighlight">\(r^{-6}\)</span>) is due to induced dipole-dipole interactions, causing a weak attraction at longer distances. Of these, the second term has the correct physical scaling with distances, but the exchange interaction is only approximately correct, being too steep at short distances. More advanced force field forms are thus available, but Lennard-Jones is often used on account of its low computational cost, coupled with reasonable accuracy.</p>
</section>
<section id="electrostatic-interaction">
<h2>Electrostatic interaction<a class="headerlink" href="#electrostatic-interaction" title="Link to this heading">#</a></h2>
<p>Electrostatic interactions can be calculated using Coulomb’s law:</p>
<div class="math notranslate nohighlight">
\[
{E_\mathrm{electrostatic}} = \frac{q_i q_j}{4\pi \epsilon_0 r_{ij}},
\]</div>
<p>with <span class="math notranslate nohighlight">\(q_i\)</span> and <span class="math notranslate nohighlight">\(q_j\)</span> being point charges representing the (partial) charges of the interacting atoms. Again, more advanced interactions can be included for increasing accuracy. Many different approaches for estimating atomic charges are used, and we favour the restrained electrostatic potential (<a class="reference external" href="https://kthpanor.github.io/echem/docs/env/resp.html">RESP</a>) charge model. It is also possible to use higher order multipoles, where dipole moments are assigned to each bonded pair. This gives the advantage of a more flexible description, as the dipoles depend on the types of both involved atoms, but requires additional parametrization and has difficulty dealing with ionic systems.</p>
</section>
<section id="van-der-waals-interaction">
<h2>Van der Waals interaction<a class="headerlink" href="#van-der-waals-interaction" title="Link to this heading">#</a></h2>
<p>The van der Waals interaction is typically represented by two terms. One due to exchange interaction, causing a strong repulsion at close distances, and one that is due to London dispersion, resulting in a weak attraction at longer distances. The most commonly used form is the [Lennard-Jones potential]:</p>
<div class="math notranslate nohighlight">
\[
{E_\mathrm{vdw}} = \epsilon \left[ \left( \frac{r_\text{min}}{r} \right)^{12} - 2 \left( \frac{r_\text{min}}{r} \right)^6 \right]
\]</div>
<p>\noindent where <span class="math notranslate nohighlight">\(\epsilon\)</span> is the depth of the potential well, usually created as the mean of two parameters specific to the two interacting atom types, <span class="math notranslate nohighlight">\(r_\text{min}\)</span> is the position of the bottom of the well and <span class="math notranslate nohighlight">\(r\)</span> is the interatomic distance. While it is possible to motivate the use of <span class="math notranslate nohighlight">\(r^{-6}\)</span> for the attractive part, the use of <span class="math notranslate nohighlight">\(r^{-12}\)</span> for the repulsive part is more pragmatic in origin, having that form simply because it is the square of <span class="math notranslate nohighlight">\(r^{-6}\)</span>, making its computation highly efficient.</p>
</section>
<section id="additional-terms">
<h2>Additional terms<a class="headerlink" href="#additional-terms" title="Link to this heading">#</a></h2>
<p>Depending on what the force field is intended for, many additional terms can be added to the potential energy function. Cross-terms are a common addition, accounting for more complex couplings between structural properties. Examples of these include stretch–bend, torsion–stretch and bend–bend interactions. As an example, the stretch–bend interaction accounts for the fact that compressing an angle formed by three bonded atoms will cause the repulsion between the two end atoms to increase, resulting in an elongation of their bonds to the middle atom. Another example of such structural corrections comes in the form of the out-of-plane term. If three or four atoms are bonded to a central atom with their equilibrium position in a plane, as for <em>e.g.</em> formaledehyde, the change in energy caused by a distortion of the central atom out of the plane is hard to model by just angle bending terms, as the individual angle distortions are small. The out-of-plane term instead depends on the angles formed between the plane and the bonds connecting the central and outer atoms. This is shown below, where the <span class="math notranslate nohighlight">\(\chi\)</span> is an example of an out-of-plane angle.</p>
<figure class="align-default" id="fig-mm-outofplane">
<a class="reference internal image-reference" href="../../_images/MM_outofplane.svg"><img alt="../../_images/MM_outofplane.svg" src="../../_images/MM_outofplane.svg" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Out-of-plane bending.</span><a class="headerlink" href="#fig-mm-outofplane" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/mol_struct"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="md.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Molecular dynamics</p>
      </div>
    </a>
    <a class="right-next"
       href="reparameterize.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Reparameterize force fields</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Force fields</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bonded-terms">Bonded terms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bond-stretching">Bond stretching</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonic-fit">Harmonic fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anharmonic-fit">Anharmonic fit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#angle-bending">Angle bending</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Harmonic fit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#torsion">Torsion</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#non-bonded-terms">Non-bonded terms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-interactions">van der Waals interactions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#electrostatic-interaction">Electrostatic interaction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-interaction">Van der Waals interaction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-terms">Additional terms</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The eChem team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>