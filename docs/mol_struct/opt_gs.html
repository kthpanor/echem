
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Ground-state structure optimization &#8212; Computational Chemistry from  Laptop to HPC</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Transition-state theory" href="tst.html" />
    <link rel="prev" title="Optimization methods" href="opt_struct.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TX4YJ1J5XE"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-TX4YJ1J5XE');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Chemistry from  Laptop to HPC</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro.html">
   Getting started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../basics_notebook.html">
     Using Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../units_notation.html">
     Units and notation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Electronic ground states
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../elec_struct/elstruct_gen.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/orbitals.html">
     Orbitals and basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/slater.html">
     Many-electron wave functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/operators.html">
     Operators and matrix elements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/reduced_density.html">
     Reduced particle densities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/natural_orbitals.html">
     Natural orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/integrals.html">
     Integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/spin.html">
     Electron spin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/correlation.html">
     Electron correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/dispersion.html">
     Dispersion interactions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/pt.html">
     Rayleigh–Schrödinger perturbation theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/second_quant.html">
     Second quantization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/group_theory.html">
     Group theory
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../elec_struct/wft.html">
   Wave function theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../elec_struct/hartree-fock.html">
     Hartree–Fock
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../elec_struct/hf_theory.html">
       Hartree–Fock theory
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../elec_struct/hf_scf.html">
       SCF optimization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../elec_struct/hf_example.html">
       HF in VeloxChem
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/ci.html">
     Configuration interaction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/mp2.html">
     Møller–Plesset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/mcscf.html">
     Multiconfigurational methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/wft_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../elec_struct/dft.html">
   Density functional theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/hohenberg.html">
     Hohenberg–Kohn theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/kohn-sham.html">
     Kohn–Sham method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/kernel_int.html">
     Kernel integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/dft_scf.html">
     SCF optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/dft_prop.html">
     First-order properties
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elec_struct/available_xcfun.html">
     Available XC functionals
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Molecular structure and dynamics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="molstruct_gen.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="coordinates.html">
     Choice of coordinates
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="gradients.html">
   Gradients
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="energy_grad.html">
     Energy gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="property_grad.html">
     Property gradients
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="hessians_vib.html">
   Hessians and vibrations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hessians.html">
     Molecular Hessians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vibrations.html">
     Vibrational analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="opt.html">
   Structure optimization
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="opt_struct.html">
     Optimization methods
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Ground-state structure optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tst.html">
   Transition-state theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="tst_gen.html">
     Transition state geometry optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="impes.html">
   PES interpolation techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="impes_calc.html">
     Constructing the PES by interpolation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md.html">
   Molecular dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="forcefields.html">
     Force fields
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="reparameterize.html">
     Reparameterize force fields
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_setup.html">
     Ensembles and time integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="md_run.html">
     Running a simulation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Spectra and properties
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/spectra_aspects.html">
   General aspects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/vibrot.html">
     Rovibronic states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/response.html">
     Responses to external fields
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/selection_rules.html">
     Selection rules
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/tddft.html">
   TDDFT
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/tddft_basics.html">
     Foundations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/tddft_rpa.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/tddft_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/mr_response.html">
   Multireference response
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/ci_response.html">
     CI response
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/sa_mcscf.html">
     State-averaged MCSCF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/mclr.html">
     Multiconfigurational linear response
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/mr_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/adc.html">
   ADC
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_pp.html">
     Polarization propagator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_isr.html">
     Intermediate state representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_cvs.html">
     Core-valence separation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_hpc.html">
     HPC-QC implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/adc_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spec_prop/excoupl.html">
   Exciton coupling model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spec_prop/excoupl_impl.html">
     Implementation of the exciton coupling model
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../env/localprop.html">
   Localized properties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/esp.html">
     ESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/resp.html">
     RESP charges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/loprop.html">
     LoProp charges and polarisabilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../env/embedding.html">
   Embedding potentials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/nonpol_emb.html">
     Non-polarizable embedding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../env/pol_emb.html">
     Polarizable embedding
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Visualization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../visualize/mol_struct.html">
   Molecular structure and dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/struct_vis.html">
     Molecular structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/md_vis.html">
     MD trajectories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/opt_vib_vis.html">
     Optimization and normal modes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../visualize/elec_struct.html">
   Electronic structure
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/orb_vis.html">
     Orbitals and densities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/exc_vis.html">
     Excited states
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../visualize/spec_prop.html">
   Spectra and properties
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../visualize/broadening.html">
     Spectrum broadening
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials and workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/workflow.html">
   Constructing workflows
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
  <label for="toctree-checkbox-23">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/wf_build.html">
     Building the system
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/wf_struct.html">
     Optimizing molecular structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/wf_scf.html">
     Optimizing electronic structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/wf_construct.html">
     Assembling a full workflow
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/uv_vis.html">
   UV/vis spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
  <label for="toctree-checkbox-24">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_absorption.html">
     Absorption
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_fluorescence.html">
     Fluorescence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_analysis.html">
     Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_rec.html">
     Recommendations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/uv_vis_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/vib_ir.html">
   Vibrational spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
  <label for="toctree-checkbox-25">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/vib_ir_calc.html">
     IR spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/vib_ir_raman.html">
     Raman spectroscopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/vib_ir_exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/openshells.html">
   Open shells
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
  <label for="toctree-checkbox-26">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/rest_unrest.html">
     Restricted versus unrestricted
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/correlation.html">
     Static versus dynamic correlation correlation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/xray.html">
   X-ray spectroscopies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
  <label for="toctree-checkbox-27">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_calc.html">
     Spectrum calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_analysis.html">
     Spectrum analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_aspects.html">
     Special aspects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_large.html">
     Larger systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_nonstandard.html">
     Non-standard calculations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_rec.html">
     Recommendations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_exercises.html">
     Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/xray_cheatsheet.html">
     Cheat sheet
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bibliography
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../cite.html">
   How to cite and contact
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../refs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/kthpanor/echem/master?urlpath=tree/docs/docs/mol_struct/opt_gs.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/kthpanor/echem"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/mol_struct/opt_gs.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/docs/mol_struct/opt_gs.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scf-geometry-optimization">
   SCF geometry optimization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#internal-coordinate-scan">
     Internal coordinate scan
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constrained-optimization">
     Constrained optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#xtb-geometry-optimization">
   XTB geometry optimization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-the-xtb-gradient-and-optimization-drivers-and-run-the-geometry-optimization">
     Set up the xtb gradient and optimization drivers and run the geometry optimization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-the-xtb-structure-optimization-for-kahweol">
     Run the XTB structure optimization for kahweol:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-initial-and-final-geometries">
     Compare initial and final geometries
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Ground-state structure optimization</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scf-geometry-optimization">
   SCF geometry optimization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#internal-coordinate-scan">
     Internal coordinate scan
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constrained-optimization">
     Constrained optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#xtb-geometry-optimization">
   XTB geometry optimization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-the-xtb-gradient-and-optimization-drivers-and-run-the-geometry-optimization">
     Set up the xtb gradient and optimization drivers and run the geometry optimization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-the-xtb-structure-optimization-for-kahweol">
     Run the XTB structure optimization for kahweol:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-initial-and-final-geometries">
     Compare initial and final geometries
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="ground-state-structure-optimization">
<h1>Ground-state structure optimization<a class="headerlink" href="#ground-state-structure-optimization" title="Permalink to this headline">#</a></h1>
<p>Molecular structure optimizations always start from an initial guess of the molecular geometry (constructed using <span class="xref myst">SMILES</span>, a chemistry software, e.g. <span class="xref myst">Avogadro</span>, or downloaded from a <span class="xref myst">database</span>). In the following, we will see how to perform ground-state geometry optimization using <a class="reference external" href="https://veloxchem.org/">VeloxChem</a> and <a class="reference external" href="https://github.com/leeping/geomeTRIC">GeomeTRIC</a>.</p>
<section id="scf-geometry-optimization">
<h2>SCF geometry optimization<a class="headerlink" href="#scf-geometry-optimization" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span> <span class="k">as</span> <span class="nn">p3d</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">geometric</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">ostream</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OutputStream</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Warning * Environment variable OMP_NUM_THREADS not set.
* Warning * Setting OMP_NUM_THREADS to 4.
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the molecule and basis set</span>
<span class="n">water_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;3</span>
<span class="s2">water molecule, bond angle 150 deg</span>
<span class="s2">O       0.0000000       0.0000000       0.0000000</span>
<span class="s2">H       0.2760264       0.8822741       0.6495351</span>
<span class="s2">H       0.1036576      -0.7768012      -0.5501827</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">basis_set_label</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">water_xyz</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis_set_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /home/thomas/Notebook/anaconda/envs/echem/lib/python3.10/site-packages/veloxchem/basis/STO-3G
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: STO-3G                                                                              
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                O   (2S,1P)                   (6S,3P)                                                     
                                H   (1S)                      (3S)                                                        
                                                                                                                          
                               Contracted Basis Functions : 7                                                             
                               Primitive Basis Functions  : 21                                                            
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># View initial structure of the molecule</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">viewergrid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">water_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">view</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">}})</span>
<span class="n">view</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_16824235480831747"  style="position: relative; width: 300px; height: 300px">
        <p id="3dmolwarning_16824235480831747" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_16824235480831747 = null;
var warn = document.getElementById("3dmolwarning_16824235480831747");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_16824235480831747 = null;
viewergrid_16824235480831747 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_16824235480831747"),{rows: 1, cols: 1, control_all: true},{backgroundColor:"white"});
viewer_16824235480831747 = viewergrid_16824235480831747[0][0];
viewergrid_16824235480831747[0][0].zoomTo();	viewergrid_16824235480831747[0][0].addModel("3\nwater molecule, bond angle 150 deg\nO       0.0000000       0.0000000       0.0000000\nH       0.2760264       0.8822741       0.6495351\nH       0.1036576      -0.7768012      -0.5501827\n","xyz");
	viewergrid_16824235480831747[0][0].setViewStyle({"style": "outline", "width": 0.05});
	viewergrid_16824235480831747[0][0].setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewergrid_16824235480831747[0][0].zoomTo();
viewergrid_16824235480831747[0][0].render();
});
</script></div></div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the initial SCF and set up the gradient and optimization drivers</span>
<span class="n">scf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="c1"># Settings for DFT:</span>
<span class="c1"># scf_drv.xcfun = &quot;b3lyp&quot;</span>
<span class="n">scf_results</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 8.4257146308 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.01 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.04 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -74.838008565136 a.u. Time: 0.09 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -74.838008656380    0.0000000000      0.00020607      0.00005271      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -74.838008679393   -0.0000000230      0.00008668      0.00002305      0.00023046                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -74.838008685191   -0.0000000058      0.00001417      0.00000312      0.00018085                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -74.838008685300   -0.0000000001      0.00000241      0.00000057      0.00002422                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -74.838008685302   -0.0000000000      0.00000049      0.00000009      0.00000358                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 5 iterations. Time: 0.04 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :      -74.8380086853 a.u.                                              
               Electronic Energy                  :      -83.2637233161 a.u.                                              
               Nuclear Repulsion Energy           :        8.4257146308 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000004862 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -20.09946 a.u.                                                                  
               (   1 O   1s  :    -0.99)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.14596 a.u.                                                                  
               (   1 O   1s  :    -0.24) (   1 O   2s  :     0.85) (   3 H   1s  :     0.20)                              
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.58710 a.u.                                                                  
               (   1 O   1p-1:     0.45) (   1 O   1p0 :     0.32) (   2 H   1s  :     0.46)                              
               (   3 H   1s  :    -0.42)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.30532 a.u.                                                                  
               (   1 O   1p-1:    -0.58) (   1 O   1p0 :     0.81)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.30273 a.u.                                                                  
               (   1 O   2s  :     0.25) (   1 O   1p+1:    -0.95) (   2 H   1s  :    -0.19)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.37318 a.u.                                                                  
               (   1 O   2s  :     0.85) (   1 O   1p+1:     0.32) (   2 H   1s  :    -0.87)                              
               (   3 H   1s  :    -0.66)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.84399 a.u.                                                                  
               (   1 O   2s  :    -0.29) (   1 O   1p-1:     0.85) (   1 O   1p0 :     0.61)                              
               (   2 H   1s  :    -0.56) (   3 H   1s  :     0.98)                                                        
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the gradient and optimization dirvers:</span>
<span class="n">grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">(</span><span class="n">scf_drv</span><span class="p">)</span>
<span class="n">opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">grad_drv</span><span class="p">)</span>

<span class="n">opt_drv</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;../../data/structopt/h2o_gsstructopt&quot;</span>
<span class="c1"># Run the optimization</span>
<span class="n">opt_molecule</span> <span class="o">=</span> <span class="n">opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s plot the energies calculated during the optimization and check how the structure changes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The data we need are stored in the output file generated during the geometry optimization.</span>
<span class="c1"># Let&#39;s write a routine which reads these data points from file.</span>
<span class="k">def</span> <span class="nf">read_optimization_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">structures</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;Energy&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">parts</span><span class="p">:</span>
                <span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
                <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">steps</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">structures</span>

<span class="n">steps</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">structures</span> <span class="o">=</span> <span class="n">read_optimization_file</span><span class="p">(</span><span class="s1">&#39;../../data/structopt/h2o_gsstructopt_optim.xyz&#39;</span><span class="p">)</span>


<span class="c1"># Plot the energies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span><span class="s1">&#39;o--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (H)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;H2O GS optimization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Animate optimization</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="n">structures</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">animate</span><span class="p">({</span><span class="s2">&quot;loop&quot;</span><span class="p">:</span> <span class="s2">&quot;forward&quot;</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">}})</span>
<span class="c1"># # rotate for a better initial view</span>
<span class="c1"># viewer.rotate(-90, &quot;y&quot;)</span>
<span class="c1"># viewer.rotate(-90, &quot;x&quot;)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/opt_gs_8_0.png" src="../../_images/opt_gs_8_0.png" />
<div class="output text_html"><div id="3dmolviewer_16824235487320817"  style="position: relative; width: 300px; height: 200px">
        <p id="3dmolwarning_16824235487320817" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_16824235487320817 = null;
var warn = document.getElementById("3dmolwarning_16824235487320817");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_16824235487320817 = $3Dmol.createViewer(document.getElementById("3dmolviewer_16824235487320817"),{backgroundColor:"white"});
viewer_16824235487320817.zoomTo();
	viewer_16824235487320817.addModelsAsFrames("3    \nIteration 0 Energy -74.83800869\nO        0.0000000000    0.0000000000    0.0000000000\nH        0.2760264000    0.8822741000    0.6495351000\nH        0.1036576000   -0.7768012000   -0.5501827000\n3    \nIteration 1 Energy -74.89804404\nO       -0.0698727162    0.0410502086    0.0250433581\nH        0.2963321517    0.7875141524    0.5828990568\nH        0.1532250370   -0.7230914777   -0.5085900169\n3    \nIteration 2 Energy -74.94773048\nO       -0.1917108158    0.0739226508    0.0409732781\nH        0.3395517605    0.6741968010    0.5043987178\nH        0.2318440836   -0.6426465833   -0.4460195921\n3    \nIteration 3 Energy -74.95249268\nO       -0.3534137348    0.0779103592    0.0337081420\nH        0.4015129389    0.5442344430    0.4151428003\nH        0.3315870782   -0.5166719800   -0.3494985927\n3    \nIteration 4 Energy -74.96582905\nO       -0.2987080319    0.0707057419    0.0319697716\nH        0.3847962362    0.6255370368    0.4723589672\nH        0.2935981394   -0.5907699509   -0.4049763840\n3    \nIteration 5 Energy -74.96589975\nO       -0.2960388877    0.0688971901    0.0308407238\nH        0.3842442400    0.6311603079    0.4763533401\nH        0.2914809152   -0.5945846555   -0.4078417069\n3    \nIteration 6 Energy -74.96590120\nO       -0.2959339703    0.0688786942    0.0308339257\nH        0.3842837095    0.6319968447    0.4769543977\nH        0.2913364064   -0.5954026761   -0.4084359605\n3    \nIteration 7 Energy -74.96590122\nO       -0.2959494022    0.0688275343    0.0307962054\nH        0.3842933109    0.6319846807    0.4769455291\nH        0.2913421262   -0.5953393407   -0.4083893649\n");
	viewer_16824235487320817.animate({"loop": "forward"});
viewer_16824235487320817.render();
});
</script></div></div>
</div>
<section id="internal-coordinate-scan">
<h3>Internal coordinate scan<a class="headerlink" href="#internal-coordinate-scan" title="Permalink to this headline">#</a></h3>
<p>Let’s say that we want to see how the total energy varies when we change one internal coordinate and we optimize the rest. For this, we can set up a scan using <a class="reference external" href="https://github.com/leeping/geomeTRIC">geomeTRIC</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the gradient and optimization dirvers:</span>
<span class="n">grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">(</span><span class="n">scf_drv</span><span class="p">)</span>
<span class="n">opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">grad_drv</span><span class="p">)</span>

<span class="n">opt_drv</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;../../data/structopt/h2o_scan&quot;</span>
<span class="n">angle_scan</span> <span class="o">=</span> <span class="s2">&quot;angle 2 1 3 70 140.0 20&quot;</span> 
<span class="n">opt_drv</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$scan&quot;</span><span class="p">,</span> <span class="n">angle_scan</span><span class="p">]</span>

<span class="c1"># Run the scan</span>
<span class="n">opt_molecule</span> <span class="o">=</span> <span class="n">opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle_scan</span> <span class="o">=</span> <span class="s2">&quot;angle 2 1 3 70 140.0 20&quot;</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_scan</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">natms</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
    <span class="c1"># start, stop and how many steps</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">no_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">stop</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">no_steps</span>
    
    <span class="n">scan_coords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">structures</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no_steps</span><span class="p">):</span>
        <span class="n">energy</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_scan-00</span><span class="si">%d</span><span class="s2">.xyz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_scan-0</span><span class="si">%d</span><span class="s2">.xyz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_scan-</span><span class="si">%d</span><span class="s2">.xyz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    
        <span class="c1"># The optimized geometry is the last geometry in the file</span>
        <span class="c1"># in xyz format.</span>
        <span class="n">nlines</span> <span class="o">=</span> <span class="n">natms</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    
        <span class="n">opt_struct</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">nlines</span><span class="p">:]:</span>
            <span class="n">opt_struct</span> <span class="o">+=</span> <span class="n">line</span>
            <span class="k">if</span> <span class="s2">&quot;Energy&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">scan_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">step</span><span class="p">)</span>
        <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
        <span class="n">structures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_struct</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scan_coords</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">structures</span>

<span class="n">natms</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>
<span class="n">scan_coords</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">structures</span> <span class="o">=</span> <span class="n">read_scan</span><span class="p">(</span><span class="s2">&quot;../../data/structopt/h2o_scan&quot;</span><span class="p">,</span> <span class="n">natms</span><span class="p">,</span> <span class="n">angle_scan</span><span class="p">)</span>


<span class="c1"># Plot the energies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scan_coords</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span><span class="s1">&#39;o--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angle (deg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (H)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;H2O bond angle scan&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/opt_gs_12_0.png" src="../../_images/opt_gs_12_0.png" />
</div>
</div>
</section>
<section id="constrained-optimization">
<h3>Constrained optimization<a class="headerlink" href="#constrained-optimization" title="Permalink to this headline">#</a></h3>
<p>Now let’s see how to run a constrained optimization. For this example, we will constrain the OH bond lengths to specific values and we will optimize the bond angle of the water molecule to construct a “relaxed” potential energy surface. For this, we will need several water structures with different combinations of OH bond lengths. These will be read from file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Since we are considering many combinations, running this cell may take a while...</span>
<span class="n">bond_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">folder</span> <span class="o">=</span> <span class="s2">&quot;../../data/structopt/h2o_relaxed_pes/&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">r1</span> <span class="ow">in</span> <span class="n">bond_lengths</span><span class="p">:</span>
    <span class="c1"># We will constrain the first OH bond length to bond_1.</span>
    <span class="n">bond_1</span> <span class="o">=</span> <span class="s2">&quot;distance 1 2 </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r1</span> 
    <span class="k">for</span> <span class="n">r2</span> <span class="ow">in</span> <span class="n">bond_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">:]:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s2">&quot;h2o_</span><span class="si">%.2f</span><span class="s2">_</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;.xyz&quot;</span> <span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">h2o_xyz</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">new_molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">h2o_xyz</span><span class="p">)</span>
        <span class="n">scf_results</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">new_molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
        
        <span class="c1"># Set up the gradient and optimization dirvers:</span>
        <span class="n">new_grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">(</span><span class="n">scf_drv</span><span class="p">)</span>
        <span class="n">new_opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">new_grad_drv</span><span class="p">)</span>
        <span class="n">new_opt_drv</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">file_name</span>
        
        <span class="c1"># We will constrain the second OH bond length to value bond_2.</span>
        <span class="n">bond_2</span> <span class="o">=</span> <span class="s2">&quot;distance 1 3 </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r2</span>
        
        <span class="c1"># Possible options: set, scan, freeze.</span>
        <span class="n">new_opt_drv</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$set&quot;</span><span class="p">,</span> <span class="n">bond_1</span><span class="p">,</span> <span class="n">bond_2</span><span class="p">]</span>
        
        <span class="c1"># We now optimize th bond angle:</span>
        <span class="n">h2o_opt</span> <span class="o">=</span> <span class="n">new_opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">new_molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_optimized_structure</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">natms</span><span class="p">):</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    
    <span class="c1"># The optimized geometry is the last geometry in the file</span>
    <span class="c1"># in xyz format.</span>
    <span class="n">nlines</span> <span class="o">=</span> <span class="n">natms</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    
    <span class="n">opt_struct</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">nlines</span><span class="p">:]:</span>
        <span class="n">opt_struct</span> <span class="o">+=</span> <span class="n">line</span>
        <span class="k">if</span> <span class="s2">&quot;Energy&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">energy</span><span class="p">,</span> <span class="n">opt_struct</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s plot the 2D PES and the 2D map of relaxed bond angles.</span>
<span class="n">npts</span> <span class="o">=</span> <span class="n">bond_lengths</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">natm</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>

<span class="n">pes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>

<span class="c1"># Read energies</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">r1</span> <span class="ow">in</span> <span class="n">bond_lengths</span><span class="p">:</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">for</span> <span class="n">r2</span> <span class="ow">in</span> <span class="n">bond_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">:]:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s2">&quot;h2o_</span><span class="si">%.2f</span><span class="s2">_</span><span class="si">%.2f</span><span class="s2">_optim.xyz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="n">energy</span><span class="p">,</span> <span class="n">xyz_opt</span> <span class="o">=</span> <span class="n">read_optimized_structure</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">natm</span><span class="p">)</span>
        <span class="n">pes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">energy</span>
        <span class="n">pes</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">energy</span>
        
        <span class="c1"># calculate the relaxed bond angle</span>
        <span class="n">opt_molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">xyz_opt</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">geometric</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">Angle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">opt_molecule</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span> <span class="o">*</span> <span class="n">natm</span><span class="p">))</span>
        <span class="c1"># transform from radians to degrees</span>
        <span class="n">angle_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">angle</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">coords</span><span class="p">))</span><span class="o">*</span><span class="mf">180.0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle_value</span>
        <span class="n">theta</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle_value</span>
        
        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r1 (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;r2 (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;H2O relaxed PES&quot;</span><span class="p">)</span>
<span class="n">conts</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">bond_lengths</span><span class="p">,</span> <span class="n">pes</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">conts</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">CS</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">bond_lengths</span><span class="p">,</span> <span class="n">pes</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdGy&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Energy (H)&quot;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r1 (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;r2 (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;H2O relaxed bond angle&quot;</span><span class="p">)</span>
<span class="n">conts</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">bond_lengths</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">conts</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">bond_lengths</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span>
                  <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues_r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Angle (rad)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/opt_gs_17_0.png" src="../../_images/opt_gs_17_0.png" />
</div>
</div>
</section>
</section>
<section id="xtb-geometry-optimization">
<h2>XTB geometry optimization<a class="headerlink" href="#xtb-geometry-optimization" title="Permalink to this headline">#</a></h2>
<p>In the following we will perform a ground state structure optimization of cafestol and kahweol. Cafestol is a molecule present in Robusta coffee beans, while kahweol is a very similar molecule present in Arabica coffee beans. Kahweol has a distinctive Raman peak which allows to identify Arabica coffee beans by Raman spectroscopy. Here, we determine the relaxed geometries of these two molecules. Since these molecules are large, we will use the semiempirical tight binding method from the <a class="reference external" href="https://xtb-docs.readthedocs.io/en/latest/contents.html">Xtb code</a>. Veloxchem has dedicated drivers which connect to Xtb.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cafestol_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;51</span>
<span class="s2">cafestol initial structure</span>
<span class="s2">O  -4.5215   -1.3455    0.4926</span>
<span class="s2">O  -5.2905    0.0812   -1.7033</span>
<span class="s2">O   5.1630    0.4345   -0.1101</span>
<span class="s2">C  -1.2807   -0.7511   -0.0465</span>
<span class="s2">C  -0.5244    0.5810   -0.4102</span>
<span class="s2">C   0.9909    0.6610    0.0407</span>
<span class="s2">C  -2.9440    0.2916    1.2866</span>
<span class="s2">C  -1.8143   -0.7311    1.3945</span>
<span class="s2">C  -2.6188   -0.8159   -0.8642</span>
<span class="s2">C  -3.7116   -0.2387    0.0606</span>
<span class="s2">C  -0.4332   -2.0024   -0.3283</span>
<span class="s2">C  -1.3742    1.8303   -0.0654</span>
<span class="s2">C   1.6844   -0.6873   -0.4019</span>
<span class="s2">C  -2.3206    1.6833    1.1309</span>
<span class="s2">C   0.9997   -1.9155    0.1913</span>
<span class="s2">C   1.7285    1.8344   -0.7277</span>
<span class="s2">C   1.1437    0.9261    1.5588</span>
<span class="s2">C   3.1644   -0.6155   -0.2085</span>
<span class="s2">C  -4.6490    0.7442   -0.6282</span>
<span class="s2">C   3.2525    1.9378   -0.4590</span>
<span class="s2">C   3.8298    0.5879   -0.2856</span>
<span class="s2">C   4.1654   -1.5888    0.0140</span>
<span class="s2">C   5.3604   -0.9015    0.0689</span>
<span class="s2">H  -0.4604    0.5817   -1.5108</span>
<span class="s2">H  -3.5646    0.2626    2.1897</span>
<span class="s2">H  -1.0861   -0.4449    2.1498</span>
<span class="s2">H  -2.1902   -1.7145    1.7003</span>
<span class="s2">H  -2.5286   -0.2495   -1.7981</span>
<span class="s2">H  -2.8534   -1.8505   -1.1460</span>
<span class="s2">H  -0.3943   -2.1694   -1.4136</span>
<span class="s2">H  -0.9135   -2.8938    0.0946</span>
<span class="s2">H  -1.9810    2.0650   -0.9487</span>
<span class="s2">H  -0.7587    2.7222    0.0818</span>
<span class="s2">H   1.5605   -0.7646   -1.4951</span>
<span class="s2">H  -1.7642    1.9154    2.0477</span>
<span class="s2">H  -3.1082    2.4431    1.0635</span>
<span class="s2">H   1.0176   -1.9046    1.2859</span>
<span class="s2">H   1.5276   -2.8282   -0.1118</span>
<span class="s2">H   1.2808    2.8061   -0.4944</span>
<span class="s2">H   1.5851    1.6842   -1.8068</span>
<span class="s2">H   0.5898    1.8173    1.8670</span>
<span class="s2">H   0.8147    0.0892    2.1727</span>
<span class="s2">H   2.1832    1.0992    1.8532</span>
<span class="s2">H  -4.1337    1.6158   -1.0351</span>
<span class="s2">H  -5.4265    1.0934    0.0595</span>
<span class="s2">H   3.4273    2.5264    0.4487</span>
<span class="s2">H   3.7385    2.4646   -1.2871</span>
<span class="s2">H  -3.9519   -2.0832    0.7635</span>
<span class="s2">H   4.0442   -2.6573    0.1180</span>
<span class="s2">H  -5.7603   -0.6874   -1.3370</span>
<span class="s2">H   6.3869   -1.2031    0.2186</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">cafestol</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">cafestol_xyz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kahweol_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;49</span>
<span class="s2">kahweol initial structure</span>
<span class="s2">O  -4.4710   -1.5361    0.0905</span>
<span class="s2">O  -5.6188    0.9753   -0.0811</span>
<span class="s2">O   5.1625    0.5695   -0.0997</span>
<span class="s2">C  -1.2209   -0.8317   -0.2017</span>
<span class="s2">C  -0.4821    0.5357   -0.4703</span>
<span class="s2">C  -3.0038    0.1167    1.0462</span>
<span class="s2">C  -1.8514   -0.8737    1.1997</span>
<span class="s2">C  -2.4967   -0.9058   -1.1119</span>
<span class="s2">C   0.9884    0.6333    0.0944</span>
<span class="s2">C  -3.6676   -0.3924   -0.2474</span>
<span class="s2">C  -0.3220   -2.0551   -0.4569</span>
<span class="s2">C  -1.3919    1.7479   -0.1363</span>
<span class="s2">C  -2.4167    1.5304    0.9816</span>
<span class="s2">C   1.7435   -0.6786   -0.3542</span>
<span class="s2">C   1.0741   -1.9483    0.1552</span>
<span class="s2">C   1.0367    0.8330    1.6293</span>
<span class="s2">C  -4.5845    0.5870   -0.9677</span>
<span class="s2">C   1.7610    1.8511   -0.4907</span>
<span class="s2">C   3.2146   -0.5444   -0.1101</span>
<span class="s2">C   3.1013    1.8722   -0.6493</span>
<span class="s2">C   3.8167    0.6946   -0.3059</span>
<span class="s2">C   4.2309   -1.4546    0.2464</span>
<span class="s2">C   5.3980   -0.7259    0.2399</span>
<span class="s2">H  -0.3415    0.5842   -1.5631</span>
<span class="s2">H  -3.6779    0.0397    1.9072</span>
<span class="s2">H  -1.1861   -0.6021    2.0159</span>
<span class="s2">H  -2.2356   -1.8757    1.4322</span>
<span class="s2">H  -2.3648   -0.3090   -2.0216</span>
<span class="s2">H  -2.6844   -1.9384   -1.4328</span>
<span class="s2">H  -0.2098   -2.1924   -1.5413</span>
<span class="s2">H  -0.8043   -2.9694   -0.0890</span>
<span class="s2">H  -1.9406    2.0033   -1.0514</span>
<span class="s2">H  -0.8134    2.6482    0.0921</span>
<span class="s2">H  -1.9341    1.7452    1.9434</span>
<span class="s2">H  -3.2193    2.2709    0.8849</span>
<span class="s2">H   1.6699   -0.7251   -1.4553</span>
<span class="s2">H   1.0259   -1.9792    1.2481</span>
<span class="s2">H   1.6508   -2.8307   -0.1490</span>
<span class="s2">H   2.0514    1.0518    1.9842</span>
<span class="s2">H   0.4166    1.6762    1.9486</span>
<span class="s2">H   0.7233   -0.0489    2.1864</span>
<span class="s2">H  -5.0524    0.1195   -1.8415</span>
<span class="s2">H  -4.0679    1.4861   -1.3088</span>
<span class="s2">H   1.2088    2.7568   -0.7218</span>
<span class="s2">H  -5.0925   -1.2746    0.7905</span>
<span class="s2">H   3.6240    2.7536   -0.9997</span>
<span class="s2">H   4.1386   -2.5085    0.4650</span>
<span class="s2">H  -6.2132    0.2149    0.0339</span>
<span class="s2">H   6.4308   -0.9731    0.4374</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">kahweol</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">kahweol_xyz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The difference between cafestol and kahweol is very subtle, essentially only one double bond and two H atoms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">               (a) Cafestol                                 (b) Kahweol&quot;</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">viewergrid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">linked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">cafestol_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">kahweol_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">view</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               (a) Cafestol                                 (b) Kahweol
</pre></div>
</div>
<div class="output text_html"><div id="3dmolviewer_1682423550020245"  style="position: relative; width: 700px; height: 250px">
        <p id="3dmolwarning_1682423550020245" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_1682423550020245 = null;
var warn = document.getElementById("3dmolwarning_1682423550020245");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_1682423550020245 = null;
viewergrid_1682423550020245 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_1682423550020245"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_1682423550020245 = viewergrid_1682423550020245[0][0];
viewergrid_1682423550020245[0][0].zoomTo();viewergrid_1682423550020245[0][1].zoomTo();	viewergrid_1682423550020245[0][0].addModel("51\ncafestol initial structure\nO  -4.5215   -1.3455    0.4926\nO  -5.2905    0.0812   -1.7033\nO   5.1630    0.4345   -0.1101\nC  -1.2807   -0.7511   -0.0465\nC  -0.5244    0.5810   -0.4102\nC   0.9909    0.6610    0.0407\nC  -2.9440    0.2916    1.2866\nC  -1.8143   -0.7311    1.3945\nC  -2.6188   -0.8159   -0.8642\nC  -3.7116   -0.2387    0.0606\nC  -0.4332   -2.0024   -0.3283\nC  -1.3742    1.8303   -0.0654\nC   1.6844   -0.6873   -0.4019\nC  -2.3206    1.6833    1.1309\nC   0.9997   -1.9155    0.1913\nC   1.7285    1.8344   -0.7277\nC   1.1437    0.9261    1.5588\nC   3.1644   -0.6155   -0.2085\nC  -4.6490    0.7442   -0.6282\nC   3.2525    1.9378   -0.4590\nC   3.8298    0.5879   -0.2856\nC   4.1654   -1.5888    0.0140\nC   5.3604   -0.9015    0.0689\nH  -0.4604    0.5817   -1.5108\nH  -3.5646    0.2626    2.1897\nH  -1.0861   -0.4449    2.1498\nH  -2.1902   -1.7145    1.7003\nH  -2.5286   -0.2495   -1.7981\nH  -2.8534   -1.8505   -1.1460\nH  -0.3943   -2.1694   -1.4136\nH  -0.9135   -2.8938    0.0946\nH  -1.9810    2.0650   -0.9487\nH  -0.7587    2.7222    0.0818\nH   1.5605   -0.7646   -1.4951\nH  -1.7642    1.9154    2.0477\nH  -3.1082    2.4431    1.0635\nH   1.0176   -1.9046    1.2859\nH   1.5276   -2.8282   -0.1118\nH   1.2808    2.8061   -0.4944\nH   1.5851    1.6842   -1.8068\nH   0.5898    1.8173    1.8670\nH   0.8147    0.0892    2.1727\nH   2.1832    1.0992    1.8532\nH  -4.1337    1.6158   -1.0351\nH  -5.4265    1.0934    0.0595\nH   3.4273    2.5264    0.4487\nH   3.7385    2.4646   -1.2871\nH  -3.9519   -2.0832    0.7635\nH   4.0442   -2.6573    0.1180\nH  -5.7603   -0.6874   -1.3370\nH   6.3869   -1.2031    0.2186\n","xyz");
	viewergrid_1682423550020245[0][1].addModel("49\nkahweol initial structure\nO  -4.4710   -1.5361    0.0905\nO  -5.6188    0.9753   -0.0811\nO   5.1625    0.5695   -0.0997\nC  -1.2209   -0.8317   -0.2017\nC  -0.4821    0.5357   -0.4703\nC  -3.0038    0.1167    1.0462\nC  -1.8514   -0.8737    1.1997\nC  -2.4967   -0.9058   -1.1119\nC   0.9884    0.6333    0.0944\nC  -3.6676   -0.3924   -0.2474\nC  -0.3220   -2.0551   -0.4569\nC  -1.3919    1.7479   -0.1363\nC  -2.4167    1.5304    0.9816\nC   1.7435   -0.6786   -0.3542\nC   1.0741   -1.9483    0.1552\nC   1.0367    0.8330    1.6293\nC  -4.5845    0.5870   -0.9677\nC   1.7610    1.8511   -0.4907\nC   3.2146   -0.5444   -0.1101\nC   3.1013    1.8722   -0.6493\nC   3.8167    0.6946   -0.3059\nC   4.2309   -1.4546    0.2464\nC   5.3980   -0.7259    0.2399\nH  -0.3415    0.5842   -1.5631\nH  -3.6779    0.0397    1.9072\nH  -1.1861   -0.6021    2.0159\nH  -2.2356   -1.8757    1.4322\nH  -2.3648   -0.3090   -2.0216\nH  -2.6844   -1.9384   -1.4328\nH  -0.2098   -2.1924   -1.5413\nH  -0.8043   -2.9694   -0.0890\nH  -1.9406    2.0033   -1.0514\nH  -0.8134    2.6482    0.0921\nH  -1.9341    1.7452    1.9434\nH  -3.2193    2.2709    0.8849\nH   1.6699   -0.7251   -1.4553\nH   1.0259   -1.9792    1.2481\nH   1.6508   -2.8307   -0.1490\nH   2.0514    1.0518    1.9842\nH   0.4166    1.6762    1.9486\nH   0.7233   -0.0489    2.1864\nH  -5.0524    0.1195   -1.8415\nH  -4.0679    1.4861   -1.3088\nH   1.2088    2.7568   -0.7218\nH  -5.0925   -1.2746    0.7905\nH   3.6240    2.7536   -0.9997\nH   4.1386   -2.5085    0.4650\nH  -6.2132    0.2149    0.0339\nH   6.4308   -0.9731    0.4374\n","xyz");
	viewergrid_1682423550020245[0][0].zoomTo();
	viewergrid_1682423550020245[0][1].zoomTo();
viewergrid_1682423550020245[0][1].render();
viewergrid_1682423550020245[0][0].render();
});
</script></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the xtb driver</span>
<span class="n">method_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xtb&#39;</span><span class="p">:</span><span class="s1">&#39;gfn2&#39;</span><span class="p">}</span>
<span class="n">xtbdrv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">XtbDriver</span><span class="p">()</span>
<span class="n">xtbdrv</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="n">method_settings</span><span class="p">[</span><span class="s1">&#39;xtb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">xtbdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">cafestol</span><span class="p">,</span> <span class="n">ostream</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                        XTB Driver                                                        
                                                       ============                                                       
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3615122026 a.u.                                                                                 
* Info *   Gradient : 8.325170e-03 a.u. (RMS)                                                                             
* Info *              1.928275e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.12 sec                                                                                            
                                                                                                                          
* Info * Reference: C. Bannwarth, E. Caldeweyher, S. Ehlert,                                                              
* Info * A. Hansen, P. Pracht, J. Seibert, S. Spicher, S. Grimme,                                                         
* Info * WIREs Comput. Mol. Sci., 2020, 11, e01493                                                                        
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<section id="set-up-the-xtb-gradient-and-optimization-drivers-and-run-the-geometry-optimization">
<h3>Set up the xtb gradient and optimization drivers and run the geometry optimization<a class="headerlink" href="#set-up-the-xtb-gradient-and-optimization-drivers-and-run-the-geometry-optimization" title="Permalink to this headline">#</a></h3>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtb_grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">XtbGradientDriver</span><span class="p">(</span><span class="n">xtbdrv</span><span class="p">)</span>
<span class="n">xtb_opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">xtb_grad_drv</span><span class="p">)</span>
<span class="n">xtb_opt_cafestol</span> <span class="o">=</span> <span class="n">xtb_opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                Optimization Driver Setup                                                 
                                               ===========================                                                
                                                                                                                          
                                     Coordinate System       :    TRIC                                                    
                                     Constraints             :    No                                                      
                                     Max. Number of Steps    :    300                                                     
                                     Transition State        :    No                                                      
                                     Hessian                 :    never                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 120          :
          :  # atomic orbitals                 120          :
          :  # shells                           74          :
          :  # electrons                       126          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -70.1256729 -0.701257E+02  0.308E+00    4.51       0.0  T
   2    -70.1969288 -0.712559E-01  0.183E+00    4.43       1.0  T
   3    -70.1926047  0.432407E-02  0.777E-01    4.43       1.0  T
   4    -70.2001181 -0.751331E-02  0.340E-01    4.33       1.0  T
   5    -70.2039272 -0.380913E-02  0.779E-02    4.36       1.0  T
   6    -70.2039738 -0.466179E-04  0.373E-02    4.36       1.0  T
   7    -70.2039865 -0.126975E-04  0.138E-02    4.36       1.0  T
   8    -70.2039876 -0.106686E-05  0.338E-03    4.36       4.1  T
   9    -70.2039877 -0.118719E-06  0.156E-03    4.36       9.0  T
  10    -70.2039877 -0.125795E-07  0.589E-04    4.36      23.8  T
  11    -70.2039877 -0.255977E-08  0.214E-04    4.36      65.4  T

   *** convergence criteria satisfied after 11 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7268208             -19.7778
       ...           ...                  ...                  ...
        57        2.0000           -0.4145936             -11.2817
        58        2.0000           -0.4096877             -11.1482
        59        2.0000           -0.4060970             -11.0505
        60        2.0000           -0.4022968             -10.9471
        61        2.0000           -0.4009046             -10.9092
        62        2.0000           -0.3984565             -10.8426
        63        2.0000           -0.3664995              -9.9730 (HOMO)
        64                         -0.2062144              -5.6114 (LUMO)
        65                         -0.1513512              -4.1185
        66                         -0.0221661              -0.6032
        67                          0.0014760               0.0402
        68                          0.0144309               0.3927
       ...                                ...                  ...
       120                          0.6705777              18.2473
      -------------------------------------------------------------
                  HL-Gap            0.1602851 Eh            4.3616 eV
             Fermi-level           -0.2863569 Eh           -7.7922 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.090 sec
 SCC setup                      ...        0 min,  0.002 sec (  1.694%)
 Dispersion                     ...        0 min,  0.002 sec (  2.392%)
 classical contributions        ...        0 min,  0.001 sec (  0.755%)
 integral evaluation            ...        0 min,  0.007 sec (  7.803%)
 iterations                     ...        0 min,  0.051 sec ( 56.333%)
 molecular gradient             ...        0 min,  0.027 sec ( 29.622%)
 printout                       ...        0 min,  0.001 sec (  1.363%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -69.361512202626 Eh    ::
         :: gradient norm              0.059453607714 Eh/a0 ::
         :: HOMO-LUMO gap              4.361580250884 eV    ::
         ::.................................................::
         :: SCC energy               -70.203987702583 Eh    ::
         :: -&gt; isotropic ES            0.064491640234 Eh    ::
         :: -&gt; anisotropic ES          0.010230341319 Eh    ::
         :: -&gt; anisotropic XC          0.020200140987 Eh    ::
         :: -&gt; dispersion             -0.059211487310 Eh    ::
         :: repulsion energy           0.841319621733 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -5.0077878231 a.u.                                                                                  
* Info *   Gradient : 8.274348e-02 a.u. (RMS)                                                                             
* Info *              1.032694e-01 a.u. (Max)                                                                             
* Info *   Time     : 0.01 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                   6          :
          :  # atomic orbitals                   6          :
          :  # shells                            4          :
          :  # electrons                         8          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1     -5.0197018 -0.501970E+01  0.559E+00    8.04       0.0  T
   2     -5.0265706 -0.686875E-02  0.303E+00    7.13       1.0  T
   3     -5.0280150 -0.144438E-02  0.822E-01    6.39       1.0  T
   4     -5.0280753 -0.603658E-04  0.386E-01    6.85       1.0  T
   5     -5.0281892 -0.113896E-03  0.157E-01    6.60       1.0  T
   6     -5.0282053 -0.160605E-04  0.183E-02    6.66       3.2  T
   7     -5.0282054 -0.125000E-06  0.113E-02    6.66       5.1  T
   8     -5.0282055 -0.855668E-07  0.414E-04    6.67     139.3  T
   9     -5.0282055 -0.751941E-10  0.530E-05    6.67    1088.5  T

   *** convergence criteria satisfied after 9 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.6331964             -17.2302
         2        2.0000           -0.5609091             -15.2631
         3        2.0000           -0.4063901             -11.0584
         4        2.0000           -0.3947356             -10.7413 (HOMO)
         5                         -0.1497828              -4.0758 (LUMO)
         6                          0.3162603               8.6059
      -------------------------------------------------------------
                  HL-Gap            0.2449528 Eh            6.6655 eV
             Fermi-level           -0.2722592 Eh           -7.4086 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.002 sec
 SCC setup                      ...        0 min,  0.000 sec (  5.619%)
 Dispersion                     ...        0 min,  0.000 sec (  0.681%)
 classical contributions        ...        0 min,  0.000 sec (  0.377%)
 integral evaluation            ...        0 min,  0.000 sec (  3.889%)
 iterations                     ...        0 min,  0.002 sec ( 80.247%)
 molecular gradient             ...        0 min,  0.000 sec (  4.998%)
 printout                       ...        0 min,  0.000 sec (  3.399%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy              -5.007787823105 Eh    ::
         :: gradient norm              0.143315915589 Eh/a0 ::
         :: HOMO-LUMO gap              6.665503680509 eV    ::
         ::.................................................::
         :: SCC energy                -5.028205484859 Eh    ::
         :: -&gt; isotropic ES            0.047142129713 Eh    ::
         :: -&gt; anisotropic ES          0.002165589349 Eh    ::
         :: -&gt; anisotropic XC          0.000392897530 Eh    ::
         :: -&gt; dispersion             -0.000132720419 Eh    ::
         :: repulsion energy           0.020417662059 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge              -0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                   6          :
          :  # atomic orbitals                   6          :
          :  # shells                            4          :
          :  # electrons                         8          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1     -5.0748384 -0.507484E+01  0.685E-01   10.21       0.0  T
   2     -5.0750139 -0.175494E-03  0.327E-01   10.37       1.0  T
   3     -5.0750404 -0.264845E-04  0.855E-02   10.47       1.0  T
   4     -5.0750415 -0.105517E-05  0.110E-02   10.47       5.2  T
   5     -5.0750415 -0.293862E-07  0.359E-03   10.47      16.1  T
   6     -5.0750415 -0.521258E-08  0.513E-04   10.47     112.5  T
   7     -5.0750415 -0.133116E-09  0.985E-05   10.47     586.2  T

   *** convergence criteria satisfied after 7 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          -0.6546653             -17.8144
         2        2.0000           -0.5754097             -15.6577
         3        2.0000           -0.4429072             -12.0521
         4        2.0000           -0.4175167             -11.3612 (HOMO)
         5                         -0.0327514              -0.8912 (LUMO)
         6                          0.3821567              10.3990
      -------------------------------------------------------------
                  HL-Gap            0.3847653 Eh           10.4700 eV
             Fermi-level           -0.2251340 Eh           -6.1262 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.003 sec
 SCC setup                      ...        0 min,  0.001 sec ( 52.741%)
 Dispersion                     ...        0 min,  0.000 sec (  0.660%)
 classical contributions        ...        0 min,  0.000 sec (  5.331%)
 integral evaluation            ...        0 min,  0.000 sec (  3.299%)
 iterations                     ...        0 min,  0.001 sec ( 20.009%)
 molecular gradient             ...        0 min,  0.000 sec (  4.808%)
 printout                       ...        0 min,  0.000 sec (  2.898%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy              -5.043966469668 Eh    ::
         :: gradient norm              0.097892364135 Eh/a0 ::
         :: HOMO-LUMO gap             10.469996921144 eV    ::
         ::.................................................::
         :: SCC energy                -5.075041498090 Eh    ::
         :: -&gt; isotropic ES            0.039210329610 Eh    ::
         :: -&gt; anisotropic ES         -0.000673241128 Eh    ::
         :: -&gt; anisotropic XC         -0.000768765263 Eh    ::
         :: -&gt; dispersion             -0.000134685713 Eh    ::
         :: repulsion energy           0.031075028544 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -5.0439664697 a.u.                                                                                  
* Info *   Gradient : 5.651818e-02 a.u. (RMS)                                                                             
* Info *              6.950891e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.01 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                   6          :
          :  # atomic orbitals                   6          :
          :  # shells                            4          :
          :  # electrons                         8          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1     -5.1155325 -0.511553E+01  0.956E-01   14.97       0.0  T
   2     -5.1157873 -0.254739E-03  0.483E-01   15.13       1.0  T
   3     -5.1158279 -0.406770E-04  0.114E-01   15.24       1.0  T
   4     -5.1158302 -0.221925E-05  0.145E-02   15.22       4.0  T
   5     -5.1158302 -0.373938E-07  0.478E-03   15.22      12.1  T
   6     -5.1158302 -0.100728E-07  0.484E-04   15.22     119.2  T
   7     -5.1158302 -0.157021E-10  0.589E-05   15.22     980.0  T

   *** convergence criteria satisfied after 7 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.6799418             -18.5022
         2        2.0000           -0.5788943             -15.7525
         3        2.0000           -0.4923998             -13.3989
         4        2.0000           -0.4423005             -12.0356 (HOMO)
         5                          0.1171494               3.1878 (LUMO)
         6                          0.4225401              11.4979
      -------------------------------------------------------------
                  HL-Gap            0.5594499 Eh           15.2234 eV
             Fermi-level           -0.1625756 Eh           -4.4239 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.002 sec
 SCC setup                      ...        0 min,  0.001 sec ( 36.684%)
 Dispersion                     ...        0 min,  0.000 sec (  0.541%)
 classical contributions        ...        0 min,  0.000 sec (  0.353%)
 integral evaluation            ...        0 min,  0.000 sec (  3.083%)
 iterations                     ...        0 min,  0.001 sec ( 51.788%)
 molecular gradient             ...        0 min,  0.000 sec (  4.134%)
 printout                       ...        0 min,  0.000 sec (  2.684%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy              -5.062507276421 Eh    ::
         :: gradient norm              0.126399343274 Eh/a0 ::
         :: HOMO-LUMO gap             15.223406399801 eV    ::
         ::.................................................::
         :: SCC energy                -5.115830208283 Eh    ::
         :: -&gt; isotropic ES            0.032411995229 Eh    ::
         :: -&gt; anisotropic ES         -0.000748560226 Eh    ::
         :: -&gt; anisotropic XC         -0.001621573296 Eh    ::
         :: -&gt; dispersion             -0.000138883100 Eh    ::
         :: repulsion energy           0.053322931868 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -5.0625072764 a.u.                                                                                  
* Info *   Gradient : 7.297669e-02 a.u. (RMS)                                                                             
* Info *              9.333752e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.01 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                   6          :
          :  # atomic orbitals                   6          :
          :  # shells                            4          :
          :  # electrons                         8          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1     -5.1079848 -0.510798E+01  0.663E-01   14.72       0.0  T
   2     -5.1081145 -0.129618E-03  0.340E-01   14.81       1.0  T
   3     -5.1081342 -0.197536E-04  0.963E-02   14.85       1.0  T
   4     -5.1081359 -0.171687E-05  0.146E-02   14.83       4.0  T
   5     -5.1081359 -0.738792E-08  0.264E-03   14.83      21.8  T
   6     -5.1081359 -0.375140E-08  0.472E-04   14.83     122.4  T
   7     -5.1081359 -0.444693E-10  0.833E-05   14.83     693.1  T

   *** convergence criteria satisfied after 7 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.6815565             -18.5461
         2        2.0000           -0.5692963             -15.4913
         3        2.0000           -0.5109918             -13.9048
         4        2.0000           -0.4468743             -12.1601 (HOMO)
         5                          0.0982543               2.6736 (LUMO)
         6                          0.2735296               7.4431
      -------------------------------------------------------------
                  HL-Gap            0.5451287 Eh           14.8337 eV
             Fermi-level           -0.1743100 Eh           -4.7432 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.002 sec
 SCC setup                      ...        0 min,  0.000 sec (  6.204%)
 Dispersion                     ...        0 min,  0.000 sec (  0.654%)
 classical contributions        ...        0 min,  0.000 sec (  0.401%)
 integral evaluation            ...        0 min,  0.000 sec (  3.757%)
 iterations                     ...        0 min,  0.002 sec ( 78.887%)
 molecular gradient             ...        0 min,  0.000 sec (  5.663%)
 printout                       ...        0 min,  0.000 sec (  3.431%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy              -5.070317736513 Eh    ::
         :: gradient norm              0.020354220308 Eh/a0 ::
         :: HOMO-LUMO gap             14.833705614917 eV    ::
         ::.................................................::
         :: SCC energy                -5.108135935741 Eh    ::
         :: -&gt; isotropic ES            0.031457489281 Eh    ::
         :: -&gt; anisotropic ES          0.000331767944 Eh    ::
         :: -&gt; anisotropic XC         -0.001003672096 Eh    ::
         :: -&gt; dispersion             -0.000140853354 Eh    ::
         :: repulsion energy           0.037818199204 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -5.0703177365 a.u.                                                                                  
* Info *   Gradient : 1.175151e-02 a.u. (RMS)                                                                             
* Info *              1.454898e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.01 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                   6          :
          :  # atomic orbitals                   6          :
          :  # shells                            4          :
          :  # electrons                         8          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1     -5.1052362 -0.510524E+01  0.815E-02   14.41       0.0  T
   2     -5.1052370 -0.791967E-06  0.458E-02   14.41       1.3  T
   3     -5.1052372 -0.172833E-06  0.822E-03   14.41       7.0  T
   4     -5.1052372 -0.213531E-07  0.209E-03   14.41      27.7  T
   5     -5.1052372 -0.455082E-09  0.134E-04   14.41     429.7  T
   6     -5.1052372 -0.352163E-11  0.627E-05   14.41     920.9  T

   *** convergence criteria satisfied after 6 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.6800524             -18.5052
         2        2.0000           -0.5686543             -15.4739
         3        2.0000           -0.5103726             -13.8879
         4        2.0000           -0.4462900             -12.1442 (HOMO)
         5                          0.0833319               2.2676 (LUMO)
         6                          0.2549017               6.9362
      -------------------------------------------------------------
                  HL-Gap            0.5296219 Eh           14.4117 eV
             Fermi-level           -0.1814791 Eh           -4.9383 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.001 sec
 SCC setup                      ...        0 min,  0.000 sec ( 14.111%)
 Dispersion                     ...        0 min,  0.000 sec (  1.534%)
 classical contributions        ...        0 min,  0.000 sec ( 24.300%)
 integral evaluation            ...        0 min,  0.000 sec (  7.325%)
 iterations                     ...        0 min,  0.000 sec ( 35.770%)
 molecular gradient             ...        0 min,  0.000 sec (  9.163%)
 printout                       ...        0 min,  0.000 sec (  6.164%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy              -5.070539265710 Eh    ::
         :: gradient norm              0.002564316295 Eh/a0 ::
         :: HOMO-LUMO gap             14.411745970779 eV    ::
         ::.................................................::
         :: SCC energy                -5.105237235976 Eh    ::
         :: -&gt; isotropic ES            0.031471983478 Eh    ::
         :: -&gt; anisotropic ES          0.000361474426 Eh    ::
         :: -&gt; anisotropic XC         -0.000902413222 Eh    ::
         :: -&gt; dispersion             -0.000141034920 Eh    ::
         :: repulsion energy           0.034697970241 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -5.0705392657 a.u.                                                                                  
* Info *   Gradient : 1.480509e-03 a.u. (RMS)                                                                             
* Info *              1.993165e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.01 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                   6          :
          :  # atomic orbitals                   6          :
          :  # shells                            4          :
          :  # electrons                         8          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1     -5.1049240 -0.510492E+01  0.229E-02   14.40       0.0  T
   2     -5.1049241 -0.142764E-06  0.121E-02   14.40       4.8  T
   3     -5.1049242 -0.227550E-07  0.345E-03   14.40      16.7  T
   4     -5.1049242 -0.229312E-08  0.511E-04   14.40     113.0  T
   5     -5.1049242 -0.120393E-10  0.300E-05   14.40    1926.9  T

   *** convergence criteria satisfied after 5 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.6801585             -18.5081
         2        2.0000           -0.5682116             -15.4618
         3        2.0000           -0.5110709             -13.9069
         4        2.0000           -0.4464441             -12.1484 (HOMO)
         5                          0.0827542               2.2519 (LUMO)
         6                          0.2510667               6.8319
      -------------------------------------------------------------
                  HL-Gap            0.5291982 Eh           14.4002 eV
             Fermi-level           -0.1818449 Eh           -4.9483 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.003 sec
 SCC setup                      ...        0 min,  0.001 sec ( 28.507%)
 Dispersion                     ...        0 min,  0.000 sec (  0.616%)
 classical contributions        ...        0 min,  0.001 sec ( 32.948%)
 integral evaluation            ...        0 min,  0.000 sec (  2.699%)
 iterations                     ...        0 min,  0.001 sec ( 28.272%)
 molecular gradient             ...        0 min,  0.000 sec (  3.605%)
 printout                       ...        0 min,  0.000 sec (  2.412%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy              -5.070543981965 Eh    ::
         :: gradient norm              0.000442982456 Eh/a0 ::
         :: HOMO-LUMO gap             14.400217322596 eV    ::
         ::.................................................::
         :: SCC energy                -5.104924159535 Eh    ::
         :: -&gt; isotropic ES            0.031454378114 Eh    ::
         :: -&gt; anisotropic ES          0.000406160401 Eh    ::
         :: -&gt; anisotropic XC         -0.000878562528 Eh    ::
         :: -&gt; dispersion             -0.000141093650 Eh    ::
         :: repulsion energy           0.034380177544 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -5.0705439820 a.u.                                                                                  
* Info *   Gradient : 2.557560e-04 a.u. (RMS)                                                                             
* Info *              2.823787e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.01 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                   6          :
          :  # atomic orbitals                   6          :
          :  # shells                            4          :
          :  # electrons                         8          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1     -5.1049104 -0.510491E+01  0.513E-03   14.39       0.0  T
   2     -5.1049104 -0.502174E-08  0.284E-03   14.39      20.3  T
   3     -5.1049104 -0.728636E-09  0.660E-04   14.39      87.5  T
   4     -5.1049104 -0.948841E-10  0.953E-05   14.39     606.1  T

   *** convergence criteria satisfied after 4 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.6800816             -18.5060
         2        2.0000           -0.5683071             -15.4644
         3        2.0000           -0.5108669             -13.9014
         4        2.0000           -0.4463847             -12.1467 (HOMO)
         5                          0.0824122               2.2426 (LUMO)
         6                          0.2514825               6.8432
      -------------------------------------------------------------
                  HL-Gap            0.5287969 Eh           14.3893 eV
             Fermi-level           -0.1819862 Eh           -4.9521 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.003 sec
 SCC setup                      ...        0 min,  0.002 sec ( 47.809%)
 Dispersion                     ...        0 min,  0.000 sec (  0.497%)
 classical contributions        ...        0 min,  0.000 sec (  0.412%)
 integral evaluation            ...        0 min,  0.000 sec (  2.495%)
 iterations                     ...        0 min,  0.000 sec ( 11.394%)
 molecular gradient             ...        0 min,  0.001 sec ( 31.916%)
 printout                       ...        0 min,  0.000 sec (  4.523%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy              -5.070544447551 Eh    ::
         :: gradient norm              0.000015504699 Eh/a0 ::
         :: HOMO-LUMO gap             14.389296792020 eV    ::
         ::.................................................::
         :: SCC energy                -5.104910368671 Eh    ::
         :: -&gt; isotropic ES            0.031459289816 Eh    ::
         :: -&gt; anisotropic ES          0.000395567320 Eh    ::
         :: -&gt; anisotropic XC         -0.000881497909 Eh    ::
         :: -&gt; dispersion             -0.000141084408 Eh    ::
         :: repulsion energy           0.034365921094 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -5.0705444476 a.u.                                                                                  
* Info *   Gradient : 8.951642e-06 a.u. (RMS)                                                                             
* Info *              1.243315e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.01 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Saving file: veloxchem_opt_2023-04-25T13.52.30_optim.xyz                                                         
* Info * Saving file: veloxchem_opt_2023-04-25T13.52.30.log                                                               
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Geometry optimization completed.                                                                                 
                                                                                                                          
                                              Molecular Geometry (Angstroms)                                              
                                             ================================                                             
                                                                                                                          
                          Atom         Coordinate X          Coordinate Y          Coordinate Z                           
                                                                                                                          
                           O          -0.251528013886        0.066105871310        0.031627083280                         
                           H           0.364972557710        0.644608711805        0.484787259932                         
                           H           0.266239456176       -0.605241683115       -0.417061943212                         
                                                                                                                          
                                                                                                                          
                                             Summary of Geometry Optimization                                             
                                            ==================================                                            
                                                                                                                          
                  Opt.Step       Energy (a.u.)       Energy Change (a.u.)       Displacement (RMS, Max)                   
                  -------------------------------------------------------------------------------------                   
                      0          -5.007787823105        0.000000000000         0.000e+00      0.000e+00                   
                      1          -5.043966469668       -0.036178646563         9.963e-02      1.209e-01                   
                      2          -5.062507276421       -0.018540806753         1.381e-01      1.625e-01                   
                      3          -5.070317736513       -0.007810460092         5.716e-02      7.373e-02                   
                      4          -5.070539265710       -0.000221529197         7.588e-03      1.036e-02                   
                      5          -5.070543981965       -0.000004716255         2.430e-03      2.790e-03                   
                      6          -5.070544447551       -0.000000465586         7.558e-04      8.346e-04                   
                                                                                                                          
                                                                                                                          
                                              Statistical Deviation between                                               
                                         Optimized Geometry and Initial Geometry                                          
                                        =========================================                                         
                                                                                                                          
                               Internal Coord.        RMS deviation         Max. deviation                                
                               -----------------------------------------------------------                                
                                  Bonds               0.121 Angstrom        0.171 Angstrom                                
                                  Angles             52.390 degree         52.390 degree                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                     *** Time spent in Optimization Driver: 0.26 sec                                      
                                                                                                                          
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-xtb-structure-optimization-for-kahweol">
<h3>Run the XTB structure optimization for kahweol:<a class="headerlink" href="#run-the-xtb-structure-optimization-for-kahweol" title="Permalink to this headline">#</a></h3>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtbdrv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">XtbDriver</span><span class="p">()</span>
<span class="n">xtbdrv</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="n">method_settings</span><span class="p">[</span><span class="s1">&#39;xtb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">xtbdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">kahweol</span><span class="p">,</span> <span class="n">ostream</span><span class="p">)</span>
<span class="n">xtb_grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">XtbGradientDriver</span><span class="p">(</span><span class="n">xtbdrv</span><span class="p">)</span>
<span class="n">xtb_opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">xtb_grad_drv</span><span class="p">)</span>
<span class="n">xtb_opt_kahweol</span> <span class="o">=</span> <span class="n">xtb_opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">kahweol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                        XTB Driver                                                        
                                                       ============                                                       
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.0945256 -0.690945E+02  0.335E+00    3.05       0.0  T
   2    -69.1552391 -0.607135E-01  0.197E+00    3.02       1.0  T
   3    -69.1496721  0.556704E-02  0.776E-01    3.01       1.0  T
   4    -69.1587260 -0.905395E-02  0.308E-01    2.99       1.0  T
   5    -69.1617692 -0.304311E-02  0.807E-02    3.00       1.0  T
   6    -69.1618210 -0.518211E-04  0.439E-02    3.00       1.0  T
   7    -69.1618464 -0.254646E-04  0.237E-02    3.00       1.0  T
   8    -69.1618577 -0.112592E-04  0.101E-02    3.00       1.4  T
   9    -69.1618597 -0.199642E-05  0.261E-03    3.00       5.5  T
  10    -69.1618598 -0.677972E-07  0.144E-03    3.00       9.9  T
  11    -69.1618598 -0.381185E-07  0.545E-04    3.00      26.2  T
  12    -69.1618598 -0.377010E-08  0.158E-04    3.00      90.1  T

   *** convergence criteria satisfied after 12 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7255326             -19.7427
       ...           ...                  ...                  ...
        56        2.0000           -0.4203811             -11.4392
        57        2.0000           -0.4084609             -11.1148
        58        2.0000           -0.4076528             -11.0928
        59        2.0000           -0.4020316             -10.9398
        60        2.0000           -0.3988397             -10.8530
        61        2.0000           -0.3963877             -10.7863
        62        2.0000           -0.3564174              -9.6986 (HOMO)
        63                         -0.2461602              -6.6984 (LUMO)
        64                         -0.1788396              -4.8665
        65                         -0.1267271              -3.4484
        66                         -0.0099203              -0.2699
        67                          0.0051269               0.1395
       ...                                ...                  ...
       118                          0.6709176              18.2566
      -------------------------------------------------------------
                  HL-Gap            0.1102572 Eh            3.0003 eV
             Fermi-level           -0.3012888 Eh           -8.1985 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.081 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.561%)
 Dispersion                     ...        0 min,  0.001 sec (  0.929%)
 classical contributions        ...        0 min,  0.000 sec (  0.263%)
 integral evaluation            ...        0 min,  0.008 sec ( 10.146%)
 iterations                     ...        0 min,  0.044 sec ( 54.564%)
 molecular gradient             ...        0 min,  0.027 sec ( 33.157%)
 printout                       ...        0 min,  0.000 sec (  0.337%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.310234156957 Eh    ::
         :: gradient norm              0.059015972263 Eh/a0 ::
         :: HOMO-LUMO gap              3.000251409403 eV    ::
         ::.................................................::
         :: SCC energy               -69.161859807846 Eh    ::
         :: -&gt; isotropic ES            0.064055799707 Eh    ::
         :: -&gt; anisotropic ES          0.010957972238 Eh    ::
         :: -&gt; anisotropic XC          0.020993529454 Eh    ::
         :: -&gt; dispersion             -0.057983897157 Eh    ::
         :: repulsion energy           0.850629559592 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3102341570 a.u.                                                                                 
* Info *   Gradient : 8.430853e-03 a.u. (RMS)                                                                             
* Info *              3.152908e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.09 sec                                                                                            
                                                                                                                          
* Info * Reference: C. Bannwarth, E. Caldeweyher, S. Ehlert,                                                              
* Info * A. Hansen, P. Pracht, J. Seibert, S. Spicher, S. Grimme,                                                         
* Info * WIREs Comput. Mol. Sci., 2020, 11, e01493                                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                Optimization Driver Setup                                                 
                                               ===========================                                                
                                                                                                                          
                                     Coordinate System       :    TRIC                                                    
                                     Constraints             :    No                                                      
                                     Max. Number of Steps    :    300                                                     
                                     Transition State        :    No                                                      
                                     Hessian                 :    never                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.1618598 -0.691619E+02  0.722E-05    3.00       0.0  T
   2    -69.1618598 -0.256080E-10  0.411E-05    3.00     347.5  T
   3    -69.1618598  0.517275E-11  0.297E-05    3.00     481.3  T

   *** convergence criteria satisfied after 3 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7255319             -19.7427
       ...           ...                  ...                  ...
        56        2.0000           -0.4203815             -11.4392
        57        2.0000           -0.4084615             -11.1148
        58        2.0000           -0.4076535             -11.0928
        59        2.0000           -0.4020321             -10.9398
        60        2.0000           -0.3988402             -10.8530
        61        2.0000           -0.3963877             -10.7863
        62        2.0000           -0.3564174              -9.6986 (HOMO)
        63                         -0.2461602              -6.6984 (LUMO)
        64                         -0.1788400              -4.8665
        65                         -0.1267268              -3.4484
        66                         -0.0099209              -0.2700
        67                          0.0051276               0.1395
       ...                                ...                  ...
       118                          0.6709173              18.2566
      -------------------------------------------------------------
                  HL-Gap            0.1102572 Eh            3.0003 eV
             Fermi-level           -0.3012888 Eh           -8.1985 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.047 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.688%)
 Dispersion                     ...        0 min,  0.001 sec (  1.071%)
 classical contributions        ...        0 min,  0.000 sec (  0.493%)
 integral evaluation            ...        0 min,  0.005 sec ( 11.084%)
 iterations                     ...        0 min,  0.011 sec ( 24.512%)
 molecular gradient             ...        0 min,  0.029 sec ( 61.502%)
 printout                       ...        0 min,  0.000 sec (  0.584%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.310234157198 Eh    ::
         :: gradient norm              0.059016261886 Eh/a0 ::
         :: HOMO-LUMO gap              3.000251177667 eV    ::
         ::.................................................::
         :: SCC energy               -69.161859808087 Eh    ::
         :: -&gt; isotropic ES            0.064056455814 Eh    ::
         :: -&gt; anisotropic ES          0.010958185776 Eh    ::
         :: -&gt; anisotropic XC          0.020993499483 Eh    ::
         :: -&gt; dispersion             -0.057983927403 Eh    ::
         :: repulsion energy           0.850629559592 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3102341572 a.u.                                                                                 
* Info *   Gradient : 8.430895e-03 a.u. (RMS)                                                                             
* Info *              3.152932e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2220861 -0.692221E+02  0.320E-01    3.15       0.0  T
   2    -69.2222040 -0.117957E-03  0.195E-01    3.14       1.0  T
   3    -69.2218329  0.371111E-03  0.112E-01    3.15       1.0  T
   4    -69.2222881 -0.455206E-03  0.189E-02    3.15       1.0  T
   5    -69.2222983 -0.101543E-04  0.742E-03    3.15       1.9  T
   6    -69.2222993 -0.100072E-05  0.362E-03    3.15       3.9  T
   7    -69.2222994 -0.116416E-06  0.134E-03    3.15      10.7  T
   8    -69.2222994 -0.259887E-07  0.574E-04    3.15      24.9  T
   9    -69.2222994 -0.243799E-08  0.213E-04    3.15      67.1  T

   *** convergence criteria satisfied after 9 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7303984             -19.8752
       ...           ...                  ...                  ...
        56        2.0000           -0.4207420             -11.4490
        57        2.0000           -0.4102539             -11.1636
        58        2.0000           -0.4091121             -11.1325
        59        2.0000           -0.4015630             -10.9271
        60        2.0000           -0.3979475             -10.8287
        61        2.0000           -0.3948058             -10.7432
        62        2.0000           -0.3585825              -9.7575 (HOMO)
        63                         -0.2429356              -6.6106 (LUMO)
        64                         -0.1762779              -4.7968
        65                         -0.1230107              -3.3473
        66                          0.0062671               0.1705
        67                          0.0172302               0.4689
       ...                                ...                  ...
       118                          0.7033797              19.1399
      -------------------------------------------------------------
                  HL-Gap            0.1156468 Eh            3.1469 eV
             Fermi-level           -0.3007591 Eh           -8.1841 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.065 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.644%)
 Dispersion                     ...        0 min,  0.001 sec (  0.938%)
 classical contributions        ...        0 min,  0.001 sec (  1.108%)
 integral evaluation            ...        0 min,  0.005 sec (  8.511%)
 iterations                     ...        0 min,  0.031 sec ( 47.949%)
 molecular gradient             ...        0 min,  0.026 sec ( 40.372%)
 printout                       ...        0 min,  0.000 sec (  0.420%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.319437730841 Eh    ::
         :: gradient norm              0.026520967246 Eh/a0 ::
         :: HOMO-LUMO gap              3.146910584690 eV    ::
         ::.................................................::
         :: SCC energy               -69.222299431778 Eh    ::
         :: -&gt; isotropic ES            0.062994069984 Eh    ::
         :: -&gt; anisotropic ES          0.010255803050 Eh    ::
         :: -&gt; anisotropic XC          0.020083937536 Eh    ::
         :: -&gt; dispersion             -0.059129190703 Eh    ::
         :: repulsion energy           0.901870190442 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3194377308 a.u.                                                                                 
* Info *   Gradient : 3.788710e-03 a.u. (RMS)                                                                             
* Info *              1.025883e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.07 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2191977 -0.692192E+02  0.126E-01    3.19       0.0  T
   2    -69.2192095 -0.117238E-04  0.760E-02    3.18       1.0  T
   3    -69.2191877  0.217979E-04  0.232E-02    3.18       1.0  T
   4    -69.2192140 -0.263208E-04  0.383E-03    3.18       3.7  T
   5    -69.2192143 -0.316581E-06  0.202E-03    3.18       7.1  T
   6    -69.2192143 -0.159674E-07  0.735E-04    3.18      19.4  T
   7    -69.2192143 -0.932397E-08  0.382E-04    3.18      37.4  T

   *** convergence criteria satisfied after 7 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7303696             -19.8744
       ...           ...                  ...                  ...
        56        2.0000           -0.4202194             -11.4348
        57        2.0000           -0.4098027             -11.1513
        58        2.0000           -0.4091292             -11.1330
        59        2.0000           -0.4023207             -10.9477
        60        2.0000           -0.3976901             -10.8217
        61        2.0000           -0.3942878             -10.7291
        62        2.0000           -0.3589387              -9.7672 (HOMO)
        63                         -0.2420114              -6.5855 (LUMO)
        64                         -0.1756812              -4.7805
        65                         -0.1247274              -3.3940
        66                          0.0056623               0.1541
        67                          0.0170185               0.4631
       ...                                ...                  ...
       118                          0.6959229              18.9370
      -------------------------------------------------------------
                  HL-Gap            0.1169274 Eh            3.1818 eV
             Fermi-level           -0.3004750 Eh           -8.1763 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.059 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.552%)
 Dispersion                     ...        0 min,  0.000 sec (  0.742%)
 classical contributions        ...        0 min,  0.000 sec (  0.371%)
 integral evaluation            ...        0 min,  0.006 sec (  9.687%)
 iterations                     ...        0 min,  0.025 sec ( 42.749%)
 molecular gradient             ...        0 min,  0.027 sec ( 45.242%)
 printout                       ...        0 min,  0.000 sec (  0.603%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.320707883896 Eh    ::
         :: gradient norm              0.011872660044 Eh/a0 ::
         :: HOMO-LUMO gap              3.181755313585 eV    ::
         ::.................................................::
         :: SCC energy               -69.219214327332 Eh    ::
         :: -&gt; isotropic ES            0.062733149999 Eh    ::
         :: -&gt; anisotropic ES          0.010122594533 Eh    ::
         :: -&gt; anisotropic XC          0.020029023847 Eh    ::
         :: -&gt; dispersion             -0.058876579015 Eh    ::
         :: repulsion energy           0.897516403291 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge              -0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3207078839 a.u.                                                                                 
* Info *   Gradient : 1.696094e-03 a.u. (RMS)                                                                             
* Info *              5.380955e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.07 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2139983 -0.692140E+02  0.943E-02    3.17       0.0  T
   2    -69.2140049 -0.662579E-05  0.570E-02    3.18       1.0  T
   3    -69.2139782  0.267462E-04  0.267E-02    3.17       1.0  T
   4    -69.2140082 -0.300049E-04  0.446E-03    3.17       3.2  T
   5    -69.2140087 -0.527423E-06  0.162E-03    3.17       8.8  T
   6    -69.2140087 -0.374575E-07  0.897E-04    3.17      15.9  T
   7    -69.2140087 -0.979654E-08  0.334E-04    3.17      42.8  T

   *** convergence criteria satisfied after 7 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7312725             -19.8989
       ...           ...                  ...                  ...
        56        2.0000           -0.4200093             -11.4290
        57        2.0000           -0.4100084             -11.1569
        58        2.0000           -0.4091246             -11.1328
        59        2.0000           -0.4020444             -10.9402
        60        2.0000           -0.3975846             -10.8188
        61        2.0000           -0.3937372             -10.7141
        62        2.0000           -0.3589376              -9.7672 (HOMO)
        63                         -0.2422892              -6.5930 (LUMO)
        64                         -0.1765184              -4.8033
        65                         -0.1257057              -3.4206
        66                          0.0070120               0.1908
        67                          0.0178664               0.4862
       ...                                ...                  ...
       118                          0.6911095              18.8060
      -------------------------------------------------------------
                  HL-Gap            0.1166484 Eh            3.1742 eV
             Fermi-level           -0.3006134 Eh           -8.1801 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.069 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.476%)
 Dispersion                     ...        0 min,  0.001 sec (  0.869%)
 classical contributions        ...        0 min,  0.000 sec (  0.174%)
 integral evaluation            ...        0 min,  0.006 sec (  8.222%)
 iterations                     ...        0 min,  0.028 sec ( 40.709%)
 molecular gradient             ...        0 min,  0.034 sec ( 49.080%)
 printout                       ...        0 min,  0.000 sec (  0.422%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321101833645 Eh    ::
         :: gradient norm              0.006090445239 Eh/a0 ::
         :: HOMO-LUMO gap              3.174164565663 eV    ::
         ::.................................................::
         :: SCC energy               -69.214008736848 Eh    ::
         :: -&gt; isotropic ES            0.062488222400 Eh    ::
         :: -&gt; anisotropic ES          0.010331593343 Eh    ::
         :: -&gt; anisotropic XC          0.020104874369 Eh    ::
         :: -&gt; dispersion             -0.058839926222 Eh    ::
         :: repulsion energy           0.891909755590 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3211018336 a.u.                                                                                 
* Info *   Gradient : 8.700636e-04 a.u. (RMS)                                                                             
* Info *              2.454892e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.08 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2153091 -0.692153E+02  0.589E-02    3.18       0.0  T
   2    -69.2153103 -0.115035E-05  0.353E-02    3.18       1.0  T
   3    -69.2153048  0.543959E-05  0.116E-02    3.18       1.2  T
   4    -69.2153110 -0.615809E-05  0.189E-03    3.18       7.6  T
   5    -69.2153111 -0.875889E-07  0.895E-04    3.18      16.0  T
   6    -69.2153111 -0.593646E-08  0.433E-04    3.18      33.0  T

   *** convergence criteria satisfied after 6 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7311189             -19.8948
       ...           ...                  ...                  ...
        56        2.0000           -0.4200862             -11.4311
        57        2.0000           -0.4099900             -11.1564
        58        2.0000           -0.4091818             -11.1344
        59        2.0000           -0.4021065             -10.9419
        60        2.0000           -0.3975780             -10.8186
        61        2.0000           -0.3936265             -10.7111
        62        2.0000           -0.3591368              -9.7726 (HOMO)
        63                         -0.2423132              -6.5937 (LUMO)
        64                         -0.1763428              -4.7985
        65                         -0.1257850              -3.4228
        66                          0.0083300               0.2267
        67                          0.0186711               0.5081
       ...                                ...                  ...
       118                          0.6900721              18.7778
      -------------------------------------------------------------
                  HL-Gap            0.1168236 Eh            3.1789 eV
             Fermi-level           -0.3007250 Eh           -8.1831 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.063 sec
 SCC setup                      ...        0 min,  0.007 sec ( 11.022%)
 Dispersion                     ...        0 min,  0.001 sec (  2.343%)
 classical contributions        ...        0 min,  0.000 sec (  0.689%)
 integral evaluation            ...        0 min,  0.009 sec ( 14.412%)
 iterations                     ...        0 min,  0.019 sec ( 30.716%)
 molecular gradient             ...        0 min,  0.025 sec ( 40.321%)
 printout                       ...        0 min,  0.000 sec (  0.431%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321262321180 Eh    ::
         :: gradient norm              0.005012732822 Eh/a0 ::
         :: HOMO-LUMO gap              3.178932044599 eV    ::
         ::.................................................::
         :: SCC energy               -69.215311084067 Eh    ::
         :: -&gt; isotropic ES            0.062460276471 Eh    ::
         :: -&gt; anisotropic ES          0.010232492603 Eh    ::
         :: -&gt; anisotropic XC          0.020050138283 Eh    ::
         :: -&gt; dispersion             -0.058933676473 Eh    ::
         :: repulsion energy           0.893049287671 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3212623212 a.u.                                                                                 
* Info *   Gradient : 7.161047e-04 a.u. (RMS)                                                                             
* Info *              1.889722e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.07 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2173909 -0.692174E+02  0.686E-02    3.18       0.0  T
   2    -69.2173918 -0.919336E-06  0.407E-02    3.18       1.0  T
   3    -69.2173906  0.120248E-05  0.590E-03    3.18       2.4  T
   4    -69.2173921 -0.154379E-05  0.162E-03    3.18       8.8  T
   5    -69.2173922 -0.380557E-07  0.776E-04    3.18      18.4  T
   6    -69.2173922 -0.245349E-08  0.400E-04    3.18      35.7  T

   *** convergence criteria satisfied after 6 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7315814             -19.9073
       ...           ...                  ...                  ...
        56        2.0000           -0.4203264             -11.4377
        57        2.0000           -0.4103865             -11.1672
        58        2.0000           -0.4093912             -11.1401
        59        2.0000           -0.4022773             -10.9465
        60        2.0000           -0.3977361             -10.8229
        61        2.0000           -0.3936442             -10.7116
        62        2.0000           -0.3590502              -9.7703 (HOMO)
        63                         -0.2423228              -6.5939 (LUMO)
        64                         -0.1764843              -4.8024
        65                         -0.1259966              -3.4285
        66                          0.0090473               0.2462
        67                          0.0190532               0.5185
       ...                                ...                  ...
       118                          0.6904971              18.7894
      -------------------------------------------------------------
                  HL-Gap            0.1167274 Eh            3.1763 eV
             Fermi-level           -0.3006865 Eh           -8.1821 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.059 sec
 SCC setup                      ...        0 min,  0.001 sec (  1.503%)
 Dispersion                     ...        0 min,  0.001 sec (  2.195%)
 classical contributions        ...        0 min,  0.000 sec (  0.722%)
 integral evaluation            ...        0 min,  0.007 sec ( 11.907%)
 iterations                     ...        0 min,  0.025 sec ( 41.972%)
 molecular gradient             ...        0 min,  0.024 sec ( 41.189%)
 printout                       ...        0 min,  0.000 sec (  0.454%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321347171693 Eh    ::
         :: gradient norm              0.004565964377 Eh/a0 ::
         :: HOMO-LUMO gap              3.176314547100 eV    ::
         ::.................................................::
         :: SCC energy               -69.217392155142 Eh    ::
         :: -&gt; isotropic ES            0.062382729063 Eh    ::
         :: -&gt; anisotropic ES          0.010152015574 Eh    ::
         :: -&gt; anisotropic XC          0.020069275283 Eh    ::
         :: -&gt; dispersion             -0.059019916717 Eh    ::
         :: repulsion energy           0.895042493194 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge              -0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3213471717 a.u.                                                                                 
* Info *   Gradient : 6.522806e-04 a.u. (RMS)                                                                             
* Info *              1.478018e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.07 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2168121 -0.692168E+02  0.259E-02    3.18       0.0  T
   2    -69.2168124 -0.325100E-06  0.155E-02    3.18       1.0  T
   3    -69.2168110  0.138500E-05  0.606E-03    3.18       2.4  T
   4    -69.2168126 -0.156022E-05  0.103E-03    3.18      13.9  T
   5    -69.2168126 -0.238700E-07  0.485E-04    3.18      29.5  T
   6    -69.2168126 -0.388611E-08  0.246E-04    3.18      58.2  T

   *** convergence criteria satisfied after 6 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7314482             -19.9037
       ...           ...                  ...                  ...
        56        2.0000           -0.4204078             -11.4399
        57        2.0000           -0.4104584             -11.1691
        58        2.0000           -0.4094511             -11.1417
        59        2.0000           -0.4023870             -10.9495
        60        2.0000           -0.3978584             -10.8263
        61        2.0000           -0.3937960             -10.7157
        62        2.0000           -0.3592066              -9.7745 (HOMO)
        63                         -0.2424839              -6.5983 (LUMO)
        64                         -0.1764531              -4.8015
        65                         -0.1258919              -3.4257
        66                          0.0082323               0.2240
        67                          0.0182307               0.4961
       ...                                ...                  ...
       118                          0.6909726              18.8023
      -------------------------------------------------------------
                  HL-Gap            0.1167227 Eh            3.1762 eV
             Fermi-level           -0.3008452 Eh           -8.1864 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.053 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.591%)
 Dispersion                     ...        0 min,  0.000 sec (  0.845%)
 classical contributions        ...        0 min,  0.000 sec (  0.225%)
 integral evaluation            ...        0 min,  0.007 sec ( 12.743%)
 iterations                     ...        0 min,  0.021 sec ( 40.333%)
 molecular gradient             ...        0 min,  0.024 sec ( 44.640%)
 printout                       ...        0 min,  0.000 sec (  0.523%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321403406885 Eh    ::
         :: gradient norm              0.002110919773 Eh/a0 ::
         :: HOMO-LUMO gap              3.176186578238 eV    ::
         ::.................................................::
         :: SCC energy               -69.216812635433 Eh    ::
         :: -&gt; isotropic ES            0.062440536597 Eh    ::
         :: -&gt; anisotropic ES          0.010141136672 Eh    ::
         :: -&gt; anisotropic XC          0.020058718350 Eh    ::
         :: -&gt; dispersion             -0.058985738822 Eh    ::
         :: repulsion energy           0.894406423624 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3214034069 a.u.                                                                                 
* Info *   Gradient : 3.015600e-04 a.u. (RMS)                                                                             
* Info *              7.622212e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3214289182 a.u.                                                                                 
* Info *   Gradient : 1.800950e-04 a.u. (RMS)                                                                             
* Info *              4.199760e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2160272 -0.692160E+02  0.220E-02    3.17       0.0  T
   2    -69.2160274 -0.215962E-06  0.132E-02    3.17       1.1  T
   3    -69.2160266  0.823549E-06  0.494E-03    3.17       2.9  T
   4    -69.2160275 -0.957269E-06  0.860E-04    3.17      16.6  T
   5    -69.2160275 -0.911497E-08  0.470E-04    3.17      30.4  T

   *** convergence criteria satisfied after 5 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7314320             -19.9033
       ...           ...                  ...                  ...
        56        2.0000           -0.4205752             -11.4444
        57        2.0000           -0.4105857             -11.1726
        58        2.0000           -0.4095594             -11.1447
        59        2.0000           -0.4025676             -10.9544
        60        2.0000           -0.3979787             -10.8296
        61        2.0000           -0.3939472             -10.7198
        62        2.0000           -0.3592363              -9.7753 (HOMO)
        63                         -0.2426275              -6.6022 (LUMO)
        64                         -0.1765649              -4.8046
        65                         -0.1260583              -3.4302
        66                          0.0076660               0.2086
        67                          0.0172940               0.4706
       ...                                ...                  ...
       118                          0.6906979              18.7948
      -------------------------------------------------------------
                  HL-Gap            0.1166089 Eh            3.1731 eV
             Fermi-level           -0.3009319 Eh           -8.1888 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.050 sec
 SCC setup                      ...        0 min,  0.001 sec (  1.006%)
 Dispersion                     ...        0 min,  0.001 sec (  1.304%)
 classical contributions        ...        0 min,  0.000 sec (  0.489%)
 integral evaluation            ...        0 min,  0.006 sec ( 12.556%)
 iterations                     ...        0 min,  0.019 sec ( 38.055%)
 molecular gradient             ...        0 min,  0.023 sec ( 46.002%)
 printout                       ...        0 min,  0.000 sec (  0.531%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321428918243 Eh    ::
         :: gradient norm              0.001260665141 Eh/a0 ::
         :: HOMO-LUMO gap              3.173089487497 eV    ::
         ::.................................................::
         :: SCC energy               -69.216027526770 Eh    ::
         :: -&gt; isotropic ES            0.062506157981 Eh    ::
         :: -&gt; anisotropic ES          0.010117331752 Eh    ::
         :: -&gt; anisotropic XC          0.020077879138 Eh    ::
         :: -&gt; dispersion             -0.058968879660 Eh    ::
         :: repulsion energy           0.893595047520 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
        * Info *   Energy   : -68.3214476641 a.u.                                                                                 
* Info *   Gradient : 2.538812e-04 a.u. (RMS)                                                                             
* Info *              6.595610e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
  :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2158286 -0.692158E+02  0.248E-02    3.17       0.0  T
   2    -69.2158289 -0.274122E-06  0.150E-02    3.17       1.0  T
   3    -69.2158288  0.417772E-07  0.208E-03    3.17       6.9  T
   4    -69.2158290 -0.140537E-06  0.926E-04    3.17      15.4  T
   5    -69.2158290 -0.116678E-07  0.470E-04    3.17      30.4  T

   *** convergence criteria satisfied after 5 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7314457             -19.9037
       ...           ...                  ...                  ...
        56        2.0000           -0.4207476             -11.4491
        57        2.0000           -0.4107127             -11.1761
        58        2.0000           -0.4096679             -11.1476
        59        2.0000           -0.4026831             -10.9576
        60        2.0000           -0.3981590             -10.8345
        61        2.0000           -0.3940279             -10.7220
        62        2.0000           -0.3593621              -9.7787 (HOMO)
        63                         -0.2427521              -6.6056 (LUMO)
        64                         -0.1766893              -4.8080
        65                         -0.1261369              -3.4324
        66                          0.0075685               0.2059
        67                          0.0166188               0.4522
       ...                                ...                  ...
       118                          0.6905619              18.7911
      -------------------------------------------------------------
                  HL-Gap            0.1166100 Eh            3.1731 eV
             Fermi-level           -0.3010571 Eh           -8.1922 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.049 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.635%)
 Dispersion                     ...        0 min,  0.000 sec (  0.873%)
 classical contributions        ...        0 min,  0.000 sec (  0.262%)
 integral evaluation            ...        0 min,  0.008 sec ( 16.652%)
 iterations                     ...        0 min,  0.017 sec ( 34.125%)
 molecular gradient             ...        0 min,  0.023 sec ( 46.847%)
 printout                       ...        0 min,  0.000 sec (  0.545%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321447664121 Eh    ::
         :: gradient norm              0.001777168168 Eh/a0 ::
         :: HOMO-LUMO gap              3.173120622695 eV    ::
         ::.................................................::
         :: SCC energy               -69.215828983788 Eh    ::
         :: -&gt; isotropic ES            0.062561438005 Eh    ::
         :: -&gt; anisotropic ES          0.010061593208 Eh    ::
         :: -&gt; anisotropic XC          0.020079965466 Eh    ::
         :: -&gt; dispersion             -0.058964800424 Eh    ::
         :: repulsion energy           0.893376918833 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge              -0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2160451 -0.692160E+02  0.273E-02    3.17       0.0  T
   2    -69.2160454 -0.267266E-06  0.165E-02    3.17       1.0  T
   3    -69.2160452  0.198901E-06  0.307E-03    3.17       4.7  T
   4    -69.2160455 -0.327479E-06  0.110E-03    3.17      13.0  T
   5    -69.2160455 -0.146482E-07  0.554E-04    3.17      25.8  T
   6    -69.2160455 -0.265810E-08  0.179E-04    3.17      79.8  T

   *** convergence criteria satisfied after 6 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7315332             -19.9060
       ...           ...                  ...                  ...
        56        2.0000           -0.4209180             -11.4538
        57        2.0000           -0.4108441             -11.1796
        58        2.0000           -0.4097979             -11.1512
        59        2.0000           -0.4028507             -10.9621
        60        2.0000           -0.3982793             -10.8377
        61        2.0000           -0.3940809             -10.7235
        62        2.0000           -0.3594242              -9.7804 (HOMO)
        63                         -0.2427873              -6.6066 (LUMO)
        64                         -0.1767654              -4.8100
        65                         -0.1261991              -3.4341
        66                          0.0076063               0.2070
        67                          0.0162164               0.4413
       ...                                ...                  ...
       118                          0.6906740              18.7942
      -------------------------------------------------------------
                  HL-Gap            0.1166369 Eh            3.1739 eV
             Fermi-level           -0.3011057 Eh           -8.1935 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.117 sec
 SCC setup                      ...        0 min,  0.007 sec (  5.572%)
 Dispersion                     ...        0 min,  0.001 sec (  0.676%)
 classical contributions        ...        0 min,  0.000 sec (  0.212%)
 integral evaluation            ...        0 min,  0.012 sec ( 10.318%)
 iterations                     ...        0 min,  0.057 sec ( 48.863%)
 molecular gradient             ...        0 min,  0.040 sec ( 33.738%)
 printout                       ...        0 min,  0.001 sec (  0.582%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321467602202 Eh    ::
         :: gradient norm              0.001636039944 Eh/a0 ::
         :: HOMO-LUMO gap              3.173850368398 eV    ::
         ::.................................................::
         :: SCC energy               -69.216045539115 Eh    ::
         :: -&gt; isotropic ES            0.062581989544 Eh    ::
         :: -&gt; anisotropic ES          0.009995099005 Eh    ::
         :: -&gt; anisotropic XC          0.020083650049 Eh    ::
         :: -&gt; dispersion             -0.058967297673 Eh    ::
         :: repulsion energy           0.893573385822 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge              -0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3214676022 a.u.                                                                                 
* Info *   Gradient : 2.337200e-04 a.u. (RMS)                                                                             
* Info *              5.855979e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.12 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2162941 -0.692163E+02  0.466E-02    3.18       0.0  T
   2    -69.2162948 -0.713097E-06  0.281E-02    3.18       1.0  T
   3    -69.2162942  0.631626E-06  0.523E-03    3.18       2.7  T
   4    -69.2162952 -0.987982E-06  0.177E-03    3.18       8.0  T
   5    -69.2162952 -0.328150E-07  0.919E-04    3.18      15.5  T
   6    -69.2162952 -0.616424E-08  0.367E-04    3.18      38.9  T

   *** convergence criteria satisfied after 6 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7316635             -19.9096
       ...           ...                  ...                  ...
        56        2.0000           -0.4211614             -11.4604
        57        2.0000           -0.4110091             -11.1841
        58        2.0000           -0.4099726             -11.1559
        59        2.0000           -0.4030812             -10.9684
        60        2.0000           -0.3984270             -10.8418
        61        2.0000           -0.3940834             -10.7236
        62        2.0000           -0.3595143              -9.7829 (HOMO)
        63                         -0.2428274              -6.6077 (LUMO)
        64                         -0.1768484              -4.8123
        65                         -0.1262781              -3.4362
        66                          0.0078570               0.2138
        67                          0.0158616               0.4316
       ...                                ...                  ...
       118                          0.6906993              18.7949
      -------------------------------------------------------------
                  HL-Gap            0.1166869 Eh            3.1752 eV
             Fermi-level           -0.3011708 Eh           -8.1953 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.111 sec
 SCC setup                      ...        0 min,  0.007 sec (  6.280%)
 Dispersion                     ...        0 min,  0.001 sec (  0.556%)
 classical contributions        ...        0 min,  0.001 sec (  0.473%)
 integral evaluation            ...        0 min,  0.012 sec ( 10.491%)
 iterations                     ...        0 min,  0.046 sec ( 41.989%)
 molecular gradient             ...        0 min,  0.044 sec ( 39.884%)
 printout                       ...        0 min,  0.000 sec (  0.290%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321489028322 Eh    ::
         :: gradient norm              0.001172219684 Eh/a0 ::
         :: HOMO-LUMO gap              3.175212325236 eV    ::
         ::.................................................::
         :: SCC energy               -69.216295243781 Eh    ::
         :: -&gt; isotropic ES            0.062573891035 Eh    ::
         :: -&gt; anisotropic ES          0.009897940690 Eh    ::
         :: -&gt; anisotropic XC          0.020082237733 Eh    ::
         :: -&gt; dispersion             -0.058966848068 Eh    ::
         :: repulsion energy           0.893801958106 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3214890283 a.u.                                                                                 
* Info *   Gradient : 1.674600e-04 a.u. (RMS)                                                                             
* Info *              3.666025e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.12 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
* Info *   Energy   : -68.3214959619 a.u.                                                                                 
* Info *   Gradient : 1.054950e-04 a.u. (RMS)                                                                             
* Info *              2.144445e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.08 sec                                                                                            
                                                                                                                          
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2163322 -0.692163E+02  0.199E-02    3.18       0.0  T
   2    -69.2163324 -0.129480E-06  0.120E-02    3.18       1.2  T
   3    -69.2163324 -0.275717E-07  0.110E-03    3.18      13.0  T
   4    -69.2163324 -0.256452E-07  0.622E-04    3.18      23.0  T
   5    -69.2163324 -0.350494E-08  0.357E-04    3.18      40.0  T

   *** convergence criteria satisfied after 5 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317075             -19.9108
       ...           ...                  ...                  ...
        56        2.0000           -0.4212497             -11.4628
        57        2.0000           -0.4110482             -11.1852
        58        2.0000           -0.4100211             -11.1572
        59        2.0000           -0.4031388             -10.9700
        60        2.0000           -0.3984660             -10.8428
        61        2.0000           -0.3940631             -10.7230
        62        2.0000           -0.3595539              -9.7840 (HOMO)
        63                         -0.2428459              -6.6082 (LUMO)
        64                         -0.1768629              -4.8127
        65                         -0.1262955              -3.4367
        66                          0.0079635               0.2167
        67                          0.0158236               0.4306
       ...                                ...                  ...
       118                          0.6906645              18.7939
      -------------------------------------------------------------
                  HL-Gap            0.1167080 Eh            3.1758 eV
             Fermi-level           -0.3011999 Eh           -8.1961 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.076 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.470%)
 Dispersion                     ...        0 min,  0.001 sec (  0.904%)
 classical contributions        ...        0 min,  0.000 sec (  0.181%)
 integral evaluation            ...        0 min,  0.010 sec ( 13.365%)
 iterations                     ...        0 min,  0.024 sec ( 31.221%)
 molecular gradient             ...        0 min,  0.041 sec ( 53.438%)
 printout                       ...        0 min,  0.000 sec (  0.366%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321495961945 Eh    ::
         :: gradient norm              0.000738465041 Eh/a0 ::
         :: HOMO-LUMO gap              3.175787476614 eV    ::
         ::.................................................::
         :: SCC energy               -69.216332410466 Eh    ::
         :: -&gt; isotropic ES            0.062552963803 Eh    ::
         :: -&gt; anisotropic ES          0.009859882873 Eh    ::
         :: -&gt; anisotropic XC          0.020077703583 Eh    ::
         :: -&gt; dispersion             -0.058964292371 Eh    ::
         :: repulsion energy           0.893832556909 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2162296 -0.692162E+02  0.190E-02    3.18       0.0  T
   2    -69.2162297 -0.924006E-07  0.115E-02    3.18       1.2  T
   3    -69.2162296  0.138902E-06  0.225E-03    3.18       6.3  T
   4    -69.2162297 -0.188568E-06  0.645E-04    3.18      22.1  T
   5    -69.2162298 -0.551502E-08  0.333E-04    3.18      42.9  T

   *** convergence criteria satisfied after 5 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317532             -19.9120
       ...           ...                  ...                  ...
        56        2.0000           -0.4213217             -11.4647
        57        2.0000           -0.4110789             -11.1860
        58        2.0000           -0.4100505             -11.1580
        59        2.0000           -0.4031857             -10.9712
        60        2.0000           -0.3985014             -10.8438
        61        2.0000           -0.3940551             -10.7228
        62        2.0000           -0.3595901              -9.7849 (HOMO)
        63                         -0.2428937              -6.6095 (LUMO)
        64                         -0.1768775              -4.8131
        65                         -0.1263069              -3.4370
        66                          0.0079792               0.2171
        67                          0.0157750               0.4293
       ...                                ...                  ...
       118                          0.6906409              18.7933
      -------------------------------------------------------------
                  HL-Gap            0.1166964 Eh            3.1755 eV
             Fermi-level           -0.3012419 Eh           -8.1972 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.063 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.505%)
 Dispersion                     ...        0 min,  0.000 sec (  0.736%)
 classical contributions        ...        0 min,  0.000 sec (  0.190%)
 integral evaluation            ...        0 min,  0.008 sec ( 13.129%)
 iterations                     ...        0 min,  0.022 sec ( 34.390%)
 molecular gradient             ...        0 min,  0.032 sec ( 50.565%)
 printout                       ...        0 min,  0.000 sec (  0.438%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321500842839 Eh    ::
         :: gradient norm              0.000607333559 Eh/a0 ::
         :: HOMO-LUMO gap              3.175471546029 eV    ::
         ::.................................................::
         :: SCC energy               -69.216229753455 Eh    ::
         :: -&gt; isotropic ES            0.062528509916 Eh    ::
         :: -&gt; anisotropic ES          0.009833129912 Eh    ::
         :: -&gt; anisotropic XC          0.020074217902 Eh    ::
         :: -&gt; dispersion             -0.058952133100 Eh    ::
         :: repulsion energy           0.893725782398 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3215008428 a.u.                                                                                 
* Info *   Gradient : 8.676194e-05 a.u. (RMS)                                                                             
* Info *              2.089650e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.07 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
        * Info *   Energy   : -68.3215031059 a.u.                                                                                 
* Info *   Gradient : 8.541317e-05 a.u. (RMS)                                                                             
* Info *              1.874937e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
  :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2161538 -0.692162E+02  0.857E-03    3.18       0.0  T
   2    -69.2161539 -0.231899E-07  0.514E-03    3.18       2.8  T
   3    -69.2161538  0.984278E-07  0.174E-03    3.18       8.2  T
   4    -69.2161539 -0.114514E-06  0.301E-04    3.18      47.5  T
   5    -69.2161539 -0.130666E-08  0.168E-04    3.18      85.1  T

   *** convergence criteria satisfied after 5 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317455             -19.9118
       ...           ...                  ...                  ...
        56        2.000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0           -0.4213591             -11.4658
        57        2.0000           -0.4110836             -11.1862
        58        2.0000           -0.4100475             -11.1580
        59        2.0000           -0.4031649             -10.9707
        60        2.0000           -0.3985136             -10.8441
        61        2.0000           -0.3940621             -10.7230
        62        2.0000           -0.3596091              -9.7855 (HOMO)
        63                         -0.2429173              -6.6101 (LUMO)
        64                         -0.1768825              -4.8132
        65                         -0.1263289              -3.4376
        66                          0.0080318               0.2186
        67                          0.0157267               0.4279
       ...                                ...                  ...
       118                          0.6905043              18.7896
      -------------------------------------------------------------
                  HL-Gap            0.1166918 Eh            3.1753 eV
             Fermi-level           -0.3012632 Eh           -8.1978 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.048 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.668%)
 Dispersion                     ...        0 min,  0.000 sec (  0.895%)
 classical contributions        ...        0 min,  0.000 sec (  0.255%)
 integral evaluation            ...        0 min,  0.005 sec ( 11.171%)
 iterations                     ...        0 min,  0.016 sec ( 32.907%)
 molecular gradient             ...        0 min,  0.025 sec ( 53.468%)
 printout                       ...        0 min,  0.000 sec (  0.576%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321503105893 Eh    ::
         :: gradient norm              0.000597892162 Eh/a0 ::
         :: HOMO-LUMO gap              3.175345671826 eV    ::
         ::.................................................::
         :: SCC energy               -69.216153880361 Eh    ::
         :: -&gt; isotropic ES            0.062527380611 Eh    ::
         :: -&gt; anisotropic ES          0.009819117753 Eh    ::
         :: -&gt; anisotropic XC          0.020073296782 Eh    ::
         :: -&gt; dispersion             -0.058950921328 Eh    ::
         :: repulsion energy           0.893647716372 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge              -0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215045621 a.u.                                                                                 
* Info *   Gradient : 5.740670e-05 a.u. (RMS)                                                                             
* Info *              1.476872e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.09 sec                                                                                            
                                                                                                                          
          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2161068 -0.692161E+02  0.537E-03    3.17       0.0  T
   2    -69.2161068 -0.107732E-07  0.321E-03    3.18       4.5  T
   3    -69.2161068  0.382144E-07  0.105E-03    3.17      13.6  T
   4    -69.2161068 -0.437488E-07  0.189E-04    3.17      75.5  T
   5    -69.2161068 -0.680870E-09  0.938E-05    3.17     152.4  T

   *** convergence criteria satisfied after 5 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317582             -19.9122
       ...           ...                  ...                  ...
        56        2.0000           -0.4213699             -11.4661
        57        2.0000           -0.4110967             -11.1865
        58        2.0000           -0.4100429             -11.1578
        59        2.0000           -0.4031632             -10.9706
        60        2.0000           -0.3985262             -10.8445
        61        2.0000           -0.3940909             -10.7238
        62        2.0000           -0.3596167              -9.7857 (HOMO)
        63                         -0.2429380              -6.6107 (LUMO)
        64                         -0.1768974              -4.8136
        65                         -0.1263408              -3.4379
        66                          0.0080014               0.2177
        67                          0.0156314               0.4254
       ...                                ...                  ...
       118                          0.6904941              18.7893
      -------------------------------------------------------------
                  HL-Gap            0.1166787 Eh            3.1750 eV
             Fermi-level           -0.3012774 Eh           -8.1982 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.082 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.395%)
 Dispersion                     ...        0 min,  0.001 sec (  1.371%)
 classical contributions        ...        0 min,  0.001 sec (  0.820%)
 integral evaluation            ...        0 min,  0.013 sec ( 15.600%)
 iterations                     ...        0 min,  0.026 sec ( 32.087%)
 molecular gradient             ...        0 min,  0.040 sec ( 49.220%)
 printout                       ...        0 min,  0.000 sec (  0.449%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321504562101 Eh    ::
         :: gradient norm              0.000401846893 Eh/a0 ::
         :: HOMO-LUMO gap              3.174989428814 eV    ::
         ::.................................................::
         :: SCC energy               -69.216106797347 Eh    ::
         :: -&gt; isotropic ES            0.062531742918 Eh    ::
         :: -&gt; anisotropic ES          0.009812489435 Eh    ::
         :: -&gt; anisotropic XC          0.020076242590 Eh    ::
         :: -&gt; dispersion             -0.058946018915 Eh    ::
         :: repulsion energy           0.893599450674 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2161143 -0.692161E+02  0.421E-03    3.17       0.0  T
   2    -69.2161143 -0.731013E-08  0.251E-03    3.17       5.7  T
   3    -69.2161143  0.238038E-08  0.336E-04    3.17      42.6  T
   4    -69.2161143 -0.383542E-08  0.128E-04    3.17     111.3  T

   *** convergence criteria satisfied after 4 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317576             -19.9121
       ...           ...                  ...                  ...
        56        2.0000           -0.4213724             -11.4661
        57        2.0000           -0.4111063             -11.1868
        58        2.0000           -0.4100387             -11.1577
        59        2.0000           -0.4031581             -10.9705
        60        2.0000           -0.3985340             -10.8447
        61        2.0000           -0.3941181             -10.7245
        62        2.0000           -0.3596161              -9.7857 (HOMO)
        63                         -0.2429409              -6.6108 (LUMO)
        64                         -0.1769047              -4.8138
        65                         -0.1263510              -3.4382
        66                          0.0080195               0.2182
        67                          0.0155567               0.4233
       ...                                ...                  ...
       118                          0.6904870              18.7891
      -------------------------------------------------------------
                  HL-Gap            0.1166752 Eh            3.1749 eV
             Fermi-level           -0.3012785 Eh           -8.1982 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.093 sec
 SCC setup                      ...        0 min,  0.005 sec (  5.477%)
 Dispersion                     ...        0 min,  0.001 sec (  1.334%)
 classical contributions        ...        0 min,  0.000 sec (  0.138%)
 integral evaluation            ...        0 min,  0.010 sec ( 10.715%)
 iterations                     ...        0 min,  0.025 sec ( 27.258%)
 molecular gradient             ...        0 min,  0.050 sec ( 54.370%)
 printout                       ...        0 min,  0.001 sec (  0.661%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321505303040 Eh    ::
         :: gradient norm              0.000206429128 Eh/a0 ::
         :: HOMO-LUMO gap              3.174894600209 eV    ::
         ::.................................................::
         :: SCC energy               -69.216114277169 Eh    ::
         :: -&gt; isotropic ES            0.062539269628 Eh    ::
         :: -&gt; anisotropic ES          0.009806881576 Eh    ::
         :: -&gt; anisotropic XC          0.020079571179 Eh    ::
         :: -&gt; dispersion             -0.058945050284 Eh    ::
         :: repulsion energy           0.893606271982 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge              -0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3215053030 a.u.                                                                                 
* Info *   Gradient : 2.948988e-05 a.u. (RMS)                                                                             
* Info *              5.839041e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.10 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
       * Info *   Energy   : -68.3215056031 a.u.                                                                                 
* Info *   Gradient : 2.620071e-05 a.u. (RMS)                                                                             
* Info *              5.876969e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.07 sec                                                                                            
                                                                                                                          
   :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2161344 -0.692161E+02  0.275E-03    3.18       0.0  T
   2    -69.2161345 -0.295560E-08  0.165E-03    3.18       8.7  T
   3    -69.2161344  0.803686E-08  0.511E-04    3.18      28.0  T
   4    -69.2161345 -0.940196E-08  0.997E-05    3.18     143.3  T

   *** convergence criteria satisfied after 4 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317603             -19.9122
       ...           ...                  ...                  ...
        56        2.0000           -0.4213679             -11.4660
        57        2.0000           -0.4111073             -11.1868
        58        2.0000           -0.4100346             -11.1576
        59        2.0000           -0.4031570             -10.9705
        60        2.0000           -0.3985337             -10.8447
        61        2.0000           -0.3941318             -10.7249
        62        2.0000           -0.3596137              -9.7856 (HOMO)
        63                         -0.2429341              -6.6106 (LUMO)
        64                         -0.1769069              -4.8139
        65                         -0.1263504              -3.4382
        66                          0.0080358               0.2187
        67                          0.0155343               0.4227
       ...                                ...                  ...
       118                          0.6905037              18.7896
      -------------------------------------------------------------
                  HL-Gap            0.1166796 Eh            3.1750 e
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V
             Fermi-level           -0.3012739 Eh           -8.1981 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.066 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.589%)
 Dispersion                     ...        0 min,  0.002 sec (  2.396%)
 classical contributions        ...        0 min,  0.000 sec (  0.207%)
 integral evaluation            ...        0 min,  0.008 sec ( 12.077%)
 iterations                     ...        0 min,  0.020 sec ( 30.346%)
 molecular gradient             ...        0 min,  0.036 sec ( 53.912%)
 printout                       ...        0 min,  0.000 sec (  0.411%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321505603135 Eh    ::
         :: gradient norm              0.000183404994 Eh/a0 ::
         :: HOMO-LUMO gap              3.175013555072 eV    ::
         ::.................................................::
         :: SCC energy               -69.216134453540 Eh    ::
         :: -&gt; isotropic ES            0.062539576010 Eh    ::
         :: -&gt; anisotropic ES          0.009803153668 Eh    ::
         :: -&gt; anisotropic XC          0.020081035653 Eh    ::
         :: -&gt; dispersion             -0.058944701315 Eh    ::
         :: repulsion energy           0.893626223854 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2161580 -0.692162E+02  0.349E-03    3.18       0.0  T
   2    -69.2161580 -0.506172E-08  0.211E-03    3.18       6.8  T
   3    -69.2161579  0.124098E-07  0.631E-04    3.18      22.6  T
   4    -69.2161580 -0.145280E-07  0.135E-04    3.18     106.1  T

   *** convergence criteria satisfied after 4 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317559             -19.9121
       ...           ...                  ...                  ...
        56        2.0000           -0.4213560             -11.4657
        57        2.0000           -0.4111015             -11.1866
        58        2.0000           -0.4100284             -11.1574
        59        2.0000           -0.4031494             -10.9703
        60        2.0000           -0.3985282             -10.8445
        61        2.0000           -0.3941422             -10.7252
        62        2.0000           -0.3596087              -9.7855 (HOMO)
        63                         -0.2429219              -6.6102 (LUMO)
        64                         -0.1769012              -4.8137
        65                         -0.1263455              -3.4380
        66                          0.0080690               0.2196
        67                          0.0155396               0.4229
       ...                                ...                  ...
       118                          0.6905221              18.7901
      -------------------------------------------------------------
                  HL-Gap            0.1166868 Eh            3.1752 eV
             Fermi-level           -0.3012653 Eh           -8.1978 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.051 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.642%)
 Dispersion                     ...        0 min,  0.000 sec (  0.843%)
 classical contributions        ...        0 min,  0.000 sec (  0.254%)
 integral evaluation            ...        0 min,  0.005 sec ( 10.347%)
 iterations                     ...        0 min,  0.017 sec ( 34.018%)
 molecular gradient             ...        0 min,  0.027 sec ( 53.278%)
 printout                       ...        0 min,  0.000 sec (  0.557%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321505896886 Eh    ::
         :: gradient norm              0.000205735968 Eh/a0 ::
         :: HOMO-LUMO gap              3.175210234718 eV    ::
         ::.................................................::
         :: SCC energy               -69.216157957330 Eh    ::
         :: -&gt; isotropic ES            0.062536908065 Eh    ::
         :: -&gt; anisotropic ES          0.009799743982 Eh    ::
         :: -&gt; anisotropic XC          0.020081841520 Eh    ::
         :: -&gt; dispersion             -0.058944736053 Eh    ::
         :: repulsion energy           0.893649549235 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge              -0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3215058969 a.u.                                                                                 
* Info *   Gradient : 2.939085e-05 a.u. (RMS)                                                                             
* Info *              8.259962e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2161607 -0.692162E+02  0.290E-03    3.18       0.0  T
   2    -69.2161607 -0.442535E-08  0.174E-03    3.18       8.2  T
   3    -69.2161607  0.342695E-09  0.226E-04    3.18      63.2  T
   4    -69.2161607 -0.113253E-08  0.115E-04    3.18     124.7  T

   *** convergence criteria satisfied after 4 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317512             -19.9120
       ...           ...                  ...                  ...
        56        2.0000           -0.4213390             -11.4652
        57        2.0000           -0.4110887             -11.1863
        58        2.0000           -0.4100192             -11.1572
        59        2.0000           -0.4031392             -10.9700
        60        2.0000           -0.3985169             -10.8442
        61        2.0000           -0.3941449             -10.7252
        62        2.0000           -0.3596024              -9.7853 (HOMO)
        63                         -0.2429100              -6.6099 (LUMO)
        64                         -0.1768939              -4.8135
        65                         -0.1263369              -3.4378
        66                          0.0080919               0.2202
        67                          0.0155701               0.4237
       ...                                ...                  ...
       118                          0.6905391              18.7905
      -------------------------------------------------------------
                  HL-Gap            0.1166924 Eh            3.1754 eV
             Fermi-level           -0.3012562 Eh           -8.1976 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.064 sec
 SCC setup                      ...        0 min,  0.003 sec (  5.205%)
 Dispersion                     ...        0 min,  0.001 sec (  0.971%)
 classical contributions        ...        0 min,  0.000 sec (  0.345%)
 integral evaluation            ...        0 min,  0.007 sec ( 10.553%)
 iterations                     ...        0 min,  0.023 sec ( 36.061%)
 molecular gradient             ...        0 min,  0.029 sec ( 46.361%)
 printout                       ...        0 min,  0.000 sec (  0.433%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321506132000 Eh    ::
         :: gradient norm              0.000194949545 Eh/a0 ::
         :: HOMO-LUMO gap              3.175360935749 eV    ::
         ::.................................................::
         :: SCC energy               -69.216160682811 Eh    ::
         :: -&gt; isotropic ES            0.062531981196 Eh    ::
         :: -&gt; anisotropic ES          0.009799517607 Eh    ::
         :: -&gt; anisotropic XC          0.020081422748 Eh    ::
         :: -&gt; dispersion             -0.058944224793 Eh    ::
         :: repulsion energy           0.893652145578 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3215061320 a.u.                                                                                 
* Info *   Gradient : 2.784993e-05 a.u. (RMS)                                                                             
* Info *              8.526449e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.07 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2161504 -0.692162E+02  0.248E-03    3.18       0.0  T
   2    -69.2161505 -0.432327E-08  0.150E-03    3.18       9.6  T
   3    -69.2161505  0.954429E-09  0.263E-04    3.18      54.4  T
   4    -69.2161505 -0.183459E-08  0.100E-04    3.18     142.8  T

   *** convergence criteria satisfied after 4 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317454             -19.9118
       ...           ...                  ...                  ...
        56        2.0000           -0.4213194             -11.4647
        57        2.0000           -0.4110727             -11.1859
        58        2.0000           -0.4100091             -11.1569
        59        2.0000           -0.4031233             -10.9695
        60        2.0000           -0.3985029             -10.8438
        61        2.0000           -0.3941453             -10.7252
        62        2.0000           -0.3595964              -9.7851 (HOMO)
        63                         -0.2429017              -6.6097 (LUMO)
        64                         -0.1768858              -4.8133
        65                         -0.1263280              -3.4376
        66                          0.0081007               0.2204
        67                          0.0156016               0.4245
       ...                                ...                  ...
       118                          0.6905458              18.7907
      -------------------------------------------------------------
                  HL-Gap            0.1166947 Eh            3.1754 eV
             Fermi-level           -0.3012490 Eh           -8.1974 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.065 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.578%)
 Dispersion                     ...        0 min,  0.001 sec (  1.030%)
 classical contributions        ...        0 min,  0.000 sec (  0.559%)
 integral evaluation            ...        0 min,  0.009 sec ( 14.061%)
 iterations                     ...        0 min,  0.022 sec ( 33.647%)
 molecular gradient             ...        0 min,  0.032 sec ( 49.163%)
 printout                       ...        0 min,  0.001 sec (  0.901%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321506307525 Eh    ::
         :: gradient norm              0.000130056911 Eh/a0 ::
         :: HOMO-LUMO gap              3.175424617460 eV    ::
         ::.................................................::
         :: SCC energy               -69.216150452505 Eh    ::
         :: -&gt; isotropic ES            0.062526528783 Eh    ::
         :: -&gt; anisotropic ES          0.009800348259 Eh    ::
         :: -&gt; anisotropic XC          0.020080568868 Eh    ::
         :: -&gt; dispersion             -0.058943604814 Eh    ::
         :: repulsion energy           0.893641863845 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3215063075 a.u.                                                                                 
* Info *   Gradient : 1.857956e-05 a.u. (RMS)                                                                             
* Info *              4.087119e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.07 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.2161390 -0.692161E+02  0.116E-03    3.18       0.0  T
   2    -69.2161390 -0.125526E-08  0.709E-04    3.18      20.2  T
   3    -69.2161390  0.325549E-08  0.342E-04    3.18      41.8  T

   *** convergence criteria satisfied after 3 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7317397             -19.9117
       ...           ...                  ...                  ...
        56        2.0000           -0.4213097             -11.4644
        57        2.0000           -0.4110634             -11.1856
        58        2.0000           -0.4100032             -11.1568
        59        2.0000           -0.4031146             -10.9693
        60        2.0000           -0.3984964             -10.8436
        61        2.0000           -0.3941442             -10.7252
        62        2.0000           -0.3595937              -9.7850 (HOMO)
        63                         -0.2429025              -6.6097 (LUMO)
        64                         -0.1768803              -4.8132
        65                         -0.1263250              -3.4375
        66                          0.0080996               0.2204
        67                          0.0156135               0.4249
       ...                                ...                  ...
       118                          0.6905448              18.7907
      -------------------------------------------------------------
                  HL-Gap            0.1166911 Eh            3.1753 eV
             Fermi-level           -0.3012481 Eh           -8.1974 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.077 sec
 SCC setup                      ...        0 min,  0.001 sec (  0.865%)
 Dispersion                     ...        0 min,  0.001 sec (  1.265%)
 classical contributions        ...        0 min,  0.001 sec (  1.275%)
 integral evaluation            ...        0 min,  0.006 sec (  7.641%)
 iterations                     ...        0 min,  0.018 sec ( 23.378%)
 molecular gradient             ...        0 min,  0.050 sec ( 65.145%)
 printout                       ...        0 min,  0.000 sec (  0.372%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.321506377051 Eh    ::
         :: gradient norm              0.000071521428 Eh/a0 ::
         :: HOMO-LUMO gap              3.175327375573 eV    ::
         ::.................................................::
         :: SCC energy               -69.216139028785 Eh    ::
         :: -&gt; isotropic ES            0.062525596654 Eh    ::
         :: -&gt; anisotropic ES          0.009802328288 Eh    ::
         :: -&gt; anisotropic XC          0.020080240829 Eh    ::
         :: -&gt; dispersion             -0.058943254973 Eh    ::
         :: repulsion energy           0.893630424151 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::

* Info *   Energy   : -68.3215063771 a.u.                                                                                 
* Info *   Gradient : 1.021735e-05 a.u. (RMS)                                                                             
* Info *              2.520052e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.09 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Saving file: veloxchem_opt_2023-04-25T13.52.30_optim.xyz                                                         
* Info * Saving file: veloxchem_opt_2023-04-25T13.52.30.log                                                               
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Geometry optimization completed.                                                                                 
                                                                                                                          
                                              Molecular Geometry (Angstroms)                                              
                                             ================================                                             
                                                                                                                          
                          Atom         Coordinate X          Coordinate Y          Coordinate Z                           
                                                                                                                          
                           O          -4.444356148301       -1.519231405669        0.133818802956                         
                           O          -5.717728473424        0.942316237085       -0.066968962396                         
                           O           5.074944380112        0.621839630722        0.095361864009                         
                           C          -1.218663248680       -0.830595956308       -0.247223992768                         
                           C          -0.477629871511        0.497184226791       -0.529673918529                         
                           C          -2.930011813590        0.109407860554        1.091647841024                         
                           C          -1.787420846331       -0.894913983905        1.174595923880                         
                           C          -2.515711138491       -0.855946194540       -1.095040548846                         
                           C           0.968464285398        0.594394878134        0.023051359150                         
                           C          -3.654907965826       -0.372192923668       -0.180394141422                         
                           C          -0.338906858539       -2.036979464433       -0.583399668258                         
                           C          -1.380813476472        1.698304225777       -0.180085905847                         
                           C          -2.322111192586        1.507002611293        1.012160926977                         
                           C           1.723598180203       -0.686836785339       -0.399658653325                         
                           C           1.033616297128       -1.956732648516        0.075560115874                         
                           C           1.068852139151        0.833440819862        1.537692826584                         
                           C          -4.585050097840        0.655858178693       -0.853861880085                         
                           C           1.691896058511        1.770006746900       -0.620577515432                         
                           C           3.162347118014       -0.539762374924       -0.024338881740                         
                           C           3.026560322778        1.832733770694       -0.661355332056                         
                           C           3.761395103265        0.686565534847       -0.201084927987                         
                           C           4.186018037272       -1.411360657395        0.402952793555                         
                           C           5.318365378847       -0.649258410860        0.464736569034                         
                           H          -0.335036180682        0.523105134952       -1.619153335984                         
                           H          -3.599176954096        0.065966348093        1.957690684664                         
                           H          -1.080856355109       -0.645807578441        1.956928694655                         
                           H          -2.177294048983       -1.897906384653        1.358785220594                         
                           H          -2.433801681300       -0.246547664772       -1.993148048283                         
                           H          -2.750703334368       -1.876555715621       -1.397466956806                         
                           H          -0.203126601759       -2.084320493005       -1.667436130424                         
                           H          -0.851890375365       -2.949981497842       -0.273589578941                         
                           H          -1.983411213175        1.924016483574       -1.061330676925                         
                           H          -0.767945077172        2.580213930262        0.010339706865                         
                           H          -1.779556090234        1.670505612833        1.945822615459                         
                           H          -3.112392348725        2.258845075562        0.965603116349                         
                           H           1.702548680040       -0.706998814070       -1.502646038847                         
                           H           0.940906440249       -1.969012908147        1.160909209162                         
                           H           1.629806822589       -2.823430346797       -0.216840792668                         
                           H           2.103739193839        1.037127297702        1.803288498697                         
                           H           0.473184324759        1.693615965109        1.827260296171                         
                           H           0.749302119412       -0.028513839353        2.112157924155                         
                           H          -4.890341940956        0.251895622750       -1.829136457420                         
                           H          -4.081362417860        1.607147612841       -1.012173100013                         
                           H           1.101176933735        2.597977027327       -0.978171475143                         
                           H          -4.939036199772       -1.335514044125        0.940761097788                         
                           H           3.561011194929        2.688548100827       -1.042815340861                         
                           H           4.105646417170       -2.452204647179        0.640894394432                         
                           H          -6.244800187656        0.136371594042       -0.009353562143                         
                           H           6.323262711403       -0.890385787665        0.749405341117                         
                                                                                                                          
                                                                                                                          
                                             Summary of Geometry Optimization                                             
                                            ==================================                                            
                                                                                                                          
                  Opt.Step       Energy (a.u.)       Energy Change (a.u.)       Displacement (RMS, Max)                   
                  -------------------------------------------------------------------------------------                   
                      0         -68.310234157198        0.000000000000         0.000e+00      0.000e+00                   
                      1         -68.319437730841       -0.009203573643         9.448e-02      2.163e-01                   
                      2         -68.320707883896       -0.001270153055         3.422e-02      7.343e-02                   
                      3         -68.321101833645       -0.000393949749         3.393e-02      7.122e-02                   
                      4         -68.321262321180       -0.000160487535         1.908e-02      4.656e-02                   
                      5         -68.321347171693       -0.000084850512         2.113e-02      5.546e-02                   
                      6         -68.321403406885       -0.000056235192         6.867e-03      1.655e-02                   
                      7         -68.321428918243       -0.000025511358         7.166e-03      2.091e-02                   
                      8         -68.321447664121       -0.000018745878         7.271e-03      2.488e-02                   
                      9         -68.321467602202       -0.000019938081         7.604e-03      2.985e-02                   
                     10         -68.321489028322       -0.000021426120         1.267e-02      5.192e-02                   
                     11         -68.321495961945       -0.000006933623         5.653e-03      2.341e-02                   
                     12         -68.321500842839       -0.000004880894         5.779e-03      2.311e-02                   
                     13         -68.321503105893       -0.000002263054         2.534e-03      9.698e-03                   
                     14         -68.321504562101       -0.000001456207         1.622e-03      5.554e-03                   
                     15         -68.321505303040       -0.000000740939         1.216e-03      3.786e-03                   
                     16         -68.321505603135       -0.000000300096         8.057e-04      2.964e-03                   
                     17         -68.321505896886       -0.000000293750         1.067e-03      4.209e-03                   
                     18         -68.321506132000       -0.000000235114         9.041e-04      3.413e-03                   
                     19         -68.321506307525       -0.000000175525         7.735e-04      2.782e-03                   
                     20         -68.321506377051       -0.000000069525         3.570e-04      1.372e-03                   
                                                                                                                          
                                                                                                                          
                                              Statistical Deviation between                                               
                                         Optimized Geometry and Initial Geometry                                          
                                        =========================================                                         
                                                                                                                          
                               Internal Coord.        RMS deviation         Max. deviation                                
                               -----------------------------------------------------------                                
                                  Bonds               0.012 Angstrom        0.033 Angstrom                                
                                  Angles              1.359 degree          3.480 degree                                  
                                  Dihedrals           3.908 degree         13.103 degree                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                     *** Time spent in Optimization Driver: 19.26 sec                                     
                                                                                                                          
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-initial-and-final-geometries">
<h3>Compare initial and final geometries<a class="headerlink" href="#compare-initial-and-final-geometries" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">xyz</span><span class="p">(</span><span class="n">molecule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the molecular geometry in xyz format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">veloxchem.veloxchemlib</span> <span class="kn">import</span> <span class="n">ChemicalElement</span>
    <span class="kn">from</span> <span class="nn">veloxchem.veloxchemlib</span> <span class="kn">import</span> <span class="n">bohr_in_angstroms</span>

    <span class="n">elem_ids</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">elem_ids_to_numpy</span><span class="p">()</span>

    <span class="n">xs</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">x_to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="n">bohr_in_angstroms</span><span class="p">()</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">y_to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="n">bohr_in_angstroms</span><span class="p">()</span>
    <span class="n">zs</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">z_to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="n">bohr_in_angstroms</span><span class="p">()</span>

    <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> 
    <span class="n">txt</span> <span class="o">+=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">elem_id</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">elem_ids</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span><span class="p">):</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">ChemicalElement</span><span class="p">()</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">set_atom_type</span><span class="p">(</span><span class="n">elem_id</span><span class="p">)</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%6s</span><span class="s2"> </span><span class="si">%22.12f</span><span class="s2"> </span><span class="si">%22.12f</span><span class="s2"> </span><span class="si">%22.12f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">txt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># xtb_opt_cafestol.write_xyz(&quot;xtb_opt_cafestol.xyz&quot;)</span>
<span class="c1"># xtb_opt_kahweol.write_xyz(&quot;xtb_opt_kahweol.xyz&quot;)</span>
<span class="c1"># </span>
<span class="n">xyz_xtb_opt_cafestol</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../../data/structopt/xtb_opt_cafestol.xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read optimized geometry from file</span>
<span class="n">xyz_xtb_opt_kahweol</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../../data/structopt/xtb_opt_kahweol.xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> (a) Cafestol, initial vs. XTB opt. geom.         (b) Kahweol, initial vs. XTB opt. geom.:&#39;</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">viewergrid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">linked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">cafestol_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">xyz_xtb_opt_cafestol</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">kahweol_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">xyz_xtb_opt_kahweol</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">view</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> (a) Cafestol, initial vs. XTB opt. geom.         (b) Kahweol, initial vs. XTB opt. geom.:
</pre></div>
</div>
<div class="output text_html"><div id="3dmolviewer_1682423569839536"  style="position: relative; width: 700px; height: 250px">
        <p id="3dmolwarning_1682423569839536" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_1682423569839536 = null;
var warn = document.getElementById("3dmolwarning_1682423569839536");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_1682423569839536 = null;
viewergrid_1682423569839536 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_1682423569839536"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_1682423569839536 = viewergrid_1682423569839536[0][0];
viewergrid_1682423569839536[0][0].zoomTo();viewergrid_1682423569839536[0][1].zoomTo();	viewergrid_1682423569839536[0][0].addModel("51\ncafestol initial structure\nO  -4.5215   -1.3455    0.4926\nO  -5.2905    0.0812   -1.7033\nO   5.1630    0.4345   -0.1101\nC  -1.2807   -0.7511   -0.0465\nC  -0.5244    0.5810   -0.4102\nC   0.9909    0.6610    0.0407\nC  -2.9440    0.2916    1.2866\nC  -1.8143   -0.7311    1.3945\nC  -2.6188   -0.8159   -0.8642\nC  -3.7116   -0.2387    0.0606\nC  -0.4332   -2.0024   -0.3283\nC  -1.3742    1.8303   -0.0654\nC   1.6844   -0.6873   -0.4019\nC  -2.3206    1.6833    1.1309\nC   0.9997   -1.9155    0.1913\nC   1.7285    1.8344   -0.7277\nC   1.1437    0.9261    1.5588\nC   3.1644   -0.6155   -0.2085\nC  -4.6490    0.7442   -0.6282\nC   3.2525    1.9378   -0.4590\nC   3.8298    0.5879   -0.2856\nC   4.1654   -1.5888    0.0140\nC   5.3604   -0.9015    0.0689\nH  -0.4604    0.5817   -1.5108\nH  -3.5646    0.2626    2.1897\nH  -1.0861   -0.4449    2.1498\nH  -2.1902   -1.7145    1.7003\nH  -2.5286   -0.2495   -1.7981\nH  -2.8534   -1.8505   -1.1460\nH  -0.3943   -2.1694   -1.4136\nH  -0.9135   -2.8938    0.0946\nH  -1.9810    2.0650   -0.9487\nH  -0.7587    2.7222    0.0818\nH   1.5605   -0.7646   -1.4951\nH  -1.7642    1.9154    2.0477\nH  -3.1082    2.4431    1.0635\nH   1.0176   -1.9046    1.2859\nH   1.5276   -2.8282   -0.1118\nH   1.2808    2.8061   -0.4944\nH   1.5851    1.6842   -1.8068\nH   0.5898    1.8173    1.8670\nH   0.8147    0.0892    2.1727\nH   2.1832    1.0992    1.8532\nH  -4.1337    1.6158   -1.0351\nH  -5.4265    1.0934    0.0595\nH   3.4273    2.5264    0.4487\nH   3.7385    2.4646   -1.2871\nH  -3.9519   -2.0832    0.7635\nH   4.0442   -2.6573    0.1180\nH  -5.7603   -0.6874   -1.3370\nH   6.3869   -1.2031    0.2186\n","xyz");
	viewergrid_1682423569839536[0][0].addModel("51\n\n  O          -4.586922162974       -1.279900812113        0.480337869078\n  O          -5.319323530885        0.246554365936       -1.628989941244\n  O           5.096372498472        0.479139956230        0.047310612905\n  C          -1.255192697448       -0.766696561134       -0.090680700621\n  C          -0.509234466538        0.539151236263       -0.458497461171\n  C           0.978370747200        0.632242902907       -0.012006512131\n  C          -2.880145679352        0.238843091772        1.312526020141\n  C          -1.740421279317       -0.771906128054        1.364308303799\n  C          -2.598904413550       -0.799819297667       -0.863821905179\n  C          -3.682491218731       -0.248170989788        0.088677460835\n  C          -0.416171856128       -1.999831913414       -0.434959752014\n  C          -1.378411313968        1.760376905852       -0.090406780583\n  C           1.674850324712       -0.681265249621       -0.445496937757\n  C          -2.250006350441        1.621571012248        1.161331852636\n  C           0.997770390990       -1.919051827794        0.128028449325\n  C           1.666368222649        1.766535265007       -0.811794267310\n  C           1.168852673164        0.910141469260        1.479830281478\n  C           3.135518572114       -0.569550865805       -0.157684604443\n  C          -4.609466314165        0.795532801004       -0.551522132290\n  C           3.155677966053        1.954157317637       -0.478214676554\n  C           3.782185082670        0.630198832857       -0.219344526624\n  C           4.130804955549       -1.530152616409        0.161723351875\n  C           5.294635313579       -0.835297576497        0.273979341092\n  H          -0.446360137783        0.529011979065       -1.555045941088\n  H          -3.512276691160        0.221160868043        2.205141648238\n  H          -0.987780594566       -0.489632372357        2.090197270116\n  H          -2.099445044295       -1.770574821753        1.629874750702\n  H          -2.561137057430       -0.227442656009       -1.788299281649\n  H          -2.854669838498       -1.827149482034       -1.131641653395\n  H          -0.352942590254       -2.090388651997       -1.522821651934\n  H          -0.917394798855       -2.895612334664       -0.058886958584\n  H          -2.030555326995        1.964782360795       -0.939705323129\n  H          -0.751051975891        2.643276021212        0.031130693326\n  H           1.568194400156       -0.751872378847       -1.538335604040\n  H          -1.648508824488        1.799646480939        2.055437245879\n  H          -3.024928113420        2.390215391246        1.135430100123\n  H           0.980017214779       -1.887152290395        1.216940514291\n  H           1.555470829259       -2.809092130899       -0.168741092389\n  H           1.159640751768        2.715756362720       -0.639015686027\n  H           1.574163446206        1.537818439213       -1.875630033472\n  H           0.649843343939        1.820861931771        1.764748945912\n  H           0.808434218847        0.095438043278        2.096511455476\n  H           2.222642848582        1.033915253750        1.709232361580\n  H          -4.054666405978        1.641877616737       -0.952393409708\n  H          -5.302115655464        1.156090786275        0.223529309300\n  H           3.278598845993        2.596761863060        0.399104307011\n  H           3.657811203010        2.457382354381       -1.308865130885\n  H          -4.087267519509       -1.977189217287        0.916499888018\n  H           4.002118794978       -2.584674815930        0.293351616107\n  H          -5.695011382514       -0.585398198682       -1.313342576256\n  H           6.294960595927       -1.145417720306        0.500960891235\n","xyz");
	viewergrid_1682423569839536[0][1].addModel("49\nkahweol initial structure\nO  -4.4710   -1.5361    0.0905\nO  -5.6188    0.9753   -0.0811\nO   5.1625    0.5695   -0.0997\nC  -1.2209   -0.8317   -0.2017\nC  -0.4821    0.5357   -0.4703\nC  -3.0038    0.1167    1.0462\nC  -1.8514   -0.8737    1.1997\nC  -2.4967   -0.9058   -1.1119\nC   0.9884    0.6333    0.0944\nC  -3.6676   -0.3924   -0.2474\nC  -0.3220   -2.0551   -0.4569\nC  -1.3919    1.7479   -0.1363\nC  -2.4167    1.5304    0.9816\nC   1.7435   -0.6786   -0.3542\nC   1.0741   -1.9483    0.1552\nC   1.0367    0.8330    1.6293\nC  -4.5845    0.5870   -0.9677\nC   1.7610    1.8511   -0.4907\nC   3.2146   -0.5444   -0.1101\nC   3.1013    1.8722   -0.6493\nC   3.8167    0.6946   -0.3059\nC   4.2309   -1.4546    0.2464\nC   5.3980   -0.7259    0.2399\nH  -0.3415    0.5842   -1.5631\nH  -3.6779    0.0397    1.9072\nH  -1.1861   -0.6021    2.0159\nH  -2.2356   -1.8757    1.4322\nH  -2.3648   -0.3090   -2.0216\nH  -2.6844   -1.9384   -1.4328\nH  -0.2098   -2.1924   -1.5413\nH  -0.8043   -2.9694   -0.0890\nH  -1.9406    2.0033   -1.0514\nH  -0.8134    2.6482    0.0921\nH  -1.9341    1.7452    1.9434\nH  -3.2193    2.2709    0.8849\nH   1.6699   -0.7251   -1.4553\nH   1.0259   -1.9792    1.2481\nH   1.6508   -2.8307   -0.1490\nH   2.0514    1.0518    1.9842\nH   0.4166    1.6762    1.9486\nH   0.7233   -0.0489    2.1864\nH  -5.0524    0.1195   -1.8415\nH  -4.0679    1.4861   -1.3088\nH   1.2088    2.7568   -0.7218\nH  -5.0925   -1.2746    0.7905\nH   3.6240    2.7536   -0.9997\nH   4.1386   -2.5085    0.4650\nH  -6.2132    0.2149    0.0339\nH   6.4308   -0.9731    0.4374\n","xyz");
	viewergrid_1682423569839536[0][1].addModel("49\n\n  O          -4.444356148301       -1.519231405669        0.133818802956\n  O          -5.717728473424        0.942316237085       -0.066968962396\n  O           5.074944380112        0.621839630722        0.095361864009\n  C          -1.218663248680       -0.830595956308       -0.247223992768\n  C          -0.477629871511        0.497184226791       -0.529673918529\n  C          -2.930011813590        0.109407860554        1.091647841024\n  C          -1.787420846331       -0.894913983905        1.174595923880\n  C          -2.515711138491       -0.855946194540       -1.095040548846\n  C           0.968464285398        0.594394878134        0.023051359150\n  C          -3.654907965826       -0.372192923668       -0.180394141422\n  C          -0.338906858539       -2.036979464433       -0.583399668258\n  C          -1.380813476472        1.698304225777       -0.180085905847\n  C          -2.322111192587        1.507002611293        1.012160926977\n  C           1.723598180203       -0.686836785339       -0.399658653325\n  C           1.033616297128       -1.956732648516        0.075560115874\n  C           1.068852139151        0.833440819862        1.537692826584\n  C          -4.585050097839        0.655858178693       -0.853861880085\n  C           1.691896058511        1.770006746900       -0.620577515432\n  C           3.162347118014       -0.539762374924       -0.024338881740\n  C           3.026560322778        1.832733770694       -0.661355332056\n  C           3.761395103265        0.686565534847       -0.201084927987\n  C           4.186018037272       -1.411360657395        0.402952793555\n  C           5.318365378847       -0.649258410860        0.464736569034\n  H          -0.335036180683        0.523105134952       -1.619153335984\n  H          -3.599176954096        0.065966348093        1.957690684664\n  H          -1.080856355109       -0.645807578441        1.956928694655\n  H          -2.177294048983       -1.897906384653        1.358785220593\n  H          -2.433801681300       -0.246547664772       -1.993148048283\n  H          -2.750703334368       -1.876555715621       -1.397466956806\n  H          -0.203126601759       -2.084320493005       -1.667436130424\n  H          -0.851890375365       -2.949981497842       -0.273589578941\n  H          -1.983411213175        1.924016483574       -1.061330676925\n  H          -0.767945077172        2.580213930262        0.010339706865\n  H          -1.779556090234        1.670505612833        1.945822615459\n  H          -3.112392348725        2.258845075562        0.965603116349\n  H           1.702548680040       -0.706998814069       -1.502646038847\n  H           0.940906440249       -1.969012908147        1.160909209162\n  H           1.629806822589       -2.823430346797       -0.216840792668\n  H           2.103739193839        1.037127297702        1.803288498697\n  H           0.473184324759        1.693615965109        1.827260296171\n  H           0.749302119412       -0.028513839353        2.112157924155\n  H          -4.890341940956        0.251895622750       -1.829136457420\n  H          -4.081362417860        1.607147612841       -1.012173100013\n  H           1.101176933735        2.597977027327       -0.978171475143\n  H          -4.939036199772       -1.335514044125        0.940761097787\n  H           3.561011194929        2.688548100827       -1.042815340861\n  H           4.105646417170       -2.452204647179        0.640894394432\n  H          -6.244800187656        0.136371594042       -0.009353562144\n  H           6.323262711403       -0.890385787665        0.749405341117\n","xyz");
	viewergrid_1682423569839536[0][0].zoomTo();
	viewergrid_1682423569839536[0][1].zoomTo();
viewergrid_1682423569839536[0][1].render();
viewergrid_1682423569839536[0][0].render();
});
</script></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/mol_struct"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="opt_struct.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Optimization methods</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="tst.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Transition-state theory</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The eChem team<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>