

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Ground-state structure optimization &#8212; Computational Chemistry from  Laptop to HPC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-TX4YJ1J5XE"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/mol_struct/opt_gs';</script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Transition-state theory" href="tst.html" />
    <link rel="prev" title="Optimization methods" href="opt_struct.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../title.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics_notebook.html">Using Jupyter notebooks</a></li>







<li class="toctree-l2"><a class="reference internal" href="../units_notation.html">Units and notation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronic ground states</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/elstruct_gen.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/orbitals.html">Orbitals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/slater.html">Many-electron wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/operators.html">Operators and matrix elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/reduced_density.html">Reduced particle densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/natural_orbitals.html">Natural orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/spin.html">Electron spin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/correlation.html">Electron correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dispersion.html">Dispersion interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/pt.html">Rayleigh–Schrödinger perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/second_quant.html">Second quantization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/group_theory.html">Group theory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/wft.html">Wave function theory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../elec_struct/hartree-fock.html">Hartree–Fock</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_theory.html">Hartree–Fock theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_scf.html">SCF optimization</a></li>

<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_example.html">HF in VeloxChem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/ci.html">Configuration interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mp2.html">Møller–Plesset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcscf.html">Multiconfigurational methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/wft_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/dft.html">Density functional theory</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/hohenberg.html">Hohenberg–Kohn theorems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kohn-sham.html">Kohn–Sham method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kernel_int.html">Kernel integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_scf.html">SCF optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_prop.html">First-order properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/available_xcfun.html">Available XC functionals</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular structure and dynamics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="molstruct_gen.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="coordinates.html">Choice of coordinates</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="gradients.html">Gradients</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="energy_grad.html">Energy gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="property_grad.html">Property gradients</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="hessians_vib.html">Hessians and vibrations</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="hessians.html">Molecular Hessians</a></li>
<li class="toctree-l2"><a class="reference internal" href="vibrations.html">Vibrational analysis</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="opt.html">Structure optimization</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="opt_struct.html">Optimization methods</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Ground-state structure optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tst.html">Transition-state theory</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tst_gen.html">Transition state geometry optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="impes.html">PES interpolation techniques</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="impes_calc.html">Constructing the PES by interpolation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="md.html">Molecular dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="forcefields.html">Force fields</a></li>


<li class="toctree-l2"><a class="reference internal" href="reparameterize.html">Reparameterize force fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="md_setup.html">Ensembles and time integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="md_run.html">Running a simulation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spectra and properties</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/spectra_aspects.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/vibrot.html">Rovibronic states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/response.html">Responses to external fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/selection_rules.html">Selection rules</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/tddft.html">TDDFT</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_basics.html">Foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_rpa.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/mr_response.html">Multireference response</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/ci_response.html">CI response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/sa_mcscf.html">State-averaged MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/mclr.html">Multiconfigurational linear response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/mr_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/adc.html">ADC</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_pp.html">Polarization propagator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_isr.html">Intermediate state representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_cvs.html">Core-valence separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_hpc.html">HPC-QC implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/excoupl.html">Exciton coupling model</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/excoupl_impl.html">Implementation of the exciton coupling model</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/localprop.html">Localized properties</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/esp.html">ESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/resp.html">RESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/loprop.html">LoProp charges and polarisabilities</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/embedding.html">Embedding potentials</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/nonpol_emb.html">Non-polarizable embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/pol_emb.html">Polarizable embedding</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/mol_struct.html">Molecular structure and dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/struct_vis.html">Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/md_vis.html">MD trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/opt_vib_vis.html">Optimization and normal modes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/elec_struct.html">Electronic structure</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/orb_vis.html">Orbitals and densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/exc_vis.html">Excited states</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/spec_prop.html">Spectra and properties</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/broadening.html">Spectrum broadening</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials and workflows</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/workflow.html">Constructing workflows</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_build.html">Building the system</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_struct.html">Optimizing molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_scf.html">Optimizing electronic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_construct.html">Assembling a full workflow</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/uv_vis.html">UV/vis spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_absorption.html">Absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_fluorescence.html">Fluorescence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/vib_ir.html">Vibrational spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_calc.html">IR spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_raman.html">Raman spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/openshells.html">Open shells</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rest_unrest.html">Restricted versus unrestricted</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/correlation.html">Static versus dynamic correlation correlation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/xray.html">X-ray spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_calc.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_analysis.html">Spectrum analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_aspects.html">Special aspects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_large.html">Larger systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_nonstandard.html">Non-standard calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_cheatsheet.html">Cheat sheet</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite and contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kthpanor/echem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/mol_struct/opt_gs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/mol_struct/opt_gs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ground-state structure optimization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scf-geometry-optimization">SCF geometry optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-coordinate-scan">Internal coordinate scan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constrained-optimization">Constrained optimization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xtb-geometry-optimization">XTB geometry optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-xtb-gradient-and-optimization-drivers-and-run-the-geometry-optimization">Set up the xtb gradient and optimization drivers and run the geometry optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-xtb-structure-optimization-for-kahweol">Run the XTB structure optimization for kahweol:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-initial-and-final-geometries">Compare initial and final geometries</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ground-state-structure-optimization">
<h1>Ground-state structure optimization<a class="headerlink" href="#ground-state-structure-optimization" title="Permalink to this headline">#</a></h1>
<p>Molecular structure optimizations always start from an initial guess of the molecular geometry (constructed using <a class="reference external" href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system">SMILES</a> <span class="math notranslate nohighlight">\(-\)</span> see <a class="reference internal" href="../tutorials/wf_build.html#sec-from-smiles"><span class="std std-ref">tutorial</span></a> <span class="math notranslate nohighlight">\(-\)</span>, a chemistry software, e.g. <a class="reference external" href="https://avogadro.cc/">Avogadro</a>, or downloaded from a database like <a class="reference external" href="https://www.chemspider.com/">ChemSpider</a> or <a class="reference external" href="https://molview.org/">MolView</a>). Using the initial guess, we will see in the following how to perform ground-state geometry optimization using <a class="reference external" href="https://veloxchem.org/">VeloxChem</a> and <a class="reference external" href="https://github.com/leeping/geomeTRIC">GeomeTRIC</a>.</p>
<section id="scf-geometry-optimization">
<h2>SCF geometry optimization<a class="headerlink" href="#scf-geometry-optimization" title="Permalink to this headline">#</a></h2>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span> <span class="k">as</span> <span class="nn">p3d</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">geometric</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the molecule and basis set</span>
<span class="n">water_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;3</span>
<span class="s2">water molecule, bond angle 150 deg</span>
<span class="s2">O       0.0000000       0.0000000       0.0000000</span>
<span class="s2">H       0.2760264       0.8822741       0.6495351</span>
<span class="s2">H       0.1036576      -0.7768012      -0.5501827</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">basis_set_label</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz_string</span><span class="p">(</span><span class="n">water_xyz</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis_set_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># View initial structure of the molecule</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">viewergrid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">water_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">view</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">}})</span>
<span class="n">view</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_1686572813560944"  style="position: relative; width: 300px; height: 300px">
        <p id="3dmolwarning_1686572813560944" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_1686572813560944 = null;
var warn = document.getElementById("3dmolwarning_1686572813560944");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_1686572813560944 = null;
viewergrid_1686572813560944 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_1686572813560944"),{rows: 1, cols: 1, control_all: true},{backgroundColor:"white"});
viewer_1686572813560944 = viewergrid_1686572813560944[0][0];
viewergrid_1686572813560944[0][0].zoomTo();	viewergrid_1686572813560944[0][0].addModel("3\nwater molecule, bond angle 150 deg\nO       0.0000000       0.0000000       0.0000000\nH       0.2760264       0.8822741       0.6495351\nH       0.1036576      -0.7768012      -0.5501827\n","xyz");
	viewergrid_1686572813560944[0][0].setViewStyle({"style": "outline", "width": 0.05});
	viewergrid_1686572813560944[0][0].setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewergrid_1686572813560944[0][0].zoomTo();
viewergrid_1686572813560944[0][0].render();
});
</script></div></div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the initial SCF and set up the gradient and optimization drivers</span>
<span class="n">scf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="c1"># Settings for DFT:</span>
<span class="c1"># scf_drv.xcfun = &quot;b3lyp&quot;</span>
<span class="n">scf_results</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 8.4257146308 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -74.838008565136 a.u. Time: 0.01 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -74.838008656380    0.0000000000      0.00020607      0.00005271      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -74.838008679393   -0.0000000230      0.00008668      0.00002305      0.00023046                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -74.838008685191   -0.0000000058      0.00001417      0.00000312      0.00018085                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -74.838008685300   -0.0000000001      0.00000241      0.00000057      0.00002422                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -74.838008685302   -0.0000000000      0.00000049      0.00000009      0.00000358                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 5 iterations. Time: 0.01 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :      -74.8380086853 a.u.                                              
               Electronic Energy                  :      -83.2637233161 a.u.                                              
               Nuclear Repulsion Energy           :        8.4257146308 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000004862 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -20.09946 a.u.                                                                  
               (   1 O   1s  :    -0.99)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.14596 a.u.                                                                  
               (   1 O   1s  :    -0.24) (   1 O   2s  :     0.85) (   3 H   1s  :     0.20)                              
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.58710 a.u.                                                                  
               (   1 O   1p-1:     0.45) (   1 O   1p0 :     0.32) (   2 H   1s  :     0.46)                              
               (   3 H   1s  :    -0.42)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.30532 a.u.                                                                  
               (   1 O   1p-1:    -0.58) (   1 O   1p0 :     0.81)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.30273 a.u.                                                                  
               (   1 O   2s  :     0.25) (   1 O   1p+1:    -0.95) (   2 H   1s  :    -0.19)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.37318 a.u.                                                                  
               (   1 O   2s  :     0.85) (   1 O   1p+1:     0.32) (   2 H   1s  :    -0.87)                              
               (   3 H   1s  :    -0.66)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.84399 a.u.                                                                  
               (   1 O   2s  :    -0.29) (   1 O   1p-1:     0.85) (   1 O   1p0 :     0.61)                              
               (   2 H   1s  :    -0.56) (   3 H   1s  :     0.98)                                                        
                                                                                                                          
</pre></div>
</div>
</div>
</details>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the gradient and optimization dirvers:</span>
<span class="n">grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">()</span>
<span class="n">opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">grad_drv</span><span class="p">)</span>

<span class="n">opt_drv</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;../../data/structopt/h2o_gsstructopt&quot;</span>
<span class="c1"># Run the optimization</span>
<span class="n">opt_molecule</span> <span class="o">=</span> <span class="n">opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_drv</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s plot the energies calculated during the optimization and check how the structure changes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The data we need are stored in the output file generated during the geometry optimization.</span>
<span class="c1"># Let&#39;s write a routine which reads these data points from file.</span>
<span class="k">def</span> <span class="nf">read_optimization_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">structures</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;Energy&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">parts</span><span class="p">:</span>
                <span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
                <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">steps</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">structures</span>

<span class="n">steps</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">structures</span> <span class="o">=</span> <span class="n">read_optimization_file</span><span class="p">(</span><span class="s1">&#39;../../data/structopt/h2o_gsstructopt_optim.xyz&#39;</span><span class="p">)</span>


<span class="c1"># Plot the energies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span><span class="s1">&#39;o--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (H)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;H2O GS optimization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Animate optimization</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="n">structures</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">animate</span><span class="p">({</span><span class="s2">&quot;loop&quot;</span><span class="p">:</span> <span class="s2">&quot;forward&quot;</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">}})</span>
<span class="c1"># # rotate for a better initial view</span>
<span class="c1"># viewer.rotate(-90, &quot;y&quot;)</span>
<span class="c1"># viewer.rotate(-90, &quot;x&quot;)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/682e1b0553e64be3f43243e31ca6df6f8408db805a0653f77d75bf19a7a37895.png" src="../../_images/682e1b0553e64be3f43243e31ca6df6f8408db805a0653f77d75bf19a7a37895.png" />
<div class="output text_html"><div id="3dmolviewer_1686572813704158"  style="position: relative; width: 300px; height: 200px">
        <p id="3dmolwarning_1686572813704158" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_1686572813704158 = null;
var warn = document.getElementById("3dmolwarning_1686572813704158");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1686572813704158 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1686572813704158"),{backgroundColor:"white"});
viewer_1686572813704158.zoomTo();
	viewer_1686572813704158.addModelsAsFrames("3    \nIteration 0 Energy -74.83800869\nO        0.0000000000    0.0000000000    0.0000000000\nH        0.2760264000    0.8822741000    0.6495351000\nH        0.1036576000   -0.7768012000   -0.5501827000\n3    \nIteration 1 Energy -74.89804404\nO       -0.0698727162    0.0410502086    0.0250433581\nH        0.2963321517    0.7875141524    0.5828990568\nH        0.1532250370   -0.7230914777   -0.5085900169\n3    \nIteration 2 Energy -74.94773048\nO       -0.1917108158    0.0739226508    0.0409732781\nH        0.3395517605    0.6741968010    0.5043987178\nH        0.2318440836   -0.6426465833   -0.4460195921\n3    \nIteration 3 Energy -74.95249268\nO       -0.3534137348    0.0779103592    0.0337081420\nH        0.4015129389    0.5442344430    0.4151428003\nH        0.3315870782   -0.5166719800   -0.3494985927\n3    \nIteration 4 Energy -74.96582905\nO       -0.2987080319    0.0707057419    0.0319697716\nH        0.3847962362    0.6255370368    0.4723589672\nH        0.2935981394   -0.5907699509   -0.4049763840\n3    \nIteration 5 Energy -74.96589975\nO       -0.2960388877    0.0688971901    0.0308407238\nH        0.3842442400    0.6311603079    0.4763533401\nH        0.2914809152   -0.5945846555   -0.4078417069\n3    \nIteration 6 Energy -74.96590120\nO       -0.2959339703    0.0688786942    0.0308339257\nH        0.3842837095    0.6319968447    0.4769543977\nH        0.2913364064   -0.5954026761   -0.4084359605\n3    \nIteration 7 Energy -74.96590122\nO       -0.2959494022    0.0688275343    0.0307962054\nH        0.3842933109    0.6319846807    0.4769455291\nH        0.2913421262   -0.5953393407   -0.4083893649\n");
	viewer_1686572813704158.animate({"loop": "forward"});
	viewer_1686572813704158.setViewStyle({"style": "outline", "width": 0.05});
	viewer_1686572813704158.setStyle({"stick": {}, "sphere": {"scale": 0.25}});
viewer_1686572813704158.render();
});
</script></div></div>
</div>
<section id="internal-coordinate-scan">
<h3>Internal coordinate scan<a class="headerlink" href="#internal-coordinate-scan" title="Permalink to this headline">#</a></h3>
<p>Let’s say that we want to see how the total energy varies when we change one internal coordinate and we optimize the rest. For this, we can set up a scan using <a class="reference external" href="https://github.com/leeping/geomeTRIC">geomeTRIC</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the gradient and optimization dirvers:</span>
<span class="n">grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">()</span>
<span class="n">opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">grad_drv</span><span class="p">)</span>

<span class="n">opt_drv</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;../../data/structopt/h2o_scan&quot;</span>
<span class="n">angle_scan</span> <span class="o">=</span> <span class="s2">&quot;angle 2 1 3 70 140.0 20&quot;</span> 
<span class="n">opt_drv</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$scan&quot;</span><span class="p">,</span> <span class="n">angle_scan</span><span class="p">]</span>

<span class="c1"># Run the scan</span>
<span class="n">opt_molecule</span> <span class="o">=</span> <span class="n">opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_drv</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle_scan</span> <span class="o">=</span> <span class="s2">&quot;angle 2 1 3 70 140.0 20&quot;</span> 
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_scan</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">natms</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
    <span class="c1"># start, stop and how many steps</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">no_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">stop</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">no_steps</span>
    
    <span class="n">scan_coords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">structures</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no_steps</span><span class="p">):</span>
        <span class="n">energy</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_scan-00</span><span class="si">%d</span><span class="s2">.xyz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_scan-0</span><span class="si">%d</span><span class="s2">.xyz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_scan-</span><span class="si">%d</span><span class="s2">.xyz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    
        <span class="c1"># The optimized geometry is the last geometry in the file</span>
        <span class="c1"># in xyz format.</span>
        <span class="n">nlines</span> <span class="o">=</span> <span class="n">natms</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    
        <span class="n">opt_struct</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">nlines</span><span class="p">:]:</span>
            <span class="n">opt_struct</span> <span class="o">+=</span> <span class="n">line</span>
            <span class="k">if</span> <span class="s2">&quot;Energy&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">scan_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">step</span><span class="p">)</span>
        <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
        <span class="n">structures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_struct</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scan_coords</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">structures</span>

<span class="n">natms</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>
<span class="n">scan_coords</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">structures</span> <span class="o">=</span> <span class="n">read_scan</span><span class="p">(</span><span class="s2">&quot;../../data/structopt/h2o_scan&quot;</span><span class="p">,</span> <span class="n">natms</span><span class="p">,</span> <span class="n">angle_scan</span><span class="p">)</span>


<span class="c1"># Plot the energies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scan_coords</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span><span class="s1">&#39;o--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Angle (deg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (H)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;H2O bond angle scan&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0287ed32c9db44fe94132179056c2a9032f85ff77806430f2be99a3ad213f1b8.png" src="../../_images/0287ed32c9db44fe94132179056c2a9032f85ff77806430f2be99a3ad213f1b8.png" />
</div>
</div>
</section>
<section id="constrained-optimization">
<h3>Constrained optimization<a class="headerlink" href="#constrained-optimization" title="Permalink to this headline">#</a></h3>
<p>Now let’s see how to run a constrained optimization. For this example, we will constrain the OH bond lengths to specific values and we will optimize the bond angle of the water molecule to construct a “relaxed” potential energy surface. For this, we will need several water structures with different combinations of OH bond lengths. These will be read from file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Since we are considering many combinations, running this cell may take a while...</span>
<span class="n">bond_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">folder</span> <span class="o">=</span> <span class="s2">&quot;../../data/structopt/h2o_relaxed_pes/&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">r1</span> <span class="ow">in</span> <span class="n">bond_lengths</span><span class="p">:</span>
    <span class="c1"># We will constrain the first OH bond length to bond_1.</span>
    <span class="n">bond_1</span> <span class="o">=</span> <span class="s2">&quot;distance 1 2 </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r1</span> 
    <span class="k">for</span> <span class="n">r2</span> <span class="ow">in</span> <span class="n">bond_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">:]:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s2">&quot;h2o_</span><span class="si">%.2f</span><span class="s2">_</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;.xyz&quot;</span> <span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">h2o_xyz</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">new_molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz_string</span><span class="p">(</span><span class="n">h2o_xyz</span><span class="p">)</span>
        <span class="n">scf_results</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">new_molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
        
        <span class="c1"># Set up the gradient and optimization dirvers:</span>
        <span class="n">new_grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">()</span>
        <span class="n">new_opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">new_grad_drv</span><span class="p">)</span>
        <span class="n">new_opt_drv</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">file_name</span>
        
        <span class="c1"># We will constrain the second OH bond length to value bond_2.</span>
        <span class="n">bond_2</span> <span class="o">=</span> <span class="s2">&quot;distance 1 3 </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r2</span>
        
        <span class="c1"># Possible options: set, scan, freeze.</span>
        <span class="n">new_opt_drv</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$set&quot;</span><span class="p">,</span> <span class="n">bond_1</span><span class="p">,</span> <span class="n">bond_2</span><span class="p">]</span>
        
        <span class="c1"># We now optimize th bond angle:</span>
        <span class="n">h2o_opt</span> <span class="o">=</span> <span class="n">new_opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">new_molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_drv</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_optimized_structure</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">natms</span><span class="p">):</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    
    <span class="c1"># The optimized geometry is the last geometry in the file</span>
    <span class="c1"># in xyz format.</span>
    <span class="n">nlines</span> <span class="o">=</span> <span class="n">natms</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">output_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    
    <span class="n">opt_struct</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">nlines</span><span class="p">:]:</span>
        <span class="n">opt_struct</span> <span class="o">+=</span> <span class="n">line</span>
        <span class="k">if</span> <span class="s2">&quot;Energy&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">energy</span><span class="p">,</span> <span class="n">opt_struct</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s plot the 2D PES and the 2D map of relaxed bond angles.</span>
<span class="n">npts</span> <span class="o">=</span> <span class="n">bond_lengths</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">natm</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>

<span class="n">pes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>

<span class="c1"># Read energies</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">r1</span> <span class="ow">in</span> <span class="n">bond_lengths</span><span class="p">:</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">for</span> <span class="n">r2</span> <span class="ow">in</span> <span class="n">bond_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">:]:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">+</span> <span class="s2">&quot;h2o_</span><span class="si">%.2f</span><span class="s2">_</span><span class="si">%.2f</span><span class="s2">_optim.xyz&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="n">energy</span><span class="p">,</span> <span class="n">xyz_opt</span> <span class="o">=</span> <span class="n">read_optimized_structure</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">natm</span><span class="p">)</span>
        <span class="n">pes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">energy</span>
        <span class="n">pes</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">energy</span>
        
        <span class="c1"># calculate the relaxed bond angle</span>
        <span class="n">opt_molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz_string</span><span class="p">(</span><span class="n">xyz_opt</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">geometric</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">Angle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">opt_molecule</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span> <span class="o">*</span> <span class="n">natm</span><span class="p">))</span>
        <span class="c1"># transform from radians to degrees</span>
        <span class="n">angle_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">angle</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">coords</span><span class="p">))</span><span class="o">*</span><span class="mf">180.0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle_value</span>
        <span class="n">theta</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle_value</span>
        
        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r1 (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;r2 (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;H2O relaxed PES&quot;</span><span class="p">)</span>
<span class="n">conts</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">bond_lengths</span><span class="p">,</span> <span class="n">pes</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">conts</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">CS</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">bond_lengths</span><span class="p">,</span> <span class="n">pes</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdGy&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Energy (H)&quot;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r1 (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;r2 (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;H2O relaxed bond angle&quot;</span><span class="p">)</span>
<span class="n">conts</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">bond_lengths</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">conts</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">bond_lengths</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span>
                  <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues_r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Angle (rad)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/05a6555a93081bac1fdab883574d263183b10c3b7eeeca1a52b082c385644f83.png" src="../../_images/05a6555a93081bac1fdab883574d263183b10c3b7eeeca1a52b082c385644f83.png" />
</div>
</div>
</section>
</section>
<section id="xtb-geometry-optimization">
<h2>XTB geometry optimization<a class="headerlink" href="#xtb-geometry-optimization" title="Permalink to this headline">#</a></h2>
<p>In the following we will perform a ground state structure optimization of cafestol and kahweol. Cafestol is a molecule present in Robusta coffee beans, while kahweol is a very similar molecule present in Arabica coffee beans. Kahweol has a distinctive Raman peak which allows to identify Arabica coffee beans by Raman spectroscopy. Here, we determine the relaxed geometries of these two molecules. Since these molecules are large, we will use the semiempirical tight binding method from the <a class="reference external" href="https://xtb-docs.readthedocs.io/en/latest/contents.html">Xtb code</a>. Veloxchem has dedicated drivers which connect to Xtb.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cafestol_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;51</span>
<span class="s2">cafestol initial structure</span>
<span class="s2">O  -4.5215   -1.3455    0.4926</span>
<span class="s2">O  -5.2905    0.0812   -1.7033</span>
<span class="s2">O   5.1630    0.4345   -0.1101</span>
<span class="s2">C  -1.2807   -0.7511   -0.0465</span>
<span class="s2">C  -0.5244    0.5810   -0.4102</span>
<span class="s2">C   0.9909    0.6610    0.0407</span>
<span class="s2">C  -2.9440    0.2916    1.2866</span>
<span class="s2">C  -1.8143   -0.7311    1.3945</span>
<span class="s2">C  -2.6188   -0.8159   -0.8642</span>
<span class="s2">C  -3.7116   -0.2387    0.0606</span>
<span class="s2">C  -0.4332   -2.0024   -0.3283</span>
<span class="s2">C  -1.3742    1.8303   -0.0654</span>
<span class="s2">C   1.6844   -0.6873   -0.4019</span>
<span class="s2">C  -2.3206    1.6833    1.1309</span>
<span class="s2">C   0.9997   -1.9155    0.1913</span>
<span class="s2">C   1.7285    1.8344   -0.7277</span>
<span class="s2">C   1.1437    0.9261    1.5588</span>
<span class="s2">C   3.1644   -0.6155   -0.2085</span>
<span class="s2">C  -4.6490    0.7442   -0.6282</span>
<span class="s2">C   3.2525    1.9378   -0.4590</span>
<span class="s2">C   3.8298    0.5879   -0.2856</span>
<span class="s2">C   4.1654   -1.5888    0.0140</span>
<span class="s2">C   5.3604   -0.9015    0.0689</span>
<span class="s2">H  -0.4604    0.5817   -1.5108</span>
<span class="s2">H  -3.5646    0.2626    2.1897</span>
<span class="s2">H  -1.0861   -0.4449    2.1498</span>
<span class="s2">H  -2.1902   -1.7145    1.7003</span>
<span class="s2">H  -2.5286   -0.2495   -1.7981</span>
<span class="s2">H  -2.8534   -1.8505   -1.1460</span>
<span class="s2">H  -0.3943   -2.1694   -1.4136</span>
<span class="s2">H  -0.9135   -2.8938    0.0946</span>
<span class="s2">H  -1.9810    2.0650   -0.9487</span>
<span class="s2">H  -0.7587    2.7222    0.0818</span>
<span class="s2">H   1.5605   -0.7646   -1.4951</span>
<span class="s2">H  -1.7642    1.9154    2.0477</span>
<span class="s2">H  -3.1082    2.4431    1.0635</span>
<span class="s2">H   1.0176   -1.9046    1.2859</span>
<span class="s2">H   1.5276   -2.8282   -0.1118</span>
<span class="s2">H   1.2808    2.8061   -0.4944</span>
<span class="s2">H   1.5851    1.6842   -1.8068</span>
<span class="s2">H   0.5898    1.8173    1.8670</span>
<span class="s2">H   0.8147    0.0892    2.1727</span>
<span class="s2">H   2.1832    1.0992    1.8532</span>
<span class="s2">H  -4.1337    1.6158   -1.0351</span>
<span class="s2">H  -5.4265    1.0934    0.0595</span>
<span class="s2">H   3.4273    2.5264    0.4487</span>
<span class="s2">H   3.7385    2.4646   -1.2871</span>
<span class="s2">H  -3.9519   -2.0832    0.7635</span>
<span class="s2">H   4.0442   -2.6573    0.1180</span>
<span class="s2">H  -5.7603   -0.6874   -1.3370</span>
<span class="s2">H   6.3869   -1.2031    0.2186</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">cafestol</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz_string</span><span class="p">(</span><span class="n">cafestol_xyz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kahweol_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;49</span>
<span class="s2">kahweol initial structure</span>
<span class="s2">O  -4.4710   -1.5361    0.0905</span>
<span class="s2">O  -5.6188    0.9753   -0.0811</span>
<span class="s2">O   5.1625    0.5695   -0.0997</span>
<span class="s2">C  -1.2209   -0.8317   -0.2017</span>
<span class="s2">C  -0.4821    0.5357   -0.4703</span>
<span class="s2">C  -3.0038    0.1167    1.0462</span>
<span class="s2">C  -1.8514   -0.8737    1.1997</span>
<span class="s2">C  -2.4967   -0.9058   -1.1119</span>
<span class="s2">C   0.9884    0.6333    0.0944</span>
<span class="s2">C  -3.6676   -0.3924   -0.2474</span>
<span class="s2">C  -0.3220   -2.0551   -0.4569</span>
<span class="s2">C  -1.3919    1.7479   -0.1363</span>
<span class="s2">C  -2.4167    1.5304    0.9816</span>
<span class="s2">C   1.7435   -0.6786   -0.3542</span>
<span class="s2">C   1.0741   -1.9483    0.1552</span>
<span class="s2">C   1.0367    0.8330    1.6293</span>
<span class="s2">C  -4.5845    0.5870   -0.9677</span>
<span class="s2">C   1.7610    1.8511   -0.4907</span>
<span class="s2">C   3.2146   -0.5444   -0.1101</span>
<span class="s2">C   3.1013    1.8722   -0.6493</span>
<span class="s2">C   3.8167    0.6946   -0.3059</span>
<span class="s2">C   4.2309   -1.4546    0.2464</span>
<span class="s2">C   5.3980   -0.7259    0.2399</span>
<span class="s2">H  -0.3415    0.5842   -1.5631</span>
<span class="s2">H  -3.6779    0.0397    1.9072</span>
<span class="s2">H  -1.1861   -0.6021    2.0159</span>
<span class="s2">H  -2.2356   -1.8757    1.4322</span>
<span class="s2">H  -2.3648   -0.3090   -2.0216</span>
<span class="s2">H  -2.6844   -1.9384   -1.4328</span>
<span class="s2">H  -0.2098   -2.1924   -1.5413</span>
<span class="s2">H  -0.8043   -2.9694   -0.0890</span>
<span class="s2">H  -1.9406    2.0033   -1.0514</span>
<span class="s2">H  -0.8134    2.6482    0.0921</span>
<span class="s2">H  -1.9341    1.7452    1.9434</span>
<span class="s2">H  -3.2193    2.2709    0.8849</span>
<span class="s2">H   1.6699   -0.7251   -1.4553</span>
<span class="s2">H   1.0259   -1.9792    1.2481</span>
<span class="s2">H   1.6508   -2.8307   -0.1490</span>
<span class="s2">H   2.0514    1.0518    1.9842</span>
<span class="s2">H   0.4166    1.6762    1.9486</span>
<span class="s2">H   0.7233   -0.0489    2.1864</span>
<span class="s2">H  -5.0524    0.1195   -1.8415</span>
<span class="s2">H  -4.0679    1.4861   -1.3088</span>
<span class="s2">H   1.2088    2.7568   -0.7218</span>
<span class="s2">H  -5.0925   -1.2746    0.7905</span>
<span class="s2">H   3.6240    2.7536   -0.9997</span>
<span class="s2">H   4.1386   -2.5085    0.4650</span>
<span class="s2">H  -6.2132    0.2149    0.0339</span>
<span class="s2">H   6.4308   -0.9731    0.4374</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">kahweol</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz_string</span><span class="p">(</span><span class="n">kahweol_xyz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The difference between cafestol and kahweol is very subtle, essentially only one double bond and two H atoms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">               (a) Cafestol                                 (b) Kahweol&quot;</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">viewergrid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">linked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">cafestol_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">kahweol_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               (a) Cafestol                                 (b) Kahweol
</pre></div>
</div>
<div class="output text_html"><div id="3dmolviewer_16865728140493681"  style="position: relative; width: 700px; height: 250px">
        <p id="3dmolwarning_16865728140493681" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_16865728140493681 = null;
var warn = document.getElementById("3dmolwarning_16865728140493681");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_16865728140493681 = null;
viewergrid_16865728140493681 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_16865728140493681"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_16865728140493681 = viewergrid_16865728140493681[0][0];
viewergrid_16865728140493681[0][0].zoomTo();viewergrid_16865728140493681[0][1].zoomTo();	viewergrid_16865728140493681[0][0].addModel("51\ncafestol initial structure\nO  -4.5215   -1.3455    0.4926\nO  -5.2905    0.0812   -1.7033\nO   5.1630    0.4345   -0.1101\nC  -1.2807   -0.7511   -0.0465\nC  -0.5244    0.5810   -0.4102\nC   0.9909    0.6610    0.0407\nC  -2.9440    0.2916    1.2866\nC  -1.8143   -0.7311    1.3945\nC  -2.6188   -0.8159   -0.8642\nC  -3.7116   -0.2387    0.0606\nC  -0.4332   -2.0024   -0.3283\nC  -1.3742    1.8303   -0.0654\nC   1.6844   -0.6873   -0.4019\nC  -2.3206    1.6833    1.1309\nC   0.9997   -1.9155    0.1913\nC   1.7285    1.8344   -0.7277\nC   1.1437    0.9261    1.5588\nC   3.1644   -0.6155   -0.2085\nC  -4.6490    0.7442   -0.6282\nC   3.2525    1.9378   -0.4590\nC   3.8298    0.5879   -0.2856\nC   4.1654   -1.5888    0.0140\nC   5.3604   -0.9015    0.0689\nH  -0.4604    0.5817   -1.5108\nH  -3.5646    0.2626    2.1897\nH  -1.0861   -0.4449    2.1498\nH  -2.1902   -1.7145    1.7003\nH  -2.5286   -0.2495   -1.7981\nH  -2.8534   -1.8505   -1.1460\nH  -0.3943   -2.1694   -1.4136\nH  -0.9135   -2.8938    0.0946\nH  -1.9810    2.0650   -0.9487\nH  -0.7587    2.7222    0.0818\nH   1.5605   -0.7646   -1.4951\nH  -1.7642    1.9154    2.0477\nH  -3.1082    2.4431    1.0635\nH   1.0176   -1.9046    1.2859\nH   1.5276   -2.8282   -0.1118\nH   1.2808    2.8061   -0.4944\nH   1.5851    1.6842   -1.8068\nH   0.5898    1.8173    1.8670\nH   0.8147    0.0892    2.1727\nH   2.1832    1.0992    1.8532\nH  -4.1337    1.6158   -1.0351\nH  -5.4265    1.0934    0.0595\nH   3.4273    2.5264    0.4487\nH   3.7385    2.4646   -1.2871\nH  -3.9519   -2.0832    0.7635\nH   4.0442   -2.6573    0.1180\nH  -5.7603   -0.6874   -1.3370\nH   6.3869   -1.2031    0.2186\n","xyz");
	viewergrid_16865728140493681[0][1].addModel("49\nkahweol initial structure\nO  -4.4710   -1.5361    0.0905\nO  -5.6188    0.9753   -0.0811\nO   5.1625    0.5695   -0.0997\nC  -1.2209   -0.8317   -0.2017\nC  -0.4821    0.5357   -0.4703\nC  -3.0038    0.1167    1.0462\nC  -1.8514   -0.8737    1.1997\nC  -2.4967   -0.9058   -1.1119\nC   0.9884    0.6333    0.0944\nC  -3.6676   -0.3924   -0.2474\nC  -0.3220   -2.0551   -0.4569\nC  -1.3919    1.7479   -0.1363\nC  -2.4167    1.5304    0.9816\nC   1.7435   -0.6786   -0.3542\nC   1.0741   -1.9483    0.1552\nC   1.0367    0.8330    1.6293\nC  -4.5845    0.5870   -0.9677\nC   1.7610    1.8511   -0.4907\nC   3.2146   -0.5444   -0.1101\nC   3.1013    1.8722   -0.6493\nC   3.8167    0.6946   -0.3059\nC   4.2309   -1.4546    0.2464\nC   5.3980   -0.7259    0.2399\nH  -0.3415    0.5842   -1.5631\nH  -3.6779    0.0397    1.9072\nH  -1.1861   -0.6021    2.0159\nH  -2.2356   -1.8757    1.4322\nH  -2.3648   -0.3090   -2.0216\nH  -2.6844   -1.9384   -1.4328\nH  -0.2098   -2.1924   -1.5413\nH  -0.8043   -2.9694   -0.0890\nH  -1.9406    2.0033   -1.0514\nH  -0.8134    2.6482    0.0921\nH  -1.9341    1.7452    1.9434\nH  -3.2193    2.2709    0.8849\nH   1.6699   -0.7251   -1.4553\nH   1.0259   -1.9792    1.2481\nH   1.6508   -2.8307   -0.1490\nH   2.0514    1.0518    1.9842\nH   0.4166    1.6762    1.9486\nH   0.7233   -0.0489    2.1864\nH  -5.0524    0.1195   -1.8415\nH  -4.0679    1.4861   -1.3088\nH   1.2088    2.7568   -0.7218\nH  -5.0925   -1.2746    0.7905\nH   3.6240    2.7536   -0.9997\nH   4.1386   -2.5085    0.4650\nH  -6.2132    0.2149    0.0339\nH   6.4308   -0.9731    0.4374\n","xyz");
	viewergrid_16865728140493681[0][0].setViewStyle({"style": "outline", "width": 0.05});
	viewergrid_16865728140493681[0][1].setViewStyle({"style": "outline", "width": 0.05});
	viewergrid_16865728140493681[0][0].setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewergrid_16865728140493681[0][1].setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewergrid_16865728140493681[0][0].zoomTo();
	viewergrid_16865728140493681[0][1].zoomTo();
viewergrid_16865728140493681[0][1].render();
viewergrid_16865728140493681[0][0].render();
});
</script></div></div>
</div>
<div class="cell tag_output_scroll tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the xtb driver</span>
<span class="n">xtbdrv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">XtbDriver</span><span class="p">()</span>
<span class="n">xtbdrv</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="s1">&#39;gfn2&#39;</span><span class="p">)</span>
<span class="n">xtbdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">cafestol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 120          :
          :  # atomic orbitals                 120          :
          :  # shells                           74          :
          :  # electrons                       126          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  :  -&gt; SCF convergence          0.1000000E-05 Eh   :
          :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -70.1256729 -0.701257E+02  0.308E+00    4.51       0.0  T
   2    -70.1969288 -0.712559E-01  0.183E+00    4.43       1.0  T
   3    -70.1926047  0.432407E-02  0.777E-01    4.43       1.0  T
   4    -70.2001181 -0.751331E-02  0.340E-01    4.33       1.0  T
   5    -70.2039272 -0.380913E-02  0.779E-02    4.36       1.0  T
   6    -70.2039738 -0.466179E-04  0.373E-02    4.36       1.0  T
   7    -70.2039865 -0.126975E-04  0.138E-02    4.36       1.0  T
   8    -70.2039876 -0.106686E-05  0.338E-03    4.36       4.1  T
   9    -70.2039877 -0.118719E-06  0.156E-03    4.36       9.0  T
  10    -70.2039877 -0.125795E-07  0.589E-04    4.36      23.8  T
  11    -70.2039877 -0.255973E-08  0.214E-04    4.36      65.4  T

   *** convergence criteria satisfied after 11 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7268208             -19.7778
       ...           ...                  ...                  ...
        57        2.0000           -0.4145936             -11.2817
        58        2.0000           -0.4096877             -11.1482
        59        2.0000           -0.4060970             -11.0505
        60        2.0000           -0.4022968             -10.9471
        61        2.0000           -0.4009046             -10.9092
        62        2.0000           -0.3984565             -10.8426
        63        2.0000           -0.3664995              -9.9730 (HOMO)
        64                         -0.2062144              -5.6114 (LUMO)
        65                         -0.1513512              -4.1185
        6
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6                         -0.0221661              -0.6032
        67                          0.0014760               0.0402
        68                          0.0144309               0.3927
       ...                                ...                  ...
       120                          0.6705777              18.2473
      -------------------------------------------------------------
                  HL-Gap            0.1602851 Eh            4.3616 eV
             Fermi-level           -0.2863569 Eh           -7.7922 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.051 sec
 SCC setup                      ...        0 min,  0.003 sec (  5.736%)
 Dispersion                     ...        0 min,  0.000 sec (  0.787%)
 classical contributions        ...        0 min,  0.000 sec (  0.723%)
 integral evaluation            ...        0 min,  0.004 sec (  7.938%)
 iterations                     ...        0 min,  0.027 sec ( 54.047%)
 molecular gradient             ...        0 min,  0.015 sec ( 29.613%)
 printout                       ...        0 min,  0.001 sec (  1.135%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -69.361512202626 Eh    ::
         :: gradient norm              0.059453607714 Eh/a0 ::
         :: HOMO-LUMO gap              4.361580250884 eV    ::
         ::.................................................::
         :: SCC energy               -70.203987702583 Eh    ::
         :: -&gt; isotropic ES            0.064491640234 Eh    ::
         :: -&gt; anisotropic ES          0.010230341319 Eh    ::
         :: -&gt; anisotropic XC          0.020200140987 Eh    ::
         :: -&gt; dispersion             -0.059211487310 Eh    ::
         :: repulsion energy           0.841319621733 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
</div>
</details>
</div>
<section id="set-up-the-xtb-gradient-and-optimization-drivers-and-run-the-geometry-optimization">
<h3>Set up the xtb gradient and optimization drivers and run the geometry optimization<a class="headerlink" href="#set-up-the-xtb-gradient-and-optimization-drivers-and-run-the-geometry-optimization" title="Permalink to this headline">#</a></h3>
<div class="cell tag_output_scroll tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtb_grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">XtbGradientDriver</span><span class="p">()</span>
<span class="n">xtb_opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">xtb_grad_drv</span><span class="p">)</span>
<span class="n">xtb_opt_cafestol</span> <span class="o">=</span> <span class="n">xtb_opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">cafestol</span><span class="p">,</span> <span class="n">xtbdrv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                Optimization Driver Setup                                                 
                                               ===========================                                                
                                                                                                                          
                                     Coordinate System       :    TRIC                                                    
                                     Constraints             :    No                                                      
                                     Max. Number of Steps    :    300                                                     
                                     Transition State        :    No                                                      
                                     Hessian                 :    never                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3615122035 a.u.                                                                                 
* Info *   Gradient : 8.325322e-03 a.u. (RMS)                                                                             
* Info *              1.928454e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3710058836 a.u.                                                                                 
* Info *   Gradient : 3.923981e-03 a.u. (RMS)                                                                             
* Info *              9.301846e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3722458724 a.u.                                                                                 
* Info *   Gradient : 2.159347e-03 a.u. (RMS)                                                                             
* Info *              7.974968e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3726427963 a.u.                                                                                 
* Info *   Gradient : 1.107748e-03 a.u. (RMS)                                                                             
* Info *              4.002520e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3728625818 a.u.                                                                                 
* Info *   Gradient : 5.724391e-04 a.u. (RMS)                                                                             
* Info *              1.901848e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3729577548 a.u.                                                                                 
* Info *   Gradient : 3.816103e-04 a.u. (RMS)                                                                             
* Info *              9.881626e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730321297 a.u.                                                                                 
* Info *   Gradient : 3.155273e-04 a.u. (RMS)                                                                             
* Info *              8.318735e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730679685 a.u.                                                                                 
* Info *   Gradient : 2.001910e-04 a.u. (RMS)                                                                             
* Info *              5.533687e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730753850 a.u.                                                                                 
* Info *   Gradient : 1.166858e-04 a.u. (RMS)                                                                             
* Info *              2.372876e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730804351 a.u.                                                                                 
* Info *   Gradient : 6.970578e-05 a.u. (RMS)                                                                             
* Info *              1.798257e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730830365 a.u.                                                                                 
* Info *   Gradient : 6.708893e-05 a.u. (RMS)                                                                             
* Info *              1.927371e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730839403 a.u.                                                                                 
* Info *   Gradient : 4.328344e-05 a.u. (RMS)                                                                             
* Info *              1.301321e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730847891 a.u.                                                                                 
* Info *   Gradient : 3.104179e-05 a.u. (RMS)                                                                             
* Info *              8.742235e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730852597 a.u.                                                                                 
* Info *   Gradient : 3.926610e-05 a.u. (RMS)                                                                             
* Info *              1.113513e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730857417 a.u.                                                                                 
* Info *   Gradient : 3.673542e-05 a.u. (RMS)                                                                             
* Info *              1.127451e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730861287 a.u.                                                                                 
* Info *   Gradient : 2.352441e-05 a.u. (RMS)                                                                             
* Info *              6.344279e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730864008 a.u.                                                                                 
* Info *   Gradient : 2.201488e-05 a.u. (RMS)                                                                             
* Info *              6.665192e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730866063 a.u.                                                                                 
* Info *   Gradient : 2.456196e-05 a.u. (RMS)                                                                             
* Info *              6.707557e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730867353 a.u.                                                                                 
* Info *   Gradient : 1.788210e-05 a.u. (RMS)                                                                             
* Info *              5.657216e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -69.3730867912 a.u.                                                                                 
* Info *   Gradient : 8.285115e-06 a.u. (RMS)                                                                             
* Info *              2.364064e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Saving file: veloxchem_opt_2023-06-12T14.26.54_optim.xyz                                                         
* Info * Saving file: veloxchem_opt_2023-06-12T14.26.54.log                                                               
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Geometry optimization completed.                                                                                 
                                                                                                                          
                                              Molecular Geometry (Angstroms)                                              
                                             ================================                                             
                                                                                                                          
                          Atom         Coordinate X          Coordinate Y          Coordinate Z                           
                                                                                                                          
                           O          -4.586927894297       -1.279900580081        0.480283797793                         
                           O          -5.319303242952        0.246562207320       -1.629047843300                         
                           O           5.096372964454        0.479142524541        0.047370527290                         
                           C          -1.255190295744       -0.766697135858       -0.090694519716                         
                           C          -0.509228219094        0.539152695692       -0.458496889438                         
                           C           0.978372037194        0.632243366820       -0.011990155161                         
                           C          -2.880159755562        0.238836828861        1.312497729308                         
                           C          -1.740436945819       -0.771913903412        1.364288546093                         
                           C          -2.598892938446       -0.799816206160       -0.863851939900                         
                           C          -3.682490893188       -0.248170686858        0.088636802757                         
                           C          -0.416164506854       -1.999830242086       -0.434968241726                         
                           C          -1.378410399217        1.760376004456       -0.090411193298                         
                           C           1.674856502875       -0.681263507644       -0.445474818245                         
                           C          -2.250016721329        1.621564634949        1.161318676793                         
                           C           0.997770067356       -1.919050968336        0.128039543449                         
                           C           1.666376726005        1.766537760643       -0.811768240558                         
                           C           1.168837532826        0.910140988103        1.479849080800                         
                           C           3.135520466851       -0.569549508958       -0.157646718636                         
                           C          -4.609457056369        0.795536374054       -0.551570433613                         
                           C           3.155683415864        1.954159444441       -0.478173900174                         
                           C           3.782186986193        0.630199905389       -0.219299021035                         
                           C           4.130802164950       -1.530150373797        0.161772362564                         
                           C           5.294632956634       -0.835297374348        0.274041555784                         
                           H          -0.446342259653        0.529017873163       -1.555044787035                         
                           H          -3.512301962729        0.221149517725        2.205105205326                         
                           H          -0.987805192361       -0.489646713079        2.090189238482                         
                           H          -2.099466069880       -1.770583425745        1.629844780980                         
                           H          -2.561113930095       -0.227435609543       -1.788326352210                         
                           H          -2.854655290972       -1.827144938935       -1.131680096908                         
                           H          -0.352920373720       -2.090381541625       -1.522829914942                         
                           H          -0.917392216442       -2.895613171681       -0.058907062896                         
                           H          -2.030547320612        1.964782326180       -0.939715067955                         
                           H          -0.751054032804        2.643276309973        0.031133878813                         
                           H           1.568213879475       -0.751868233951       -1.538315305172                         
                           H          -1.648526534108        1.799632361004        2.055430463497                         
                           H          -3.024936836985        2.390210621298        1.135414632642                         
                           H           0.980001478774       -1.887152726443        1.216951591943                         
                           H           1.555474968493       -2.809090968393       -0.168723212483                         
                           H           1.159647477215        2.715758648017       -0.638991630812                         
                           H           1.574182496031        1.537824463169       -1.875605731830                         
                           H           0.649837420195        1.820869381957        1.764759763362                         
                           H           0.808399132338        0.095444063030        2.096526843634                         
                           H           2.222626553193        1.033900090352        1.709265075873                         
                           H          -4.054650314922        1.641880113076       -0.952434821920                         
                           H          -5.302113708996        1.156095586962        0.223473746127                         
                           H           3.278594509806        2.596762656843        0.399147629118                         
                           H           3.657824474030        2.457385896016       -1.308818819672                         
                           H          -4.087273901127       -1.977207925165        0.916416235667                         
                           H           4.002114599241       -2.584672649985        0.293398315288                         
                           H          -5.695005406483       -0.585384959153       -1.313403501686                         
                           H           6.294955410769       -1.145419292801        0.501034196932                         
                                                                                                                          
                                                                                                                          
                                             Summary of Geometry Optimization                                             
                                            ==================================                                            
                                                                                                                          
                  Opt.Step       Energy (a.u.)       Energy Change (a.u.)       Displacement (RMS, Max)                   
                  -------------------------------------------------------------------------------------                   
                      0         -69.361512203479        0.000000000000         0.000e+00      0.000e+00                   
                      1         -69.371005883633       -0.009493680153         9.371e-02      1.764e-01                   
                      2         -69.372245872446       -0.001239988813         3.111e-02      6.262e-02                   
                      3         -69.372642796341       -0.000396923895         2.277e-02      5.494e-02                   
                      4         -69.372862581760       -0.000219785419         1.642e-02      3.635e-02                   
                      5         -69.372957754801       -0.000095173041         1.237e-02      2.656e-02                   
                      6         -69.373032129672       -0.000074374871         1.314e-02      3.166e-02                   
                      7         -69.373067968527       -0.000035838854         1.261e-02      3.285e-02                   
                      8         -69.373075384965       -0.000007416438         3.850e-03      1.127e-02                   
                      9         -69.373080435105       -0.000005050141         2.618e-03      6.103e-03                   
                     10         -69.373083036530       -0.000002601425         3.036e-03      7.661e-03                   
                     11         -69.373083940347       -0.000000903817         1.273e-03      2.686e-03                   
                     12         -69.373084789081       -0.000000848734         1.658e-03      4.487e-03                   
                     13         -69.373085259683       -0.000000470602         9.193e-04      3.155e-03                   
                     14         -69.373085741656       -0.000000481973         1.153e-03      3.977e-03                   
                     15         -69.373086128723       -0.000000387067         1.139e-03      4.015e-03                   
                     16         -69.373086400847       -0.000000272125         9.826e-04      3.297e-03                   
                     17         -69.373086606303       -0.000000205455         8.375e-04      2.820e-03                   
                     18         -69.373086735312       -0.000000129009         6.423e-04      1.851e-03                   
                     19         -69.373086791229       -0.000000055917         3.349e-04      7.964e-04                   
                                                                                                                          
                                                                                                                          
                                              Statistical Deviation between                                               
                                         Optimized Geometry and Initial Geometry                                          
                                        =========================================                                         
                                                                                                                          
                               Internal Coord.        RMS deviation         Max. deviation                                
                               -----------------------------------------------------------                                
                                  Bonds               0.011 Angstrom        0.036 Angstrom                                
                                  Angles              1.350 degree          3.923 degree                                  
                                  Dihedrals           3.195 degree         13.585 degree                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                     *** Time spent in Optimization Driver: 6.05 sec                                      
                                                                                                                          
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="run-the-xtb-structure-optimization-for-kahweol">
<h3>Run the XTB structure optimization for kahweol:<a class="headerlink" href="#run-the-xtb-structure-optimization-for-kahweol" title="Permalink to this headline">#</a></h3>
<div class="cell tag_output_scroll tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtbdrv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">XtbDriver</span><span class="p">()</span>
<span class="n">xtbdrv</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="s1">&#39;gfn2&#39;</span><span class="p">)</span>
<span class="n">xtbdrv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">kahweol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          ...................................................
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          :                      SETUP                      :
          :.................................................:
          :  # basis functions                 118          :
          :  # atomic orbitals                 118          :
          :  # shells                           72          :
          :  # electrons                       124          :
          :  max. iterations                   280          :
          :  Hamiltonian                  GFN2-xTB          :
          :  restarted?                       true          :
          :  GBSA solvation                  false          :
          :  PC potential                    false          :
          :  electronic temp.          300.0000000     K    :
          :  accuracy                    1.0000000          :
          :  -&gt; integral cutoff          0.2500000E+02      :
          :  -&gt; integral neglect         0.1000000E-07      :
          :  -&gt; SCF convergence          0.1000000E-05 Eh   :
        
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  :  -&gt; wf. convergence          0.1000000E-03 e    :
          :  Broyden damping             0.4000000          :
          ...................................................

 iter      E             dE          RMSdq      gap      omega  full diag
   1    -69.0945256 -0.690945E+02  0.335E+00    3.05       0.0  T
   2    -69.1552391 -0.607135E-01  0.197E+00    3.02       1.0  T
   3    -69.1496721  0.556704E-02  0.776E-01    3.01       1.0  T
   4    -69.1587260 -0.905395E-02  0.308E-01    2.99       1.0  T
   5    -69.1617692 -0.304311E-02  0.807E-02    3.00       1.0  T
   6    -69.1618210 -0.518211E-04  0.439E-02    3.00       1.0  T
   7    -69.1618464 -0.254646E-04  0.237E-02    3.00       1.0  T
   8    -69.1618577 -0.112592E-04  0.101E-02    3.00       1.4  T
   9    -69.1618597 -0.199642E-05  0.261E-03    3.00       5.5  T
  10    -69.1618598 -0.677972E-07  0.144E-03    3.00       9.9  T
  11    -69.1618598 -0.381184E-07  0.545E-04    3.00      26.2  T
  12    -69.1618598 -0.377007E-08  0.158E-04    3.00      90.1  T

   *** convergence criteria satisfied after 12 iterations ***

         #    Occupation            Energy/Eh            Energy/eV
      -------------------------------------------------------------
         1        2.0000           -0.7255326             -19.7427
       ...           ...                  ...                  ...
        56        2.0000           -0.4203811             -11.4392
        57        2.0000           -0.4084609             -11.1148
        58        2.0000           -0.4076528             -11.0928
        59        2.0000           -0.4020316             -10.9398
        60        2.0000           -0.3988397             -10.8530
        61        2.0000           -0.3963877             -10.7863
        62        2.0000           -0.3564174              -9.6986 (HOMO)
        63                         -0.2461602              -6.6984 (LUMO)
        64                         -0.1788396              -4.8665
     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   65                         -0.1267271              -3.4484
        66                         -0.0099203              -0.2699
        67                          0.0051269               0.1395
       ...                                ...                  ...
       118                          0.6709176              18.2566
      -------------------------------------------------------------
                  HL-Gap            0.1102572 Eh            3.0003 eV
             Fermi-level           -0.3012888 Eh           -8.1985 eV

 SCC (total)                   0 d,  0 h,  0 min,  0.035 sec
 SCC setup                      ...        0 min,  0.000 sec (  0.531%)
 Dispersion                     ...        0 min,  0.001 sec (  2.415%)
 classical contributions        ...        0 min,  0.000 sec (  0.818%)
 integral evaluation            ...        0 min,  0.003 sec (  8.769%)
 iterations                     ...        0 min,  0.017 sec ( 48.134%)
 molecular gradient             ...        0 min,  0.014 sec ( 38.905%)
 printout                       ...        0 min,  0.000 sec (  0.406%)

         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         ::                     SUMMARY                     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
         :: total energy             -68.310234156957 Eh    ::
         :: gradient norm              0.059015972263 Eh/a0 ::
         :: HOMO-LUMO gap              3.000251409403 eV    ::
         ::.................................................::
         :: SCC energy               -69.161859807846 Eh    ::
         :: -&gt; isotropic ES            0.064055799707 Eh    ::
         :: -&gt; anisotropic ES          0.010957972238 Eh    ::
         :: -&gt; anisotropic XC          0.020993529454 Eh    ::
         :: -&gt; dispersion             -0.057983897157 Eh    ::
         :: repulsion energy           0.850629559592 Eh    ::
         :: add. restraining           0.000000000000 Eh    ::
         :: total charge               0.000000000000 e     ::
         :::::::::::::::::::::::::::::::::::::::::::::::::::::
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_output_scroll docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtb_grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">XtbGradientDriver</span><span class="p">()</span>
<span class="n">xtb_opt_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OptimizationDriver</span><span class="p">(</span><span class="n">xtb_grad_drv</span><span class="p">)</span>
<span class="n">xtb_opt_kahweol</span> <span class="o">=</span> <span class="n">xtb_opt_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">kahweol</span><span class="p">,</span> <span class="n">xtbdrv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                Optimization Driver Setup                                                 
                                               ===========================                                                
                                                                                                                          
                                     Coordinate System       :    TRIC                                                    
                                     Constraints             :    No                                                      
                                     Max. Number of Steps    :    300                                                     
                                     Transition State        :    No                                                      
                                     Hessian                 :    never                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3102341572 a.u.                                                                                 
* Info *   Gradient : 8.430888e-03 a.u. (RMS)                                                                             
* Info *              3.152910e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3194377305 a.u.                                                                                 
* Info *   Gradient : 3.788613e-03 a.u. (RMS)                                                                             
* Info *              1.026022e-02 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3207078420 a.u.                                                                                 
* Info *   Gradient : 1.696187e-03 a.u. (RMS)                                                                             
* Info *              5.384314e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3211017988 a.u.                                                                                 
* Info *   Gradient : 8.702338e-04 a.u. (RMS)                                                                             
* Info *              2.453755e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3212623136 a.u.                                                                                 
* Info *   Gradient : 7.160991e-04 a.u. (RMS)                                                                             
* Info *              1.889567e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3213472035 a.u.                                                                                 
* Info *   Gradient : 6.526878e-04 a.u. (RMS)                                                                             
* Info *              1.484448e-03 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3214034870 a.u.                                                                                 
* Info *   Gradient : 3.020675e-04 a.u. (RMS)                                                                             
* Info *              7.637624e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3214290429 a.u.                                                                                 
* Info *   Gradient : 1.803308e-04 a.u. (RMS)                                                                             
* Info *              4.186287e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.06 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3214477989 a.u.                                                                                 
* Info *   Gradient : 2.557944e-04 a.u. (RMS)                                                                             
* Info *              6.645090e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3214677700 a.u.                                                                                 
* Info *   Gradient : 2.352957e-04 a.u. (RMS)                                                                             
* Info *              5.885042e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3214890583 a.u.                                                                                 
* Info *   Gradient : 1.667861e-04 a.u. (RMS)                                                                             
* Info *              3.682147e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3214960720 a.u.                                                                                 
* Info *   Gradient : 1.055778e-04 a.u. (RMS)                                                                             
* Info *              2.130604e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215007939 a.u.                                                                                 
* Info *   Gradient : 8.680498e-05 a.u. (RMS)                                                                             
* Info *              2.098592e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215030976 a.u.                                                                                 
* Info *   Gradient : 8.548065e-05 a.u. (RMS)                                                                             
* Info *              1.860242e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215045601 a.u.                                                                                 
* Info *   Gradient : 5.725651e-05 a.u. (RMS)                                                                             
* Info *              1.466322e-04 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215052972 a.u.                                                                                 
* Info *   Gradient : 2.969516e-05 a.u. (RMS)                                                                             
* Info *              5.772642e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215056017 a.u.                                                                                 
* Info *   Gradient : 2.610916e-05 a.u. (RMS)                                                                             
* Info *              5.841689e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215058954 a.u.                                                                                 
* Info *   Gradient : 2.939108e-05 a.u. (RMS)                                                                             
* Info *              8.178844e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215061317 a.u.                                                                                 
* Info *   Gradient : 2.819444e-05 a.u. (RMS)                                                                             
* Info *              8.585832e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215063064 a.u.                                                                                 
* Info *   Gradient : 1.915187e-05 a.u. (RMS)                                                                             
* Info *              4.266796e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Computing energy and gradient...                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info *   Energy   : -68.3215063782 a.u.                                                                                 
* Info *   Gradient : 1.020411e-05 a.u. (RMS)                                                                             
* Info *              2.548941e-05 a.u. (Max)                                                                             
* Info *   Time     : 0.05 sec                                                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Saving file: veloxchem_opt_2023-06-12T14.27.00_optim.xyz                                                         
* Info * Saving file: veloxchem_opt_2023-06-12T14.27.00.log                                                               
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Geometry optimization completed.                                                                                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                              Molecular Geometry (Angstroms)                                              
                                             ================================                                             
                                                                                                                          
                          Atom         Coordinate X          Coordinate Y          Coordinate Z                           
                                                                                                                          
                           O          -4.444246777041       -1.519500184760        0.133687531696                         
                           O          -5.717823367908        0.941920247191       -0.067035378737                         
                           O           5.074906471664        0.622193623988        0.095473632113                         
                           C          -1.218602072799       -0.830635685957       -0.247269720612                         
                           C          -0.477652350991        0.497206859079       -0.529645873242                         
                           C          -2.930032992048        0.109193794340        1.091620378561                         
                           C          -1.787380235852       -0.895060417667        1.174536822172                         
                           C          -2.515633689930       -0.856030106347       -1.095108430247                         
                           C           0.968427401326        0.594486819654        0.023105350455                         
                           C          -3.654876617179       -0.372392602218       -0.180458472359                         
                           C          -0.338761173834       -2.036945429660       -0.583487647170                         
                           C          -1.380922979880        1.698249048613       -0.180015868996                         
                           C          -2.322218578481        1.506829862993        1.012213415312                         
                           C           1.723651132776       -0.686675316567       -0.399653676283                         
                           C           1.033746130303       -1.956638037484        0.075497470977                         
                           C           1.068775515460        0.833466747697        1.537760243536                         
                           C          -4.585076305760        0.655631548432       -0.853891425080                         
                           C           1.691792477249        1.770178546276       -0.620456373727                         
                           C           3.162384674665       -0.539524931275       -0.024308835986                         
                           C           3.026453417345        1.832993169416       -0.661213458299                         
                           C           3.761356117396        0.686850100864       -0.200988462347                         
                           C           4.186105772490       -1.411077541156        0.402955911206                         
                           C           5.318402057353       -0.648904554007        0.464791088959                         
                           H          -0.335044283024        0.523188240595       -1.619121935637                         
                           H          -3.599210157051        0.065664226708        1.957648973711                         
                           H          -1.080844988373       -0.645952746940        1.956895670602                         
                           H          -2.177196951506       -1.898085777230        1.358665298028                         
                           H          -2.433748208795       -0.246586339554       -1.993187408162                         
                           H          -2.750555988910       -1.876641394325       -1.397583155030                         
                           H          -0.202960809259       -2.084227408498       -1.667524196228                         
                           H          -0.851689802471       -2.949995114334       -0.273727664073                         
                           H          -1.983529167451        1.923955505205       -1.061256403684                         
                           H          -0.768118578497        2.580194152344        0.010452737792                         
                           H          -1.779681306265        1.670316886081        1.945888113628                         
                           H          -3.112544172753        2.258627623935        0.965687394824                         
                           H           1.702617585292       -0.706788044839       -1.502641974234                         
                           H           0.941020366065       -1.968972909219        1.160844552883                         
                           H           1.629998855522       -2.823282549407       -0.216933715679                         
                           H           2.103646971685        1.037195455404        1.803383367123                         
                           H           0.473056818750        1.693597069299        1.827356187713                         
                           H           0.749260115453       -0.028531398806        2.112178950134                         
                           H          -4.890278846740        0.251727445199       -1.829217855767                         
                           H          -4.081465688583        1.606980030046       -1.012092786442                         
                           H           1.101025022226        2.598128915550       -0.978016602208                         
                           H          -4.939041486336       -1.335806703585        0.940565644080                         
                           H           3.560854657454        2.688860507163       -1.042623805224                         
                           H           4.105797619339       -2.451938367526        0.640845591965                         
                           H          -6.244852481130        0.135937465409       -0.009556359706                         
                           H           6.323310879036       -0.889980330118        0.749463157685                         
                                                                                                                          
                                                                                                                          
                                             Summary of Geometry Optimization                                             
                                            ==================================                                            
                                                                                                                          
                  Opt.Step       Energy (a.u.)       Energy Change (a.u.)       Displacement (RMS, Max)                   
                  -------------------------------------------------------------------------------------                   
                      0         -68.310234157198        0.000000000000         0.000e+00      0.000e+00                   
                      1         -68.319437730465       -0.009203573267         9.448e-02      2.163e-01                   
                      2         -68.320707842027       -0.001270111562         3.422e-02      7.342e-02                   
                      3         -68.321101798832       -0.000393956806         3.393e-02      7.123e-02                   
                      4         -68.321262313555       -0.000160514722         1.908e-02      4.657e-02                   
                      5         -68.321347203517       -0.000084889962         2.115e-02      5.549e-02                   
                      6         -68.321403486976       -0.000056283459         6.872e-03      1.656e-02                   
                      7         -68.321429042901       -0.000025555925         7.176e-03      2.097e-02                   
                      8         -68.321447798926       -0.000018756025         7.326e-03      2.508e-02                   
                      9         -68.321467769997       -0.000019971071         7.674e-03      3.013e-02                   
                     10         -68.321489058336       -0.000021288339         1.244e-02      5.091e-02                   
                     11         -68.321496071988       -0.000007013652         5.918e-03      2.461e-02                   
                     12         -68.321500793911       -0.000004721923         5.777e-03      2.325e-02                   
                     13         -68.321503097569       -0.000002303658         2.600e-03      9.960e-03                   
                     14         -68.321504560138       -0.000001462569         1.516e-03      4.717e-03                   
                     15         -68.321505297248       -0.000000737109         1.157e-03      3.325e-03                   
                     16         -68.321505601721       -0.000000304473         8.243e-04      3.052e-03                   
                     17         -68.321505895430       -0.000000293709         1.093e-03      4.356e-03                   
                     18         -68.321506131708       -0.000000236278         9.455e-04      3.618e-03                   
                     19         -68.321506306422       -0.000000174714         7.641e-04      2.729e-03                   
                     20         -68.321506378185       -0.000000071764         3.670e-04      1.459e-03                   
                                                                                                                          
                                                                                                                          
                                              Statistical Deviation between                                               
                                         Optimized Geometry and Initial Geometry                                          
                                        =========================================                                         
                                                                                                                          
                               Internal Coord.        RMS deviation         Max. deviation                                
                               -----------------------------------------------------------                                
                                  Bonds               0.012 Angstrom        0.033 Angstrom                                
                                  Angles              1.359 degree          3.480 degree                                  
                                  Dihedrals           3.908 degree         13.107 degree                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                     *** Time spent in Optimization Driver: 6.15 sec                                      
                                                                                                                          
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="compare-initial-and-final-geometries">
<h3>Compare initial and final geometries<a class="headerlink" href="#compare-initial-and-final-geometries" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xyz_xtb_opt_cafestol</span> <span class="o">=</span> <span class="n">xtb_opt_cafestol</span><span class="o">.</span><span class="n">get_xyz_string</span><span class="p">()</span>
<span class="n">xyz_xtb_opt_kahweol</span> <span class="o">=</span> <span class="n">xtb_opt_kahweol</span><span class="o">.</span><span class="n">get_xyz_string</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> (a) Cafestol, initial vs. XTB opt. geom.         (b) Kahweol, initial vs. XTB opt. geom.:&#39;</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">viewergrid</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">linked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">cafestol_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">xyz_xtb_opt_cafestol</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">kahweol_xyz</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">xyz_xtb_opt_kahweol</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setViewStyle</span><span class="p">({</span><span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;outline&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.25</span><span class="p">}})</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> (a) Cafestol, initial vs. XTB opt. geom.         (b) Kahweol, initial vs. XTB opt. geom.:
</pre></div>
</div>
<div class="output text_html"><div id="3dmolviewer_1686572826384063"  style="position: relative; width: 700px; height: 250px">
        <p id="3dmolwarning_1686572826384063" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_1686572826384063 = null;
var warn = document.getElementById("3dmolwarning_1686572826384063");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_1686572826384063 = null;
viewergrid_1686572826384063 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_1686572826384063"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_1686572826384063 = viewergrid_1686572826384063[0][0];
viewergrid_1686572826384063[0][0].zoomTo();viewergrid_1686572826384063[0][1].zoomTo();	viewergrid_1686572826384063[0][0].addModel("51\ncafestol initial structure\nO  -4.5215   -1.3455    0.4926\nO  -5.2905    0.0812   -1.7033\nO   5.1630    0.4345   -0.1101\nC  -1.2807   -0.7511   -0.0465\nC  -0.5244    0.5810   -0.4102\nC   0.9909    0.6610    0.0407\nC  -2.9440    0.2916    1.2866\nC  -1.8143   -0.7311    1.3945\nC  -2.6188   -0.8159   -0.8642\nC  -3.7116   -0.2387    0.0606\nC  -0.4332   -2.0024   -0.3283\nC  -1.3742    1.8303   -0.0654\nC   1.6844   -0.6873   -0.4019\nC  -2.3206    1.6833    1.1309\nC   0.9997   -1.9155    0.1913\nC   1.7285    1.8344   -0.7277\nC   1.1437    0.9261    1.5588\nC   3.1644   -0.6155   -0.2085\nC  -4.6490    0.7442   -0.6282\nC   3.2525    1.9378   -0.4590\nC   3.8298    0.5879   -0.2856\nC   4.1654   -1.5888    0.0140\nC   5.3604   -0.9015    0.0689\nH  -0.4604    0.5817   -1.5108\nH  -3.5646    0.2626    2.1897\nH  -1.0861   -0.4449    2.1498\nH  -2.1902   -1.7145    1.7003\nH  -2.5286   -0.2495   -1.7981\nH  -2.8534   -1.8505   -1.1460\nH  -0.3943   -2.1694   -1.4136\nH  -0.9135   -2.8938    0.0946\nH  -1.9810    2.0650   -0.9487\nH  -0.7587    2.7222    0.0818\nH   1.5605   -0.7646   -1.4951\nH  -1.7642    1.9154    2.0477\nH  -3.1082    2.4431    1.0635\nH   1.0176   -1.9046    1.2859\nH   1.5276   -2.8282   -0.1118\nH   1.2808    2.8061   -0.4944\nH   1.5851    1.6842   -1.8068\nH   0.5898    1.8173    1.8670\nH   0.8147    0.0892    2.1727\nH   2.1832    1.0992    1.8532\nH  -4.1337    1.6158   -1.0351\nH  -5.4265    1.0934    0.0595\nH   3.4273    2.5264    0.4487\nH   3.7385    2.4646   -1.2871\nH  -3.9519   -2.0832    0.7635\nH   4.0442   -2.6573    0.1180\nH  -5.7603   -0.6874   -1.3370\nH   6.3869   -1.2031    0.2186\n","xyz");
	viewergrid_1686572826384063[0][0].addModel("51\n\nO             -4.586927894297        -1.279900580081         0.480283797793\nO             -5.319303242952         0.246562207320        -1.629047843300\nO              5.096372964454         0.479142524541         0.047370527290\nC             -1.255190295744        -0.766697135858        -0.090694519716\nC             -0.509228219094         0.539152695692        -0.458496889438\nC              0.978372037194         0.632243366820        -0.011990155161\nC             -2.880159755562         0.238836828861         1.312497729308\nC             -1.740436945819        -0.771913903412         1.364288546093\nC             -2.598892938446        -0.799816206160        -0.863851939900\nC             -3.682490893188        -0.248170686858         0.088636802757\nC             -0.416164506854        -1.999830242086        -0.434968241726\nC             -1.378410399217         1.760376004456        -0.090411193298\nC              1.674856502875        -0.681263507644        -0.445474818245\nC             -2.250016721329         1.621564634949         1.161318676793\nC              0.997770067356        -1.919050968336         0.128039543449\nC              1.666376726005         1.766537760643        -0.811768240558\nC              1.168837532826         0.910140988103         1.479849080800\nC              3.135520466851        -0.569549508958        -0.157646718636\nC             -4.609457056369         0.795536374054        -0.551570433613\nC              3.155683415864         1.954159444441        -0.478173900174\nC              3.782186986193         0.630199905389        -0.219299021035\nC              4.130802164950        -1.530150373797         0.161772362564\nC              5.294632956634        -0.835297374348         0.274041555784\nH             -0.446342259653         0.529017873163        -1.555044787035\nH             -3.512301962729         0.221149517725         2.205105205326\nH             -0.987805192361        -0.489646713079         2.090189238482\nH             -2.099466069880        -1.770583425745         1.629844780980\nH             -2.561113930095        -0.227435609543        -1.788326352210\nH             -2.854655290972        -1.827144938935        -1.131680096908\nH             -0.352920373720        -2.090381541625        -1.522829914942\nH             -0.917392216442        -2.895613171681        -0.058907062896\nH             -2.030547320612         1.964782326180        -0.939715067955\nH             -0.751054032804         2.643276309973         0.031133878813\nH              1.568213879475        -0.751868233951        -1.538315305172\nH             -1.648526534108         1.799632361004         2.055430463497\nH             -3.024936836985         2.390210621298         1.135414632642\nH              0.980001478774        -1.887152726443         1.216951591943\nH              1.555474968493        -2.809090968393        -0.168723212483\nH              1.159647477215         2.715758648017        -0.638991630812\nH              1.574182496031         1.537824463169        -1.875605731830\nH              0.649837420195         1.820869381957         1.764759763362\nH              0.808399132338         0.095444063030         2.096526843634\nH              2.222626553193         1.033900090352         1.709265075873\nH             -4.054650314922         1.641880113076        -0.952434821920\nH             -5.302113708996         1.156095586962         0.223473746127\nH              3.278594509806         2.596762656843         0.399147629118\nH              3.657824474030         2.457385896016        -1.308818819672\nH             -4.087273901127        -1.977207925165         0.916416235667\nH              4.002114599241        -2.584672649985         0.293398315288\nH             -5.695005406483        -0.585384959153        -1.313403501686\nH              6.294955410769        -1.145419292801         0.501034196932\n","xyz");
	viewergrid_1686572826384063[0][1].addModel("49\nkahweol initial structure\nO  -4.4710   -1.5361    0.0905\nO  -5.6188    0.9753   -0.0811\nO   5.1625    0.5695   -0.0997\nC  -1.2209   -0.8317   -0.2017\nC  -0.4821    0.5357   -0.4703\nC  -3.0038    0.1167    1.0462\nC  -1.8514   -0.8737    1.1997\nC  -2.4967   -0.9058   -1.1119\nC   0.9884    0.6333    0.0944\nC  -3.6676   -0.3924   -0.2474\nC  -0.3220   -2.0551   -0.4569\nC  -1.3919    1.7479   -0.1363\nC  -2.4167    1.5304    0.9816\nC   1.7435   -0.6786   -0.3542\nC   1.0741   -1.9483    0.1552\nC   1.0367    0.8330    1.6293\nC  -4.5845    0.5870   -0.9677\nC   1.7610    1.8511   -0.4907\nC   3.2146   -0.5444   -0.1101\nC   3.1013    1.8722   -0.6493\nC   3.8167    0.6946   -0.3059\nC   4.2309   -1.4546    0.2464\nC   5.3980   -0.7259    0.2399\nH  -0.3415    0.5842   -1.5631\nH  -3.6779    0.0397    1.9072\nH  -1.1861   -0.6021    2.0159\nH  -2.2356   -1.8757    1.4322\nH  -2.3648   -0.3090   -2.0216\nH  -2.6844   -1.9384   -1.4328\nH  -0.2098   -2.1924   -1.5413\nH  -0.8043   -2.9694   -0.0890\nH  -1.9406    2.0033   -1.0514\nH  -0.8134    2.6482    0.0921\nH  -1.9341    1.7452    1.9434\nH  -3.2193    2.2709    0.8849\nH   1.6699   -0.7251   -1.4553\nH   1.0259   -1.9792    1.2481\nH   1.6508   -2.8307   -0.1490\nH   2.0514    1.0518    1.9842\nH   0.4166    1.6762    1.9486\nH   0.7233   -0.0489    2.1864\nH  -5.0524    0.1195   -1.8415\nH  -4.0679    1.4861   -1.3088\nH   1.2088    2.7568   -0.7218\nH  -5.0925   -1.2746    0.7905\nH   3.6240    2.7536   -0.9997\nH   4.1386   -2.5085    0.4650\nH  -6.2132    0.2149    0.0339\nH   6.4308   -0.9731    0.4374\n","xyz");
	viewergrid_1686572826384063[0][1].addModel("49\n\nO             -4.444246777041        -1.519500184760         0.133687531696\nO             -5.717823367908         0.941920247191        -0.067035378737\nO              5.074906471664         0.622193623988         0.095473632113\nC             -1.218602072799        -0.830635685957        -0.247269720612\nC             -0.477652350991         0.497206859079        -0.529645873242\nC             -2.930032992048         0.109193794340         1.091620378561\nC             -1.787380235852        -0.895060417667         1.174536822172\nC             -2.515633689930        -0.856030106347        -1.095108430247\nC              0.968427401326         0.594486819654         0.023105350455\nC             -3.654876617179        -0.372392602218        -0.180458472359\nC             -0.338761173834        -2.036945429660        -0.583487647170\nC             -1.380922979880         1.698249048613        -0.180015868996\nC             -2.322218578481         1.506829862993         1.012213415312\nC              1.723651132776        -0.686675316567        -0.399653676283\nC              1.033746130303        -1.956638037484         0.075497470977\nC              1.068775515460         0.833466747697         1.537760243536\nC             -4.585076305760         0.655631548432        -0.853891425080\nC              1.691792477249         1.770178546276        -0.620456373727\nC              3.162384674665        -0.539524931275        -0.024308835986\nC              3.026453417345         1.832993169416        -0.661213458299\nC              3.761356117396         0.686850100864        -0.200988462347\nC              4.186105772490        -1.411077541156         0.402955911206\nC              5.318402057353        -0.648904554007         0.464791088959\nH             -0.335044283024         0.523188240595        -1.619121935637\nH             -3.599210157051         0.065664226708         1.957648973711\nH             -1.080844988373        -0.645952746940         1.956895670602\nH             -2.177196951506        -1.898085777230         1.358665298028\nH             -2.433748208795        -0.246586339554        -1.993187408162\nH             -2.750555988910        -1.876641394325        -1.397583155030\nH             -0.202960809259        -2.084227408498        -1.667524196228\nH             -0.851689802471        -2.949995114334        -0.273727664073\nH             -1.983529167451         1.923955505205        -1.061256403684\nH             -0.768118578497         2.580194152344         0.010452737792\nH             -1.779681306265         1.670316886081         1.945888113628\nH             -3.112544172753         2.258627623935         0.965687394824\nH              1.702617585292        -0.706788044839        -1.502641974234\nH              0.941020366065        -1.968972909219         1.160844552883\nH              1.629998855522        -2.823282549407        -0.216933715679\nH              2.103646971685         1.037195455404         1.803383367123\nH              0.473056818750         1.693597069299         1.827356187713\nH              0.749260115453        -0.028531398806         2.112178950134\nH             -4.890278846740         0.251727445199        -1.829217855767\nH             -4.081465688583         1.606980030046        -1.012092786442\nH              1.101025022226         2.598128915550        -0.978016602208\nH             -4.939041486336        -1.335806703585         0.940565644080\nH              3.560854657454         2.688860507163        -1.042623805224\nH              4.105797619339        -2.451938367526         0.640845591965\nH             -6.244852481130         0.135937465409        -0.009556359706\nH              6.323310879036        -0.889980330118         0.749463157685\n","xyz");
	viewergrid_1686572826384063[0][0].setViewStyle({"style": "outline", "width": 0.05});
	viewergrid_1686572826384063[0][1].setViewStyle({"style": "outline", "width": 0.05});
	viewergrid_1686572826384063[0][0].setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewergrid_1686572826384063[0][1].setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewergrid_1686572826384063[0][0].zoomTo();
	viewergrid_1686572826384063[0][1].zoomTo();
viewergrid_1686572826384063[0][1].render();
viewergrid_1686572826384063[0][0].render();
});
</script></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/mol_struct"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="opt_struct.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Optimization methods</p>
      </div>
    </a>
    <a class="right-next"
       href="tst.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Transition-state theory</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scf-geometry-optimization">SCF geometry optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-coordinate-scan">Internal coordinate scan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constrained-optimization">Constrained optimization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xtb-geometry-optimization">XTB geometry optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-xtb-gradient-and-optimization-drivers-and-run-the-geometry-optimization">Set up the xtb gradient and optimization drivers and run the geometry optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-xtb-structure-optimization-for-kahweol">Run the XTB structure optimization for kahweol:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-initial-and-final-geometries">Compare initial and final geometries</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The eChem team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>