

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Special aspects &#8212; Computational Chemistry from  Laptop to HPC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-TX4YJ1J5XE"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/tutorials/xray_aspects';</script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Larger systems" href="xray_large.html" />
    <link rel="prev" title="Spectrum analysis" href="xray_analysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../title.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics_notebook.html">Using Jupyter notebooks</a></li>







<li class="toctree-l2"><a class="reference internal" href="../units_notation.html">Units and notation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronic ground states</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/elstruct_gen.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/orbitals.html">Orbitals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/slater.html">Many-electron wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/operators.html">Operators and matrix elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/reduced_density.html">Reduced particle densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/natural_orbitals.html">Natural orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/spin.html">Electron spin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/correlation.html">Electron correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dispersion.html">Dispersion interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/pt.html">Rayleigh–Schrödinger perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/second_quant.html">Second quantization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/group_theory.html">Group theory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/wft.html">Wave function theory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../elec_struct/hartree-fock.html">Hartree–Fock</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_theory.html">Hartree–Fock theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_scf.html">SCF optimization</a></li>

<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_example.html">HF in VeloxChem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/ci.html">Configuration interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mp2.html">Møller–Plesset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcscf.html">Multiconfigurational methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/wft_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/dft.html">Density functional theory</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/hohenberg.html">Hohenberg–Kohn theorems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kohn-sham.html">Kohn–Sham method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kernel_int.html">Kernel integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_scf.html">SCF optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_prop.html">First-order properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/available_xcfun.html">Available XC functionals</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular structure and dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/molstruct_gen.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/coordinates.html">Choice of coordinates</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/gradients.html">Gradients</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/energy_grad.html">Energy gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/property_grad.html">Property gradients</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/hessians_vib.html">Hessians and vibrations</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/hessians.html">Molecular Hessians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/vibrations.html">Vibrational analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/opt.html">Structure optimization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_struct.html">Optimization methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_gs.html">Ground-state structure optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/tst.html">Transition-state theory</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/tst_gen.html">Transition state geometry optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/impes.html">PES interpolation techniques</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/impes_calc.html">Constructing the PES by interpolation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/md.html">Molecular dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/forcefields.html">Force fields</a></li>


<li class="toctree-l2"><a class="reference internal" href="../mol_struct/reparameterize.html">Reparameterize force fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/md_setup.html">Ensembles and time integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/md_run.html">Running a simulation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spectra and properties</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/spectra_aspects.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/vibrot.html">Rovibronic states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/response.html">Responses to external fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/selection_rules.html">Selection rules</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/tddft.html">TDDFT</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_basics.html">Foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_rpa.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/mr_response.html">Multireference response</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/ci_response.html">CI response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/sa_mcscf.html">State-averaged MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/mclr.html">Multiconfigurational linear response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/mr_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/adc.html">ADC</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_pp.html">Polarization propagator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_isr.html">Intermediate state representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_cvs.html">Core-valence separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_hpc.html">HPC-QC implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/excoupl.html">Exciton coupling model</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/excoupl_impl.html">Implementation of the exciton coupling model</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/localprop.html">Localized properties</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/esp.html">ESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/resp.html">RESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/loprop.html">LoProp charges and polarisabilities</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/embedding.html">Embedding potentials</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/nonpol_emb.html">Non-polarizable embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/pol_emb.html">Polarizable embedding</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/mol_struct.html">Molecular structure and dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/struct_vis.html">Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/md_vis.html">MD trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/opt_vib_vis.html">Optimization and normal modes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/elec_struct.html">Electronic structure</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/orb_vis.html">Orbitals and densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/exc_vis.html">Excited states</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/spec_prop.html">Spectra and properties</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/broadening.html">Spectrum broadening</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials and workflows</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="workflow.html">Constructing workflows</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="wf_build.html">Building the system</a></li>

<li class="toctree-l2"><a class="reference internal" href="wf_struct.html">Optimizing molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_scf.html">Optimizing electronic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_construct.html">Assembling a full workflow</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="uv_vis.html">UV/vis spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_absorption.html">Absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_fluorescence.html">Fluorescence</a></li>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="vib_ir.html">Vibrational spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="vib_ir_calc.html">IR spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="vib_ir_raman.html">Raman spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="vib_ir_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="openshells.html">Open shells</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="rest_unrest.html">Restricted versus unrestricted</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlation.html">Static versus dynamic correlation correlation</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="xray.html">X-ray spectroscopies</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="xray_calc.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_analysis.html">Spectrum analysis</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Special aspects</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_large.html">Larger systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_nonstandard.html">Non-standard calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_cheatsheet.html">Cheat sheet</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite and contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kthpanor/echem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/tutorials/xray_aspects.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/tutorials/xray_aspects.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Special aspects</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation">Relaxation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation-of-core-ionized-systems">Relaxation of core-ionized systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation-of-core-de-excitation">Relaxation of core-(de)excitation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#including-relaxation-with-deltascf-methods">Including relaxation with <span class="math notranslate nohighlight">\(\Delta\)</span>SCF methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#including-relaxation-with-wave-function-methods">Including relaxation with wave-function methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#including-relaxation-with-dft-based-methods">Including relaxation with DFT-based methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relativity">Relativity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-relativistic-effects">Scalar relativistic effects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-orbit-coupling">Spin-orbit coupling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basis-set-considerations">Basis set considerations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-interaction-error-in-dft">Self-interaction error in DFT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-hole-localization">Core-hole localization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tailored-cvs">Tailored CVS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-hf-on-a-non-aufbau-reference">Post-HF on a non-Aufbau reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spurious-valence-mixing-in-xas">Spurious valence mixing in XAS</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="special-aspects">
<h1>Special aspects<a class="headerlink" href="#special-aspects" title="Permalink to this headline">#</a></h1>
<p>In this section we will discuss a number of issues and questions relating to core spectroscopies, ranging from the physical effect of a core-transition, to technical aspects relating to lowering computational costs. They are ordered by approximate relevance, with some topics being pertient only for certain cases.</p>
<section id="relaxation">
<span id="sec-xray-topics-relax"></span><h2>Relaxation<a class="headerlink" href="#relaxation" title="Permalink to this headline">#</a></h2>
<p>Core spectroscopies exhibit strong relaxation effects, originating in the significant change in shielding of the nuclear charge arising from the creation/annihilation of a core-hole. These effects need to be properly accounted for in order to get good absolute energies, as  the lack of this will mean that, <em>e.g.</em> an unrelaxed core-hole system is too high in energy. This explains the previously <a class="reference internal" href="xray_calc.html#sec-xray-calc-iekoop"><span class="std std-ref">observed</span></a> large error obtained using Koopmans’ theorem.</p>
<section id="relaxation-of-core-ionized-systems">
<h3>Relaxation of core-ionized systems<a class="headerlink" href="#relaxation-of-core-ionized-systems" title="Permalink to this headline">#</a></h3>
<p>Below we see the effects of relaxation for creating a core-hole in the oxygen/carbon 1s of formaldehyde, illustrated by plotting the total electron density:</p>
<figure class="align-default" id="relax-form">
<img alt="../../_images/relax_form.png" src="../../_images/relax_form.png" />
</figure>
<p>We see that there is a noticable attraction of electron density toward the core-holes, as marked with a <strong>+</strong>. These effects can be modeled with the <span class="math notranslate nohighlight">\(Z+1\)</span> approximation, within which the change in screening is modeled by substituting the ionized atom with the next element in the periodic table. This can be illustrated with the following radial distribution plots (using cc-pcvdz basis sets, in order to increase flexibility in the core region):</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">adcc</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>

<span class="n">au2ev</span> <span class="o">=</span> <span class="mf">27.211386</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lorentzian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xstep</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lorentzian broadening function</span>

<span class="sd">    Call: xi,yi = lorentzian(energies, intensities, start energy,</span>
<span class="sd">                                    end energy, energy step, gamma)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xstep</span><span class="p">)</span>
    <span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">yi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">yi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">/</span> <span class="p">((</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;3</span>

<span class="s2">O       0.0000000000     0.0000000000     0.1178336003</span>
<span class="s2">H      -0.7595754146    -0.0000000000    -0.4713344012</span>
<span class="s2">H       0.7595754146     0.0000000000    -0.4713344012</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">water_fluorine_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;3</span>

<span class="s2">F       0.0000000000     0.0000000000     0.1178336003</span>
<span class="s2">H      -0.7595754146    -0.0000000000    -0.4713344012</span>
<span class="s2">H       0.7595754146     0.0000000000    -0.4713344012</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_1684148971486937"  style="position: relative; width: 500px; height: 200px">
        <p id="3dmolwarning_1684148971486937" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.1/3Dmol-min.js');
}

var viewer_1684148971486937 = null;
var warn = document.getElementById("3dmolwarning_1684148971486937");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_1684148971486937 = null;
viewergrid_1684148971486937 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_1684148971486937"),{rows: 1, cols: 2, control_all: true},{backgroundColor:"white"});
viewer_1684148971486937 = viewergrid_1684148971486937[0][0];
viewergrid_1684148971486937[0][0].zoomTo();viewergrid_1684148971486937[0][1].zoomTo();	viewergrid_1684148971486937[0][0].addModel("3\n\nO       0.0000000000     0.0000000000     0.1178336003\nH      -0.7595754146    -0.0000000000    -0.4713344012\nH       0.7595754146     0.0000000000    -0.4713344012\n","xyz");
	viewergrid_1684148971486937[0][1].addModel("3\n\nF       0.0000000000     0.0000000000     0.1178336003\nH      -0.7595754146    -0.0000000000    -0.4713344012\nH       0.7595754146     0.0000000000    -0.4713344012\n","xyz");
	viewergrid_1684148971486937[0][0].setViewStyle({"style": "outline", "width": 0.05});
	viewergrid_1684148971486937[0][1].setViewStyle({"style": "outline", "width": 0.05});
	viewergrid_1684148971486937[0][0].setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewergrid_1684148971486937[0][1].setStyle({"stick": {}, "sphere": {"scale": 0.25}});
	viewergrid_1684148971486937[0][0].rotate(-90,"x");
	viewergrid_1684148971486937[0][1].rotate(-90,"x");
viewergrid_1684148971486937[0][1].render();
viewergrid_1684148971486937[0][0].render();
});
</script></div></div>
</div>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">water_xyz</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="s2">&quot;CC-PCVDZ&quot;</span><span class="p">)</span>

<span class="c1"># Perform SCF calculation</span>
<span class="n">scf_gs</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">gs_results</span> <span class="o">=</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>

<span class="n">molecule</span><span class="o">.</span><span class="n">set_charge</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">molecule</span><span class="o">.</span><span class="n">set_multiplicity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">scf_ion</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfUnrestrictedDriver</span><span class="p">()</span>

<span class="c1">#Create list of occupied orbitals</span>
<span class="n">occa</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">occb</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">scf_ion</span><span class="o">.</span><span class="n">maximum_overlap</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="n">occa</span><span class="p">,</span> <span class="n">occb</span><span class="p">)</span>
<span class="n">ion_results</span> <span class="o">=</span> <span class="n">scf_ion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>

<span class="n">molecule_F</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_xyz_string</span><span class="p">(</span><span class="n">water_fluorine_xyz</span><span class="p">)</span>
<span class="n">molecule_F</span><span class="o">.</span><span class="n">set_charge</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">basis_F</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule_F</span><span class="p">,</span> <span class="s2">&quot;CC-PCVDZ&quot;</span><span class="p">)</span>

<span class="n">scf_F</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">F_results</span> <span class="o">=</span> <span class="n">scf_F</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule_F</span><span class="p">,</span> <span class="n">basis_F</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_rho</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">):</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">rho3</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
        <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">rho1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mo1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">rho2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mo2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">rho3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mo3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">rho3</span>

<span class="n">vis_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">VisualizationDriver</span><span class="p">()</span>

<span class="n">Ay</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># oxygen y-position (in au)</span>
<span class="n">Az</span> <span class="o">=</span> <span class="mf">0.1178336003</span> <span class="o">/</span> <span class="mf">0.529177249</span>  <span class="c1"># oxygen z-position (in au)</span>

<span class="c1"># Create coordinate object along x-axis (intersecting with O/F atom)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># radial points along the x-axis</span>
<span class="n">coords</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Az</span>

<span class="n">mo1_gs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">))</span>
<span class="n">mo1_ion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_ion</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">))</span>
<span class="n">mo1_Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule_F</span><span class="p">,</span> <span class="n">basis_F</span><span class="p">,</span> <span class="n">scf_F</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;MO$_{\alpha 1}$ ($1a_1$)&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">rho3</span> <span class="o">=</span> <span class="n">get_rho</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">mo1_gs</span><span class="p">,</span> <span class="n">mo1_ion</span><span class="p">,</span> <span class="n">mo1_Z1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s2">&quot;Ground-state&quot;</span><span class="p">,</span> <span class="s2">&quot;Core-hole&quot;</span><span class="p">,</span> <span class="s2">&quot;Ground-state [Z+1]&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [a.u.]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Density [$r^2 \rho$]&quot;</span><span class="p">)</span>

<span class="n">mo2_gs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">))</span>
<span class="n">mo2_ion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_ion</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">))</span>
<span class="n">mo2_Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule_F</span><span class="p">,</span> <span class="n">basis_F</span><span class="p">,</span> <span class="n">scf_F</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;MO$_{\alpha 2}$ ($2a_1$)&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">rho3</span> <span class="o">=</span> <span class="n">get_rho</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">mo2_gs</span><span class="p">,</span> <span class="n">mo2_ion</span><span class="p">,</span> <span class="n">mo2_Z1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [a.u.]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Density [$r^2 \rho$]&quot;</span><span class="p">)</span>

<span class="n">mo2b_gs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">))</span>
<span class="n">mo2b_ion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_ion</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">))</span>
<span class="n">mo2b_Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vis_drv</span><span class="o">.</span><span class="n">get_mo</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">molecule_F</span><span class="p">,</span> <span class="n">basis_F</span><span class="p">,</span> <span class="n">scf_F</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;MO$_{\beta 2}$ ($2a_1$)&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">rho3</span> <span class="o">=</span> <span class="n">get_rho</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">mo2b_gs</span><span class="p">,</span> <span class="n">mo2b_ion</span><span class="p">,</span> <span class="n">mo2b_Z1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rho3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [a.u.]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Density [$r^2 \rho$]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f913a72eeb79de07af8121b8daf15395e6144d0d1800609005e33cbea4ffd678.png" src="../../_images/f913a72eeb79de07af8121b8daf15395e6144d0d1800609005e33cbea4ffd678.png" />
</div>
</div>
<p>As can be seen, the radial distribution of particularly <span class="math notranslate nohighlight">\(\alpha_2\)</span> for the core-ionized system is closer to <span class="math notranslate nohighlight">\(Z+1\)</span> than to the neutral state, while for <span class="math notranslate nohighlight">\(\alpha_1\)</span> and <span class="math notranslate nohighlight">\(\beta_2\)</span> it is closer to that of the ground state. Also note the differences in the x-scales, with <span class="math notranslate nohighlight">\(\alpha_1\)</span> being more compressed and thus having a larger peak max.</p>
</section>
<section id="relaxation-of-core-de-excitation">
<h3>Relaxation of core-(de)excitation<a class="headerlink" href="#relaxation-of-core-de-excitation" title="Permalink to this headline">#</a></h3>
<p>For X-ray absorption and emission spectroscopy the influence of the relaxation is more complex, on account of the interaction with the created singly-occupied state. Comparing the two spectroscopies, the relaxation processes are partially inverse to each other, with</p>
<ul class="simple">
<li><p>Relaxation in XAS leading to a more contracted final state, which lowers absorption energies</p></li>
<li><p>Relaxation in XES leading to a more decontracted final state, which increases emission energies</p></li>
</ul>
<p>In addition to these strong changes in shielding, there are also additional couplings due to the population of a previous unoccupied state (XAS) or the creation of a valence-hole (XES). These effects are smaller and partially counteract the stronger change in shielding from the occupied/unoccupied core orbital, leading to a total picture as <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jctc.8b01046">follows</a>. Here we illustrate the relaxation effects involved in X-ray absorption (left) and emission (right) spectroscopies. Showing which orbitals primarily contribute to the respective effects, as well as the result in MO energies (or electron densities).:</p>
<figure class="align-default" id="relax-processes">
<img alt="../../_images/relax_processes.svg" src="../../_images/relax_processes.svg" /></figure>
<p>We here see the four main effects:</p>
<ul class="simple">
<li><p>X-ray absorption spectroscopy</p>
<ol class="arabic simple">
<li><p>A strong relaxation effect due to the creation of a core-hole, which leads to the contraction of electron density and scales with element</p></li>
<li><p>A weak polarization effect due to coupling with the newly occupied valence state, which partially decontracts the outer valence density and does not scale appreciably with the element</p></li>
</ol>
</li>
<li><p>X-ray emission spectroscopy</p>
<ol class="arabic simple">
<li><p>A strong repulsion effect due to the annihilation of a core-hole, which leads to decontraction of electron density and scales with element</p></li>
<li><p>A weaker outer relaxation effect due to the creation of a valence-hole, which leads to contraction of the (outer) valence density and scales with element</p></li>
</ol>
</li>
</ul>
<p>These effects balances in different manners, and the exact strength depends heavily on the element and which edge is being probed. As such, the accuracy of a particular method depends on which spectroscopy, element, and edge is considered.</p>
</section>
<section id="including-relaxation-with-deltascf-methods">
<span id="sec-xray-delta-rel"></span><h3>Including relaxation with <span class="math notranslate nohighlight">\(\Delta\)</span>SCF methods<a class="headerlink" href="#including-relaxation-with-deltascf-methods" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(\Delta\)</span>SCF methods provide the most direct way of including relaxation, as the core-hole state is explicitly optimized. However, these approaches need to consider each transition explicitly, and will have difficulties in calculating intensities and in properly converging higher excited states. As such, they are mainly useful for considering ionization energies and for providing a reference state for XES calculations. Comparing the performance of calculating IEs of the ten-electron series using Koopmans’ theorem and <span class="math notranslate nohighlight">\(\Delta\)</span>SCF:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">methane_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C       0.0000000000     0.0000000000     0.0000000000</span>
<span class="s2">H       0.6265918120     0.6265918120     0.6265918120</span>
<span class="s2">H      -0.6265918120    -0.6265918120     0.6265918120</span>
<span class="s2">H      -0.6265918120     0.6265918120    -0.6265918120</span>
<span class="s2">H       0.6265918120    -0.6265918120    -0.6265918120</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">ammonia_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">N       0.0000000000     0.0000000000     0.1175868000</span>
<span class="s2">H       0.9323800000     0.0000000000    -0.2743692000</span>
<span class="s2">H      -0.4661900000    -0.8074647660    -0.2743692000</span>
<span class="s2">H      -0.4661900000     0.8074647660    -0.2743692000</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">water_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">O       0.0000000000     0.0000000000     0.1178336003</span>
<span class="s2">H      -0.7595754146    -0.0000000000    -0.4713344012</span>
<span class="s2">H       0.7595754146     0.0000000000    -0.4713344012</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">hydrofluoride_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">H       0.0000000000     0.0000000000    -0.8261856000</span>
<span class="s2">F       0.0000000000     0.0000000000     0.0917984000</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">neon_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Ne      0.0000000000     0.0000000000     0.0000000000</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">Koopman_vs_delta</span><span class="p">(</span><span class="n">molecule_xyz</span><span class="p">,</span> <span class="n">basis_label</span><span class="p">):</span>
    
    <span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_str</span><span class="p">(</span><span class="n">molecule_xyz</span><span class="p">)</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis_label</span><span class="p">)</span>

    <span class="c1"># Perform SCF calculation</span>
    <span class="n">scf_gs</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
    <span class="n">gs_results</span> <span class="o">=</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
    
    <span class="n">orbital_energies</span> <span class="o">=</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">scf_tensors</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span>

    <span class="n">molecule</span><span class="o">.</span><span class="n">set_charge</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">molecule</span><span class="o">.</span><span class="n">set_multiplicity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">scf_ion</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfUnrestrictedDriver</span><span class="p">()</span>

    <span class="c1">#Create list of occupied orbitals</span>
    <span class="n">nOcc</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_alpha_electrons</span><span class="p">()</span>
    <span class="n">occa</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nOcc</span><span class="p">))</span>
    <span class="n">occb</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nOcc</span><span class="p">))</span>
    <span class="n">scf_ion</span><span class="o">.</span><span class="n">maximum_overlap</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="n">occa</span><span class="p">,</span> <span class="n">occb</span><span class="p">)</span>
    <span class="n">ion_results</span> <span class="o">=</span> <span class="n">scf_ion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>


    <span class="c1"># Return MO energy and deltaSCF</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">au2ev</span> <span class="o">*</span> <span class="n">orbital_energies</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">au2ev</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">scf_ion</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span> <span class="o">-</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span>
    <span class="p">)</span>


<span class="c1"># Basis set and container for errors</span>
<span class="n">basis</span> <span class="o">=</span> <span class="s2">&quot;cc-pcvdz&quot;</span>
<span class="n">err_koopman</span><span class="p">,</span> <span class="n">err_delta</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="n">expt</span><span class="p">,</span> <span class="n">rel</span> <span class="o">=</span> <span class="mf">290.76</span><span class="p">,</span> <span class="mf">0.11</span>  <span class="c1"># experimental IE and scalar-relativistic effects</span>
<span class="n">E_Koopman</span><span class="p">,</span> <span class="n">E_delta</span> <span class="o">=</span> <span class="n">Koopman_vs_delta</span><span class="p">(</span><span class="n">methane_xyz</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">err_koopman</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_Koopman</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>
<span class="n">err_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_delta</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>

<span class="n">expt</span><span class="p">,</span> <span class="n">rel</span> <span class="o">=</span> <span class="mf">405.52</span><span class="p">,</span> <span class="mf">0.21</span>  <span class="c1"># experimental IE and scalar-relativistic effects</span>
<span class="n">E_Koopman</span><span class="p">,</span> <span class="n">E_delta</span> <span class="o">=</span> <span class="n">Koopman_vs_delta</span><span class="p">(</span><span class="n">ammonia_xyz</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">err_koopman</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_Koopman</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>
<span class="n">err_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_delta</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>

<span class="n">expt</span><span class="p">,</span> <span class="n">rel</span> <span class="o">=</span> <span class="mf">539.90</span><span class="p">,</span> <span class="mf">0.37</span>  <span class="c1"># experimental IE and scalar-relativistic effects</span>
<span class="n">E_Koopman</span><span class="p">,</span> <span class="n">E_delta</span> <span class="o">=</span> <span class="n">Koopman_vs_delta</span><span class="p">(</span><span class="n">water_xyz</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">err_koopman</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_Koopman</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>
<span class="n">err_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_delta</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>

<span class="n">expt</span><span class="p">,</span> <span class="n">rel</span> <span class="o">=</span> <span class="mf">694.10</span><span class="p">,</span> <span class="mf">0.61</span>  <span class="c1"># experimental IE and scalar-relativistic effects</span>
<span class="n">E_Koopman</span><span class="p">,</span> <span class="n">E_delta</span> <span class="o">=</span> <span class="n">Koopman_vs_delta</span><span class="p">(</span><span class="n">hydrofluoride_xyz</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">err_koopman</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_Koopman</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>
<span class="n">err_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_delta</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>

<span class="n">expt</span><span class="p">,</span> <span class="n">rel</span> <span class="o">=</span> <span class="mf">870.09</span><span class="p">,</span> <span class="mf">0.94</span>  <span class="c1"># experimental IE and scalar-relativistic effects</span>
<span class="n">E_Koopman</span><span class="p">,</span> <span class="n">E_delta</span> <span class="o">=</span> <span class="n">Koopman_vs_delta</span><span class="p">(</span><span class="n">neon_xyz</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">err_koopman</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_Koopman</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>
<span class="n">err_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_delta</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /home/xinli/miniconda3/envs/echem/lib/python3.10/site-packages/veloxchem/basis/CC-PCVDZ
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: CC-PCVDZ                                                                            
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                H   (2S,1P)                   (4S,1P)                                                     
                                C   (4S,3P,1D)                (18S,5P,1D)                                                 
                                                                                                                          
                               Contracted Basis Functions : 38                                                            
                               Primitive Basis Functions  : 66                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 13.4937111288 a.u.                                                                     
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -40.176641252708 a.u. Time: 0.03 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -40.198632549790    0.0000000000      0.07238664      0.00936881      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -40.199216137990   -0.0005835882      0.00782091      0.00076076      0.02494254                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -40.199223311012   -0.0000071730      0.00284629      0.00029267      0.00277747                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -40.199224544997   -0.0000012340      0.00033787      0.00004920      0.00101091                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -40.199224580341   -0.0000000353      0.00002279      0.00000407      0.00032567                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -40.199224580473   -0.0000000001      0.00000241      0.00000058      0.00002005                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -40.199224580475   -0.0000000000      0.00000024      0.00000006      0.00000128                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 7 iterations. Time: 0.16 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :      -40.1992245805 a.u.                                              
               Electronic Energy                  :      -53.6929357092 a.u.                                              
               Nuclear Repulsion Energy           :       13.4937111288 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000002419 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -11.21468 a.u.                                                                  
               (   1 C   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.94394 a.u.                                                                  
               (   1 C   2s  :    -0.36) (   1 C   3s  :    -0.24) (   2 H   1s  :    -0.19)                              
               (   3 H   1s  :    -0.19) (   4 H   1s  :    -0.19) (   5 H   1s  :    -0.19)                              
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.54399 a.u.                                                                  
               (   1 C   1p+1:     0.28) (   1 C   1p-1:     0.29) (   2 H   1s  :     0.37)                              
               (   2 H   2s  :     0.15) (   3 H   1s  :    -0.23)                                                        
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.54399 a.u.                                                                  
               (   1 C   1p0 :     0.40) (   1 C   2p0 :     0.18) (   3 H   1s  :     0.31)                              
               (   4 H   1s  :    -0.16) (   5 H   1s  :    -0.26)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.54399 a.u.                                                                  
               (   1 C   1p+1:    -0.28) (   1 C   1p-1:     0.31) (   4 H   1s  :     0.35)                              
               (   5 H   1s  :    -0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.19200 a.u.                                                                  
               (   1 C   3s  :     2.43) (   2 H   2s  :    -0.86) (   3 H   2s  :    -0.86)                              
               (   4 H   2s  :    -0.86) (   5 H   2s  :    -0.86)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.27467 a.u.                                                                  
               (   1 C   1p-1:    -0.21) (   1 C   1p0 :    -0.21) (   1 C   2p-1:    -1.00)                              
               (   1 C   2p0 :    -1.01) (   2 H   2s  :     1.93) (   5 H   2s  :    -1.80)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.27467 a.u.                                                                  
               (   1 C   1p+1:    -0.30) (   1 C   2p+1:    -1.42) (   2 H   2s  :     1.22)                              
               (   3 H   2s  :    -1.41) (   4 H   2s  :    -1.22) (   5 H   2s  :     1.41)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.27467 a.u.                                                                  
               (   1 C   1p-1:    -0.21) (   1 C   1p0 :     0.21) (   1 C   2p-1:    -1.01)                              
               (   1 C   2p0 :     1.00) (   3 H   2s  :    -1.79) (   4 H   2s  :     1.93)                              
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.58864 a.u.                                                                  
               (   1 C   1p-1:     0.30) (   1 C   2p+1:    -0.25) (   1 C   2p-1:    -1.20)                              
               (   2 H   1s  :     0.60) (   3 H   1s  :    -0.52) (   4 H   1s  :     0.33)                              
               (   5 H   1s  :    -0.41)                                                                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.32.scf.h5                                             
                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Unrestricted Hartree-Fock                                       
                   Initial Guess Model             : Restart from Checkpoint                                              
                   Convergence Accelerator         : Direct Inversion of Iterative Subspace                               
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 13.4937111288 a.u.                                                                     
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Restarting from checkpoint file: veloxchem_scf_2023-05-15T13.09.32.scf.h5                                        
                                                                                                                          
                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -28.984548233126    0.0000000000      2.72929056      0.75211056      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -29.383245222949   -0.3986969898      1.03746343      0.14598216      0.84846701                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -29.480740305899   -0.0974950829      0.17120996      0.02756281      0.34603159                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -29.484157355961   -0.0034170501      0.03303526      0.00415502      0.06446845                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -29.484720018471   -0.0005626625      0.01405409      0.00136720      0.02807396                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -29.484843881109   -0.0001238626      0.00254185      0.00035196      0.01842700                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -29.484845836451   -0.0000019553      0.00046743      0.00007033      0.00338992                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8       -29.484845893262   -0.0000000568      0.00008456      0.00000995      0.00035811                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  9       -29.484845895285   -0.0000000020      0.00001190      0.00000137      0.00007186                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 10       -29.484845895330   -0.0000000000      0.00000170      0.00000025      0.00001234                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 11       -29.484845895330   -0.0000000000      0.00000013      0.00000002      0.00000111                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.32.scf.h5                                             
                                                                                                                          
* Info * SCF tensors written to file: veloxchem_scf_2023-05-15T13.09.32.scf.tensors.h5                                    
                                                                                                                          
               *** SCF converged in 11 iterations. Time: 0.23 sec.                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Unrestricted Hartree-Fock:                                                                            
               -------------------------------                                                                            
               Total Energy                       :      -29.4848458953 a.u.                                              
               Electronic Energy                  :      -42.9785570241 a.u.                                              
               Nuclear Repulsion Energy           :       13.4937111288 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000001275 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.5                                                                       
               Expectation value of S**2     :  0.7756                                                                    
                                                                                                                          
                                                                                                                          
                                             Spin Unrestricted Alpha Orbitals                                             
                                             --------------------------------                                             
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:  -13.84796 a.u.                                                                  
               (   1 C   1s  :    -1.07)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.45098 a.u.                                                                  
               (   1 C   2s  :    -0.61)                                                                                  
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.99657 a.u.                                                                  
               (   1 C   1p-1:     0.17) (   1 C   1p0 :    -0.63) (   3 H   1s  :    -0.23)                              
               (   4 H   1s  :     0.16)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.99657 a.u.                                                                  
               (   1 C   1p+1:     0.45) (   1 C   1p-1:     0.44) (   1 C   1p0 :     0.22)                              
               (   2 H   1s  :     0.27) (   3 H   1s  :    -0.16)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.99657 a.u.                                                                  
               (   1 C   1p+1:    -0.47) (   1 C   1p-1:     0.47) (   4 H   1s  :     0.23)                              
               (   5 H   1s  :    -0.24)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.09031 a.u.                                                                  
               (   1 C   2s  :     0.26) (   1 C   3s  :     1.85) (   2 H   2s  :    -0.74)                              
               (   3 H   2s  :    -0.74) (   4 H   2s  :    -0.74) (   5 H   2s  :    -0.74)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.02311 a.u.                                                                  
               (   1 C   1p-1:    -0.16) (   1 C   1p0 :    -0.39) (   1 C   2p+1:     0.20)                              
               (   1 C   2p-1:    -0.36) (   1 C   2p0 :    -0.87) (   2 H   2s  :     1.17)                              
               (   3 H   2s  :     0.80) (   4 H   2s  :    -0.35) (   5 H   1s  :    -0.17)                              
               (   5 H   2s  :    -1.62)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.02311 a.u.                                                                  
               (   1 C   1p+1:    -0.19) (   1 C   1p-1:     0.34) (   1 C   1p0 :    -0.18)                              
               (   1 C   2p+1:    -0.43) (   1 C   2p-1:     0.76) (   1 C   2p0 :    -0.41)                              
               (   3 H   2s  :     0.84) (   4 H   1s  :    -0.19) (   4 H   2s  :    -1.81)                              
               (   5 H   2s  :     0.87)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.02311 a.u.                                                                  
               (   1 C   1p+1:    -0.38) (   1 C   1p-1:    -0.21) (   1 C   2p+1:    -0.84)                              
               (   1 C   2p-1:    -0.47) (   2 H   1s  :     0.16) (   2 H   2s  :     1.48)                              
               (   3 H   1s  :    -0.16) (   3 H   2s  :    -1.49) (   4 H   2s  :    -0.41)                              
               (   5 H   2s  :     0.43)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.27795 a.u.                                                                  
               (   1 C   1p+1:    -0.28) (   1 C   1p-1:     0.30) (   1 C   2p+1:     1.03)                              
               (   1 C   2p-1:    -1.11) (   1 C   2p0 :    -0.41) (   4 H   1s  :     0.42)                              
               (   4 H   2s  :     0.26) (   5 H   1s  :    -0.63) (   5 H   2s  :    -0.39)                              
                                                                                                                          
                                             Spin Unrestricted Beta Orbitals                                              
                                             -------------------------------                                              
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.36903 a.u.                                                                  
               (   1 C   2s  :    -0.49) (   1 C   3s  :    -0.19) (   2 H   1s  :    -0.17)                              
               (   3 H   1s  :    -0.17) (   4 H   1s  :    -0.17) (   5 H   1s  :    -0.17)                              
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.96052 a.u.                                                                  
               (   1 C   1p+1:     0.52) (   1 C   1p-1:    -0.26) (   4 H   1s  :    -0.29)                              
               (   5 H   1s  :     0.24)                                                                                  
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.96052 a.u.                                                                  
               (   1 C   1p0 :     0.57) (   1 C   2p0 :     0.16) (   3 H   1s  :     0.26)                              
               (   4 H   1s  :    -0.18) (   5 H   1s  :    -0.20)                                                        
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.96052 a.u.                                                                  
               (   1 C   1p+1:     0.24) (   1 C   1p-1:     0.51) (   2 H   1s  :     0.30)                              
               (   3 H   1s  :    -0.22)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:  -10.19964 a.u.                                                                  
               (   1 C   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.07555 a.u.                                                                  
               (   1 C   2s  :     0.20) (   1 C   3s  :     2.03) (   2 H   2s  :    -0.78)                              
               (   3 H   2s  :    -0.78) (   4 H   2s  :    -0.78) (   5 H   2s  :    -0.78)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.01250 a.u.                                                                  
               (   1 C   1p-1:    -0.31) (   1 C   1p0 :    -0.25) (   1 C   2p+1:     0.18)                              
               (   1 C   2p-1:    -0.84) (   1 C   2p0 :    -0.67) (   2 H   2s  :     1.38)                              
               (   4 H   2s  :     0.36) (   5 H   1s  :    -0.17) (   5 H   2s  :    -1.76)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.01250 a.u.                                                                  
               (   1 C   1p-1:     0.22) (   1 C   1p0 :    -0.31) (   1 C   2p+1:    -0.36)                              
               (   1 C   2p-1:     0.60) (   1 C   2p0 :    -0.84) (   2 H   2s  :     0.63)                              
               (   3 H   2s  :     1.12) (   4 H   1s  :    -0.18) (   4 H   2s  :    -1.87)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.01250 a.u.                                                                  
               (   1 C   1p+1:    -0.38) (   1 C   2p+1:    -1.01) (   1 C   2p-1:    -0.37)                              
               (   1 C   2p0 :     0.18) (   2 H   2s  :     1.25) (   3 H   1s  :    -0.15)                              
               (   3 H   2s  :    -1.62) (   4 H   2s  :    -0.49) (   5 H   2s  :     0.86)                              
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /home/xinli/miniconda3/envs/echem/lib/python3.10/site-packages/veloxchem/basis/CC-PCVDZ
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: CC-PCVDZ                                                                            
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                H   (2S,1P)                   (4S,1P)                                                     
                                N   (4S,3P,1D)                (18S,5P,1D)                                                 
                                                                                                                          
                               Contracted Basis Functions : 33                                                            
                               Primitive Basis Functions  : 59                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 11.9703270415 a.u.                                                                     
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -56.154702188708 a.u. Time: 0.02 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -56.195358785585    0.0000000000      0.09236701      0.01092262      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -56.196206735531   -0.0008479499      0.01551902      0.00289180      0.03204290                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -56.196232682551   -0.0000259470      0.00329250      0.00061368      0.00416037                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -56.196236230580   -0.0000035480      0.00129802      0.00014764      0.00241244                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -56.196236654350   -0.0000004238      0.00047049      0.00009292      0.00079374                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -56.196236728370   -0.0000000740      0.00006997      0.00001054      0.00047731                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -56.196236729650   -0.0000000013      0.00000421      0.00000053      0.00006073                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8       -56.196236729653   -0.0000000000      0.00000048      0.00000006      0.00000255                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 8 iterations. Time: 0.18 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :      -56.1962367297 a.u.                                              
               Electronic Energy                  :      -68.1665637711 a.u.                                              
               Nuclear Repulsion Energy           :       11.9703270415 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000004806 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -15.53583 a.u.                                                                  
               (   1 N   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.13384 a.u.                                                                  
               (   1 N   2s  :     0.40) (   1 N   3s  :     0.28) (   2 H   1s  :     0.20)                              
               (   3 H   1s  :     0.20) (   4 H   1s  :     0.20)                                                        
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.61616 a.u.                                                                  
               (   1 N   1p-1:     0.45) (   1 N   2p-1:     0.21) (   3 H   1s  :    -0.32)                              
               (   4 H   1s  :     0.32)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.61616 a.u.                                                                  
               (   1 N   1p+1:     0.45) (   1 N   2p+1:     0.21) (   2 H   1s  :     0.37)                              
               (   3 H   1s  :    -0.19) (   4 H   1s  :    -0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.42176 a.u.                                                                  
               (   1 N   3s  :     0.30) (   1 N   1p0 :     0.54) (   1 N   2p0 :     0.46)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.18607 a.u.                                                                  
               (   1 N   3s  :     1.50) (   1 N   2p0 :    -0.34) (   2 H   2s  :    -0.74)                              
               (   3 H   2s  :    -0.74) (   4 H   2s  :    -0.74)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.27050 a.u.                                                                  
               (   1 N   1p-1:    -0.29) (   1 N   2p-1:    -0.90) (   3 H   2s  :    -1.56)                              
               (   4 H   2s  :     1.56)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.27050 a.u.                                                                  
               (   1 N   1p+1:    -0.29) (   1 N   2p+1:    -0.90) (   2 H   2s  :     1.80)                              
               (   3 H   2s  :    -0.90) (   4 H   2s  :    -0.90)                                                        
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.72999 a.u.                                                                  
               (   1 N   2p+1:    -0.68) (   2 H   1s  :     1.01) (   2 H   2s  :    -0.54)                              
               (   3 H   1s  :    -0.51) (   3 H   2s  :     0.27) (   4 H   1s  :    -0.51)                              
               (   4 H   2s  :     0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.72999 a.u.                                                                  
               (   1 N   2p-1:     0.68) (   3 H   1s  :     0.88) (   3 H   2s  :    -0.47)                              
               (   4 H   1s  :    -0.88) (   4 H   2s  :     0.47)                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.33.scf.h5                                             
                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Unrestricted Hartree-Fock                                       
                   Initial Guess Model             : Restart from Checkpoint                                              
                   Convergence Accelerator         : Direct Inversion of Iterative Subspace                               
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 11.9703270415 a.u.                                                                     
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Restarting from checkpoint file: veloxchem_scf_2023-05-15T13.09.33.scf.h5                                        
                                                                                                                          
                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -40.660410101572    0.0000000000      3.36296681      0.93787381      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -41.122191658113   -0.4617815565      1.36758506      0.19392095      0.86529171                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -41.266669310780   -0.1444776527      0.21528914      0.02793667      0.35551128                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -41.271020414677   -0.0043511039      0.03449561      0.00531354      0.06580037                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -41.271483608593   -0.0004631939      0.01412355      0.00223336      0.02171266                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -41.271579300234   -0.0000956916      0.00321463      0.00044586      0.01358060                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -41.271582780015   -0.0000034798      0.00076046      0.00010369      0.00252762                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8       -41.271582946469   -0.0000001665      0.00015419      0.00002015      0.00053815                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  9       -41.271582952575   -0.0000000061      0.00003472      0.00000430      0.00011550                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 10       -41.271582952900   -0.0000000003      0.00000726      0.00000138      0.00002156                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 11       -41.271582952917   -0.0000000000      0.00000201      0.00000041      0.00000518                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 12       -41.271582952918   -0.0000000000      0.00000036      0.00000006      0.00000170                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.33.scf.h5                                             
                                                                                                                          
* Info * SCF tensors written to file: veloxchem_scf_2023-05-15T13.09.33.scf.tensors.h5                                    
                                                                                                                          
               *** SCF converged in 12 iterations. Time: 0.24 sec.                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Unrestricted Hartree-Fock:                                                                            
               -------------------------------                                                                            
               Total Energy                       :      -41.2715829529 a.u.                                              
               Electronic Energy                  :      -53.2419099944 a.u.                                              
               Nuclear Repulsion Energy           :       11.9703270415 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000003577 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.5                                                                       
               Expectation value of S**2     :  0.7708                                                                    
                                                                                                                          
                                                                                                                          
                                             Spin Unrestricted Alpha Orbitals                                             
                                             --------------------------------                                             
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:  -18.57272 a.u.                                                                  
               (   1 N   1s  :    -1.06)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.71997 a.u.                                                                  
               (   1 N   2s  :     0.61) (   1 N   3s  :     0.19) (   2 H   1s  :     0.16)                              
               (   3 H   1s  :     0.16) (   4 H   1s  :     0.16)                                                        
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.14527 a.u.                                                                  
               (   1 N   1p+1:    -0.67) (   1 N   2p+1:    -0.17) (   2 H   1s  :    -0.28)                              
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.14527 a.u.                                                                  
               (   1 N   1p-1:     0.67) (   1 N   2p-1:     0.17) (   3 H   1s  :    -0.24)                              
               (   4 H   1s  :     0.24)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.00217 a.u.                                                                  
               (   1 N   2s  :     0.18) (   1 N   1p0 :     0.75) (   1 N   2p0 :     0.26)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.13072 a.u.                                                                  
               (   1 N   2s  :     0.22) (   1 N   3s  :     1.14) (   1 N   1p0 :    -0.18)                              
               (   1 N   2p0 :    -0.20) (   2 H   2s  :    -0.64) (   3 H   2s  :    -0.64)                              
               (   4 H   2s  :    -0.64)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.05496 a.u.                                                                  
               (   1 N   1p-1:    -0.38) (   1 N   2p-1:    -0.62) (   3 H   1s  :    -0.18)                              
               (   3 H   2s  :    -1.30) (   4 H   1s  :     0.18) (   4 H   2s  :     1.30)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.05496 a.u.                                                                  
               (   1 N   1p+1:    -0.38) (   1 N   2p+1:    -0.62) (   2 H   1s  :     0.21)                              
               (   2 H   2s  :     1.51) (   3 H   2s  :    -0.75) (   4 H   2s  :    -0.75)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.38300 a.u.                                                                  
               (   1 N   1p+1:    -0.19) (   1 N   2p+1:    -0.29) (   2 H   1s  :     1.00)                              
               (   2 H   2s  :    -0.93) (   3 H   1s  :    -0.50) (   3 H   2s  :     0.47)                              
               (   4 H   1s  :    -0.50) (   4 H   2s  :     0.47)                                                        
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.38300 a.u.                                                                  
               (   1 N   1p-1:     0.19) (   1 N   2p-1:     0.29) (   3 H   1s  :     0.87)                              
               (   3 H   2s  :    -0.81) (   4 H   1s  :    -0.86) (   4 H   2s  :     0.81)                              
                                                                                                                          
                                             Spin Unrestricted Beta Orbitals                                              
                                             -------------------------------                                              
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.62136 a.u.                                                                  
               (   1 N   2s  :     0.51) (   1 N   3s  :     0.23) (   2 H   1s  :     0.18)                              
               (   3 H   1s  :     0.18) (   4 H   1s  :     0.18)                                                        
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.09628 a.u.                                                                  
               (   1 N   1p+1:    -0.60) (   1 N   2p+1:    -0.18) (   2 H   1s  :    -0.33)                              
               (   3 H   1s  :     0.16) (   4 H   1s  :     0.16)                                                        
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.09628 a.u.                                                                  
               (   1 N   1p-1:     0.60) (   1 N   2p-1:     0.18) (   3 H   1s  :    -0.28)                              
               (   4 H   1s  :     0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.93070 a.u.                                                                  
               (   1 N   2s  :     0.18) (   1 N   3s  :     0.19) (   1 N   1p0 :     0.70)                              
               (   1 N   2p0 :     0.32)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:  -14.30674 a.u.                                                                  
               (   1 N   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.11641 a.u.                                                                  
               (   1 N   2s  :     0.18) (   1 N   3s  :     1.24) (   1 N   1p0 :    -0.17)                              
               (   1 N   2p0 :    -0.22) (   2 H   2s  :    -0.67) (   3 H   2s  :    -0.67)                              
               (   4 H   2s  :    -0.67)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.04172 a.u.                                                                  
               (   1 N   1p-1:    -0.38) (   1 N   2p-1:    -0.69) (   3 H   1s  :    -0.16)                              
               (   3 H   2s  :    -1.35) (   4 H   1s  :     0.16) (   4 H   2s  :     1.35)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.04172 a.u.                                                                  
               (   1 N   1p+1:    -0.38) (   1 N   2p+1:    -0.69) (   2 H   1s  :     0.18)                              
               (   2 H   2s  :     1.55) (   3 H   2s  :    -0.78) (   4 H   2s  :    -0.78)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.37116 a.u.                                                                  
               (   1 N   1p+1:    -0.16) (   1 N   2p+1:    -0.40) (   2 H   1s  :     1.00)                              
               (   2 H   2s  :    -0.85) (   3 H   1s  :    -0.50) (   3 H   2s  :     0.43)                              
               (   4 H   1s  :    -0.50) (   4 H   2s  :     0.43)                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /home/xinli/miniconda3/envs/echem/lib/python3.10/site-packages/veloxchem/basis/CC-PCVDZ
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: CC-PCVDZ                                                                            
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                O   (4S,3P,1D)                (18S,5P,1D)                                                 
                                H   (2S,1P)                   (4S,1P)                                                     
                                                                                                                          
                               Contracted Basis Functions : 28                                                            
                               Primitive Basis Functions  : 52                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 9.1561447194 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -75.980954854746 a.u. Time: 0.01 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -76.025912394461    0.0000000000      0.10613691      0.01096404      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -76.026931952439   -0.0010195580      0.02019241      0.00280757      0.02550308                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -76.026976262238   -0.0000443098      0.00419173      0.00085956      0.00453733                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -76.026979226222   -0.0000029640      0.00218984      0.00030105      0.00163383                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -76.026979655187   -0.0000004290      0.00033786      0.00007031      0.00046129                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -76.026979678134   -0.0000000229      0.00003955      0.00000573      0.00016589                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -76.026979678489   -0.0000000004      0.00000246      0.00000041      0.00002137                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8       -76.026979678490   -0.0000000000      0.00000049      0.00000007      0.00000086                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 8 iterations. Time: 0.18 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :      -76.0269796785 a.u.                                              
               Electronic Energy                  :      -85.1831243979 a.u.                                              
               Nuclear Repulsion Energy           :        9.1561447194 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000004877 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -20.55028 a.u.                                                                  
               (   1 O   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.33471 a.u.                                                                  
               (   1 O   2s  :    -0.44) (   1 O   3s  :    -0.38) (   2 H   1s  :    -0.19)                              
               (   3 H   1s  :    -0.19)                                                                                  
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.69724 a.u.                                                                  
               (   1 O   1p+1:    -0.49) (   1 O   2p+1:    -0.22) (   2 H   1s  :     0.33)                              
               (   3 H   1s  :    -0.33)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.56644 a.u.                                                                  
               (   1 O   2s  :     0.15) (   1 O   3s  :     0.35) (   1 O   1p0 :     0.54)                              
               (   1 O   2p0 :     0.37) (   2 H   1s  :    -0.21) (   3 H   1s  :    -0.21)                              
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.49324 a.u.                                                                  
               (   1 O   1p-1:     0.63) (   1 O   2p-1:     0.50)                                                        
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.18437 a.u.                                                                  
               (   1 O   3s  :    -1.01) (   1 O   1p0 :     0.19) (   1 O   2p0 :     0.34)                              
               (   2 H   2s  :     0.83) (   3 H   2s  :     0.83)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.25556 a.u.                                                                  
               (   1 O   1p+1:     0.28) (   1 O   2p+1:     0.67) (   2 H   2s  :     1.44)                              
               (   3 H   2s  :    -1.44)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.78577 a.u.                                                                  
               (   1 O   1p+1:    -0.27) (   1 O   2p+1:    -0.46) (   2 H   1s  :    -0.94)                              
               (   2 H   2s  :     0.69) (   2 H   1p0 :     0.15) (   3 H   1s  :     0.94)                              
               (   3 H   2s  :    -0.69) (   3 H   1p0 :    -0.15)                                                        
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.84995 a.u.                                                                  
               (   1 O   2s  :    -0.27) (   1 O   3s  :     0.35) (   1 O   1p0 :     0.33)                              
               (   2 H   1s  :     0.78) (   2 H   2s  :    -0.55) (   2 H   1p+1:    -0.29)                              
               (   3 H   1s  :     0.78) (   3 H   2s  :    -0.55) (   3 H   1p+1:     0.29)                              
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.16230 a.u.                                                                  
               (   1 O   3s  :    -0.74) (   1 O   1p0 :    -0.76) (   1 O   2p0 :     1.28)                              
               (   2 H   1s  :     0.54) (   2 H   1p0 :     0.25) (   3 H   1s  :     0.54)                              
               (   3 H   1p0 :     0.25)                                                                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.33.scf.h5                                             
                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Unrestricted Hartree-Fock                                       
                   Initial Guess Model             : Restart from Checkpoint                                              
                   Convergence Accelerator         : Direct Inversion of Iterative Subspace                               
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 9.1561447194 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Restarting from checkpoint file: veloxchem_scf_2023-05-15T13.09.33.scf.h5                                        
                                                                                                                          
                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -55.476698768014    0.0000000000      4.00725477      1.00603661      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -56.031465126004   -0.5547663580      1.49516221      0.19142953      0.85523582                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -56.177378495754   -0.1459133698      0.20617595      0.03128268      0.33481131                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -56.180651358574   -0.0032728628      0.03175806      0.00523624      0.05436888                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -56.180957941862   -0.0003065833      0.01110568      0.00195632      0.01691272                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -56.181002534103   -0.0000445922      0.00267353      0.00047453      0.00810046                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -56.181004700115   -0.0000021660      0.00061110      0.00007448      0.00172878                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8       -56.181004792916   -0.0000000928      0.00009944      0.00001508      0.00036532                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  9       -56.181004794731   -0.0000000018      0.00001782      0.00000370      0.00005401                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 10       -56.181004794796   -0.0000000001      0.00000300      0.00000068      0.00000901                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 11       -56.181004794798   -0.0000000000      0.00000076      0.00000011      0.00000154                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.33.scf.h5                                             
                                                                                                                          
* Info * SCF tensors written to file: veloxchem_scf_2023-05-15T13.09.33.scf.tensors.h5                                    
                                                                                                                          
               *** SCF converged in 11 iterations. Time: 0.22 sec.                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Unrestricted Hartree-Fock:                                                                            
               -------------------------------                                                                            
               Total Energy                       :      -56.1810047948 a.u.                                              
               Electronic Energy                  :      -65.3371495142 a.u.                                              
               Nuclear Repulsion Energy           :        9.1561447194 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000007610 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.5                                                                       
               Expectation value of S**2     :  0.7648                                                                    
                                                                                                                          
                                                                                                                          
                                             Spin Unrestricted Alpha Orbitals                                             
                                             --------------------------------                                             
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:  -24.02738 a.u.                                                                  
               (   1 O   1s  :    -1.06)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -2.02457 a.u.                                                                  
               (   1 O   2s  :    -0.63) (   1 O   3s  :    -0.27) (   2 H   1s  :    -0.15)                              
               (   3 H   1s  :    -0.15)                                                                                  
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.32957 a.u.                                                                  
               (   1 O   1p+1:    -0.70) (   1 O   2p+1:    -0.17) (   2 H   1s  :     0.24)                              
               (   3 H   1s  :    -0.24)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.23386 a.u.                                                                  
               (   1 O   2s  :     0.18) (   1 O   3s  :     0.18) (   1 O   1p0 :     0.74)                              
               (   1 O   2p0 :     0.22) (   2 H   1s  :    -0.15) (   3 H   1s  :    -0.15)                              
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.18294 a.u.                                                                  
               (   1 O   1p-1:     0.81) (   1 O   2p-1:     0.28)                                                        
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.17239 a.u.                                                                  
               (   1 O   2s  :    -0.18) (   1 O   3s  :    -0.77) (   1 O   1p0 :     0.23)                              
               (   1 O   2p0 :     0.19) (   2 H   1s  :     0.18) (   2 H   2s  :     0.70)                              
               (   3 H   1s  :     0.18) (   3 H   2s  :     0.70)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.10078 a.u.                                                                  
               (   1 O   1p+1:     0.35) (   1 O   2p+1:     0.45) (   2 H   1s  :     0.23)                              
               (   2 H   2s  :     1.17) (   3 H   1s  :    -0.23) (   3 H   2s  :    -1.17)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.37249 a.u.                                                                  
               (   1 O   1p+1:    -0.32) (   2 H   1s  :    -0.90) (   2 H   2s  :     1.06)                              
               (   3 H   1s  :     0.90) (   3 H   2s  :    -1.06)                                                        
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.39727 a.u.                                                                  
               (   1 O   2s  :    -0.28) (   1 O   3s  :     0.59) (   1 O   1p0 :     0.43)                              
               (   1 O   2p0 :    -0.38) (   2 H   1s  :     0.69) (   2 H   2s  :    -0.69)                              
               (   2 H   1p+1:    -0.23) (   3 H   1s  :     0.69) (   3 H   2s  :    -0.69)                              
               (   3 H   1p+1:     0.23)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.59798 a.u.                                                                  
               (   1 O   1p-1:     0.82) (   1 O   2p-1:    -1.08)                                                        
                                                                                                                          
                                             Spin Unrestricted Beta Orbitals                                              
                                             -------------------------------                                              
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.90790 a.u.                                                                  
               (   1 O   2s  :    -0.55) (   1 O   3s  :    -0.31) (   2 H   1s  :    -0.18)                              
               (   3 H   1s  :    -0.18)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.26787 a.u.                                                                  
               (   1 O   1p+1:    -0.64) (   1 O   2p+1:    -0.18) (   2 H   1s  :     0.28)                              
               (   3 H   1s  :    -0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.15789 a.u.                                                                  
               (   1 O   2s  :     0.18) (   1 O   3s  :     0.24) (   1 O   1p0 :     0.69)                              
               (   1 O   2p0 :     0.26) (   2 H   1s  :    -0.17) (   3 H   1s  :    -0.17)                              
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.10427 a.u.                                                                  
               (   1 O   1p-1:     0.77) (   1 O   2p-1:     0.33)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:  -19.14601 a.u.                                                                  
               (   1 O   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.15857 a.u.                                                                  
               (   1 O   2s  :    -0.16) (   1 O   3s  :    -0.83) (   1 O   1p0 :     0.23)                              
               (   1 O   2p0 :     0.22) (   2 H   1s  :     0.17) (   2 H   2s  :     0.73)                              
               (   3 H   1s  :     0.17) (   3 H   2s  :     0.73)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.08775 a.u.                                                                  
               (   1 O   1p+1:     0.36) (   1 O   2p+1:     0.51) (   2 H   1s  :     0.20)                              
               (   2 H   2s  :     1.20) (   3 H   1s  :    -0.20) (   3 H   2s  :    -1.20)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.36931 a.u.                                                                  
               (   1 O   1p+1:    -0.30) (   1 O   2p+1:    -0.16) (   2 H   1s  :    -0.92)                              
               (   2 H   2s  :     1.00) (   3 H   1s  :     0.92) (   3 H   2s  :    -1.00)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.40896 a.u.                                                                  
               (   1 O   2s  :    -0.26) (   1 O   3s  :     0.49) (   1 O   1p0 :     0.41)                              
               (   1 O   2p0 :    -0.25) (   2 H   1s  :     0.74) (   2 H   2s  :    -0.67)                              
               (   2 H   1p+1:    -0.24) (   3 H   1s  :     0.74) (   3 H   2s  :    -0.67)                              
               (   3 H   1p+1:     0.24)                                                                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /home/xinli/miniconda3/envs/echem/lib/python3.10/site-packages/veloxchem/basis/CC-PCVDZ
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: CC-PCVDZ                                                                            
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                H   (2S,1P)                   (4S,1P)                                                     
                                F   (4S,3P,1D)                (18S,5P,1D)                                                 
                                                                                                                          
                               Contracted Basis Functions : 23                                                            
                               Primitive Basis Functions  : 45                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 5.1881022960 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -99.988874777753 a.u. Time: 0.01 sec.                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1      -100.018768000115    0.0000000000      0.09773637      0.01303368      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2      -100.019585862254   -0.0008178621      0.02190606      0.00305029      0.02171836                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3      -100.019640824607   -0.0000549624      0.00566262      0.00116714      0.00487750                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4      -100.019645492095   -0.0000046675      0.00331753      0.00040416      0.00201343                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5      -100.019646381262   -0.0000008892      0.00037277      0.00005411      0.00064692                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6      -100.019646410026   -0.0000000288      0.00003872      0.00000711      0.00017580                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7      -100.019646410326   -0.0000000003      0.00000210      0.00000036      0.00001858                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8      -100.019646410327   -0.0000000000      0.00000019      0.00000003      0.00000071                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 8 iterations. Time: 0.18 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :     -100.0196464103 a.u.                                              
               Electronic Energy                  :     -105.2077487064 a.u.                                              
               Nuclear Repulsion Energy           :        5.1881022960 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000001942 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -26.27716 a.u.                                                                  
               (   2 F   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.58313 a.u.                                                                  
               (   1 H   1s  :     0.17) (   2 F   2s  :     0.48) (   2 F   3s  :     0.48)                              
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.74719 a.u.                                                                  
               (   1 H   1s  :     0.39) (   2 F   3s  :    -0.29) (   2 F   1p0 :    -0.56)                              
               (   2 F   2p0 :    -0.30)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.62915 a.u.                                                                  
               (   2 F   1p+1:     0.40) (   2 F   1p-1:    -0.53) (   2 F   2p+1:     0.29)                              
               (   2 F   2p-1:    -0.38)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.62915 a.u.                                                                  
               (   2 F   1p+1:     0.53) (   2 F   1p-1:     0.40) (   2 F   2p+1:     0.38)                              
               (   2 F   2p-1:     0.29)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.18337 a.u.                                                                  
               (   1 H   2s  :    -1.27) (   2 F   3s  :     0.67) (   2 F   1p0 :    -0.22)                              
               (   2 F   2p0 :    -0.34)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.80873 a.u.                                                                  
               (   1 H   1s  :    -1.27) (   1 H   2s  :     0.91) (   1 H   1p0 :     0.33)                              
               (   2 F   1p0 :    -0.37) (   2 F   2p0 :    -0.19)                                                        
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.40908 a.u.                                                                  
               (   1 H   1p-1:    -0.43) (   2 F   1p-1:     0.85) (   2 F   2p-1:    -0.75)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.40908 a.u.                                                                  
               (   1 H   1p+1:     0.43) (   2 F   1p+1:    -0.85) (   2 F   2p+1:     0.75)                              
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.41388 a.u.                                                                  
               (   1 H   1s  :    -1.07) (   1 H   1p0 :    -0.51) (   2 F   2s  :     0.24)                              
               (   2 F   3s  :     0.57) (   2 F   1p0 :     0.65) (   2 F   2p0 :    -1.61)                              
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.34.scf.h5                                             
                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Unrestricted Hartree-Fock                                       
                   Initial Guess Model             : Restart from Checkpoint                                              
                   Convergence Accelerator         : Direct Inversion of Iterative Subspace                               
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 5.1881022960 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Restarting from checkpoint file: veloxchem_scf_2023-05-15T13.09.34.scf.h5                                        
                                                                                                                          
                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -73.742490771103    0.0000000000      4.65394692      1.19371628      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -74.398937627258   -0.6564468562      1.45174136      0.15266049      0.80606973                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -74.507809858140   -0.1088722309      0.15003366      0.02152883      0.27290087                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -74.509195127826   -0.0013852697      0.02481321      0.00345443      0.03446813                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -74.509328657671   -0.0001335298      0.00650857      0.00110570      0.01088816                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -74.509339136024   -0.0000104784      0.00159980      0.00028573      0.00336728                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -74.509339787444   -0.0000006514      0.00032453      0.00004058      0.00089691                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8       -74.509339810128   -0.0000000227      0.00004148      0.00000612      0.00018196                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  9       -74.509339810308   -0.0000000002      0.00000481      0.00000071      0.00001225                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 10       -74.509339810311   -0.0000000000      0.00000052      0.00000010      0.00000206                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.34.scf.h5                                             
                                                                                                                          
* Info * SCF tensors written to file: veloxchem_scf_2023-05-15T13.09.34.scf.tensors.h5                                    
                                                                                                                          
               *** SCF converged in 10 iterations. Time: 0.20 sec.                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Unrestricted Hartree-Fock:                                                                            
               -------------------------------                                                                            
               Total Energy                       :      -74.5093398103 a.u.                                              
               Electronic Energy                  :      -79.6974421063 a.u.                                              
               Nuclear Repulsion Energy           :        5.1881022960 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000005166 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.5                                                                       
               Expectation value of S**2     :  0.7589                                                                    
                                                                                                                          
                                                                                                                          
                                             Spin Unrestricted Alpha Orbitals                                             
                                             --------------------------------                                             
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:  -30.25722 a.u.                                                                  
               (   2 F   1s  :    -1.05)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -2.41524 a.u.                                                                  
               (   2 F   2s  :     0.65) (   2 F   3s  :     0.34)                                                        
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.54540 a.u.                                                                  
               (   1 H   1s  :     0.27) (   2 F   3s  :    -0.16) (   2 F   1p0 :    -0.75)                              
               (   2 F   2p0 :    -0.19)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.46185 a.u.                                                                  
               (   2 F   1p+1:     0.71) (   2 F   1p-1:    -0.42) (   2 F   2p+1:     0.24)                              
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.46185 a.u.                                                                  
               (   2 F   1p+1:     0.42) (   2 F   1p-1:     0.71) (   2 F   2p-1:     0.24)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.21792 a.u.                                                                  
               (   1 H   1s  :    -0.36) (   1 H   2s  :    -1.01) (   2 F   3s  :     0.50)                              
               (   2 F   1p0 :    -0.26) (   2 F   2p0 :    -0.21)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.30737 a.u.                                                                  
               (   1 H   1s  :    -1.18) (   1 H   2s  :     1.15) (   1 H   1p0 :     0.25)                              
               (   2 F   3s  :    -0.26) (   2 F   1p0 :    -0.38)                                                        
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.73464 a.u.                                                                  
               (   1 H   1p+1:     0.25) (   2 F   1p+1:    -0.77) (   2 F   2p+1:     0.97)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.73464 a.u.                                                                  
               (   1 H   1p-1:     0.25) (   2 F   1p-1:    -0.77) (   2 F   2p-1:     0.97)                              
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.84884 a.u.                                                                  
               (   1 H   1s  :    -1.05) (   1 H   1p0 :    -0.29) (   2 F   2s  :     0.37)                              
               (   2 F   3s  :     0.18) (   2 F   1p0 :     0.56) (   2 F   2p0 :    -1.54)                              
                                                                                                                          
                                             Spin Unrestricted Beta Orbitals                                              
                                             -------------------------------                                              
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -2.28147 a.u.                                                                  
               (   1 H   1s  :     0.15) (   2 F   2s  :     0.59) (   2 F   3s  :     0.40)                              
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.46527 a.u.                                                                  
               (   1 H   1s  :     0.31) (   2 F   3s  :    -0.20) (   2 F   1p0 :    -0.71)                              
               (   2 F   2p0 :    -0.21)                                                                                  
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.37679 a.u.                                                                  
               (   2 F   1p-1:    -0.79) (   2 F   2p-1:    -0.32)                                                        
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.37679 a.u.                                                                  
               (   2 F   1p+1:     0.79) (   2 F   2p+1:     0.32)                                                        
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:  -24.76185 a.u.                                                                  
               (   2 F   1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.20513 a.u.                                                                  
               (   1 H   1s  :    -0.34) (   1 H   2s  :    -1.04) (   2 F   3s  :     0.54)                              
               (   2 F   1p0 :    -0.27) (   2 F   2p0 :    -0.23)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.31497 a.u.                                                                  
               (   1 H   1s  :    -1.22) (   1 H   2s  :     1.13) (   1 H   1p0 :     0.26)                              
               (   2 F   3s  :    -0.22) (   2 F   1p0 :    -0.38)                                                        
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.77758 a.u.                                                                  
               (   1 H   1p-1:    -0.28) (   2 F   1p+1:    -0.17) (   2 F   1p-1:     0.78)                              
               (   2 F   2p+1:     0.20) (   2 F   2p-1:    -0.91)                                                        
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.77758 a.u.                                                                  
               (   1 H   1p+1:     0.28) (   2 F   1p+1:    -0.78) (   2 F   1p-1:    -0.17)                              
               (   2 F   2p+1:     0.91) (   2 F   2p-1:     0.20)                                                        
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Reading basis set from file: /home/xinli/miniconda3/envs/echem/lib/python3.10/site-packages/veloxchem/basis/CC-PCVDZ
                                                                                                                          
                                              Molecular Basis (Atomic Basis)                                              
                                             ================================                                             
                                                                                                                          
                               Basis: CC-PCVDZ                                                                            
                                                                                                                          
                               Atom Contracted GTOs           Primitive GTOs                                              
                                                                                                                          
                                Ne  (4S,3P,1D)                (18S,5P,1D)                                                 
                                                                                                                          
                               Contracted Basis Functions : 18                                                            
                               Primitive Basis Functions  : 38                                                            
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Restricted Hartree-Fock                                         
                   Initial Guess Model             : Superposition of Atomic Densities                                    
                   Convergence Accelerator         : Two Level Direct Inversion of Iterative Subspace                     
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 0.0000000000 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * SAD initial guess computed in 0.00 sec.                                                                          
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Starting Reduced Basis SCF calculation...                                                                        
* Info * ...done. SCF energy in reduced basis set: -128.488925926667 a.u. Time: 0.00 sec.                                 
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1      -128.488925929027    0.0000000000      0.00008363      0.00002132      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2      -128.488925929352   -0.0000000003      0.00001743      0.00000273      0.00001389                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3      -128.488925929372   -0.0000000000      0.00000043      0.00000014      0.00000294                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
               *** SCF converged in 3 iterations. Time: 0.09 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Restricted Hartree-Fock:                                                                              
               -----------------------------                                                                              
               Total Energy                       :     -128.4889259294 a.u.                                              
               Electronic Energy                  :     -128.4889259294 a.u.                                              
               Nuclear Repulsion Energy           :        0.0000000000 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000004282 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  0.0                                                                       
               Multiplicity (2S+1)           :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.0                                                                       
                                                                                                                          
                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:  -32.76419 a.u.                                                                  
               (   1 Ne  1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.91886 a.u.                                                                  
               (   1 Ne  2s  :     0.52) (   1 Ne  3s  :     0.57)                                                        
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.83240 a.u.                                                                  
               (   1 Ne  1p+1:     0.48) (   1 Ne  1p-1:    -0.48) (   1 Ne  2p+1:     0.32)                              
               (   1 Ne  2p-1:    -0.32)                                                                                  
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.83240 a.u.                                                                  
               (   1 Ne  1p+1:    -0.48) (   1 Ne  1p-1:    -0.50) (   1 Ne  2p+1:    -0.32)                              
               (   1 Ne  2p-1:    -0.33)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.83240 a.u.                                                                  
               (   1 Ne  1p0 :    -0.68) (   1 Ne  2p0 :    -0.45)                                                        
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.69054 a.u.                                                                  
               (   1 Ne  1p+1:     0.79) (   1 Ne  1p-1:    -0.33) (   1 Ne  1p0 :     0.32)                              
               (   1 Ne  2p+1:    -0.91) (   1 Ne  2p-1:     0.38) (   1 Ne  2p0 :    -0.37)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.69054 a.u.                                                                  
               (   1 Ne  1p+1:    -0.21) (   1 Ne  1p-1:     0.31) (   1 Ne  1p0 :     0.83)                              
               (   1 Ne  2p+1:     0.24) (   1 Ne  2p-1:    -0.36) (   1 Ne  2p0 :    -0.96)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.69054 a.u.                                                                  
               (   1 Ne  1p+1:    -0.41) (   1 Ne  1p-1:    -0.79) (   1 Ne  1p0 :     0.20)                              
               (   1 Ne  2p+1:     0.47) (   1 Ne  2p-1:     0.91) (   1 Ne  2p0 :    -0.23)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    2.09313 a.u.                                                                  
               (   1 Ne  1s  :     0.52) (   1 Ne  2s  :     1.52) (   1 Ne  3s  :    -1.51)                              
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    5.19630 a.u.                                                                  
               (   1 Ne  1d+1:     0.50) (   1 Ne  1d+2:    -0.20) (   1 Ne  1d-1:     0.70)                              
               (   1 Ne  1d-2:    -0.46)                                                                                  
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.34.scf.h5                                             
                                                                                                                          
                                            Self Consistent Field Driver Setup                                            
                                           ====================================                                           
                                                                                                                          
                   Wave Function Model             : Spin-Unrestricted Hartree-Fock                                       
                   Initial Guess Model             : Restart from Checkpoint                                              
                   Convergence Accelerator         : Direct Inversion of Iterative Subspace                               
                   Max. Number of Iterations       : 50                                                                   
                   Max. Number of Error Vectors    : 10                                                                   
                   Convergence Threshold           : 1.0e-06                                                              
                   ERI Screening Scheme            : Cauchy Schwarz + Density                                             
                   ERI Screening Mode              : Dynamic                                                              
                   ERI Screening Threshold         : 1.0e-12                                                              
                   Linear Dependence Threshold     : 1.0e-06                                                              
                                                                                                                          
* Info * Nuclear repulsion energy: 0.0000000000 a.u.                                                                      
                                                                                                                          
* Info * Overlap matrix computed in 0.00 sec.                                                                             
                                                                                                                          
* Info * Kinetic energy matrix computed in 0.00 sec.                                                                      
                                                                                                                          
* Info * Nuclear potential matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Orthogonalization matrix computed in 0.00 sec.                                                                   
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>* Info * Restarting from checkpoint file: veloxchem_scf_2023-05-15T13.09.34.scf.h5                                        
                                                                                                                          
                                                                                                                          
               Iter. | Hartree-Fock Energy | Energy Change | Gradient Norm | Max. Gradient | Density Change               
               --------------------------------------------------------------------------------------------               
                  1       -95.724739415048    0.0000000000      5.28148132      1.26602289      0.00000000                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  2       -96.447251770784   -0.7225123557      1.28775994      0.20942739      0.73277939                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  3       -96.508840201458   -0.0615884307      0.08798008      0.01988639      0.19104619                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  4       -96.509196421834   -0.0003562204      0.01626179      0.00327620      0.01701992                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  5       -96.509231483788   -0.0000350620      0.00285999      0.00052555      0.00566536                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  6       -96.509232485076   -0.0000010013      0.00010250      0.00003847      0.00110714                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  7       -96.509232486360   -0.0000000013      0.00001338      0.00000395      0.00004150                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  8       -96.509232486370   -0.0000000000      0.00000063      0.00000011      0.00000278                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
* Info * Checkpoint written to file: veloxchem_scf_2023-05-15T13.09.34.scf.h5                                             
                                                                                                                          
* Info * SCF tensors written to file: veloxchem_scf_2023-05-15T13.09.34.scf.tensors.h5                                    
                                                                                                                          
               *** SCF converged in 8 iterations. Time: 0.17 sec.                                                         
                                                                                                                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Spin-Unrestricted Hartree-Fock:                                                                            
               -------------------------------                                                                            
               Total Energy                       :      -96.5092324864 a.u.                                              
               Electronic Energy                  :      -96.5092324864 a.u.                                              
               Nuclear Repulsion Energy           :        0.0000000000 a.u.                                              
               ------------------------------------                                                                       
               Gradient Norm                      :        0.0000006335 a.u.                                              
                                                                                                                          
                                                                                                                          
               Ground State Information                                                                                   
               ------------------------                                                                                   
               Charge of Molecule            :  1.0                                                                       
               Magnetic Quantum Number (M_S) :  0.5                                                                       
               Expectation value of S**2     :  0.7549                                                                    
                                                                                                                          
                                                                                                                          
                                             Spin Unrestricted Alpha Orbitals                                             
                                             --------------------------------                                             
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:  -37.33903 a.u.                                                                  
               (   1 Ne  1s  :    -1.04)                                                                                  
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -2.94250 a.u.                                                                  
               (   1 Ne  2s  :     0.68) (   1 Ne  3s  :     0.39)                                                        
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.86722 a.u.                                                                  
               (   1 Ne  1p+1:     0.71) (   1 Ne  1p0 :    -0.45) (   1 Ne  2p+1:     0.22)                              
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.86722 a.u.                                                                  
               (   1 Ne  1p+1:    -0.45) (   1 Ne  1p-1:     0.16) (   1 Ne  1p0 :    -0.70)                              
               (   1 Ne  2p0 :    -0.21)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.86722 a.u.                                                                  
               (   1 Ne  1p-1:    -0.83) (   1 Ne  1p0 :    -0.16) (   1 Ne  2p-1:    -0.25)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.89666 a.u.                                                                  
               (   1 Ne  1p+1:     0.66) (   1 Ne  1p0 :    -0.38) (   1 Ne  2p+1:    -0.96)                              
               (   1 Ne  2p0 :     0.55)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.89666 a.u.                                                                  
               (   1 Ne  1p+1:     0.31) (   1 Ne  1p-1:    -0.58) (   1 Ne  1p0 :     0.39)                              
               (   1 Ne  2p+1:    -0.45) (   1 Ne  2p-1:     0.84) (   1 Ne  2p0 :    -0.57)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.89666 a.u.                                                                  
               (   1 Ne  1p+1:    -0.24) (   1 Ne  1p-1:    -0.49) (   1 Ne  1p0 :    -0.54)                              
               (   1 Ne  2p+1:     0.34) (   1 Ne  2p-1:     0.71) (   1 Ne  2p0 :     0.78)                              
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.25223 a.u.                                                                  
               (   1 Ne  1s  :     0.50) (   1 Ne  2s  :     1.45) (   1 Ne  3s  :    -1.56)                              
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    4.43099 a.u.                                                                  
               (   1 Ne  1d+1:     0.43) (   1 Ne  1d+2:    -0.86) (   1 Ne  1d0 :    -0.27)                              
                                                                                                                          
                                             Spin Unrestricted Beta Orbitals                                              
                                             -------------------------------                                              
                                                                                                                          
               Molecular Orbital No.   1:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -2.79165 a.u.                                                                  
               (   1 Ne  2s  :     0.63) (   1 Ne  3s  :     0.45)                                                        
                                                                                                                          
               Molecular Orbital No.   2:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.77472 a.u.                                                                  
               (   1 Ne  1p+1:     0.23) (   1 Ne  1p0 :     0.79) (   1 Ne  2p0 :     0.28)                              
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.77472 a.u.                                                                  
               (   1 Ne  1p-1:    -0.81) (   1 Ne  2p-1:    -0.29)                                                        
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.77472 a.u.                                                                  
               (   1 Ne  1p+1:     0.78) (   1 Ne  1p0 :    -0.22) (   1 Ne  2p+1:     0.28)                              
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:  -31.22975 a.u.                                                                  
               (   1 Ne  1s  :    -1.00)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.94282 a.u.                                                                  
               (   1 Ne  1p0 :     0.78) (   1 Ne  2p+1:     0.16) (   1 Ne  2p-1:     0.18)                              
               (   1 Ne  2p0 :    -1.08)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.94282 a.u.                                                                  
               (   1 Ne  1p+1:    -0.77) (   1 Ne  2p+1:     1.07) (   1 Ne  2p-1:     0.20)                              
               (   1 Ne  2p0 :     0.19)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.94282 a.u.                                                                  
               (   1 Ne  1p+1:     0.16) (   1 Ne  1p-1:    -0.77) (   1 Ne  2p+1:    -0.23)                              
               (   1 Ne  2p-1:     1.07)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    1.35039 a.u.                                                                  
               (   1 Ne  1s  :     0.50) (   1 Ne  2s  :     1.48) (   1 Ne  3s  :    -1.55)                              
                                                                                                                          
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1"># Plot error from MO energies and delta-SCF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">err_koopman</span><span class="p">,</span> <span class="s2">&quot;bs&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">err_delta</span><span class="p">,</span> <span class="s2">&quot;ro&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s2">&quot;Koopmans&#39; theorem&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\Delta$SCF&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Error wrt experiment [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;CH$_4$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;NH$_3$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;H$_2$O&quot;</span><span class="p">,</span> <span class="s2">&quot;HF&quot;</span><span class="p">,</span> <span class="s2">&quot;Ne&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5cf7234b42a640dcf79143153281d59881ca0fe9e8772da460fd968b34758d5e.png" src="../../_images/5cf7234b42a640dcf79143153281d59881ca0fe9e8772da460fd968b34758d5e.png" />
</div>
</div>
<p>We see that the error from orbital energies is large (14.4-22.3 eV) and clearly scales with atomic number, while the error of <span class="math notranslate nohighlight">\(\Delta\)</span>SCF remains small (absolute error of 0.15-0.38 eV).</p>
</section>
<section id="including-relaxation-with-wave-function-methods">
<h3>Including relaxation with wave-function methods<a class="headerlink" href="#including-relaxation-with-wave-function-methods" title="Permalink to this headline">#</a></h3>
<p>Considering the X-ray absorption and emission spectrum of water, the error of ADC(<em>n</em>) calculations with respect to experimental measurements can be considered:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently using <a class="reference external" href="https://pyscf.org/">pyscf</a> – this will be updated.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create pyscf mol object</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">water_xyz</span>
<span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="s2">&quot;unc-6-31G&quot;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="c1"># Perform restricted SCF calculation</span>
<span class="n">scf_gs</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">scf_gs</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="c1"># Perform CVS-ADC calculations</span>
<span class="n">xas_adc1</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc1</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xas_adc2</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc2</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xas_adc2x</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc2x</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xas_adc3</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc3</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Perform unrestricted SCF calculation</span>
<span class="n">scf_gs</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">scf_gs</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="c1"># Copy molecular orbitals</span>
<span class="n">mo0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">scf_gs</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
<span class="n">occ0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">scf_gs</span><span class="o">.</span><span class="n">mo_occ</span><span class="p">)</span>

<span class="c1"># Create 1s core-hole by setting alpha_0 population to zero</span>
<span class="n">occ0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1"># Perform unrestricted SCF calculation with MOM constraint</span>
<span class="n">scf_ion</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">mom_occ</span><span class="p">(</span><span class="n">scf_ion</span><span class="p">,</span> <span class="n">mo0</span><span class="p">,</span> <span class="n">occ0</span><span class="p">)</span>
<span class="n">scf_ion</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>

<span class="c1"># Perform ADC calculations</span>
<span class="n">xes_adc1</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">adc1</span><span class="p">(</span><span class="n">scf_ion</span><span class="p">,</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xes_adc2</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">adc2</span><span class="p">(</span><span class="n">scf_ion</span><span class="p">,</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xes_adc2x</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">adc2x</span><span class="p">(</span><span class="n">scf_ion</span><span class="p">,</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xes_adc3</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">adc3</span><span class="p">(</span><span class="n">scf_ion</span><span class="p">,</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Plotting the errors compared to experiment (given as a dashed line), and the variations in oscillator strength:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;XAS energy&quot;</span><span class="p">)</span>
<span class="n">expt</span><span class="p">,</span> <span class="n">rel</span> <span class="o">=</span> <span class="mf">534.00</span><span class="p">,</span> <span class="mf">0.37</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">au2ev</span> <span class="o">*</span> <span class="n">xas_adc1</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">au2ev</span> <span class="o">*</span> <span class="n">xas_adc2</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">au2ev</span> <span class="o">*</span> <span class="n">xas_adc2x</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">au2ev</span> <span class="o">*</span> <span class="n">xas_adc3</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Error wrt experiment [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="s2">&quot;ADC(1)&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(3/2)&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;XAS oscillator strength&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xas_adc1</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xas_adc2</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">xas_adc2x</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">xas_adc3</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Absolute oscillator strength&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="s2">&quot;ADC(1)&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(3/2)&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;XES energy&quot;</span><span class="p">)</span>
<span class="n">expt</span><span class="p">,</span> <span class="n">rel</span> <span class="o">=</span> <span class="mf">527.10</span><span class="p">,</span> <span class="mf">0.37</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">au2ev</span> <span class="o">*</span> <span class="n">xes_adc1</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">au2ev</span> <span class="o">*</span> <span class="n">xes_adc2</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">au2ev</span> <span class="o">*</span> <span class="n">xes_adc2x</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="n">au2ev</span> <span class="o">*</span> <span class="n">xes_adc3</span><span class="o">.</span><span class="n">excitation_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rel</span> <span class="o">-</span> <span class="n">expt</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Error wrt experiment [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="s2">&quot;ADC(1)&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(3/2)&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;XES oscillator strength&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xes_adc1</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xes_adc2</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">xes_adc2x</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">xes_adc3</span><span class="o">.</span><span class="n">oscillator_strength</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Absolute oscillator strength&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="s2">&quot;ADC(1)&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(2)&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(2)-x&quot;</span><span class="p">,</span> <span class="s2">&quot;ADC(3/2)&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="xray-adc">
<a class="reference internal image-reference" href="../../_images/xray_adc.svg"><img alt="../../_images/xray_adc.svg" height="414" src="../../_images/xray_adc.svg" width="691" /></a>
</figure>
<p>As can be seen, the smallest discrepancy for XAS is observed for CVS-ADC(2)-x, and for XES it is here for ADC(3/2). In general, it has been observed that CVS-ADC(2)-x performs best for <a class="reference external" href="https://aip.scitation.org/doi/10.1063/1.4921841">XAS</a>, and ADC(2) for <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jctc.8b01046">XES</a> (in terms of absolute energies - for relative features ADC(2)-x performs a bit <a class="reference external" href="https://doi.org/10.26434/chemrxiv-2022-vllwh-v2">better</a>). As ADC(3/2) is correct in higher order of perturbation theory and performs well for valence excitations, it could be expected to also perform best for core properties. The fact that this is not the case has <a class="reference external" href="https://aip.scitation.org/doi/10.1063/1.4921841">been</a> <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jctc.8b01046">discussed</a> as being due to balancing in relaxation effects, which are highly influential for core properties and vary significantly between XAS and XES.</p>
<p>Furthermore, we see that the oscillator strengths vary greatly for XAS <span class="math notranslate nohighlight">\(-\)</span> in particular when comparing CVS-ADC(1) to higher orders of theory <span class="math notranslate nohighlight">\(-\)</span> but not very much for XES.</p>
</section>
<section id="including-relaxation-with-dft-based-methods">
<h3>Including relaxation with DFT-based methods<a class="headerlink" href="#including-relaxation-with-dft-based-methods" title="Permalink to this headline">#</a></h3>
<p>When using a <span class="math notranslate nohighlight">\(\Delta\)</span>KS approach, relaxation is explicitly accounted for, as discussed <a class="reference internal" href="#sec-xray-delta-rel"><span class="std std-ref">above</span></a>. By contrast, TDDFT is a single-excitation theory which cannot properly account for relaxation (which requires doubly-excited configuration in a response theory framework), although it can be partially accounted for through some separate correction scheme. The error introduced by a lack of relaxation will furthermore be counteracted by the self-interaction error, as is discussed <a class="reference internal" href="#sec-xray-topics-sie"><span class="std std-ref">below</span></a>.</p>
</section>
</section>
<section id="relativity">
<span id="sec-xray-topics-rel"></span><h2>Relativity<a class="headerlink" href="#relativity" title="Permalink to this headline">#</a></h2>
<p>Relativistic effects are significantly stronger for core than valence MOs, on account of the strong potential experienced by the core orbitals. These effects mainly influences calculated properties in two separate manners:</p>
<ol class="arabic simple">
<li><p>Scalar relativistic effects, which are always present and lead to a contraction (and thus increase in binding energy) of core orbitals. Higher lying orbitals (especially for <span class="math notranslate nohighlight">\(l&gt;1\)</span>) can become decontracted due to increasing screening from contracted MOs, but this effect is typically much smaller than for, <em>e.g.</em>, 1s orbitals</p></li>
<li><p>Spin-orbit coupling, which breaks degeneracies for MOs of <span class="math notranslate nohighlight">\(l&gt;0\)</span> and is thus negligible for, <em>e.g.</em>, the <span class="math notranslate nohighlight">\(K\)</span>- and <span class="math notranslate nohighlight">\(L_1\)</span>-edges (as the splitting for valence MOs is much smaller), but very important for, <em>e.g.</em>, the <span class="math notranslate nohighlight">\(L_{2,3}\)</span>-edge</p></li>
</ol>
<section id="scalar-relativistic-effects">
<h3>Scalar relativistic effects<a class="headerlink" href="#scalar-relativistic-effects" title="Permalink to this headline">#</a></h3>
<p>Including scalar relativistic effects is relatively straightforward, as a number of Hamiltonians are available which can include these effects in a 1-component framework. Furthermore, the effects are typically quite stable over the separate elements, and can thus often be considered as a common absolute off-set in energy. It should be noted that the (scalar) relativistic effects are technically not additive with electron correlation, such that a proper consideration should account for both simultaneously. In practice, this discrepancy is small and relativistic shifts from lower levels of theory are typically sufficient.</p>
</section>
<section id="spin-orbit-coupling">
<h3>Spin-orbit coupling<a class="headerlink" href="#spin-orbit-coupling" title="Permalink to this headline">#</a></h3>
<p>Including the spin-orbit effects is more complicated, and can either be</p>
<ul class="simple">
<li><p>Included by using 4-component relativistic theory, where they do not need to explicitly addressed</p></li>
<li><p>Included in a non-relativistic approach through a perturbative scheme, or through some <em>ad hoc</em> correction</p></li>
</ul>
<p>At the present stage, including spin-orbit effects is beyond the scope of this tutorial.</p>
</section>
</section>
<section id="basis-set-considerations">
<span id="sec-xray-topics-basis"></span><h2>Basis set considerations<a class="headerlink" href="#basis-set-considerations" title="Permalink to this headline">#</a></h2>
<p>The basis set requirements of X-ray spectrum calculations depend on which spectroscopy is considered</p>
<ul class="simple">
<li><p>XPS and XES probe occupied states, and thus need a good description of those</p></li>
<li><p>XAS and RIXS probe excited states, and thus need an improved description of this region</p></li>
</ul>
<p>In all cases the relaxation due to the creation of a core-hole needs to be accommodated, which yields requirements of reasonable flexibility of the core and inner valence region. This is not usually the case for standard basis sets, as they are typically constructed with valence properties in mind and thus have a minimal or close to minimal description of the core region. A number of approaches for improving such valence-focused basis sets have been developed by:</p>
<ol class="arabic simple">
<li><p>Augmenting the Dunning basis sets with core-polarizing functions, <em>e.g.</em> cc-pV<em>n</em>Z <span class="math notranslate nohighlight">\(\rightarrow\)</span> cc-pCV<em>n</em>Z</p></li>
<li><p>Adding extra flexibility by performing full or partial decontraction, such as</p>
<ol class="arabic simple">
<li><p>Decontracting 1s of the probed element (<em>e.g.</em> u6-311++G**, which is based on 6-311++G**)</p></li>
<li><p>Fully decontracting the basis set (<em>e.g.</em> un6-311++G**, which is based on 6-311++G**)</p></li>
</ol>
</li>
<li><p>Using basis functions from the next element, as inspired by the <span class="math notranslate nohighlight">\(Z+1\)</span> approximation</p></li>
</ol>
<p>As an illustration, we consider the IE of water with different basis sets and levels of theory</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently using <a class="reference external" href="https://pyscf.org/">pyscf</a> – this will be updated.</p>
</div>
<p><em>Toggle for u6-311G**, un6-311G**, and 6-311G** (Z+1) basis sets.</em></p>
<div class="toggle docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>

<span class="n">u6311gss</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="n">gto</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">O    S</span>
<span class="s1">   8588.500                  1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">   1297.230                  1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">    299.2960                 1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">     87.37710                1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">     25.67890                1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">      3.740040               1.000000 </span>
<span class="s1">O    SP</span>
<span class="s1">     42.11750                0.113889               0.0365114</span>
<span class="s1">      9.628370               0.920811               0.237153</span>
<span class="s1">      2.853320              -0.00327447             0.819702</span>
<span class="s1">O    SP</span>
<span class="s1">      0.905661               1.000000               1.000000</span>
<span class="s1">O    SP</span>
<span class="s1">      0.255611               1.000000               1.000000</span>
<span class="s1">O    D</span>
<span class="s1">      1.292                  1.000000</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;6-311G**&#39;</span><span class="p">}</span>
<span class="n">un6311gss</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="n">gto</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">O    S</span>
<span class="s1">   8588.500                  1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">   1297.230                  1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">    299.2960                 1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">     87.37710                1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">     25.67890                1.000000 </span>
<span class="s1">O    S</span>
<span class="s1">      3.740040               1.000000 </span>
<span class="s1">O    SP</span>
<span class="s1">     42.11750                1.000000               1.000000</span>
<span class="s1">O    SP</span>
<span class="s1">      9.628370               1.000000               1.000000</span>
<span class="s1">O    SP</span>
<span class="s1">      2.853320               1.000000               1.000000</span>
<span class="s1">O    SP</span>
<span class="s1">      0.905661               1.000000               1.000000</span>
<span class="s1">O    SP</span>
<span class="s1">      0.255611               1.000000               1.000000</span>
<span class="s1">O    D</span>
<span class="s1">      1.292                  1.000000</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;6-311G**&#39;</span><span class="p">}</span>
<span class="n">z6311gss</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="n">gto</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">O    S</span>
<span class="s1">   8588.500                  0.00189515</span>
<span class="s1">   1297.230                  0.0143859</span>
<span class="s1">    299.2960                 0.0707320</span>
<span class="s1">     87.37710                0.2400010</span>
<span class="s1">     25.67890                0.5947970</span>
<span class="s1">      3.740040               0.2808020</span>
<span class="s1">O    SP</span>
<span class="s1">     42.11750                0.113889               0.0365114</span>
<span class="s1">      9.628370               0.920811               0.237153</span>
<span class="s1">      2.853320              -0.00327447             0.819702</span>
<span class="s1">O    SP</span>
<span class="s1">      0.905661               1.000000               1.000000</span>
<span class="s1">O    SP</span>
<span class="s1">      0.255611               1.000000               1.000000</span>
<span class="s1">O    D</span>
<span class="s1">      1.292                  1.000000</span>
<span class="s1">O    S</span>
<span class="s1">  11427.10                   0.00180093</span>
<span class="s1">   1722.350                  0.0137419</span>
<span class="s1">    395.7460                 0.0681334</span>
<span class="s1">    115.1390                 0.2333250</span>
<span class="s1">     33.60260                0.5890860</span>
<span class="s1">      4.919010               0.2995050</span>
<span class="s1">O    SP</span>
<span class="s1">     55.44410                0.114536               0.0354609</span>
<span class="s1">     12.63230                0.920512               0.237451</span>
<span class="s1">      3.717560              -0.00337804             0.820458</span>
<span class="s1">O    SP</span>
<span class="s1">      1.165450               1.000000               1.000000</span>
<span class="s1">O    SP</span>
<span class="s1">      0.321892               1.000000               1.000000</span>
<span class="s1">O    D</span>
<span class="s1">      1.750                  1.000000</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;6-311G**&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Investigated basis sets</span>
<span class="n">basis_sets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;6-311G**&quot;</span><span class="p">,</span>
    <span class="n">u6311gss</span><span class="p">,</span>
    <span class="n">un6311gss</span><span class="p">,</span>
    <span class="n">z6311gss</span><span class="p">,</span>
    <span class="s2">&quot;cc-pVDZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pCVDZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pVTZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pCVTZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pVQZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pCVQZ&quot;</span><span class="p">,</span>
<span class="p">]</span>


<span class="c1"># Containers for IE calculated with four different delta calculations: HF, MP2, CCSD, and B3LYP</span>
<span class="n">ip_hf</span><span class="p">,</span> <span class="n">ip_mp2</span><span class="p">,</span> <span class="n">ip_ccsd</span><span class="p">,</span> <span class="n">ip_b3lyp</span><span class="p">,</span> <span class="n">n_bas</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">basis</span> <span class="ow">in</span> <span class="n">basis_sets</span><span class="p">:</span>
    <span class="c1"># Create pyscf mol object</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">water_xyz</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">basis</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="c1"># Unrestricted SCF calculation of neutral</span>
    <span class="n">scfres</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">scfres</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="c1"># Copy molecular orbitals and change population of 1s</span>
    <span class="n">mo0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">scfres</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
    <span class="n">occ0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">scfres</span><span class="o">.</span><span class="n">mo_occ</span><span class="p">)</span>
    <span class="n">occ0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1"># Unrestricted HF calculation of core-hole and appending delta_HF IP</span>
    <span class="n">scfion</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">mom_occ</span><span class="p">(</span><span class="n">scfion</span><span class="p">,</span> <span class="n">mo0</span><span class="p">,</span> <span class="n">occ0</span><span class="p">)</span>
    <span class="n">scfion</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="n">ip_hf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">au2ev</span> <span class="o">*</span> <span class="p">(</span><span class="n">scfion</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">()</span> <span class="o">-</span> <span class="n">scfres</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">()))</span>
    <span class="c1"># CCSD calculations of neutral and core-hole and appending delta_CCSD IP</span>
    <span class="n">ccsd_res</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">UCCSD</span><span class="p">(</span><span class="n">scfres</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">ccsd_ion</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">UCCSD</span><span class="p">(</span><span class="n">scfion</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">max_cycle</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    <span class="n">ip_ccsd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">au2ev</span> <span class="o">*</span> <span class="p">(</span><span class="n">ccsd_ion</span><span class="o">.</span><span class="n">e_tot</span> <span class="o">-</span> <span class="n">ccsd_res</span><span class="o">.</span><span class="n">e_tot</span><span class="p">))</span>
    <span class="c1"># Appending delta_MP2 IP</span>
    <span class="n">ip_mp2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">au2ev</span> <span class="o">*</span> <span class="p">(</span><span class="n">ccsd_ion</span><span class="o">.</span><span class="n">e_hf</span> <span class="o">+</span> <span class="n">ccsd_ion</span><span class="o">.</span><span class="n">emp2</span> <span class="o">-</span> <span class="p">(</span><span class="n">ccsd_res</span><span class="o">.</span><span class="n">e_hf</span> <span class="o">+</span> <span class="n">ccsd_res</span><span class="o">.</span><span class="n">emp2</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="c1"># Unrestricted KS-DFT calculation of neutral</span>
    <span class="n">scfres</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">scfres</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s2">&quot;b3lyp&quot;</span>
    <span class="n">scfres</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="c1"># Copy molecular orbitals and change population of 1s</span>
    <span class="n">mo0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">scfres</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
    <span class="n">occ0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">scfres</span><span class="o">.</span><span class="n">mo_occ</span><span class="p">)</span>
    <span class="n">occ0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1"># Unrestricted KS-DFT calculation of core-hole and appending delta_DFT IP</span>
    <span class="n">scfion</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">mom_occ</span><span class="p">(</span><span class="n">scfion</span><span class="p">,</span> <span class="n">mo0</span><span class="p">,</span> <span class="n">occ0</span><span class="p">)</span>
    <span class="n">scfion</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="s2">&quot;b3lyp&quot;</span>
    <span class="n">scfion</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="n">ip_b3lyp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">au2ev</span> <span class="o">*</span> <span class="p">(</span><span class="n">scfion</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">()</span> <span class="o">-</span> <span class="n">scfres</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">()))</span>
    <span class="c1"># Append basis set size</span>
    <span class="n">n_bas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scfres</span><span class="o">.</span><span class="n">mo_occ</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># Plot IEs, with error as a function of basis set size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_bas</span><span class="p">,</span> <span class="n">ip_hf</span><span class="p">,</span> <span class="s2">&quot;r*&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_bas</span><span class="p">,</span> <span class="n">ip_mp2</span><span class="p">,</span> <span class="s2">&quot;bv&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_bas</span><span class="p">,</span> <span class="n">ip_ccsd</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_bas</span><span class="p">,</span> <span class="n">ip_b3lyp</span><span class="p">,</span> <span class="s2">&quot;go&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s2">&quot;HF&quot;</span><span class="p">,</span> <span class="s2">&quot;MP2&quot;</span><span class="p">,</span> <span class="s2">&quot;CCSD&quot;</span><span class="p">,</span> <span class="s2">&quot;B3LYP&quot;</span><span class="p">,</span> <span class="s2">&quot;Expt&quot;</span><span class="p">,</span> <span class="s2">&quot;Expt - 0.37 eV&quot;</span><span class="p">))</span>

<span class="c1"># Experimental value as a dotted line, minus relativistic effect as dashed line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">n_bas</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_bas</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mf">539.9</span><span class="p">,</span> <span class="mf">539.9</span><span class="p">],</span> <span class="s2">&quot;k:&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">n_bas</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_bas</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mf">539.9</span> <span class="o">-</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">539.9</span> <span class="o">-</span> <span class="mf">0.37</span><span class="p">],</span> <span class="s2">&quot;k--&quot;</span><span class="p">)</span>

<span class="c1"># Basis set label as x-ticks</span>
<span class="n">basis_set_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;6-311G**&quot;</span><span class="p">,</span>
    <span class="s2">&quot;u6-311G**&quot;</span><span class="p">,</span>
    <span class="s2">&quot;un6-311G**&quot;</span><span class="p">,</span>
    <span class="s2">&quot;6-311G** (Z+1)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pVDZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pCVDZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pVTZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pCVTZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pVQZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cc-pCVQZ&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">n_bas</span><span class="p">,</span> <span class="n">basis_set_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Labels and setting x-interval</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Ionization energy [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">n_bas</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_bas</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="basis-xps">
<img alt="../../_images/basis_xps.svg" src="../../_images/basis_xps.svg" /></figure>
<p>At the HF and KS-DFT levels of theory we see that some of the smaller basis sets have fortuitous error cancellations, such that both 6-311G** and cc-pVTZ yield results close to experimental values. However, augmenting these basis sets with more functions in the core region brings us away from experimental measurements (note that the calculations do not include relativistic effects, so the comparison would be toward experiment minus relativistic shift, <em>i.e.</em> the dashed line).</p>
<p>With MP2 and CCSD we note very similar results for the smaller basis sets, which then deviate significantly for cc-pVTZ and above. <span class="math notranslate nohighlight">\(\Delta\)</span>CCSD estimates using core-polarized cc-pVTZ and cc-pVQZ are well in line with experimental measurements. Augmenting the 6-311G** basis sets with a decontracted core region (u6-311G**) yields some improvement at a relatively low increase in computational cost, and further decontracting the full set (un6-311G**) or adding basis functions from <span class="math notranslate nohighlight">\(Z+1\)</span> (6-311G** (Z+1)) provides some additional improvement.</p>
</section>
<section id="self-interaction-error-in-dft">
<span id="sec-xray-topics-sie"></span><h2>Self-interaction error in DFT<a class="headerlink" href="#self-interaction-error-in-dft" title="Permalink to this headline">#</a></h2>
<p>For a single-electron systems the following equality should hold for the two-electron terms:</p>
<div class="math notranslate nohighlight">
\[
J[\rho] + E_{xc} [\rho] = 0
\]</div>
<p>This cancellation is preserved within HF theory, but for any approximate functionals in KS-DFT the equality will no longer hold, resulting in the potentially significant errors due to spurious self-interactions. Reformulated, the Coulomb self-repulsion of each electron included in the Coulomb operator is exactly canceled by the nonlocal exchange self-attraction in Hartree-Fock, but this is no longer the case when the exchange operator is replaced by an approximate exchange functional.</p>
<p>As such, KS-DFT possess a self-interaction error (SIE), which shows a strong dependence on how compact the respective MOs are. This means that the self-interaction error is significantly more influential for core properties than for valence properties, and the tendency to decontract core orbitals due to the SIE has an opposite effect on transition energies as compared to relaxation effects.</p>
<p>Let us consider the ionization energy of water, as calculated with MO energies and <span class="math notranslate nohighlight">\(\Delta\textrm{SCF}\)</span> using two different exchange-correlation functionals with variable HF exchange:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently using <a class="reference external" href="https://pyscf.org/">pyscf</a> – this will be updated.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using MO energies for TDHF and TDDFT yields the same IE as when addressing core-transitions to extremely diffuse basis functions (due to the lack of relaxation), and is thus representative of the error for such XAS calculations.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create pyscf mol object</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">water_xyz</span>
<span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="s2">&quot;6-31G&quot;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="c1"># Investigated HF exchange and result containers</span>
<span class="n">hf_exc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">hf_blyp</span><span class="p">,</span> <span class="n">hf_pbe</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]],</span> <span class="p">[[],</span> <span class="p">[]]</span>


<span class="k">def</span> <span class="nf">dft_delta</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">xc</span><span class="p">):</span>
    <span class="c1"># Neutral calculation</span>
    <span class="n">dft_res</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">dft_res</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span>
    <span class="n">dft_res</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="c1"># Core-hole calculation</span>
    <span class="n">mo0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dft_res</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
    <span class="n">occ0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dft_res</span><span class="o">.</span><span class="n">mo_occ</span><span class="p">)</span>
    <span class="n">occ0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">dft_ion</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UKS</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">dft_ion</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span>
    <span class="n">scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">mom_occ</span><span class="p">(</span><span class="n">dft_ion</span><span class="p">,</span> <span class="n">mo0</span><span class="p">,</span> <span class="n">occ0</span><span class="p">)</span>
    <span class="n">dft_ion</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">au2ev</span> <span class="o">*</span> <span class="n">dft_res</span><span class="o">.</span><span class="n">mo_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">au2ev</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">dft_ion</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">()</span> <span class="o">-</span> <span class="n">dft_res</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">()</span>
    <span class="p">)</span>


<span class="k">for</span> <span class="n">h_x</span> <span class="ow">in</span> <span class="n">hf_exc</span><span class="p">:</span>
    <span class="c1"># BxLYP (Slater exchange 0.08, except when HF i 1.00)</span>
    <span class="k">if</span> <span class="n">h_x</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="n">s_x</span> <span class="o">=</span> <span class="mf">0.00</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s_x</span> <span class="o">=</span> <span class="mf">0.08</span>
    <span class="n">b_x</span> <span class="o">=</span> <span class="mf">1.00</span> <span class="o">-</span> <span class="n">h_x</span> <span class="o">-</span> <span class="n">s_x</span>
    <span class="n">v_e</span><span class="p">,</span> <span class="n">v_l</span> <span class="o">=</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.81</span>
    <span class="n">xc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h_x</span><span class="si">:}</span><span class="s2"> * HF + </span><span class="si">{</span><span class="n">s_x</span><span class="si">:}</span><span class="s2"> * Slater + </span><span class="si">{</span><span class="n">b_x</span><span class="si">:}</span><span class="s2"> * B88, </span><span class="si">{</span><span class="n">v_l</span><span class="si">:}</span><span class="s2"> * LYP + </span><span class="si">{</span><span class="n">v_e</span><span class="si">:}</span><span class="s2"> * VWN&quot;</span>
    <span class="n">E_mo</span><span class="p">,</span> <span class="n">E_delta</span> <span class="o">=</span> <span class="n">dft_delta</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span>
    <span class="n">hf_blyp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_mo</span><span class="p">)</span>
    <span class="n">hf_blyp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_delta</span><span class="p">)</span>
    <span class="c1"># PBEx</span>
    <span class="n">p_x</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">h_x</span>
    <span class="n">xc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h_x</span><span class="si">:}</span><span class="s2"> * HF + </span><span class="si">{</span><span class="n">p_x</span><span class="si">:}</span><span class="s2"> * PBE, PBE&quot;</span>
    <span class="n">E_mo</span><span class="p">,</span> <span class="n">E_delta</span> <span class="o">=</span> <span class="n">dft_delta</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span>
    <span class="n">hf_pbe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_mo</span><span class="p">)</span>
    <span class="n">hf_pbe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_delta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1"># DFT ionization energies, including scalar relativistic shift</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hf_exc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hf_blyp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.37</span><span class="p">,</span> <span class="s2">&quot;bs--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hf_exc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hf_blyp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.37</span><span class="p">,</span> <span class="s2">&quot;ro--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hf_exc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hf_pbe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.37</span><span class="p">,</span> <span class="s2">&quot;d--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hf_exc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hf_pbe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.37</span><span class="p">,</span> <span class="s2">&quot;g^--&quot;</span><span class="p">)</span>

<span class="c1"># Experimental value and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">539.9</span><span class="p">,</span> <span class="mf">539.9</span><span class="p">],</span> <span class="s2">&quot;k-&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;BxLYP ($\Delta$SCF)&quot;</span><span class="p">,</span> <span class="s2">&quot;BxLYP (MO)&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;PBEx ($\Delta$SCF)&quot;</span><span class="p">,</span> <span class="s2">&quot;PBEx (MO)&quot;</span><span class="p">,</span> <span class="s2">&quot;Expt&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">1.025</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">508</span><span class="p">,</span> <span class="mf">562.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;HF exchange [%]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Ionization energy [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="xray-sie">
<a class="reference internal image-reference" href="../../_images/sie.svg"><img alt="../../_images/sie.svg" height="276" src="../../_images/sie.svg" width="414" /></a>
</figure>
<p>We see that the <span class="math notranslate nohighlight">\(\Delta\)</span>SCF errors are quite constant between the two base functionals and amounts of HF exchange, while the MO energies strongly scale with HF exchange, but not with the base functional. The total MO error is a function of two effects:</p>
<ol class="arabic simple">
<li><p>Lack of relaxation, which generally leads to an overestimation of IEs and core-excitation energies</p></li>
<li><p>Self-interaction, which by contrast leads to an underestimation of these energies</p></li>
</ol>
<p>For a typical exchange-correlation functional (<span class="math notranslate nohighlight">\(\sim\)</span>20-25% HF exchange) the SIE thus dominates, and by tuning the (global) HF exchange to around 60% we achieve IE estimates in good agreement to experiment. We note that this is only acheieved by cancellation of the above two errors, and does not mean that we have an appropriate description of the core-excitation processes. Furthermore, a good exchange-correlation functional should possess good energies <em>and</em> densities, and focusing on only energies can push us away from such a goal. Nevertheless, a number of tailored functionals with good absolute energies have been constructed, tuning the HF exchange either in a global or range-separated manner. Note that the parameterization will have to depend on the spectroscopy, probed edge, and row of the periodic table, as the exact balance in relaxation terms and SIE varies.</p>
</section>
<section id="core-hole-localization">
<span id="sec-xray-topics-chloc"></span><h2>Core-hole localization<a class="headerlink" href="#core-hole-localization" title="Permalink to this headline">#</a></h2>
<p>For <span class="math notranslate nohighlight">\(\Delta\)</span> SCF calculations (either for estimating IEs or as a initial state for XES), a core-hole is created at some atomic site. For many systems, this is unproblematic, but if chemically equivalent atoms are present, the MOs are delocalized over these sites. Performing a straightforward <span class="math notranslate nohighlight">\(\Delta\)</span>SCF calculation will then results in a delocalized core-hole, as illustrated below for ethene:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently using <a class="reference external" href="https://pyscf.org/">pyscf</a> – this will be updated.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ethene_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C0      0.6660048050     0.0000000000    -0.0000000000</span>
<span class="s2">C1     -0.6660048050    -0.0000000000     0.0000000000</span>
<span class="s2">H       1.2278735620     0.9228358077    -0.0000000000</span>
<span class="s2">H       1.2278735620    -0.9228358077    -0.0000000000</span>
<span class="s2">H      -1.2278735620     0.9228358077     0.0000000000</span>
<span class="s2">H      -1.2278735620    -0.9228358077     0.0000000000</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">Koopman_vs_delta</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">ecp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># Create pyscf mol object</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">molecule</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">basis</span>
    <span class="k">if</span> <span class="n">ecp</span><span class="p">:</span>
        <span class="n">mol</span><span class="o">.</span><span class="n">ecp</span> <span class="o">=</span> <span class="n">ecp</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="c1"># Perform unrestricted SCF calculation</span>
    <span class="n">scf_gs</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">scf_gs</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="c1"># Copy molecular orbitals</span>
    <span class="n">mo0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">scf_gs</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
    <span class="n">occ0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">scf_gs</span><span class="o">.</span><span class="n">mo_occ</span><span class="p">)</span>
    <span class="c1"># Create 1s core-hole by setting alpha_0 population to zero</span>
    <span class="n">occ0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1"># Perform unrestricted SCF calculation with MOM constraint</span>
    <span class="n">scf_ion</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">scf</span><span class="o">.</span><span class="n">addons</span><span class="o">.</span><span class="n">mom_occ</span><span class="p">(</span><span class="n">scf_ion</span><span class="p">,</span> <span class="n">mo0</span><span class="p">,</span> <span class="n">occ0</span><span class="p">)</span>
    <span class="n">scf_ion</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
    <span class="c1"># Return MO energy and deltaSCF</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">au2ev</span> <span class="o">*</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">mo_energy</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">au2ev</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">scf_ion</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">()</span> <span class="o">-</span> <span class="n">scf_gs</span><span class="o">.</span><span class="n">energy_tot</span><span class="p">()</span>
    <span class="p">)</span>


<span class="c1"># All-electron calculation of IP</span>
<span class="n">delta_all</span> <span class="o">=</span> <span class="n">Koopman_vs_delta</span><span class="p">(</span><span class="n">ethene_xyz</span><span class="p">,</span> <span class="s2">&quot;unc-6-31G&quot;</span><span class="p">)</span>

<span class="c1"># IE calculation with ECP on one carbon</span>
<span class="n">delta_ecp</span> <span class="o">=</span> <span class="n">Koopman_vs_delta</span><span class="p">(</span><span class="n">ethene_xyz</span><span class="p">,</span> <span class="s2">&quot;unc-6-31G&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;C0&quot;</span><span class="p">:</span> <span class="s2">&quot;stuttgart&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="c1"># IE estimates with all-electron (delocalized core-hole)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">delta_all</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.11</span><span class="p">,</span> <span class="n">delta_all</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.11</span><span class="p">],</span> <span class="s2">&quot;ro&quot;</span><span class="p">)</span>

<span class="c1"># IE estimates with ECP (localized core-hole)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">delta_ecp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.11</span><span class="p">,</span> <span class="n">delta_ecp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.11</span><span class="p">],</span> <span class="s2">&quot;bs&quot;</span><span class="p">)</span>

<span class="c1"># Experiment and figure settings</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">290.80</span><span class="p">,</span> <span class="mf">290.80</span><span class="p">],</span> <span class="s2">&quot;k--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Ionization energy [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="s2">&quot;MO&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\Delta$SCF&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="xray-ch-loc">
<a class="reference internal image-reference" href="../../_images/ch_loc.svg"><img alt="../../_images/ch_loc.svg" height="207" src="../../_images/ch_loc.svg" width="345" /></a>
</figure>
<p>As can be seen, the errors from MO energies are very similar for the all-electron calculation (with a delocalized core-hole) and using ECP (delocalized core-hole). For the <span class="math notranslate nohighlight">\(\Delta\)</span>SCF calculation, however, only approximately half the relaxation energy is accounted for using a delocalized core-hole. Such a discrepancy for delocalized calculations of IEs has been noted <a class="reference external" href="https://doi.org/10.1063/1.1676850">previously</a>, and it has been <a class="reference external" href="https://doi.org/10.1063/1.433763">associated</a> with missing correlation effects which are required to properly correct the delocalized calculation. Within a full CI scheme, delocalization will no longer be an issue (and it will capture the small shift in energy between the gerade and ungerade core-hole).</p>
<p>Moving from theory, in experiment the localizatio/delocalization of core-holes is primarily relevant for diatomic systems, as other compounds will possess vibrational effects which break the symmetry. For diatomic systems the localized/delocalized nature of the core-hole has been seen to depend on the details of the measurement, such that both can be probed [ref].</p>
<p>As such, for practical calculation we <a class="reference external" href="https://doi.org/10.1063/5.0088195">recommend</a> that core-holes are localized for IE and XES calculations. For XAS it does not provide any issues for linear response methods (provided that both gerade and ungerade MOs are kept in the CVS space/equivalent), but for state-specific approaches this will again be an issue (<em>e.g.</em> STEX and TP-DFT).</p>
</section>
<section id="tailored-cvs">
<span id="sec-xray-topics-tailcvs"></span><h2>Tailored CVS<a class="headerlink" href="#tailored-cvs" title="Permalink to this headline">#</a></h2>
<p>For large systems, it may become relevant to tailor the CVS space such that each chemically unique atom is probed in turn. While this requires explicit consideration of each set of unique MOs separately, it serves dual purposes which can make it worth it:</p>
<ol class="arabic simple">
<li><p>It lowers the dimensionality of the involved matrices, and thus decrease computational costs</p></li>
<li><p>The density-of-states decrease, which means that the same energy region can be resolved with a few states per unique MO, rather than having to converge a large number of eigenstates simultaneously</p></li>
</ol>
<p>While this technically does not fulfill one of foundations on which the CVS approximation is built (the MOs are not energetically well-separated), the spatial separation means that it will typically work. As an example, we consider ethene (which has delocalized MOs) and vinylfluoride (which does not):</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently using <a class="reference external" href="https://pyscf.org/">pyscf</a> – this will be updated.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vinyl_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"> C     0.000000    -0.246412    -1.271068</span>
<span class="s2"> C     0.000000     0.457081    -0.154735</span>
<span class="s2"> F     0.000000    -0.119195     1.052878</span>
<span class="s2"> H     0.000000     0.272328    -2.210194</span>
<span class="s2"> H     0.000000    -1.319906    -1.249847</span>
<span class="s2"> H     0.000000     1.530323    -0.095954</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ethene&quot;</span><span class="p">)</span>
<span class="c1"># Create pyscf mol object</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">ethene_xyz</span>
<span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="s2">&quot;6-31G&quot;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="c1"># Perform restricted SCF calculation</span>
<span class="n">scf_gs</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">scf_gs</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="c1"># Perform CVS-ADC calculations</span>
<span class="n">ethene_adc1_0</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc1</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ethene_adc1_1</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc1</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ethene_adc1_01</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc1</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ethene_adc2_0</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc2</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ethene_adc2_1</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc2</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ethene_adc2_01</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc2</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vinylfluoride&quot;</span><span class="p">)</span>
<span class="c1"># Create pyscf mol object</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">vinyl_xyz</span>
<span class="n">mol</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="s2">&quot;6-31G&quot;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="c1"># Perform restricted SCF calculation</span>
<span class="n">scf_gs</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">scf_gs</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="c1"># Perform CVS-ADC calculations</span>
<span class="n">vinyl_adc1_1</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc1</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">vinyl_adc1_2</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc1</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">vinyl_adc1_12</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc1</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">vinyl_adc2_1</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc2</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">vinyl_adc2_2</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc2</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">vinyl_adc2_12</span> <span class="o">=</span> <span class="n">adcc</span><span class="o">.</span><span class="n">cvs_adc2</span><span class="p">(</span><span class="n">scf_gs</span><span class="p">,</span> <span class="n">n_singlets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">core_orbitals</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># Ethene with CVS-ADC(1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Ethene&quot;</span><span class="p">)</span>
<span class="n">ethene_adc1_0</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MO #0&quot;</span><span class="p">)</span>
<span class="n">ethene_adc1_1</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MO #1&quot;</span><span class="p">)</span>
<span class="n">ethene_adc1_01</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MOs #0-1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CVS-ADC(1)&quot;</span><span class="p">)</span>

<span class="c1"># Vinylfluoride with CVS-ADC(1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Vinylfluoride&quot;</span><span class="p">)</span>
<span class="n">vinyl_adc1_1</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MO #1&quot;</span><span class="p">)</span>
<span class="n">vinyl_adc1_2</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MO #2&quot;</span><span class="p">)</span>
<span class="n">vinyl_adc1_12</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MO #1-2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Ethene with CVS-ADC(2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">ethene_adc2_0</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">()</span>
<span class="n">ethene_adc2_1</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">()</span>
<span class="n">ethene_adc2_01</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CVS-ADC(2)&quot;</span><span class="p">)</span>

<span class="c1"># Vinylfluoride with CVS-ADC(2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">vinyl_adc2_1</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">()</span>
<span class="n">vinyl_adc2_2</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">()</span>
<span class="n">vinyl_adc2_12</span><span class="o">.</span><span class="n">plot_spectrum</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="xray-adc-cvs">
<a class="reference internal image-reference" href="../../_images/adc_cvs.svg"><img alt="../../_images/adc_cvs.svg" height="414" src="../../_images/adc_cvs.svg" width="691" /></a>
</figure>
<p>We see that considering each MO in turn works well for vinylfluoride, where the two carbon 1s are localized, but not for ethene, where they are delocalized. Including or not including fluorine here makes little difference, as that MO is both energetically and spatially well separated from the carbon 1s.</p>
<p>Note that the delocalization <a class="reference external" href="https://doi.org/10.1063/5.0088195">might</a> not be immediatelly apparent, as just visually looking at the molecule and concluding which atoms are unique might not be sufficient. Care should be taken for larger systems, and explicitly looking at the MOs is advised. Alternatively, using ECPs to localize the core-hole and then restricting the CVS space accordingly will avoid this issue.</p>
</section>
<section id="post-hf-on-a-non-aufbau-reference">
<span id="sec-xray-topics-nonaufbau"></span><h2>Post-HF on a non-Aufbau reference<a class="headerlink" href="#post-hf-on-a-non-aufbau-reference" title="Permalink to this headline">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Include a discussion on the potential issues in using post-HF methods for a non-<em>Aufbau</em> reference state, as can be seen by noting the MP2 energy denominator (and potential singularities, and discusses <a class="reference external" href="https://doi.org/10.1039/D2CP00584K">here</a>)</p></li>
<li><p>Include explicit example:</p>
<ol class="arabic simple">
<li><p>Go over all permutations (aa, ab, bb), saving the highest MO index which yields denominators below 0.1 au. Just have a list of virtual indices, adding when an index is not already found there. Do this in one shot, instead of saving one virtual at a time.</p></li>
<li><p>Compare this to the scheme in adcc, noting that the present (simpler) scheme is likely just as useful - despite not ordering indices by how problematic they are.</p></li>
<li><p>Use this to calculate the ADC(2)/cc-pCVQZ spectra of ammonia, with and without frozen virtuals.</p></li>
</ol>
</li>
</ul>
</div>
</section>
<section id="spurious-valence-mixing-in-xas">
<span id="sec-xray-cons-spur-val"></span><h2>Spurious valence mixing in XAS<a class="headerlink" href="#spurious-valence-mixing-in-xas" title="Permalink to this headline">#</a></h2>
<p>Within a damped response theory framework or when performing explicit real-time propagation, a CVS-like scheme which separates core-transitions from the valence-continuum is usually not performed. If such calculations are run with an atom-centered basis set (as most are), this can then lead to spurious mixing with valence-excited states. What happens is that resonances in the valence-continuum occur close to core-excitations, leading to unphysical mixing which affects excitation energies and (more significantly) intensities. These issues occur both for methods featuring only single-excited configurations (<em>e.g.</em> TDDFT) and higher-excited configurations (<em>e.g.</em> ADC) and need to be avoided.</p>
<p>These issues have been observed for, <em>e.g.</em>, <span class="math notranslate nohighlight">\(L_{2,3}\)</span>-edge of silicon <span id="id1">[<a class="reference internal" href="../refs.html#id28" title="T. Fransson, D. Burdakova, and P. Norman. K- and L-edge X-ray absorption spectrum calculations of closed-shell carbon, silicon, germanium, and sulfur compounds using damped four-component density functional response theory. Phys. Chem. Chem. Phys., 18:13591-13603, 2016. URL: https://doi.org/10.1039/C6CP00561F.">FBN16</a>, <a class="reference internal" href="../refs.html#id49" title="M. Kadek, L. Konecny, B. Gao, M. Repisky, and K. Ruud. X-ray absorption resonances near L2,3-edges from real-time propagation of the Dirac–Kohn–Sham density matrix. Phys. Chem. Chem. Phys., 17:22566-22570, 2015. URL: https://doi.org/10.1039/C5CP03712C.">KKG+15</a>]</span>, and are usually more common at lower energies. They can be identified by studying the amplitudes and the <span class="math notranslate nohighlight">\(t^2\)</span> values for post-HF methods, and can be avoided by chosing appropriate basis sets, freezing certain virtual orbitals, or by re-introducing the CVS approximation (or some other flavour) within the CPP/RT framework. The latter approach is recommended at least for CPP-ADC, as converging the response vectors has otherwise been seen to be difficult <span id="id2">[<a class="reference internal" href="../refs.html#id79" title="D. R. Rehn, Z. Rinkevicius, M. Herbst, M. Li, X. Scheurer, M. Brand, A. L. Dempwolff, I. E. Brumboiu, T. Fransson, A. Dreuw, and P. Norman. Gator: a Python-driven program for spectroscopy simulations using correlated wave functions. WIREs Comput. Mol. Sci., 2021. URL: https://doi.org/10.1002/wcms.1528.">RRH+21</a>]</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="xray_analysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Spectrum analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="xray_large.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Larger systems</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation">Relaxation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation-of-core-ionized-systems">Relaxation of core-ionized systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation-of-core-de-excitation">Relaxation of core-(de)excitation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#including-relaxation-with-deltascf-methods">Including relaxation with <span class="math notranslate nohighlight">\(\Delta\)</span>SCF methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#including-relaxation-with-wave-function-methods">Including relaxation with wave-function methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#including-relaxation-with-dft-based-methods">Including relaxation with DFT-based methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relativity">Relativity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-relativistic-effects">Scalar relativistic effects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-orbit-coupling">Spin-orbit coupling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basis-set-considerations">Basis set considerations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-interaction-error-in-dft">Self-interaction error in DFT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-hole-localization">Core-hole localization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tailored-cvs">Tailored CVS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-hf-on-a-non-aufbau-reference">Post-HF on a non-Aufbau reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spurious-valence-mixing-in-xas">Spurious valence mixing in XAS</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The eChem team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>