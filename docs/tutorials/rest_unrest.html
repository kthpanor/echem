

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Restricted versus unrestricted &#8212; Computational Chemistry from  Laptop to HPC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-TX4YJ1J5XE"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/tutorials/rest_unrest';</script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Static versus dynamic correlation correlation" href="correlation.html" />
    <link rel="prev" title="Open shells" href="openshells.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../title.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics_notebook.html">Using Jupyter notebooks</a></li>







<li class="toctree-l2"><a class="reference internal" href="../units_notation.html">Units and notation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronic ground states</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/elstruct_gen.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/orbitals.html">Orbitals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/slater.html">Many-electron wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/operators.html">Operators and matrix elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/reduced_density.html">Reduced particle densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/natural_orbitals.html">Natural orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/spin.html">Electron spin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/correlation.html">Electron correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dispersion.html">Dispersion interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/pt.html">Rayleigh–Schrödinger perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/second_quant.html">Second quantization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/group_theory.html">Group theory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/wft.html">Wave function theory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../elec_struct/hartree-fock.html">Hartree–Fock</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_theory.html">Hartree–Fock theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_scf.html">SCF optimization</a></li>

<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_example.html">HF in VeloxChem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/ci.html">Configuration interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mp2.html">Møller–Plesset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcscf.html">Multiconfigurational methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/wft_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/dft.html">Density functional theory</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/hohenberg.html">Hohenberg–Kohn theorems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kohn-sham.html">Kohn–Sham method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kernel_int.html">Kernel integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_scf.html">SCF optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_prop.html">First-order properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/available_xcfun.html">Available XC functionals</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular structure and dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/molstruct_gen.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/coordinates.html">Choice of coordinates</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/gradients.html">Gradients</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/energy_grad.html">Energy gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/property_grad.html">Property gradients</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/hessians_vib.html">Hessians and vibrations</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/hessians.html">Molecular Hessians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/vibrations.html">Vibrational analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/opt.html">Structure optimization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_struct.html">Optimization methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_gs.html">Ground-state structure optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/tst.html">Transition-state theory</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/tst_gen.html">Transition state geometry optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/impes.html">PES interpolation techniques</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/impes_calc.html">Constructing the PES by interpolation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/md.html">Molecular dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/forcefields.html">Force fields</a></li>


<li class="toctree-l2"><a class="reference internal" href="../mol_struct/reparameterize.html">Reparameterize force fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/md_setup.html">Ensembles and time integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/md_run.html">Running a simulation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spectra and properties</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/spectra_aspects.html">General aspects</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/resp_external.html">Responses to external fields</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/mol_prop.html">Molecular properties</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/cubic_resp.html">Cubic response function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/quad_resp.html">Quadratic response function</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/elec_nuc.html">Electronic and nuclear contributions</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/rovib.html">Rovibronic states</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/selection_rules.html">Selection rules</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/expt_theory.html">Experiment to theory</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/opa.html">UV/vis absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/dichroism.html">Dichroism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tpa.html">Two-photon absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/birefring.html">Birefringence</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/tddft.html">TDDFT</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_basics.html">Foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_rpa.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/mr_response.html">Multireference response</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/ci_response.html">CI response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/sa_mcscf.html">State-averaged MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/mclr.html">Multiconfigurational linear response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/mr_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/adc.html">ADC</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_pp.html">Polarization propagator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_isr.html">Intermediate state representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_cvs.html">Core-valence separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_hpc.html">HPC-QC implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/adc_exercises_new.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/excoupl.html">Exciton coupling model</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/excoupl_impl.html">Implementation of the exciton coupling model</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/localprop.html">Localized properties</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/esp.html">ESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/resp.html">RESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/loprop.html">LoProp charges and polarisabilities</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/embedding.html">Embedding potentials</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/nonpol_emb.html">Non-polarizable embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/pol_emb.html">Polarizable embedding</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/mol_struct.html">Molecular structure and dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/struct_vis.html">Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/md_vis.html">MD trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/opt_vib_vis.html">Optimization and normal modes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/elec_struct.html">Electronic structure</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/orb_vis.html">Orbitals and densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/exc_vis.html">Excited states</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/spec_prop.html">Spectra and properties</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/broadening.html">Spectrum broadening</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials and workflows</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="workflow.html">Constructing workflows</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="wf_build.html">Building the system</a></li>

<li class="toctree-l2"><a class="reference internal" href="wf_struct.html">Optimizing molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_scf.html">Optimizing electronic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_construct.html">Assembling a full workflow</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="uv_vis.html">UV/vis spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_absorption.html">Absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_fluorescence.html">Fluorescence</a></li>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="uv_vis_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="vib_ir.html">Vibrational spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="vib_ir_calc.html">IR spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="vib_ir_raman.html">Raman spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="vib_ir_exercises.html">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="openshells.html">Open shells</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Restricted versus unrestricted</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlation.html">Static versus dynamic correlation correlation</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="xray.html">X-ray spectroscopies</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="xray_calc.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_analysis.html">Spectrum analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_aspects.html">Special aspects</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_large.html">Larger systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_nonstandard.html">Non-standard calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="xray_cheatsheet.html">Cheat sheet</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite and contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kthpanor/echem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/tutorials/rest_unrest.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/tutorials/rest_unrest.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Restricted versus unrestricted</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-spin-states">High spin states</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-reference-methods">Single-reference methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-reference-methods">Multi-reference methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#low-spin-states">Low spin states</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-reference-methods-broken-symmetry">Single-reference methods: broken symmetry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-reference-solution">Multi-reference solution</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="restricted-versus-unrestricted">
<h1>Restricted versus unrestricted<a class="headerlink" href="#restricted-versus-unrestricted" title="Permalink to this heading">#</a></h1>
<section id="high-spin-states">
<h2>High spin states<a class="headerlink" href="#high-spin-states" title="Permalink to this heading">#</a></h2>
<section id="single-reference-methods">
<h3>Single-reference methods<a class="headerlink" href="#single-reference-methods" title="Permalink to this heading">#</a></h3>
<p>By a high-spin state, we refer to an open-shell system where all unpaired electrons are chosen to have <span class="math notranslate nohighlight">\(\alpha\)</span>-spin. As detailed in  section <a class="reference internal" href="../elec_struct/spin.html#sec-spin"><span class="std std-ref">Electron spin</span></a>, this case is particularly simple since the system can be described by a single Slater determinant.</p>
<p>There are two main ways to proceed:</p>
<ul class="simple">
<li><p>Keep the molecular orbitals of the <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> spin-orbitals identical but populating the <span class="math notranslate nohighlight">\(\alpha\)</span> spin-orbitals with more electrons. This is known as a restricted open-shell calculation.</p></li>
<li><p>Allow for different molecular orbitals for the <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> spin-orbitals. This is known as an unrestricted calculation.</p></li>
</ul>
<p>Let us illustrate these two approaches on the most important open-shell molecule on earth namely the oxygen molecule.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">multipsi</span> <span class="k">as</span> <span class="nn">mtp</span>
<span class="kn">import</span> <span class="nn">veloxchem</span> <span class="k">as</span> <span class="nn">vlx</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">au2kcal</span> <span class="o">=</span> <span class="mf">627.51</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">O   0.0  0.0  -0.6</span>
<span class="s2">O   0.0  0.0   0.6</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_molecule_string</span><span class="p">(</span><span class="n">mol_str</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;angstrom&quot;</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="s2">&quot;cc-pvdz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We determine the triplet ground state with the RODFT and UDFT approaches.</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span><span class="o">.</span><span class="n">set_multiplicity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">triplet_rodft_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedOpenDriver</span><span class="p">()</span>
<span class="n">triplet_rodft_drv</span><span class="o">.</span><span class="n">xcfun</span> <span class="o">=</span> <span class="s2">&quot;B3LYP&quot;</span>

<span class="n">triplet_rodft_results</span> <span class="o">=</span> <span class="n">triplet_rodft_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>

<span class="n">triplet_udft_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfUnrestrictedDriver</span><span class="p">()</span>
<span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">xcfun</span> <span class="o">=</span> <span class="s2">&quot;B3LYP&quot;</span>

<span class="n">triplet_udft_results</span> <span class="o">=</span> <span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Owing to the larger flexibility in the reference state, the UDFT energy is slightly lower than the RODFT one.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ROB3LYP energy: </span><span class="si">{</span><span class="n">triplet_rodft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; UB3LYP energy: </span><span class="si">{</span><span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ROB3LYP energy:  -150.33014560
 UB3LYP energy:  -150.33392791
</pre></div>
</div>
</div>
</div>
<p>In the RODFT case, we have one set of MOs with the first seven being doubly occupied and MOs eight and nine being singly occupied.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triplet_rodft_drv</span><span class="o">.</span><span class="n">molecular_orbitals</span><span class="o">.</span><span class="n">print_orbitals</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.78650 a.u.                                                                  
               (   1 O   2s  :    -0.36) (   1 O   3s  :    -0.46) (   2 O   2s  :     0.36)                              
               (   2 O   3s  :     0.46)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.52369 a.u.                                                                  
               (   1 O   3s  :     0.28) (   1 O   1p0 :    -0.47) (   1 O   2p0 :    -0.23)                              
               (   2 O   3s  :     0.28) (   2 O   1p0 :     0.47) (   2 O   2p0 :     0.23)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.50972 a.u.                                                                  
               (   1 O   1p+1:     0.43) (   1 O   2p+1:     0.26) (   2 O   1p+1:     0.43)                              
               (   2 O   2p+1:     0.26)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.50972 a.u.                                                                  
               (   1 O   1p-1:     0.43) (   1 O   2p-1:     0.26) (   2 O   1p-1:     0.43)                              
               (   2 O   2p-1:     0.26)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.20092 a.u.                                                                  
               (   1 O   1p+1:    -0.53) (   1 O   2p+1:    -0.39) (   2 O   1p+1:     0.53)                              
               (   2 O   2p+1:     0.39)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.20092 a.u.                                                                  
               (   1 O   1p-1:     0.53) (   1 O   2p-1:     0.39) (   2 O   1p-1:    -0.53)                              
               (   2 O   2p-1:    -0.39)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.23772 a.u.                                                                  
               (   1 O   2s  :     0.21) (   1 O   3s  :     1.06) (   1 O   1p0 :     0.50)                              
               (   1 O   2p0 :     1.00) (   2 O   2s  :    -0.21) (   2 O   3s  :    -1.06)                              
               (   2 O   1p0 :     0.50) (   2 O   2p0 :     1.00)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.79595 a.u.                                                                  
               (   1 O   3s  :     1.12) (   1 O   1p0 :    -0.65) (   1 O   2p0 :     1.46)                              
               (   2 O   3s  :    -1.12) (   2 O   1p0 :    -0.65) (   2 O   2p0 :     1.46)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.83473 a.u.                                                                  
               (   1 O   1p+1:     0.50) (   1 O   1p-1:     0.45) (   1 O   2p+1:    -0.46)                              
               (   1 O   2p-1:    -0.42) (   2 O   1p+1:     0.50) (   2 O   1p-1:     0.45)                              
               (   2 O   2p+1:    -0.46) (   2 O   2p-1:    -0.42)                                                        
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.83473 a.u.                                                                  
               (   1 O   1p+1:    -0.45) (   1 O   1p-1:     0.50) (   1 O   2p+1:     0.42)                              
               (   1 O   2p-1:    -0.46) (   2 O   1p+1:    -0.45) (   2 O   1p-1:     0.50)                              
               (   2 O   2p+1:     0.42) (   2 O   2p-1:    -0.46)                                                        
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>In the UDFT case, there are two different sets of MOs with nine occupied <span class="math notranslate nohighlight">\(\alpha\)</span>-spin orbitals and seven occupied <span class="math notranslate nohighlight">\(\beta\)</span>-spin orbitals.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">molecular_orbitals</span><span class="o">.</span><span class="n">print_orbitals</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                             Spin Unrestricted Alpha Orbitals                                             
                                             --------------------------------                                             
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.56129 a.u.                                                                  
               (   1 O   1p+1:     0.46) (   1 O   2p+1:     0.26) (   2 O   1p+1:     0.46)                              
               (   2 O   2p+1:     0.26)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.56129 a.u.                                                                  
               (   1 O   1p-1:    -0.46) (   1 O   2p-1:    -0.26) (   2 O   1p-1:    -0.46)                              
               (   2 O   2p-1:    -0.26)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.54325 a.u.                                                                  
               (   1 O   3s  :     0.28) (   1 O   1p0 :    -0.47) (   1 O   2p0 :    -0.22)                              
               (   2 O   3s  :     0.28) (   2 O   1p0 :     0.47) (   2 O   2p0 :     0.22)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.29937 a.u.                                                                  
               (   1 O   1p+1:    -0.52) (   1 O   2p+1:    -0.38) (   2 O   1p+1:     0.52)                              
               (   2 O   2p+1:     0.38)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.29937 a.u.                                                                  
               (   1 O   1p-1:    -0.52) (   1 O   2p-1:    -0.38) (   2 O   1p-1:     0.52)                              
               (   2 O   2p-1:     0.38)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.21614 a.u.                                                                  
               (   1 O   2s  :     0.21) (   1 O   3s  :     1.02) (   1 O   1p0 :     0.51)                              
               (   1 O   2p0 :     0.98) (   2 O   2s  :    -0.21) (   2 O   3s  :    -1.02)                              
               (   2 O   1p0 :     0.51) (   2 O   2p0 :     0.98)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.78644 a.u.                                                                  
               (   1 O   3s  :     1.11) (   1 O   1p0 :    -0.65) (   1 O   2p0 :     1.46)                              
               (   2 O   3s  :    -1.11) (   2 O   1p0 :    -0.65) (   2 O   2p0 :     1.46)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.80682 a.u.                                                                  
               (   1 O   1p+1:     0.45) (   1 O   1p-1:    -0.48) (   1 O   2p+1:    -0.43)                              
               (   1 O   2p-1:     0.46) (   2 O   1p+1:     0.45) (   2 O   1p-1:    -0.48)                              
               (   2 O   2p+1:    -0.43) (   2 O   2p-1:     0.46)                                                        
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.80682 a.u.                                                                  
               (   1 O   1p+1:    -0.48) (   1 O   1p-1:    -0.45) (   1 O   2p+1:     0.46)                              
               (   1 O   2p-1:     0.43) (   2 O   1p+1:    -0.48) (   2 O   1p-1:    -0.45)                              
               (   2 O   2p+1:     0.46) (   2 O   2p-1:     0.43)                                                        
                                                                                                                          
               Molecular Orbital No.  14:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.89114 a.u.                                                                  
               (   1 O   3s  :     0.33) (   1 O   1p0 :     0.58) (   1 O   2p0 :    -0.82)                              
               (   2 O   3s  :     0.33) (   2 O   1p0 :    -0.58) (   2 O   2p0 :     0.82)                              
                                                                                                                          
                                             Spin Unrestricted Beta Orbitals                                              
                                             -------------------------------                                              
                                                                                                                          
               Molecular Orbital No.   3:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -1.25526 a.u.                                                                  
               (   1 O   2s  :    -0.32) (   1 O   3s  :    -0.26) (   1 O   1p0 :    -0.19)                              
               (   2 O   2s  :    -0.32) (   2 O   3s  :    -0.26) (   2 O   1p0 :     0.19)                              
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.74211 a.u.                                                                  
               (   1 O   2s  :    -0.35) (   1 O   3s  :    -0.45) (   2 O   2s  :     0.35)                              
               (   2 O   3s  :     0.45)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.50336 a.u.                                                                  
               (   1 O   3s  :     0.29) (   1 O   1p0 :    -0.46) (   1 O   2p0 :    -0.23)                              
               (   2 O   3s  :     0.29) (   2 O   1p0 :     0.46) (   2 O   2p0 :     0.23)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.45864 a.u.                                                                  
               (   1 O   1p+1:     0.40) (   1 O   1p-1:     0.19) (   1 O   2p+1:     0.26)                              
               (   2 O   1p+1:     0.40) (   2 O   1p-1:     0.19) (   2 O   2p+1:     0.26)                              
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.45864 a.u.                                                                  
               (   1 O   1p+1:     0.19) (   1 O   1p-1:    -0.40) (   1 O   2p-1:    -0.26)                              
               (   2 O   1p+1:     0.19) (   2 O   1p-1:    -0.40) (   2 O   2p-1:    -0.26)                              
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.10410 a.u.                                                                  
               (   1 O   1p+1:     0.38) (   1 O   1p-1:     0.33) (   1 O   2p+1:     0.34)                              
               (   1 O   2p-1:     0.29) (   2 O   1p+1:    -0.38) (   2 O   1p-1:    -0.33)                              
               (   2 O   2p+1:    -0.34) (   2 O   2p-1:    -0.29)                                                        
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.10410 a.u.                                                                  
               (   1 O   1p+1:    -0.33) (   1 O   1p-1:     0.38) (   1 O   2p+1:    -0.29)                              
               (   1 O   2p-1:     0.34) (   2 O   1p+1:     0.33) (   2 O   1p-1:    -0.38)                              
               (   2 O   2p+1:     0.29) (   2 O   2p-1:    -0.34)                                                        
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.26034 a.u.                                                                  
               (   1 O   2s  :     0.21) (   1 O   3s  :     1.10) (   1 O   1p0 :     0.49)                              
               (   1 O   2p0 :     1.03) (   2 O   2s  :    -0.21) (   2 O   3s  :    -1.10)                              
               (   2 O   1p0 :     0.49) (   2 O   2p0 :     1.03)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.80590 a.u.                                                                  
               (   1 O   3s  :     1.12) (   1 O   1p0 :    -0.66) (   1 O   2p0 :     1.45)                              
               (   2 O   3s  :    -1.12) (   2 O   1p0 :    -0.66) (   2 O   2p0 :     1.45)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.86451 a.u.                                                                  
               (   1 O   1p+1:     0.60) (   1 O   1p-1:     0.33) (   1 O   2p+1:    -0.54)                              
               (   1 O   2p-1:    -0.30) (   2 O   1p+1:     0.60) (   2 O   1p-1:     0.33)                              
               (   2 O   2p+1:    -0.54) (   2 O   2p-1:    -0.30)                                                        
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>It is a common procedure to determine a Kohn–Sham DFT value estimating the expectation value of the  <a class="reference external" href="https://kthpanor.github.io/echem/docs/elec_struct/spin.html#many-electron-systems">total spin operator</a> in the same manner as would be the case for a Hartree–Fock wave function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the <a class="reference external" href="https://kthpanor.github.io/echem/docs/elec_struct/reduced_density.html#two-particle-density">two-particle density</a> is not directly available in DFT, the expectation value of a two-electron operator such as e.g. the total spin operator is also not available.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&lt;S^2&gt; RODFT = </span><span class="si">{</span><span class="n">triplet_rodft_drv</span><span class="o">.</span><span class="n">compute_s2</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="w"> </span><span class="n">triplet_rodft_results</span><span class="p">)</span><span class="w"> </span><span class="si">:</span><span class="s2"> 8.6f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&lt;S^2&gt; UDFT  = </span><span class="si">{</span><span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">compute_s2</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="w"> </span><span class="n">triplet_udft_results</span><span class="p">)</span><span class="w"> </span><span class="si">:</span><span class="s2"> 8.6f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;S^2&gt; RODFT =  2.000000
&lt;S^2&gt; UDFT  =  2.006227
</pre></div>
</div>
</div>
</div>
<p>The ground state of oxygen is a triplet with spin quantum number <span class="math notranslate nohighlight">\(S = 1\)</span> and</p>
<div class="math notranslate nohighlight">
\[
\langle \hat{S}^2 \rangle = S(S+1)\hbar^2 = 2 \hbar^2
\]</div>
<p>This is exactly what we get with a restricted open-shell description, but not in the unrestricted case. In general, an unrestricted state is not a eigenfunction of <span class="math notranslate nohighlight">\(\hat{S}^2\)</span> and one refers to this situation by saying that the state is spin contaminated.</p>
<p>The relative simplicity of the unrestricted scheme together with its rather good performance makes it more widely used than the restricted open-shell form.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The additional flexibility of unrestricted molecular orbitals does not lower the energy of <em>closed-shell</em> restricted states.</p>
</div>
</section>
<section id="multi-reference-methods">
<h3>Multi-reference methods<a class="headerlink" href="#multi-reference-methods" title="Permalink to this heading">#</a></h3>
<p>A multi-configurational method such as CASSCF can also be used and we note that a CASSCF wave function with only the high-spin open-shell MOs in the active space is equivalent to restricted open-shell Hartree–Fock (ROHF).</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triplet_rohf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedOpenDriver</span><span class="p">()</span>
<span class="n">triplet_rohf_results</span> <span class="o">=</span> <span class="n">triplet_rohf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>

<span class="c1"># By default, OrbSpace includes all open-shells in the active space</span>
<span class="n">space</span> <span class="o">=</span> <span class="n">mtp</span><span class="o">.</span><span class="n">OrbSpace</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">triplet_rohf_drv</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">)</span>
<span class="n">triplet_mcscf_drv</span> <span class="o">=</span> <span class="n">mtp</span><span class="o">.</span><span class="n">McscfDriver</span><span class="p">()</span>
<span class="n">mcscf_results</span> <span class="o">=</span> <span class="n">triplet_mcscf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       ROHF energy: </span><span class="si">{</span><span class="n">triplet_rohf_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CASSCF(2,2) energy: </span><span class="si">{</span><span class="n">triplet_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">()</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       ROHF energy:  -149.60946112
CASSCF(2,2) energy:  -149.60946112
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="low-spin-states">
<h2>Low spin states<a class="headerlink" href="#low-spin-states" title="Permalink to this heading">#</a></h2>
<section id="single-reference-methods-broken-symmetry">
<h3>Single-reference methods: broken symmetry<a class="headerlink" href="#single-reference-methods-broken-symmetry" title="Permalink to this heading">#</a></h3>
<p>To address low spin open-shell systems, we can study <a class="reference external" href="https://en.wikipedia.org/wiki/Singlet_oxygen">singlet states of the oxygen molecule</a>. The two lowest singlet states are <span class="math notranslate nohighlight">\(a^1\Delta_g\)</span> and <span class="math notranslate nohighlight">\(b^1\Sigma^+_g\)</span> and experimentally they are found to be 22.5 and 37.5 kcal/mol above the ground triplet state, <span class="math notranslate nohighlight">\(X^3\Sigma_g^-\)</span>, respectively.</p>
<p>Let us first compute the lowest closed-shell singlet state using DFT.</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span><span class="o">.</span><span class="n">set_multiplicity</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">singlet_rdft_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">xcfun</span> <span class="o">=</span> <span class="s2">&quot;B3LYP&quot;</span>
<span class="n">singlet_rdft_results</span> <span class="o">=</span> <span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(\pi\)</span>-orbitals in the closed-shell state are no longer doubly degenerate.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">molecular_orbitals</span><span class="o">.</span><span class="n">print_orbitals</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.79052 a.u.                                                                  
               (   1 O   2s  :    -0.36) (   1 O   3s  :    -0.46) (   2 O   2s  :     0.36)                              
               (   2 O   3s  :     0.46)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.52746 a.u.                                                                  
               (   1 O   3s  :     0.28) (   1 O   1p0 :    -0.47) (   1 O   2p0 :    -0.23)                              
               (   2 O   3s  :     0.28) (   2 O   1p0 :     0.47) (   2 O   2p0 :     0.23)                              
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.51773 a.u.                                                                  
               (   1 O   1p+1:     0.45) (   1 O   2p+1:     0.28) (   2 O   1p+1:     0.45)                              
               (   2 O   2p+1:     0.28)                                                                                  
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.50968 a.u.                                                                  
               (   1 O   1p-1:     0.46) (   1 O   2p-1:     0.27) (   2 O   1p-1:     0.46)                              
               (   2 O   2p-1:     0.27)                                                                                  
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.24089 a.u.                                                                  
               (   1 O   1p-1:     0.53) (   1 O   2p-1:     0.41) (   2 O   1p-1:    -0.53)                              
               (   2 O   2p-1:    -0.41)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:   -0.17013 a.u.                                                                  
               (   1 O   1p+1:    -0.52) (   1 O   2p+1:    -0.42) (   2 O   1p+1:     0.52)                              
               (   2 O   2p+1:     0.42)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.23373 a.u.                                                                  
               (   1 O   2s  :    -0.21) (   1 O   3s  :    -1.05) (   1 O   1p0 :    -0.50)                              
               (   1 O   2p0 :    -0.99) (   2 O   2s  :     0.21) (   2 O   3s  :     1.05)                              
               (   2 O   1p0 :    -0.50) (   2 O   2p0 :    -0.99)                                                        
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.79320 a.u.                                                                  
               (   1 O   3s  :     1.12) (   1 O   1p0 :    -0.65) (   1 O   2p0 :     1.46)                              
               (   2 O   3s  :    -1.12) (   2 O   1p0 :    -0.65) (   2 O   2p0 :     1.46)                              
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.82293 a.u.                                                                  
               (   1 O   1p+1:     0.67) (   1 O   2p+1:    -0.63) (   2 O   1p+1:     0.67)                              
               (   2 O   2p+1:    -0.63)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    0.84078 a.u.                                                                  
               (   1 O   1p-1:     0.67) (   1 O   2p-1:    -0.63) (   2 O   1p-1:     0.67)                              
               (   2 O   2p-1:    -0.63)                                                                                  
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closed-shell singlet relative to triplet ground state (in kcal/mol)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;    restricted triplet state: </span><span class="si">{</span><span class="p">(</span><span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">triplet_rodft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;  unrestricted triplet state: </span><span class="si">{</span><span class="p">(</span><span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Closed-shell singlet relative to triplet ground state (in kcal/mol)
    restricted triplet state:    36.92128398
  unrestricted triplet state:    39.29472211
</pre></div>
</div>
</div>
</div>
<p>These energies match reasonably well with the higher <span class="math notranslate nohighlight">\(b^1\Sigma^+_g\)</span> singlet state.</p>
<p>There are two different ways to reach the lower singlet using DFT. The first one is to compute the (negative) excitation energy using TD-DFT.</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rsp_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">TDAExciDriver</span><span class="p">()</span>
<span class="n">rsp_drv</span><span class="o">.</span><span class="n">update_settings</span><span class="p">({</span><span class="s2">&quot;nstates&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;xcfun&quot;</span><span class="p">:</span> <span class="s2">&quot;B3LYP&quot;</span><span class="p">})</span>
<span class="n">rsp_results</span> <span class="o">=</span> <span class="n">rsp_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">singlet_rdft_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exc_energy</span> <span class="o">=</span> <span class="n">rsp_results</span><span class="p">[</span><span class="s2">&quot;eigenvalues&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Excitation energy (in kcal/mol): </span><span class="si">{</span><span class="n">exc_energy</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Open-shell singlet energy relative to triplet ground state (in kcal/mol)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;    restricted triplet state: </span><span class="si">{</span><span class="p">(</span><span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exc_energy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">triplet_rodft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;  unrestricted triplet state: </span><span class="si">{</span><span class="p">(</span><span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exc_energy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Excitation energy (in kcal/mol):     -11.732361

Open-shell singlet energy relative to triplet ground state (in kcal/mol)
    restricted triplet state:    25.18892342
  unrestricted triplet state:    27.56236155
</pre></div>
</div>
</div>
</div>
<p>These energies is in better agreement with the lowest singlet state. We have here reached the open-shell singlet state by means of a TD-DFT calculation based on a closed-shell reference state that is higher in energy.</p>
<p>Let us instead compute the lower singlet state in a direct manner using unrestricted DFT.</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">singlet_udft_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfUnrestrictedDriver</span><span class="p">()</span>
<span class="n">singlet_udft_drv</span><span class="o">.</span><span class="n">xcfun</span> <span class="o">=</span> <span class="s2">&quot;B3LYP&quot;</span>
<span class="n">singlet_udft_result</span> <span class="o">=</span> <span class="n">singlet_udft_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RDFT singlet: </span><span class="si">{</span><span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;UDFT singlet: </span><span class="si">{</span><span class="n">singlet_udft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RDFT singlet:  -150.27130784
UDFT singlet:  -150.27130784
</pre></div>
</div>
</div>
</div>
<p>Since the closed-shell state represent a stable point, the UDFT solution will become identical.</p>
<p>In the absence of magnetic fields, there is no impetus for the MOs of the <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> spin-orbitals to differ and the SCF optimization gets stuck in a symmetric solution. In the high-spin case, on the other hand, this symmetry was broken by the fact that we had an excess of <span class="math notranslate nohighlight">\(\alpha\)</span>-spin electrons.</p>
<p>However, we can break the symmetry by introducing different starting occupations for the <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> spin-orbitals and remain in this region during the SCF optimization with the maximum-overlap method.</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A list of which orbitals are occupied in alpha and beta (starting from the triplet orbitals)</span>
<span class="n">a_occ</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">b_occ</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>

<span class="n">broken_udft_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfUnrestrictedDriver</span><span class="p">()</span>
<span class="n">broken_udft_drv</span><span class="o">.</span><span class="n">xcfun</span> <span class="o">=</span> <span class="s2">&quot;B3LYP&quot;</span>

<span class="n">broken_udft_drv</span><span class="o">.</span><span class="n">maximum_overlap</span><span class="p">(</span>
    <span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">triplet_rodft_drv</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">,</span> <span class="n">a_occ</span><span class="p">,</span> <span class="n">b_occ</span>
<span class="p">)</span>
<span class="n">broken_udft_results</span> <span class="o">=</span> <span class="n">broken_udft_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can look at the <a class="reference internal" href="../elec_struct/natural_orbitals.html"><span class="doc std std-doc">natural orbitals</span></a> and see that the state indeed corresponds to two singly occupied <span class="math notranslate nohighlight">\(\pi\)</span>-orbitals.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">natural_orbs</span> <span class="o">=</span> <span class="n">broken_udft_drv</span><span class="o">.</span><span class="n">natural_orbitals</span><span class="p">(</span><span class="n">broken_udft_results</span><span class="p">)</span>
<span class="n">natural_orbs</span><span class="o">.</span><span class="n">print_orbitals</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                          
                                                 Spin Restricted Orbitals                                                 
                                                 ------------------------                                                 
                                                                                                                          
               Molecular Orbital No.   4:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -1.01237 a.u.                                                                  
               (   1 O   2s  :    -0.32) (   1 O   3s  :    -0.38) (   2 O   2s  :    -0.32)                              
               (   2 O   3s  :    -0.38)                                                                                  
                                                                                                                          
               Molecular Orbital No.   5:                                                                                 
               --------------------------                                                                                 
               Occupation: 2.000 Energy:   -0.80124 a.u.                                                                  
               (   1 O   2s  :    -0.36) (   1 O   3s  :    -0.46) (   2 O   2s  :     0.36)                              
               (   2 O   3s  :     0.46)                                                                                  
                                                                                                                          
               Molecular Orbital No.   6:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.999 Energy:   -0.51076 a.u.                                                                  
               (   1 O   1p+1:     0.38) (   1 O   1p-1:     0.26) (   1 O   2p+1:     0.22)                              
               (   1 O   2p-1:     0.16) (   2 O   1p+1:     0.38) (   2 O   1p-1:     0.26)                              
               (   2 O   2p+1:     0.22) (   2 O   2p-1:     0.16)                                                        
                                                                                                                          
               Molecular Orbital No.   7:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.999 Energy:   -0.51076 a.u.                                                                  
               (   1 O   1p+1:    -0.26) (   1 O   1p-1:     0.38) (   1 O   2p+1:    -0.16)                              
               (   1 O   2p-1:     0.22) (   2 O   1p+1:    -0.26) (   2 O   1p-1:     0.38)                              
               (   2 O   2p+1:    -0.16) (   2 O   2p-1:     0.22)                                                        
                                                                                                                          
               Molecular Orbital No.   8:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.20217 a.u.                                                                  
               (   1 O   1p+1:    -0.54) (   1 O   2p+1:    -0.40) (   2 O   1p+1:     0.54)                              
               (   2 O   2p+1:     0.40)                                                                                  
                                                                                                                          
               Molecular Orbital No.   9:                                                                                 
               --------------------------                                                                                 
               Occupation: 1.000 Energy:   -0.20217 a.u.                                                                  
               (   1 O   1p-1:     0.54) (   1 O   2p-1:     0.40) (   2 O   1p-1:    -0.54)                              
               (   2 O   2p-1:    -0.40)                                                                                  
                                                                                                                          
               Molecular Orbital No.  10:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.001 Energy:    0.91738 a.u.                                                                  
               (   1 O   1p+1:    -0.67) (   1 O   2p+1:     0.60) (   2 O   1p+1:    -0.67)                              
               (   2 O   2p+1:     0.60)                                                                                  
                                                                                                                          
               Molecular Orbital No.  11:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.001 Energy:    0.91738 a.u.                                                                  
               (   1 O   1p-1:    -0.67) (   1 O   2p-1:     0.60) (   2 O   1p-1:    -0.67)                              
               (   2 O   2p-1:     0.60)                                                                                  
                                                                                                                          
               Molecular Orbital No.  12:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    2.65807 a.u.                                                                  
               (   1 O   1d+2:    -0.69) (   1 O   1d-2:    -0.23) (   2 O   1d+2:     0.69)                              
               (   2 O   1d-2:     0.23)                                                                                  
                                                                                                                          
               Molecular Orbital No.  13:                                                                                 
               --------------------------                                                                                 
               Occupation: 0.000 Energy:    2.34841 a.u.                                                                  
               (   1 O   1d+2:    -0.66) (   1 O   1d-2:    -0.22) (   2 O   1d+2:    -0.66)                              
               (   2 O   1d-2:    -0.22)                                                                                  
                                                                                                                          
</pre></div>
</div>
</div>
</div>
<p>The energy of this singlet relative to the triplet ground state becomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Broken symmetry singlet-triplet gap: </span><span class="si">{</span><span class="p">(</span><span class="n">broken_udft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 10.8</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Broken symmetry singlet-triplet gap:  10.308167
</pre></div>
</div>
</div>
</div>
<p>With this trick, we have thus found a lower energy singlet, albeit by introducing spin contamination.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&lt;S^2&gt; UDFT  = </span><span class="si">{</span><span class="n">broken_udft_drv</span><span class="o">.</span><span class="n">compute_s2</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span><span class="w"> </span><span class="n">broken_udft_results</span><span class="p">)</span><span class="w"> </span><span class="si">:</span><span class="s2"> 8.6f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;S^2&gt; UDFT  =  1.003282
</pre></div>
</div>
</div>
</div>
<p>We also note that the energy gap is now well below that of the experimental value. The reason is that, while high spin open-shells are single-determinant in nature, open-shell singlets and low-spin triplets are not.</p>
<p>A minimum of two determinant is needed for physically correct wave functions</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
| \Psi_\mathrm{S} \rangle &amp; = 
\frac{1}{\sqrt{2}} ( | \alpha \beta \rangle -| \beta \alpha \rangle ) \\
%
| \Psi_\mathrm{T} \rangle &amp; = 
\frac{1}{\sqrt{2}} ( | \alpha \beta \rangle +| \beta \alpha \rangle )
\end{align*}\]</div>
<p>Our single determinant reference state is seen to correspond to a 50/50 mix of the singlet and triplet wave functions as reflected in the spin contamination of the UDFT state.</p>
<p>True singlets and triplets have spin expectation values of <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(2 \hbar^2\)</span>, respectively, whereas we obtained a value close to <span class="math notranslate nohighlight">\(\hbar^2\)</span>.</p>
<p>However, knowing this fact, we can actually correct the energy. Since we know the energy of the triplet and of the broken-symmetry solution, we can estimate the energy of the true singlet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Estimated singlet-triplet gap: </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">broken_udft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">triplet_udft_drv</span><span class="o">.</span><span class="n">get_scf_energy</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 12.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated singlet-triplet gap:  20.61633352
</pre></div>
</div>
</div>
</div>
<p>This is now very close to the experimental energy of 22.5 kcal/mol.</p>
<p>Our technique to obtain the “true” singlet energy is a special case of the more general “weighted-averaged broken symmetry” (WABS) method, which can in principle correct any broken symmetry solution with knowledge of the high-spin energy and the expectation value of the total spin operator.</p>
</section>
<section id="multi-reference-solution">
<h3>Multi-reference solution<a class="headerlink" href="#multi-reference-solution" title="Permalink to this heading">#</a></h3>
<p>Arguably a multi-reference approach is simpler. For O<span class="math notranslate nohighlight">\(_2\)</span>, we create an active space with two electrons in two orbitals.</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">mtp</span><span class="o">.</span><span class="n">OrbSpace</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">)</span>
<span class="n">space</span><span class="o">.</span><span class="n">cas</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">singlet_mcscf_drv</span> <span class="o">=</span> <span class="n">mtp</span><span class="o">.</span><span class="n">McscfDriver</span><span class="p">()</span>
<span class="n">mcscf_results</span> <span class="o">=</span> <span class="n">singlet_mcscf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Lowest singlet relative energy: </span><span class="si">{</span><span class="p">(</span><span class="n">singlet_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">triplet_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lowest singlet relative energy:    29.69991700
</pre></div>
</div>
</div>
</div>
<p>The CASSCF automatically finds the open-shell to be the lowest state.</p>
<p>The CASSCF code in MultiPsi even allows to compute singlets and triplets simultaneously. We only need to deactivate the spin restriction that is applied by defaults to singlets and compute several states at the same time.</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">mtp</span><span class="o">.</span><span class="n">OrbSpace</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">singlet_rdft_drv</span><span class="o">.</span><span class="n">mol_orbs</span><span class="p">)</span>
<span class="n">space</span><span class="o">.</span><span class="n">spin_restricted</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">space</span><span class="o">.</span><span class="n">cas</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">all_mcscf_drv</span> <span class="o">=</span> <span class="n">mtp</span><span class="o">.</span><span class="n">McscfDriver</span><span class="p">()</span>
<span class="n">mcscf_results</span> <span class="o">=</span> <span class="n">all_mcscf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;First singlet relative energy : </span><span class="si">{</span><span class="p">(</span><span class="n">all_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">all_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;First singlet relative energy : </span><span class="si">{</span><span class="p">(</span><span class="n">all_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">all_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Second singlet relative energy: </span><span class="si">{</span><span class="p">(</span><span class="n">all_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">all_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First singlet relative energy :    29.55604878
First singlet relative energy :    29.55604878
Second singlet relative energy:    59.11209757
</pre></div>
</div>
</div>
</div>
<p>In a single calculation, the CASSCF finds the lowest triplet state and the two components of the doubly degenerate <span class="math notranslate nohighlight">\(a^1\Delta_g\)</span> state followed by a higher lying singlet.</p>
<p>The energies are not a great match with experiment due to the fact that a CASSCF calculation with so small an active space does not include correlation. A much better result is found by expanding the active space to include all atomic 2p orbitals.</p>
<div class="cell tag_output_scroll tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">space</span><span class="o">.</span><span class="n">cas</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">large_mcscf_drv</span> <span class="o">=</span> <span class="n">mtp</span><span class="o">.</span><span class="n">McscfDriver</span><span class="p">()</span>
<span class="n">mcscf_results</span> <span class="o">=</span> <span class="n">large_mcscf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;First singlet relative energy : </span><span class="si">{</span><span class="p">(</span><span class="n">large_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">large_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2">14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;First singlet relative energy : </span><span class="si">{</span><span class="p">(</span><span class="n">large_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">large_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Second singlet relative energy: </span><span class="si">{</span><span class="p">(</span><span class="n">large_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">large_mcscf_drv</span><span class="o">.</span><span class="n">get_energy</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">au2kcal</span><span class="w"> </span><span class="si">:</span><span class="s2"> 14.8f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First singlet relative energy :    21.00270944
First singlet relative energy :    21.00270944
Second singlet relative energy:    39.02176804
</pre></div>
</div>
</div>
</div>
<p>If we examine the CASSCF wave functions, we clearly see the multi-determinant nature of the states.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_mcscf_drv</span><span class="o">.</span><span class="n">CIVecs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wavefunction for state&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wavefunction for state
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1
Determinant     coef.    weight 
ab              0.707    0.500 
ba             -0.707    0.500 

Wavefunction for state 2
Determinant     coef.    weight 
20              0.475    0.225 
ab             -0.524    0.275 
ba             -0.524    0.275 
02             -0.475    0.225 

Wavefunction for state 3
Determinant     coef.    weight 
20             -0.524    0.275 
ab             -0.475    0.225 
ba             -0.475    0.225 
02              0.524    0.275 

Wavefunction for state 4
Determinant     coef.    weight 
20              0.707    0.500 
02              0.707    0.500 
</pre></div>
</div>
</div>
</div>
<p>The determinant notation lists the occupation of the two orbitals in order, with “0” meaning “empty”, “a” and “b” meaning respectively singly occupied with an <span class="math notranslate nohighlight">\(\alpha\)</span> or <span class="math notranslate nohighlight">\(\beta\)</span> electron, and “2” meaning doubly occupied. Clearly in this case, every single state in the calculation is an equal-weight superposition of two determinants.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="openshells.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Open shells</p>
      </div>
    </a>
    <a class="right-next"
       href="correlation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Static versus dynamic correlation correlation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-spin-states">High spin states</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-reference-methods">Single-reference methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-reference-methods">Multi-reference methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#low-spin-states">Low spin states</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-reference-methods-broken-symmetry">Single-reference methods: broken symmetry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-reference-solution">Multi-reference solution</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The eChem team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>