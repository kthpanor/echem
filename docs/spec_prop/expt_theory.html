
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Experiment to theory &#8212; Computational Chemistry from  Laptop to HPC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-TX4YJ1J5XE"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/spec_prop/expt_theory';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="UV/vis absorption" href="uv_vis.html" />
    <link rel="prev" title="Implementation" href="excoupl_impl.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../title.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Computational Chemistry from  Laptop to HPC - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Computational Chemistry from  Laptop to HPC - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro.html">Getting started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics_notebook.html">Using Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../units_notation.html">Units and notation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronic ground states</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/elstruct_gen.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/orbitals.html">Orbitals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/slater.html">Many-electron wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/operators.html">Operators and matrix elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/reduced_density.html">Reduced particle densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/natural_orbitals.html">Natural orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/spin.html">Electron spin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/correlation.html">Electron correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dispersion.html">Dispersion interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/pt.html">Rayleigh–Schrödinger perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/second_quant.html">Second quantization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/group_theory.html">Symmetry</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/wft.html">Wave function theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../elec_struct/hartree-fock.html">Hartree–Fock</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_theory.html">Hartree–Fock theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/fock_diagonalize.html">Fock matrix diagonalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_scf.html">SCF optimization</a></li>

<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_example.html">HF in VeloxChem</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mp2.html">Møller–Plesset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/ci.html">Configuration interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/wft_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/dft.html">Density functional theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/hohenberg.html">Hohenberg–Kohn theorems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kohn-sham.html">Kohn–Sham method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kernel_int.html">Kernel integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_scf.html">SCF optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_prop.html">First-order properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/available_xcfun.html">Available XC functionals</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/multiref.html">Multireference methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcscf.html">MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcpdft.html">MC-PDFT</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular structure and dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/molstruct_gen.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/coordinates.html">Choice of coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/symmetry.html">Molecular symmetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/tst.html">Transition-state theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_struct.html">Optimization methods</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/gradients.html">Gradients</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/energy_grad.html">Energy gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/property_grad.html">Property gradients</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/hessians_vib.html">Hessians and vibrations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/hessians.html">Molecular Hessians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/vibrations.html">Vibrational analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/opt.html">Structure optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_gs.html">Ground state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_constrained.html">Constrained coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/conformer.html">Conformer search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/tst_gen.html">Transition state</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/impes.html">PES interpolation techniques</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/impes_calc.html">Constructing the PES by interpolation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/md.html">Molecular dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/forcefields.html">Force fields</a></li>


<li class="toctree-l2"><a class="reference internal" href="../mol_struct/reparameterize.html">Reparameterize force fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/md_setup.html">Ensembles and time integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/md_run.html">Running a simulation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spectra and properties</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="spectra_aspects.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="resp_external.html">Responses to external fields</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="mol_prop.html">Molecular properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="first_order.html">First-order properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="linear_resp.html">Linear Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="quad_resp.html">Quadratic response</a></li>
<li class="toctree-l3"><a class="reference internal" href="cubic_resp.html">Cubic response</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="elec_nuc.html">Electronic and nuclear contributions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="rovib.html">Rovibronic states</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="dipole_equiv.html">Dipole equivalence relations</a></li>
<li class="toctree-l2"><a class="reference internal" href="finite_field.html">Finite field method</a></li>
<li class="toctree-l2"><a class="reference internal" href="nto.html">Natural transition orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="selection_rules.html">Selection rules</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="excoupl.html">Exciton coupling model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="excoupl_impl.html">Implementation</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Experiment to theory</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="uv_vis.html">UV/vis absorption</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="opa.html">One-photon absorption</a></li>
<li class="toctree-l3"><a class="reference internal" href="tpa.html">Two-photon absorption</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="optact.html">Optical activity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="ecd.html">Electronic Circular Dichroism</a></li>
<li class="toctree-l3"><a class="reference internal" href="or.html">Optical Rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tpcd.html">Two-photon circular dichroism</a></li>
<li class="toctree-l3"><a class="reference internal" href="tpor.html">Two-photon optical rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="more_optact.html">More birefringences &amp; dichroisms</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="wavefunction.html">Wave function methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="hf.html">Hartree–Fock</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="orb_rot.html">Orbital rotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="kappa_expansion.html">Time-dependence of observables</a></li>
<li class="toctree-l3"><a class="reference internal" href="orb_param_field.html">Field-dependence of parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="hf_param_energy.html">Energy determination of parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="hf_quasienergy.html">Quasi-energy determination of parameters</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="ci.html">Configuration interaction</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="adc.html">Algebraic-diagrammatic construction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="adc_pp.html">Polarization propagator</a></li>
<li class="toctree-l3"><a class="reference internal" href="adc_isr.html">Intermediate state representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="adc_cvs.html">Core-valence separation</a></li>
<li class="toctree-l3"><a class="reference internal" href="adc_hpc.html">HPC-QC implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="adc_exercises_new.html">Exercises</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tddft.html">Time-dependent DFT</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="tddft_foundation.html">Foundations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="tddft_quasienergy.html">Quasi-energy</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="tddft_linear_response.html">Linear response</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="tddft_lr_theory.html">Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="tddft_lr_implementation.html">Implementation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="tddft_excited_states.html">Excited states</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="tddft_rpa.html">RPA equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tddft_tda.html">Tamm–Dancoff approximation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tddft_cvs.html">Core-valence separation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tddft_triplet_inst.html">Triplet instability</a></li>
<li class="toctree-l3"><a class="reference internal" href="tddft_spin_flip.html">Spin-flip</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="tddft_charge_transfer.html">Charge transfer</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mr_response.html">Multireference methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="sa_mcscf.html">State-averaged MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="mclr.html">Linear response</a></li>
<li class="toctree-l2"><a class="reference internal" href="mr_exercises.html">Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/localprop.html">Localized properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/esp.html">ESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/chelpg.html">CHELPG charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/resp.html">RESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/loprop.html">LoProp charges and polarisabilities</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/embedding.html">Embedding potentials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../env/nonpol_emb.html">Non-polarizable embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/pol_emb.html">Polarizable embedding</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/mol_struct.html">Molecular structure and dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/struct_vis.html">Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/md_vis.html">MD trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/opt_vib_vis.html">Optimization and normal modes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/elec_struct.html">Electronic structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/orb_vis.html">Orbitals and densities</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/spec_prop.html">Spectra and properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/exc_vis.html">Excited states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/broadening.html">Spectrum broadening</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials and workflows</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/workflow.html">Constructing workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_build.html">Building systems</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_struct.html">Optimizing molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_scf.html">Optimizing electronic structure</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorials/wf_construct.html">Assembling a full workflow</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_methane.html">Methane combustion energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_gwp.html">Global warming potential</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_spectra.html">From structure to spectrum</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/uv_vis.html">UV/vis spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_absorption.html">Absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_fluorescence.html">Fluorescence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/vib_ir.html">Vibrational spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_calc.html">IR spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_raman.html">Raman spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/openshells.html">Open shells</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rest_unrest.html">Restricted versus unrestricted</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/correlation.html">Static versus dynamic correlation correlation</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/xray.html">X-ray spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_calc.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_analysis.html">Spectrum analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_aspects.html">Special aspects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_large.html">Larger systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_nonstandard.html">Non-standard calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_cheatsheet.html">Cheat sheet</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/colab.html">Google Colab notebooks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite and contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kthpanor/echem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/spec_prop/expt_theory.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/spec_prop/expt_theory.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Experiment to theory</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fields-and-polarization">Fields and polarization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-polarization">Linear polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#circular-polarization">Circular polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#field-strengths-and-intensities">Field strengths and intensities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#isotropic-molecular-orientation">Isotropic molecular orientation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#laboratory-and-molecular-frames">Laboratory and molecular frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotational-averages">Rotational averages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-averaging-of-higher-order-properties">Spatial averaging of higher-order properties</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#formulas-for-tensor-properties-of-rank-two-to-five">Formulas for tensor properties of rank two to five</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-application">Examples of application</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#electric-dipole-polarizability">Electric dipole polarizability</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#quadrupolar-contributions">Quadrupolar contributions</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-response">Linear response</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#quadratic-response">Quadratic response</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="experiment-to-theory">
<h1>Experiment to theory<a class="headerlink" href="#experiment-to-theory" title="Link to this heading">#</a></h1>
<section id="fields-and-polarization">
<h2>Fields and polarization<a class="headerlink" href="#fields-and-polarization" title="Link to this heading">#</a></h2>
<p>Experimental setups frequently use electromagnetic fields produced by lasers with control over wavelength and polarization. Such fields are purely solenoidal and perpendicular to the direction of propagation. We will here consider the case of a monochromatic light source and two common states of polarization namely linear and circular.</p>
<section id="linear-polarization">
<h3>Linear polarization<a class="headerlink" href="#linear-polarization" title="Link to this heading">#</a></h3>
<p>In a state of linear polarization, the electric field takes the form</p>
<div class="math notranslate nohighlight">
\[
  \mathbf{E}_\mathrm{lp} = E_0 
  \left(
  \cos\theta \, \mathbf{e}_X + \sin\theta \, \mathbf{e}_Y
  \right) \cos(k z - \omega t + \delta)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{k} = k \mathbf{e}_Z\)</span> is the wave vector pointing along the direction of propagation. The associated magnetic field is perpendicular to the electric field and given by</p>
<div class="math notranslate nohighlight">
\[
\mathbf{B}_\mathrm{lp} = \frac{E_0}{c} 
  \left(
  -\sin\theta \, \mathbf{e}_X + \cos\theta \, \mathbf{e}_Y
  \right) \cos(k z - \omega t + \delta)
\]</div>
<p>We note that the magnetic field strength is equal to that of that electric field divided by the speed of light. In atomic units with <span class="math notranslate nohighlight">\(c=137.036\)</span> a.u., the magnetic field is thus two orders of magnitude smaller than the electric field and depending on the spectroscopy at hand, it can often be ignored in calculations of induced dipole moments.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/linear_polarization.gif"><img alt="../../_images/linear_polarization.gif" src="../../_images/linear_polarization.gif" style="width: 266.0px; height: 170.1px;" /></a>
</figure>
<p>The electric and magnetic field vectors are traced in this illustration by the red and blue curves, respectively.</p>
</section>
<section id="circular-polarization">
<h3>Circular polarization<a class="headerlink" href="#circular-polarization" title="Link to this heading">#</a></h3>
<p>In a state of <a class="reference external" href="https://en.wikipedia.org/wiki/Circular_polarization">circular polarization</a>, the electric field takes the form</p>
<div class="math notranslate nohighlight">
\[
  \mathbf{E}_\mathrm{cp}(t) = E_0 
  \left(
  \cos\left(k Z -\omega t + \delta\right) \, \mathbf{e}_X
   -(-1)^{m}\sin\left(k Z - \omega t + \delta\right) \, \mathbf{e}_Y
   \right)
\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is an integer. At a certain instant in time, say for simplicity <span class="math notranslate nohighlight">\(t_0 = \delta / \omega\)</span>, the electric field with <span class="math notranslate nohighlight">\(m\)</span> being even equals</p>
<div class="math notranslate nohighlight">
\[
  \mathbf{E}_\mathrm{cp}(t_0) = E_0 
  \left(
  \cos k Z \, \mathbf{e}_X - \sin k Z \, \mathbf{e}_Y 
   \right)
\]</div>
<p>This field is illustrated in the figure below.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/elliptic_polarization.svg"><img alt="../../_images/elliptic_polarization.svg" src="../../_images/elliptic_polarization.svg" style="width: 415.5px; height: 112.55000000000001px;" /></a>
</figure>
<p>In this time frozen spatial view, this electric field forms a left-handed helix and we refer to this state of polarization as left circularly polarized light. If we instead time trace the electric field vector at a fixed point in space, say <span class="math notranslate nohighlight">\(Z =0\)</span>, it is seen to circle in an anti-clockwise direction when viewed in the direction of the source.</p>
</section>
<section id="field-strengths-and-intensities">
<h3>Field strengths and intensities<a class="headerlink" href="#field-strengths-and-intensities" title="Link to this heading">#</a></h3>
<p>For a monochromatic electromagnetic wave, the intensity relates to the electric field strength according to</p>
<div class="math notranslate nohighlight">
\[
I = \frac{1}{2} \varepsilon_0 c E_0^2
\]</div>
<p>The intensity depends not only on the laser at hand but also on the experimental setup. In a test bed for optical power limiting materials that depend critically on nonlinear absorption, a laser that delivered 1 mJ pulses of 10 ns duration was used. These pulses were focused to a spot size (or circle radius) of 100 <span class="math notranslate nohighlight">\(\mu\)</span>m. The associated intensity becomes</p>
<div class="math notranslate nohighlight">
\[
I = \frac{E_\mathsf{pulse}}{t_\mathsf{pulse} \cdot A_\mathsf{spot}} \approx
0.3\; \mathsf{GW/cm}^2.
\]</div>
<p>Combining these two equation, we are able to determine the electric field strength for this experimental setup that is designed for the characterization of molecular materials without causing (too frequent) damage. Still, on the atomic scale, this electric field is weak and in the order of <span class="math notranslate nohighlight">\(10^{-5}\)</span> a.u., which very much is the foundation for our approach of identifying molecular properties from perturbational field expansions of induced moments.</p>
</section>
</section>
<section id="isotropic-molecular-orientation">
<h2>Isotropic molecular orientation<a class="headerlink" href="#isotropic-molecular-orientation" title="Link to this heading">#</a></h2>
<p>When studying physical processes involving light–matter interactions, experiments are predominantly performed in the liquid phase. To connect theory to such experiments, it becomes necessary to take into account the random molecular orientation.</p>
<section id="laboratory-and-molecular-frames">
<h3>Laboratory and molecular frames<a class="headerlink" href="#laboratory-and-molecular-frames" title="Link to this heading">#</a></h3>
<p>Let us consider a laboratory frame that is space fixed with Cartesian axes <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span>, and <span class="math notranslate nohighlight">\(Z\)</span> and an arbitrarily oriented molecular frame with Cartesian axes <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span>. It is a common practice to relate these two frames of reference by means of a non-unique set of three <a class="reference external" href="https://en.wikipedia.org/wiki/Euler_angles">Euler angles</a>. We choose the elementary rotations to be intrinsic and referring to the axes sequence (<span class="math notranslate nohighlight">\(z\)</span>-<span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(z\)</span>). The associated proper Euler angles are denoted by <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\theta\)</span>, and <span class="math notranslate nohighlight">\(\psi\)</span> and they are illustrated in the figure below.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/euler_angles.svg"><img alt="../../_images/euler_angles.svg" src="../../_images/euler_angles.svg" style="width: 268.8px; height: 303.2px;" /></a>
</figure>
<p>The three unit vectors in the molecular frame relate to those in the laboratory frame according to</p>
<div class="math notranslate nohighlight">
\[\begin{split}
(\mathbf{e}_x, \mathbf{e}_y, \mathbf{e}_z) =
(\mathbf{e}_X, \mathbf{e}_Y, \mathbf{e}_Z) 
\begin{pmatrix}
c_\phi c_\psi - c_\theta s_\phi s_\psi &amp; - c_\psi s_\phi - c_\phi c_\theta s_\psi &amp; s_\theta s_\psi \\
c_\phi s_\psi + c_\theta c_\psi s_\phi &amp; c_\phi c_\theta c_\psi - s_\phi s_\psi &amp; - c_\psi s_\theta \\
s_\phi s_\theta &amp; c_\phi s_\theta &amp; c_\theta
\end{pmatrix}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(c_\phi\)</span> is short for <span class="math notranslate nohighlight">\(\cos \phi\)</span> and so on. The rotation matrix in the equation above is obtained from the three elemental rotation matrices</p>
<div class="math notranslate nohighlight">
\[
R = R_z(\psi) R_x(\theta) R_z(\phi)
\]</div>
<p>We note that the elements of this rotation matrix are equal to the cosine of the angles in between the unit vectors, or, in other words,</p>
<div class="math notranslate nohighlight">
\[
l_{i\lambda} = \mathbf{e}_i \cdot \mathbf{e}_\lambda
\]</div>
<p>with <span class="math notranslate nohighlight">\(i \in \{X,Y,Z\}\)</span> and <span class="math notranslate nohighlight">\(\lambda \in \{x,y,z\}\)</span>. These elements are known as directional cosines.</p>
<p>A molecular property such as the dipole moment is a first-rank tensor for which we readily obtain the following transformation relation</p>
<div class="math notranslate nohighlight">
\[
\mu_i = l_{i\lambda} \mu_\lambda
\]</div>
<p>where the Einstein summation convention has been adopted for the repeated index <span class="math notranslate nohighlight">\(\lambda\)</span>. The expression for the transformation of higher-order property tensors follow suit</p>
<div class="math notranslate nohighlight">
\[
P_{i_1 \cdots i_n} = l_{i_1 \lambda_1} \cdots l_{i_n \lambda_n} P_{\lambda_1 \cdots \lambda_n}
\]</div>
</section>
<section id="rotational-averages">
<h3>Rotational averages<a class="headerlink" href="#rotational-averages" title="Link to this heading">#</a></h3>
<p>In general, an expression for an observable <span class="math notranslate nohighlight">\(T\)</span> takes the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
T = A_{i_1 \cdots i_n} P_{i_1 \cdots i_n}
\end{equation*}\]</div>
<p>where the tensor <span class="math notranslate nohighlight">\(P_{i_1 \cdots i_n}\)</span> contains the response of a molecule subject to external fields under conditions represented by the tensor <span class="math notranslate nohighlight">\(A_{i_1 \cdots i_n}\)</span>. The tensor components are given in the space-fixed laboratory frame, typically with an orientation chosen such that the polarization information can be straightforwardly expressed in <span class="math notranslate nohighlight">\(A_{i_1 \cdots i_n}\)</span>.</p>
<p>For a randomly oriented molecular system, the a calculation of the observable requires the calculation of rotationally averaged products of the aforementioned direction cosines</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
I_{i_1 \cdots i_n ; \lambda_1 \cdots \lambda_n} = \frac{1}{8 \pi^2} \int_{0}^{2 \pi} \int_{0}^{\pi} \int_{0}^{2 \pi} l_{i_1 \lambda_1} \cdots l_{i_n \lambda_n} \sin \theta
 \, d\phi d\theta d\psi
\end{equation*}\]</div>
<p>Since integrals of first order <span class="math notranslate nohighlight">\(I_{i;\lambda}\)</span> are zero, the rotational averages of first-rank tensors (such as the dipole moment) vanish.</p>
<p>Induced moments, on the other hand, involve higher-order tensors that do not necessarily vanish upon rotational averaging. As an example, to linear order, the induced dipole moment in an electric field equals the product of the polarizability and the electric field, here assumed to be applied along the <span class="math notranslate nohighlight">\(Z\)</span>-axis in the laboratory frame,</p>
<div class="math notranslate nohighlight">
\[
\mu_Z = \alpha_{ZZ} E_Z 
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
\alpha_{ZZ} = I_{ZZ;\lambda_1 \lambda_2} \alpha_{\lambda_1 \lambda_2}
\]</div>
<p>The only  nonzero integrals are those where <span class="math notranslate nohighlight">\(\lambda_1 = \lambda_2\)</span> and one arrives at</p>
<div class="math notranslate nohighlight">
\[
\alpha_{ZZ} = \frac{1}{3}
\big(
\alpha_{xx} + \alpha_{yy} + \alpha_{zz}
\big)
\]</div>
</section>
<section id="spatial-averaging-of-higher-order-properties">
<h3>Spatial averaging of higher-order properties<a class="headerlink" href="#spatial-averaging-of-higher-order-properties" title="Link to this heading">#</a></h3>
<p>In the perturbative expansion of the electric dipole polarization - the expectation value of the induced electric dipole operator where nonvanishing permanent dipole is subtracted - one often encounters situations where the general expression of the molecular contribution to a particular term of the expansion takes the form</p>
<div class="math notranslate nohighlight">
\[
\sum_j 
\sum_k 
\cdots
\sum_l
\sum_m 
\frac{
(\mathbf{A}^{f j}  \cdot \mathbf{R}_{-\omega_\sigma})
(\mathbf{B}^{j k}  \cdot \mathbf{S}_{\omega_n})
\cdots 
(\mathbf{L}^{l m} \cdot \mathbf{W}_{\omega_2})
(\mathbf{M}^{m i} \cdot \mathbf{Z}_{\omega_1})
}{
\Delta (\omega_1, \omega_2, \cdots , +\omega_n, \omega_\sigma, \omega^{o p}) 
}
\]</div>
<p>The contribution of this term along the <span class="math notranslate nohighlight">\(\mathbf{e}_q\)</span> (<span class="math notranslate nohighlight">\(q=X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span> or <span class="math notranslate nohighlight">\(Z\)</span>) laboratory cartesian axe is then</p>
<div class="math notranslate nohighlight">
\[
\sum_j 
\sum_k 
\cdots
\sum_l
\sum_m 
\frac{
(\mathbf{A}^{f j}  \cdot \mathbf{e}_q)
(\mathbf{B}^{j k}  \cdot \mathbf{S}_{\omega_n})
\cdots 
(\mathbf{L}^{l m} \cdot \mathbf{W}_{\omega_2})
(\mathbf{M}^{m i} \cdot \mathbf{Z}_{\omega_1})
}{
\Delta (\omega_1, \omega_2, \cdots , +\omega_n, \omega_\sigma, \omega^{o p}) 
}
\]</div>
<p>Above <span class="math notranslate nohighlight">\(\Delta (\omega_1, \omega_2, \cdots , +\omega_n, \omega_\sigma, \omega^{o p})\)</span> is a general function involving <span class="math notranslate nohighlight">\(\omega^{o p}\)</span> - the collection of transition frequencies between states <span class="math notranslate nohighlight">\(o\)</span> and <span class="math notranslate nohighlight">\(p\)</span>,  <span class="math notranslate nohighlight">\(\omega_1, \cdots, \omega_n\)</span> - the angular frequencies of the radiation, and <span class="math notranslate nohighlight">\(\omega_\sigma = \omega_1+\cdots+\omega_n\)</span>. Summations run over all states of the molecule. Furthermore, <span class="math notranslate nohighlight">\(\mathbf{A}, \mathbf{B}, \cdots, \mathbf{M}\)</span> are operators such as <span class="math notranslate nohighlight">\(\hat{\boldsymbol{\mu}}\)</span> or <span class="math notranslate nohighlight">\(\hat{\mathbf{m}}\)</span>, yielding transition moments in the molecular frame, whereas <span class="math notranslate nohighlight">\(\mathbf{R}\)</span> is a scalar or - see above - a unit vector while <span class="math notranslate nohighlight">\(\mathbf{S}, \cdots, \mathbf{Z}\)</span> represent field quantities aligned with the laboratory frame. Usually the terms within brackets in  the numerator are elements of the multipolar expansion of the hamiltonian describing the interaction of the molecule with the electromagnetic interaction, for example</p>
<div class="math notranslate nohighlight">
\[
(\mathbf{B}^{j k}  \cdot \mathbf{S}^{\omega_n}) = (\boldsymbol{\mu}^{j k} \cdot \mathbf{E}^{\omega_n})  
\]</div>
<p>When the perturbation includes electromagnetic field gradients (i.e. tensorial physical quantities of rank two or more, as for instance terms like (<span class="math notranslate nohighlight">\(\hat{\mathbf{q}} : \boldsymbol{\nabla} \mathbf{E}\)</span>), the scalar product turns into general tensor contractions, f.ex.</p>
<div class="math notranslate nohighlight">
\[
(\mathbf{B}^{j k} \cdot \mathbf{S}^{\omega_n}) \rightarrow \mathbf{q}^{j k} : \boldsymbol{\nabla} \mathbf{E}^{\omega_n})  = \sum_\alpha \sum_\beta \mathbf{q}^{j k}_{\alpha \beta} \boldsymbol{\nabla}_\alpha \mathbf{E}_\beta^{\omega_n} \rightarrow [\boldsymbol{\mu} \cdot ( \boldsymbol{\mu} \cdot \boldsymbol{\nabla}) \mathbf{E}^{\omega_n}]^{j k} 
\]</div>
<p>ultimately involving combinations of unit vector representing the cartesian directions of the laboratory frame. Note that for sake of symplicity we use the traced form of the quadrupole <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> in place of the more popolar traceless form <span class="math notranslate nohighlight">\(\boldsymbol{\Theta}\)</span> throughout the rest of these notes, and that the second <span class="math notranslate nohighlight">\(\rightarrow\)</span> (in place of the equal sign) above highlights the existence of a an electron charge factor implied at the denominator.</p>
<p>As a  specific example of what we are going to discuss in this section, let’s concentrate on the perturbative expansion of the electric dipole polarization, a vector, in particular on the all electric dipole second order contribution <span class="math notranslate nohighlight">\(\boldsymbol{\mu}(\omega_\sigma,t)\)</span> describing the sum frequency generation process when two beams propagating in the same direction and of angular frequency <span class="math notranslate nohighlight">\(\omega_1\)</span> and <span class="math notranslate nohighlight">\(\omega_2\)</span> impinge into a molecular system. The structure of one of the six terms entering in the general case of different optical angular frequencies this contribution is</p>
<div class="math notranslate nohighlight">
\[
\sum_k 
\sum_l 
\frac{\boldsymbol{\mu}^{il}(\boldsymbol{\mu}^{l k} \cdot \mathbf{E}_{\omega_2})(\boldsymbol{\mu}^{k i} \cdot \mathbf{E}_{\omega_1})}
{\hbar^2 (\omega^{l i} + \omega_\sigma)(\omega^{k i} + \omega_1)}
\]</div>
<p>The other five terms are obtained by permuting optical frequencies <span class="math notranslate nohighlight">\(\omega_1, \omega_2, \omega_\sigma\)</span>. For our further discussion, only the numerators of the above equation are essential. Following the example of sum frequency generation, we concentrate on the numerator</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{\mu}^{i l} (\boldsymbol{\mu}^{l k} \cdot \mathbf{E}_{\omega_2}) (\boldsymbol{\mu}^{k i} \cdot \mathbf{E}_{\omega_1})
\]</div>
<p>The vectors representing field quantities are usually reduced to the product of a scalar field strength times linear (in general complex) combinations of the unit cartesian vectors defining the laboratory frame, see definitions given in the previous section. Indeed, the matrix elements of the electric dipole operator are fixed on the molecule whereas the radiation field vectors are defined in the frame of the laboratory. If the molecule is rigidly oriented with respect to the laboratory, we can choose to align its axes along the laboratory frame. Without loss of generality, in the particular case of linearly polarized fields propagating along the <span class="math notranslate nohighlight">\(Z\)</span> direction, we can then align the first field along the <span class="math notranslate nohighlight">\(X\)</span> direction, and the second on the <span class="math notranslate nohighlight">\(X,Y\)</span> plane. For this example, let’s choose as direction of polarization for the second field directly the <span class="math notranslate nohighlight">\(Y\)</span> axis. Then <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_1} = E_X^{\omega_1} \mathbf{e}_X\)</span> and <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_2} = E_Y^{\omega_2} \mathbf{e}_Y\)</span>, where the dependence on time and angular frequency is in the scalar field strengths <span class="math notranslate nohighlight">\(E_X^{\omega_1}\)</span> and <span class="math notranslate nohighlight">\(E_Y^{\omega_2}\)</span>. The contribution to the polarization vector along the <span class="math notranslate nohighlight">\(Z\)</span>-direction (i.e. <span class="math notranslate nohighlight">\(q=Z\)</span> above), restricting our focus on the numerator will then be of the form</p>
<div class="math notranslate nohighlight">
\[
{\mu}_Z^{i l} {\mu}^{l k}_X {\mu}^{k i}_Y E_Y^{\omega_2} E_X^{\omega_1}
\]</div>
<p>The general molecular property term therefore (restricting again to the numerator) takes the form</p>
<div class="math notranslate nohighlight">
\[
(\mathbf{A}  \cdot \mathbf{e}_{i_1})
(\mathbf{B}  \cdot \mathbf{e}_{i_2})
\cdots 
(\mathbf{M} \cdot \mathbf{e}_{i_n}) = A_{i_1} B_{i_2} \cdot M_{i_n}
\]</div>
<p>Under rotation this product transforms as a tensor with a rank equal to the number of dots enclosed within parentheses (left) or components (right). Therefore if <span class="math notranslate nohighlight">\(n=3\)</span> in the last equation, the product transforms as a tensor of rank three. If we swap f.ex. <span class="math notranslate nohighlight">\((\mathbf{B} \cdot \mathbf{e}_{i_2}) \rightarrow (\mathbf{q} : \mathbf{e}_{i_2}\mathbf{e}_{i_3})\)</span>, or equally <span class="math notranslate nohighlight">\( B_{i_2} \rightarrow B_{i_2 i_3}\)</span> then the product transforms as a tensor of rank four. The rotational averaging of such higher-rank Cartesian tensors has been treated in the literature by several authors, see e.g. <span id="id1">[<a class="reference internal" href="../refs.html#id5" title="Laurence D. Barron. Molecular Light Scattering and Optical Activity. Cambridge University Press, 2004. URL: https://doi.org/10.1017/CBO9780511535468.">Bar04</a>, <a class="reference internal" href="../refs.html#id33" title="Daniel Friese, Maarten Beerepoot, and Kenneth Ruud. Rotational averaging of multiphoton absorption cross sections. J. Chem. Phys., 141:204103, 2014. URL: https://doi.org/10.1063/1.4901563.">FBR14</a>]</span>. We follow here the approach taken by Wagnière <span id="id2">[<a class="reference internal" href="../refs.html#id124" title="Georges Wagniére. Optical activity of higher order in a medium of randomly oriented molecules. J. Chem. Phys., 77:2786, 1982. URL: https://doi.org/10.1063/1.444166.">Wagniere82a</a>, <a class="reference internal" href="../refs.html#id125" title="Georges Wagniére. The evaluation of three-dimensional rotational averages. J. Chem. Phys., 76:473, 1982. URL: https://doi.org/10.1063/1.442747.">Wagniere82b</a>]</span>. We indicate the isotropic average of the sequence <span class="math notranslate nohighlight">\(A_{i_1} B_{i_2} \cdots M_{i_n}\)</span> over the solid angle <span class="math notranslate nohighlight">\(\Omega\)</span> as <span class="math notranslate nohighlight">\(\langle A_{i_1} B_{i_2} \cdots M_{i_n} \rangle_\Omega\)</span>.</p>
<p>For sum frequency generation, performing the necessary integrals involving directional cosines introduced above one gets easily to the following expression</p>
<div class="math notranslate nohighlight">
\[
\langle \boldsymbol{\mu}^{il}(\boldsymbol{\mu}^{l k} \cdot \mathbf{E}^{\omega_2})(\boldsymbol{\mu}^{k i} \cdot \mathbf{E}^{\omega_1}) \rangle_\Omega = \frac{1}{6} \boldsymbol{\mu}^{il} \cdot (\boldsymbol{\mu}^{l k} \times \boldsymbol{\mu}^{k i})(\mathbf{E}^{\omega_2} \times \mathbf{E}^{\omega_1}) 
\]</div>
<p>yielding for the averaged second order contribution to the electric dipole polarization describing a generic sum frequency generation process the expression</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{6} \chi_{av}(-\omega_\sigma;\omega_2,\omega_1) (\mathbf{E}^{\omega_2} \times \mathbf{E}^{\omega_1}) 
\]</div>
<p>where (reintroducing the denominators, and gathering all terms obtained by permuting transition moments and associated angular frequencies)</p>
<div class="math notranslate nohighlight">
\[
\chi_{av}(-\omega_\sigma;\omega_2,\omega_1) =
P \sum_k 
\sum_l
\frac{
\boldsymbol{\mu}^{il} \cdot (\boldsymbol{\mu}^{l k} \times \boldsymbol{\mu}^{k i})
}{\hbar^2 (\omega^{l i} + \omega_\sigma)(\omega^{k i} + \omega_1)}
\]</div>
<p>We first notice that the averaging process decouples molecule fixed vectors/tensors from laboratory-fixed field quantities. Furthermore, the vector products determining the molecular response <span class="math notranslate nohighlight">\(\chi_{av}(-\omega_\sigma;\omega_2,\omega_1)\)</span> yield a nonvanishing pseudoscalar only for systems belonging to point groups where a center of inversion (or more rigorously an improper axis of rotation) is included in the symmetry group generator, e.g. in molecules exhibiting chirality. Equally important is the fact that the same pseudoscalar vanishes in all isotropic fluid media when <span class="math notranslate nohighlight">\(\omega_1=\omega_2\)</span> (optical second harmonic generation) and where it is nonvanishing, the corresponding induced polarization can in principle be detected only along the direction perpendicular to the plane containing the polarization directions of the two electric fields <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_2}\)</span>, directions that cannot coincide. All other contributions vanish. Thus the optical sum frequency generation response (due to the interaction of the molecules solely with the optical electric fields composing the impinging radiation) can be seen only in chiral fluid, with an experimental setup with crossed optical electric fields of different angular frequency and aligning the detector along the direction perpendicular to the plane defined by the polarization vectors (transversal). Below we will extend the analysis to the effects of quadrupolar (electric field gradients) interactions.</p>
<section id="formulas-for-tensor-properties-of-rank-two-to-five">
<h4>Formulas for tensor properties of rank two to five<a class="headerlink" href="#formulas-for-tensor-properties-of-rank-two-to-five" title="Link to this heading">#</a></h4>
<p>The procedure to obtain general formulae for rotational averages of tensors of any order is a straightforward, albeit increasingly mathematically intense as the order rises, generalization of that discussed above. The resulting compact expressions for tensors of rank from two to five are</p>
<p>Rank Two:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\langle(\mathbf{A}  \cdot \mathbf{N})
(\mathbf{B}  \cdot \mathbf{O}) \rangle_\Omega
 = \frac{1}{3} (\mathbf{A}  \cdot \mathbf{B})
(\mathbf{N}  \cdot \mathbf{O})
\end{equation*}\]</div>
<p>Rank Three:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\langle(\mathbf{A}  \cdot \mathbf{N})
(\mathbf{B}  \cdot \mathbf{O}) (\mathbf{C}  \cdot \mathbf{P}) \rangle_\Omega
 = \frac{1}{6} (\mathbf{A}  \cdot \mathbf{B} \times \mathbf{C} )
(\mathbf{N}  \cdot \mathbf{O} \times \mathbf{P})
\end{equation*}\]</div>
<p>Rank Four:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
&amp; &amp; 
\langle(\mathbf{A}  \cdot \mathbf{N})
(\mathbf{B}  \cdot \mathbf{O}) (\mathbf{C}  \cdot \mathbf{P}) (\mathbf{D}  \cdot \mathbf{Q}) \rangle_\Omega = \\
&amp; &amp; \Big [ \frac{2}{15} (\mathbf{A}  \cdot \mathbf{B}) (\mathbf{C} \cdot \mathbf{D}) -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{C}) (\mathbf{B} \cdot \mathbf{D}) -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{D}) (\mathbf{B} \cdot \mathbf{C}) \Big ] 
(\mathbf{M}  \cdot \mathbf{N}) (\mathbf{P} \cdot \mathbf{Q}) \\
&amp; &amp; \Big [ -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{B}) (\mathbf{C} \cdot \mathbf{D}) +\frac{2}{15} (\mathbf{A}  \cdot \mathbf{C}) (\mathbf{B} \cdot \mathbf{D}) -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{D}) (\mathbf{B} \cdot \mathbf{C}) \Big ] 
(\mathbf{M}  \cdot \mathbf{P}) (\mathbf{N} \cdot \mathbf{Q}) \\
&amp; &amp; \Big [ -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{B}) (\mathbf{C} \cdot \mathbf{D}) -\frac{1}{30} (\mathbf{A}  \cdot \mathbf{C}) (\mathbf{B} \cdot \mathbf{D}) +\frac{2}{15} (\mathbf{A}  \cdot \mathbf{D}) (\mathbf{B} \cdot \mathbf{C}) \Big ] 
(\mathbf{M}  \cdot \mathbf{Q}) (\mathbf{N} \cdot \mathbf{P})
\end{eqnarray*}\]</div>
<p>Rank Five</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
&amp; &amp; \langle(\mathbf{A}  \cdot \mathbf{N})
(\mathbf{B}  \cdot \mathbf{O}) (\mathbf{C}  \cdot \mathbf{P}) (\mathbf{D}  \cdot \mathbf{Q}) (\mathbf{E}  \cdot \mathbf{R})\rangle_\Omega
= \\
&amp; &amp; \frac{1}{30} \Big [ 
+(\mathbf{A}  \cdot \mathbf{B}) (\mathbf{C} \cdot \mathbf{D} \times \mathbf{E} )
(\mathbf{M}  \cdot \mathbf{N}) (\mathbf{P} \cdot \mathbf{Q} \times \mathbf{R} )
+ (\mathbf{A}  \cdot \mathbf{C}) (\mathbf{B} \cdot \mathbf{D} \times \mathbf{E} )
(\mathbf{M}  \cdot \mathbf{P}) (\mathbf{N} \cdot \mathbf{Q} \times \mathbf{R} ) \\
&amp; &amp; +(\mathbf{A}  \cdot \mathbf{D}) (\mathbf{B} \cdot \mathbf{C} \times \mathbf{E} )
(\mathbf{M}  \cdot \mathbf{Q}) (\mathbf{N} \cdot \mathbf{P} \times \mathbf{R} )
+ (\mathbf{A}  \cdot \mathbf{E}) (\mathbf{B} \cdot \mathbf{C} \times \mathbf{D} )
(\mathbf{M}  \cdot \mathbf{R}) (\mathbf{N} \cdot \mathbf{P} \times \mathbf{Q} ) \\
&amp; &amp; +(\mathbf{B}  \cdot \mathbf{C}) (\mathbf{A} \cdot \mathbf{D} \times \mathbf{E} )
(\mathbf{N}  \cdot \mathbf{P}) (\mathbf{M} \cdot \mathbf{Q} \times \mathbf{R} )
+ (\mathbf{B}  \cdot \mathbf{D}) (\mathbf{A} \cdot \mathbf{C} \times \mathbf{E} )
(\mathbf{N}  \cdot \mathbf{Q}) (\mathbf{M} \cdot \mathbf{P} \times \mathbf{R} ) \\
&amp; &amp; +(\mathbf{B}  \cdot \mathbf{E}) (\mathbf{A} \cdot \mathbf{C} \times \mathbf{D})(\mathbf{N}  \cdot \mathbf{R}) (\mathbf{M} \cdot \mathbf{P} \times \mathbf{Q}) +(\mathbf{C}  \cdot \mathbf{D}) (\mathbf{A} \cdot \mathbf{B} \times \mathbf{E})(\mathbf{P}  \cdot \mathbf{Q}) (\mathbf{M} \cdot \mathbf{N} \times \mathbf{R}) \\
&amp; &amp; +(\mathbf{C}  \cdot \mathbf{E}) (\mathbf{A} \cdot \mathbf{B} \times \mathbf{D})(\mathbf{P}  \cdot \mathbf{R}) (\mathbf{M} \cdot \mathbf{N} \times \mathbf{Q}) +(\mathbf{D}  \cdot \mathbf{E}) (\mathbf{A} \cdot \mathbf{B} \times \mathbf{C}) (\mathbf{Q}  \cdot \mathbf{R}) (\mathbf{M} \cdot \mathbf{N} \times \mathbf{P})  \Big ]
\end{eqnarray*}\]</div>
</section>
<section id="examples-of-application">
<h4>Examples of application<a class="headerlink" href="#examples-of-application" title="Link to this heading">#</a></h4>
<section id="electric-dipole-polarizability">
<h5>Electric dipole polarizability<a class="headerlink" href="#electric-dipole-polarizability" title="Link to this heading">#</a></h5>
<p>In the section above, the second equation (rank three) is a generalization of the results obtained in the application of the averaging process to the case of sum frequency generation. Let’s use the first equation, involving rank two tensors, and apply it to the case of the electric dipole polarizability <span class="math notranslate nohighlight">\(\alpha(-\omega;\omega)\)</span>, when <span class="math notranslate nohighlight">\(\mathbf{A} = \boldsymbol{\mu}^{ik}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{B} = \boldsymbol{\mu}^{ki}\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\langle \boldsymbol{\mu}^{il}
(\boldsymbol{\mu}^{li}  \cdot \mathbf{E}^{\omega}) \rangle_\Omega
 = \frac{1}{3} (\boldsymbol{\mu}^{il}  \cdot \boldsymbol{\mu}^{li})
\mathbf{E}^\omega
\]</div>
<p>or, turning to the linear optical electric dipole contribution to the induced dipole polarization</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\langle \boldsymbol{\mu}(\omega) \rangle_\Omega (t) &amp; = &amp;
\frac{1}{3} P \sum_l 
\frac{\boldsymbol{\mu}^{i l} \cdot \boldsymbol{\mu}^{l i}}
{\hbar (\omega^{l i} + \omega)} \mathbf{E}^\omega = \\ 
&amp; = &amp; \frac{1}{3} P \sum_l \frac{(\mu_{X}^{i l} \mu_{X}^{l i} + \mu_{Y}^{i l} \mu_{Y}^{l i} + \mu_{Z}^{i l} \mu_{Z}^{l i})} {\hbar (\omega^{l i} + \omega)} \mathbf{E}^\omega = \\
&amp; = &amp; \frac{1}{3} (\alpha_{XX} + \alpha_{YY} + \alpha_{ZZ}) \mathbf{E}^\omega = \\
&amp; = &amp; \alpha_{\mathrm{av}}(-\omega;\omega)  \mathbf{E}^\omega
\end{eqnarray*}\]</div>
<p>This coincides with the expression obtained above where we introduced the matter of rotational averages.</p>
</section>
<section id="quadrupolar-contributions">
<h5>Quadrupolar contributions<a class="headerlink" href="#quadrupolar-contributions" title="Link to this heading">#</a></h5>
<p>As a further useful example here, let’s discuss cases where terms like <span class="math notranslate nohighlight">\(\hat{\mathbf{q}} : \boldsymbol{\nabla} \mathbf{E}\)</span> appear in the averaging process.</p>
<section id="linear-response">
<h6>Linear response<a class="headerlink" href="#linear-response" title="Link to this heading">#</a></h6>
<p>We focus first on the simple example of the (vanishing) quadrupolar contribution to natural electronic circular dichroism (ECD), where terms like</p>
<div class="math notranslate nohighlight">
\[
(\boldsymbol{\mu}^{i l} \cdot \mathbf{E}^{\omega_1}) (\mathbf{q}^{l i} : \boldsymbol{\nabla} \mathbf{E}^{\omega_2}) \rightarrow (\boldsymbol{\mu}^{i l} \cdot \mathbf{E}^{\omega_1})[\mathbf{r} \cdot ( \mathbf{r} \cdot \boldsymbol{\nabla}) \mathbf{E}^{\omega_2}]^{l i}
\]</div>
<p>appear. The operator <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}\)</span> implies a differentiation applying only to the <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_2}\)</span> field vector(s) eventually appearing on the right. This is an important remark since in the process of the isotropic averaging the <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}\)</span> vector operator behaves as any other space-fixed vectors in the application of the rules given above for tensors of ranks from two to five and it moves in principle around in the corresponding expression. In our specific case, since the transformation is here that of a rank three tensor, we apply the same procedure seen above for sum frequency generation and write</p>
<div class="math notranslate nohighlight">
\[
\langle (\boldsymbol{\mu}^{i l} \cdot \mathbf{E}^{\omega_1})[\mathbf{r} \cdot ( \mathbf{r} \cdot \boldsymbol{\nabla}) \mathbf{E}^{\omega_2}]^{l i} \rangle_\Omega = \frac{1}{6} ( \boldsymbol{\mu}^{i l} \cdot [ \boldsymbol{\mu} \times \boldsymbol{\mu} ]^{l i})
(\mathbf{E}^{\omega_1} \cdot \boldsymbol{\nabla} \times \mathbf{E}^{\omega_2}) = 0
\]</div>
<p>The last equal sign stems directly from the structure of the <span class="math notranslate nohighlight">\(( \boldsymbol{\mu}^{i l} \cdot [ \boldsymbol{\mu} \times \boldsymbol{\mu}]^{l i})\)</span> product. The same applies to the contribution obtained permuting the two operator with associated angular frequencies.</p>
</section>
<section id="quadratic-response">
<h6>Quadratic response<a class="headerlink" href="#quadratic-response" title="Link to this heading">#</a></h6>
<p>Finally, let’s work out the expression of the spatially isotropically averaged contribution to the circularly difference effect in an optically active system for sum frequency generation due to the quadrupolar interaction. For instance, we concentrate on the term (one of the six arising from the permutation of operators and associated frequencies, and we assume this as understood when we write <span class="math notranslate nohighlight">\(\langle \mathbf{\mu}^{il} (\mathbf{q}^{lk} : \boldsymbol{\nabla} \mathbf{E}^{\omega_1})(\boldsymbol{\mu}^{ki} \cdot \mathbf{E}^{\omega_2}) \rangle_\Omega = \ldots \)</span>)</p>
<div class="math notranslate nohighlight">
\[
\langle \boldsymbol{\mu}^{il} (\mathbf{q}^{lk} : \boldsymbol{\nabla} \mathbf{E}^{\omega_1})(\boldsymbol{\mu}^{ki} \cdot \mathbf{E}^{\omega_2}) \rangle_\Omega =
\langle \boldsymbol{\mu}^{il} [\boldsymbol{\mu} \cdot ( \boldsymbol{\mu} \cdot \boldsymbol{\nabla}) \mathbf{E}^{\omega_1}]^{l k}(\boldsymbol{\mu}^{ki} \cdot \mathbf{E}^{\omega_2}) \rangle_\Omega
\]</div>
<p>This requires a rank four transformation which can be worked out setting in the appropriate equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\mathbf{A} \rightarrow \boldsymbol{\mu}^{il}; \mathbf{B} \rightarrow \boldsymbol{\mu}^{lk} &amp; ; &amp;  
\mathbf{C} \rightarrow \boldsymbol{\mu}^{lk}; \mathbf{D} \rightarrow \boldsymbol{\mu}^{ki} \\
\mathbf{M} \rightarrow 1 ({\mathrm{scalar}}); \mathbf{N} \rightarrow \boldsymbol{\nabla} &amp; ; &amp;  
\mathbf{P} \rightarrow \mathbf{E}^{\omega_1}; \mathbf{Q} \rightarrow \mathbf{E}^{\omega_2} \\
\end{eqnarray*}\]</div>
<p>Note that the vectors (rank one tensors) <span class="math notranslate nohighlight">\(\boldsymbol{\mu}\)</span> arising from the (rank two) tensor <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> both carry the indices <span class="math notranslate nohighlight">\(lk\)</span> and must be reassociated after the application of the averaging. In short, f.ex., a <span class="math notranslate nohighlight">\(\boldsymbol{\mu}^{lk} \cdot \boldsymbol{\mu}^{lk}\)</span> turns into</p>
<div class="math notranslate nohighlight">
\[
(\boldsymbol{\mu} \cdot \boldsymbol{\mu})^{lk} = (\boldsymbol{\mu}_X \boldsymbol{\mu}_X + \boldsymbol{\mu}_Y \boldsymbol{\mu}_Y + \boldsymbol{\mu}_Z \boldsymbol{\mu}_Z)^{lk} \rightarrow (\mathbf{q}_{XX}^{lk}+\mathbf{q}_{YY}^{lk} + \mathbf{q}_{ZZ}^{lk})
\]</div>
<p>whereas <span class="math notranslate nohighlight">\(\boldsymbol{\mu}^{lk} \boldsymbol{\mu}^{lk}\)</span> has to be rewritten as <span class="math notranslate nohighlight">\((\boldsymbol{\mu} \boldsymbol{\mu})^{lk} \rightarrow \mathbf{q}^{lk}\)</span>. One immediately sees that the resulting field arrangements are</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
(\mathbf{M} \cdot \mathbf{N})(\mathbf{P} \cdot \mathbf{Q}) &amp; \rightarrow &amp;
\boldsymbol{\nabla} ( \mathbf{E}^{\omega_1} \cdot \mathbf{E}^{\omega_2}) \\
%
(\mathbf{M}  \cdot \mathbf{P}) (\mathbf{N} \cdot \mathbf{Q}) &amp; \rightarrow &amp;
\mathbf{E}^{\omega_1} (\boldsymbol{\nabla} \cdot \mathbf{E}^{\omega_2}) &amp; \rightarrow &amp;
(\boldsymbol{\nabla} \cdot \mathbf{E}^{\omega_2}) \mathbf{E}^{\omega_1}  &amp; \rightarrow &amp;
(\mathbf{E}^{\omega_2} \cdot \boldsymbol{\nabla}) \mathbf{E}^{\omega_1} \\
%
(\mathbf{M}  \cdot \mathbf{Q})(\mathbf{N} \cdot \mathbf{P}) &amp; \rightarrow &amp;
\mathbf{E}^{\omega_2} (\boldsymbol{\nabla} \cdot \mathbf{E}^{\omega_1})
\end{align*}\]</div>
<p>where we have used the fact that the differentiation applies only to the <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_1}\)</span> field and it moves further to the right when it is in front of <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_2}\)</span>.</p>
<p>Let’s the concentrate on the molecular response conterpart (i.e. the arrangement of the <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{B}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> terms). From both the first and second row of the rank four formula given above the quantity associated to the sum of the <span class="math notranslate nohighlight">\(\boldsymbol{\nabla} ( \mathbf{E}^{\omega_1} \cdot \mathbf{E}^{\omega_2})\)</span> and <span class="math notranslate nohighlight">\((\mathbf{E}^{\omega_2} \cdot \boldsymbol{\nabla}) \mathbf{E}^{\omega_1}\)</span> field factors is seen to be</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
&amp; &amp; \frac{4}{30} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{lk})(\boldsymbol{\mu}^{lk} \cdot \boldsymbol{\mu}^{ki})
-\frac{1}{30} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{lk})(\boldsymbol{\mu}^{lk} \cdot \boldsymbol{\mu}^{ki})
-\frac{1}{30} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{ki})(\boldsymbol{\mu}^{lk} \cdot \boldsymbol{\mu}^{lk}) = \\
&amp; &amp; = \frac{1}{10} [\boldsymbol{\mu}^{il} \cdot (\boldsymbol{\mu} \boldsymbol{\mu})^{lk} \cdot \boldsymbol{\mu}^{ki}]
-\frac{1}{30} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{lk}) (\boldsymbol{\mu} \cdot \boldsymbol{\mu})^{lk}
\end{eqnarray*}\]</div>
<p>whereas from the third row we obtain for the quantity in front o the field factor <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_2} (\boldsymbol{\nabla} \cdot \mathbf{E}^{\omega_1})\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
&amp; &amp; -\frac{1}{30} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{lk})(\boldsymbol{\mu}^{lk} \cdot \boldsymbol{\mu}^{ki})
-\frac{1}{30} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{lk})(\boldsymbol{\mu}^{lk} \cdot \boldsymbol{\mu}^{ki})
+\frac{4}{30} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{ki})(\boldsymbol{\mu}^{lk} \cdot \boldsymbol{\mu}^{lk}) = \\
&amp; &amp; = -\frac{1}{15} [ \boldsymbol{\mu}^{il} \cdot (\boldsymbol{\mu} \boldsymbol{\mu})^{lk} \cdot \boldsymbol{\mu}^{ki} ]
+\frac{2}{15} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{lk})(\boldsymbol{\mu} \cdot \boldsymbol{\mu})^{lk}
\end{eqnarray*}\]</div>
<p>The final expression is therefore</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
&amp; &amp; \langle \boldsymbol{\mu}^{il} (\mathbf{q}^{lk} : \boldsymbol{\nabla} \mathbf{E}^{\omega_1})(\boldsymbol{\mu}^{ki} \cdot \mathbf{E}^{\omega_2}) \rangle_\Omega = \\
&amp; &amp; = \big[ \frac{1}{10} (\boldsymbol{\mu}^{il} \cdot \mathbf{q}^{lk} \cdot \boldsymbol{\mu}^{ki} )
- \frac{1}{30} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{lk})(\mathbf{q}_{XX}^{lk}+\mathbf{q}_{YY}^{lk}+\mathbf{q}_{ZZ}^{lk}) \big] [
\boldsymbol{\nabla} ( \mathbf{E}^{\omega_1} \cdot \mathbf{E}^{\omega_2}) + (\mathbf{E}^{\omega_2} \cdot \boldsymbol{\nabla}) \mathbf{E}^{\omega_1} ]+ \\
&amp; &amp; + \big[ -\frac{1}{15} (\boldsymbol{\mu}^{il} \cdot \mathbf{q}^{lk} \cdot \boldsymbol{\mu}^{ki})
+\frac{2}{15} (\boldsymbol{\mu}^{il} \cdot \boldsymbol{\mu}^{lk})(\mathbf{q}_{XX}^{lk}+\mathbf{q}_{YY}^{lk}+\mathbf{q}_{ZZ}^{lk}) \big] [\mathbf{E}^{\omega_2} (\boldsymbol{\nabla} \cdot \mathbf{E}^{\omega_1})]
\end{eqnarray*}\]</div>
<p>Once again, this is only one of the terms coming from permutations of operators and associated angular frequencies. Moreover, the process has contributions also for the term where the quadrupolar contribution is associated to the angular frequency <span class="math notranslate nohighlight">\(\omega_2\)</span>. Note in the last expression that the contribution coming from the field factor <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_2} (\boldsymbol{\nabla} \cdot \mathbf{E}^{\omega_1})\)</span>
vanishes due to the presence of the divergence of the electric field <span class="math notranslate nohighlight">\(\mathbf{E}^{\omega_1}\)</span>. The expression holds for all arrangement of the fields and for every choice of polarization, and again it yields an immediate information of how fields (mutual direction of propagation, choice of the circular frequencies and of their polarization) should be arranged in the experiment to allow detection of a given high order optical effect in freely rotating assemblies of absorbers.</p>
</section>
</section>
</section>
</section>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/spec_prop"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="excoupl_impl.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Implementation</p>
      </div>
    </a>
    <a class="right-next"
       href="uv_vis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">UV/vis absorption</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fields-and-polarization">Fields and polarization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-polarization">Linear polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#circular-polarization">Circular polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#field-strengths-and-intensities">Field strengths and intensities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#isotropic-molecular-orientation">Isotropic molecular orientation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#laboratory-and-molecular-frames">Laboratory and molecular frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotational-averages">Rotational averages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-averaging-of-higher-order-properties">Spatial averaging of higher-order properties</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#formulas-for-tensor-properties-of-rank-two-to-five">Formulas for tensor properties of rank two to five</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-application">Examples of application</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#electric-dipole-polarizability">Electric dipole polarizability</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#quadrupolar-contributions">Quadrupolar contributions</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-response">Linear response</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#quadratic-response">Quadratic response</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The eChem team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>