Traceback (most recent call last):
  File "/home/thomas/miniconda3/envs/echem/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/thomas/miniconda3/envs/echem/lib/python3.11/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/thomas/miniconda3/envs/echem/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/thomas/miniconda3/envs/echem/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/thomas/miniconda3/envs/echem/lib/python3.11/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/home/thomas/miniconda3/envs/echem/lib/python3.11/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/thomas/miniconda3/envs/echem/lib/python3.11/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
Energies = []

space = mtp.OrbSpace(H2O,H2O_orbs)
CIdrv = mtp.CIDriver()

for excitations in range(1,5):
    space.ci(excitations)    # Compute CIS, CISD, CISDT and CISDTQ
    ci_results = CIdrv.compute(H2O,basis,space)
    Energies.append(CIdrv.get_energy())

space.fci()   # Compute fullCI
ci_results = CIdrv.compute(H2O,basis,space)
E_FCI = CIdrv.get_energy()
------------------

----- stdout -----
                          Configuration Interaction Driver
                         ==================================
                                                                                                                          

          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 0
Number of active orbitals:              13
Number of virtual orbitals:             0

    This is a GASSCF wavefunction

         Cumulated   Min cumulated    Max cumulated 
 Space    orbitals      occupation       occupation
     1           5               9               10
     2          13              10               10


          CI expansion:
          -------------
Number of determinants:      41


        â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
        â”‚          Driver settings           â”‚
        â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
         Solved by explicit diagonalization
----- stdout -----
                                                                                                                          
        CI Iterations
        -------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm |   Time
     ----------------------------------------------------------
----- stdout -----
        1     -75.983338648     0.0e+00      2.4e-29   0:00:00
----- stdout -----
                                                                                                                          
** Convergence reached in 1 iterations
                                                                                                                          
        Final results
        -------------
                                                                                                                          
                                                                                                                          
* State 1
- Energy: -75.98333864834025
- S^2   : -0.00  (multiplicity = 1.0 )
- Natural orbitals
2.00000 2.00000 2.00000 2.00000 0.00000 -0.00000 -0.00000 -0.00000 -0.00000 0.00000 -0.00000 2.00000 0.00000
----- stdout -----
                          Configuration Interaction Driver
                         ==================================
                                                                                                                          

          Active space definition:
          ------------------------
Number of inactive (occupied) orbitals: 0
Number of active orbitals:              13
Number of virtual orbitals:             0

    This is a GASSCF wavefunction

         Cumulated   Min cumulated    Max cumulated 
 Space    orbitals      occupation       occupation
     1           5               8               10
     2          13              10               10


          CI expansion:
          -------------
Number of determinants:      1141


        â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
        â”‚          Driver settings           â”‚
        â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
          Max. iterations         : 40
          Initial diagonalization : 200
          Max subspace size       : 10
          Convergence thresholds:
            - Energy change       : 1e-08
            - Residual square norm: 1e-08
          Olsen step
----- stdout -----
                                                                                                                          
        CI Iterations
        -------------
                                                                                                                          
     Iter. | Average Energy | E. Change | Grad. Norm |   Time
     ----------------------------------------------------------
----- stdout -----
        1     -76.014423579     0.0e+00      3.9e-01   0:00:00
----- stdout -----
        2     -76.107798367    -9.3e-02      1.1e-02   0:00:00
----- stdout -----
        3     -76.112076800    -4.3e-03      3.1e-04   0:00:00
----- stdout -----
        4     -76.112174941    -9.8e-05      9.8e-06   0:00:00
----- stdout -----
        5     -76.112178184    -3.2e-06      2.5e-07   0:00:00
----- stdout -----
        6     -76.112178271    -8.7e-08      6.4e-09   0:00:00
----- stdout -----
        7     -76.112178273    -2.0e-09      1.5e-10   0:00:00
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mIndexError[0m                                Traceback (most recent call last)
Cell [0;32mIn[24], line 8[0m
[1;32m      6[0m [38;5;28;01mfor[39;00m excitations [38;5;129;01min[39;00m [38;5;28mrange[39m([38;5;241m1[39m,[38;5;241m5[39m):
[1;32m      7[0m     space[38;5;241m.[39mci(excitations)    [38;5;66;03m# Compute CIS, CISD, CISDT and CISDTQ[39;00m
[0;32m----> 8[0m     ci_results [38;5;241m=[39m [43mCIdrv[49m[38;5;241;43m.[39;49m[43mcompute[49m[43m([49m[43mH2O[49m[43m,[49m[43mbasis[49m[43m,[49m[43mspace[49m[43m)[49m
[1;32m      9[0m     Energies[38;5;241m.[39mappend(CIdrv[38;5;241m.[39mget_energy())
[1;32m     11[0m space[38;5;241m.[39mfci()   [38;5;66;03m# Compute fullCI[39;00m

File [0;32m~/miniconda3/envs/echem/lib/python3.11/site-packages/multipsi/CIDriver.py:482[0m, in [0;36mCIDriver.compute[0;34m(self, molecule, basis, orbital_space, n_states)[0m
[1;32m    479[0m result[[38;5;124m"[39m[38;5;124mci_vectors[39m[38;5;124m"[39m] [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mvecs
[1;32m    481[0m [38;5;28;01mif[39;00m doPrint:
[0;32m--> 482[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mprint_states[49m[43m([49m[43morbital_space[49m[43m,[49m[43m [49m[43mn_states[49m[43m,[49m[43m [49m[43mresult[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mostream[49m[43m)[49m
[1;32m    483[0m [38;5;28mself[39m[38;5;241m.[39mostream[38;5;241m.[39mflush()
[1;32m    485[0m [38;5;28;01mreturn[39;00m result

File [0;32m~/miniconda3/envs/echem/lib/python3.11/site-packages/multipsi/CIDriver.py:652[0m, in [0;36mCIDriver.print_states[0;34m(self, orbital_space, n_states, output_dict, ostream)[0m
[1;32m    650[0m k [38;5;241m=[39m [38;5;241m-[39m[38;5;241m2[39m
[1;32m    651[0m [38;5;28;01mwhile[39;00m tryind [38;5;129;01min[39;00m indices:
[0;32m--> 652[0m     tryind [38;5;241m=[39m [43mnp[49m[38;5;241;43m.[39;49m[43margsort[49m[43m([49m[43mmatrix[49m[43m[[49m[43mj[49m[43m][49m[43m)[49m[43m[[49m[43mk[49m[43m][49m
[1;32m    653[0m     k [38;5;241m-[39m[38;5;241m=[39m [38;5;241m1[39m
[1;32m    654[0m indices[38;5;241m.[39mappend(tryind)

[0;31mIndexError[0m: index -14 is out of bounds for axis 0 with size 13

