Traceback (most recent call last):
  File "/opt/miniconda3/envs/echem/lib/python3.7/site-packages/jupyter_cache/executors/utils.py", line 56, in single_nb_execution
    record_timing=False,
  File "/opt/miniconda3/envs/echem/lib/python3.7/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/miniconda3/envs/echem/lib/python3.7/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/miniconda3/envs/echem/lib/python3.7/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/miniconda3/envs/echem/lib/python3.7/asyncio/base_events.py", line 587, in run_until_complete
    return future.result()
  File "/opt/miniconda3/envs/echem/lib/python3.7/site-packages/nbclient/client.py", line 664, in async_execute
    cell, index, execution_count=self.code_cells_executed + 1
  File "/opt/miniconda3/envs/echem/lib/python3.7/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/miniconda3/envs/echem/lib/python3.7/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import copy
import adcc
import gator
import matplotlib.pyplot as plt
import numpy as np
import veloxchem as vlx
from matplotlib import gridspec

# QC software suites and functionalities
from pyscf import cc, gto, mp, scf
from scipy.interpolate import interp1d
from veloxchem.rsplinabscross import LinearAbsorptionCrossSection

# for vlx
silent_ostream = vlx.OutputStream(None)
from mpi4py import MPI
comm = MPI.COMM_WORLD

# au to eV conversion factor
au2ev = 27.211386


def lorentzian(x, y, xmin, xmax, xstep, gamma):
    """
    Lorentzian broadening function

    Call: xi,yi = lorentzian(energies, intensities, start energy,
                                    end energy, energy step, gamma)
    """
    xi = np.arange(xmin, xmax, xstep)
    yi = np.zeros(len(xi))
    for i in range(len(xi)):
        for k in range(len(x)):
            yi[i] = (
                yi[i]
                + y[k] * gamma / ((xi[i] - x[k]) ** 2 + (gamma / 2.0) ** 2) / np.pi
            )
    return xi, yi


def gaussian(x, y, xmin, xmax, xstep, sigma):
    """
    Gaussian broadening function

    Call: xi,yi = gaussian(energies, intensities, start energy, end energy, energy step, gamma)
    """
    xi = np.arange(xmin, xmax, xstep)
    yi = np.zeros(len(xi))
    for i in range(len(xi)):
        for k in range(len(y)):
            yi[i] = yi[i] + y[k] * np.e ** (-((xi[i] - x[k]) ** 2) / (2 * sigma ** 2))
    return xi, yi
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mOSError[0m                                   Traceback (most recent call last)
[0;32m/var/folders/ky/5h8mb6gs32nbvf3w8cyqwrhm0000gn/T/ipykernel_36421/628542218.py[0m in [0;36m<module>[0;34m[0m
[1;32m      8[0m [0;34m[0m[0m
[1;32m      9[0m [0;31m# QC software suites and functionalities[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 10[0;31m [0;32mfrom[0m [0mpyscf[0m [0;32mimport[0m [0mcc[0m[0;34m,[0m [0mgto[0m[0;34m,[0m [0mmp[0m[0;34m,[0m [0mscf[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     11[0m [0;32mfrom[0m [0mscipy[0m[0;34m.[0m[0minterpolate[0m [0;32mimport[0m [0minterp1d[0m[0;34m[0m[0;34m[0m[0m
[1;32m     12[0m [0;32mfrom[0m [0mveloxchem[0m[0;34m.[0m[0mrsplinabscross[0m [0;32mimport[0m [0mLinearAbsorptionCrossSection[0m[0;34m[0m[0;34m[0m[0m

[0;32m/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/__init__.py[0m in [0;36m<module>[0;34m[0m
[1;32m     60[0m [0;32mfrom[0m [0mpyscf[0m [0;32mimport[0m [0m__config__[0m[0;34m[0m[0;34m[0m[0m
[1;32m     61[0m [0;32mfrom[0m [0mpyscf[0m [0;32mimport[0m [0mlib[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 62[0;31m [0;32mfrom[0m [0mpyscf[0m [0;32mimport[0m [0mgto[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     63[0m [0;32mfrom[0m [0mpyscf[0m [0;32mimport[0m [0mscf[0m[0;34m[0m[0;34m[0m[0m
[1;32m     64[0m [0;32mfrom[0m [0mpyscf[0m [0;32mimport[0m [0mao2mo[0m[0;34m[0m[0;34m[0m[0m

[0;32m/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/gto/__init__.py[0m in [0;36m<module>[0;34m[0m
[1;32m     17[0m [0;31m#[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m     18[0m [0;34m[0m[0m
[0;32m---> 19[0;31m [0;32mfrom[0m [0mpyscf[0m[0;34m.[0m[0mgto[0m [0;32mimport[0m [0mmole[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     20[0m [0;32mfrom[0m [0mpyscf[0m[0;34m.[0m[0mgto[0m [0;32mimport[0m [0mbasis[0m[0;34m[0m[0;34m[0m[0m
[1;32m     21[0m [0;32mfrom[0m [0mpyscf[0m[0;34m.[0m[0mgto[0m[0;34m.[0m[0mbasis[0m [0;32mimport[0m [0mparse[0m[0;34m,[0m [0mload[0m[0;34m,[0m [0mparse_ecp[0m[0;34m,[0m [0mload_ecp[0m[0;34m[0m[0;34m[0m[0m

[0;32m/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/gto/mole.py[0m in [0;36m<module>[0;34m[0m
[1;32m     35[0m [0;32mfrom[0m [0mpyscf[0m[0;34m.[0m[0mgto[0m [0;32mimport[0m [0mcmd_args[0m[0;34m[0m[0;34m[0m[0m
[1;32m     36[0m [0;32mfrom[0m [0mpyscf[0m[0;34m.[0m[0mgto[0m [0;32mimport[0m [0mbasis[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 37[0;31m [0;32mfrom[0m [0mpyscf[0m[0;34m.[0m[0mgto[0m [0;32mimport[0m [0mmoleintor[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     38[0m [0;32mfrom[0m [0mpyscf[0m[0;34m.[0m[0mgto[0m[0;34m.[0m[0meval_gto[0m [0;32mimport[0m [0meval_gto[0m[0;34m[0m[0;34m[0m[0m
[1;32m     39[0m [0;32mfrom[0m [0mpyscf[0m[0;34m.[0m[0mgto[0m [0;32mimport[0m [0mecp[0m[0;34m[0m[0;34m[0m[0m

[0;32m/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/gto/moleintor.py[0m in [0;36m<module>[0;34m[0m
[1;32m     27[0m [0;32mfrom[0m [0mpyscf[0m [0;32mimport[0m [0mlib[0m[0;34m[0m[0;34m[0m[0m
[1;32m     28[0m [0;34m[0m[0m
[0;32m---> 29[0;31m [0mlibcgto[0m [0;34m=[0m [0mlib[0m[0;34m.[0m[0mload_library[0m[0;34m([0m[0;34m'libcgto'[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     30[0m [0;34m[0m[0m
[1;32m     31[0m [0mANG_OF[0m     [0;34m=[0m [0;36m1[0m[0;34m[0m[0;34m[0m[0m

[0;32m/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/misc.py[0m in [0;36mload_library[0;34m(libname)[0m
[1;32m     58[0m             [0;32mraise[0m [0mOSError[0m[0;34m([0m[0;34m'Unknown platform'[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m     59[0m         [0mlibname_so[0m [0;34m=[0m [0mlibname[0m [0;34m+[0m [0mso_ext[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 60[0;31m         [0;32mreturn[0m [0mctypes[0m[0;34m.[0m[0mCDLL[0m[0;34m([0m[0mos[0m[0;34m.[0m[0mpath[0m[0;34m.[0m[0mjoin[0m[0;34m([0m[0mos[0m[0;34m.[0m[0mpath[0m[0;34m.[0m[0mdirname[0m[0;34m([0m[0m__file__[0m[0;34m)[0m[0;34m,[0m [0mlibname_so[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     61[0m     [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m     62[0m         [0m_loaderpath[0m [0;34m=[0m [0mos[0m[0;34m.[0m[0mpath[0m[0;34m.[0m[0mdirname[0m[0;34m([0m[0m__file__[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m/opt/miniconda3/envs/echem/lib/python3.7/ctypes/__init__.py[0m in [0;36m__init__[0;34m(self, name, mode, handle, use_errno, use_last_error)[0m
[1;32m    362[0m [0;34m[0m[0m
[1;32m    363[0m         [0;32mif[0m [0mhandle[0m [0;32mis[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 364[0;31m             [0mself[0m[0;34m.[0m[0m_handle[0m [0;34m=[0m [0m_dlopen[0m[0;34m([0m[0mself[0m[0;34m.[0m[0m_name[0m[0;34m,[0m [0mmode[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    365[0m         [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    366[0m             [0mself[0m[0;34m.[0m[0m_handle[0m [0;34m=[0m [0mhandle[0m[0;34m[0m[0;34m[0m[0m

[0;31mOSError[0m: dlopen(/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/libcgto.dylib, 0x0006): Library not loaded: '@rpath/libcint.3.0.13.dylib'
  Referenced from: '/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/libcgto.dylib'
  Reason: tried: '/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/../../../../libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/../../../../libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/python3.7/lib-dynload/../../libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/bin/../lib/libcint.3.0.13.dylib' (no such file), '/usr/local/lib/libcint.3.0.13.dylib' (no such file), '/usr/lib/libcint.3.0.13.dylib' (no such file)
OSError: dlopen(/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/libcgto.dylib, 0x0006): Library not loaded: '@rpath/libcint.3.0.13.dylib'
  Referenced from: '/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/libcgto.dylib'
  Reason: tried: '/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/../../../../libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/python3.7/site-packages/pyscf/lib/../../../../libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/python3.7/lib-dynload/../../libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/lib/libcint.3.0.13.dylib' (no such file), '/opt/miniconda3/envs/echem/bin/../lib/libcint.3.0.13.dylib' (no such file), '/usr/local/lib/libcint.3.0.13.dylib' (no such file), '/usr/lib/libcint.3.0.13.dylib' (no such file)

