Traceback (most recent call last):
  File "/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/anaconda3/envs/echem_test/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# We choose the pi orbitals + the C=O and N lone pair => indices 26 28 29 30 31 32 33 34 36 41
# We can skip the pointless OH lone pair (23) to reduce things a bit
space=mtp.OrbSpace(molecule,"hina-cas.h5")
mcscfdrv = mtp.McscfDriver()
mcscfdrv.compute(molecule,basis,space,4) # 1 ground state + 3 excited states

SI=mtp.InterState()
sa_mcscf_results = SI.diposc(molecule,basis,mcscfdrv.CIVecs)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn [9], line 5[0m
[1;32m      3[0m space[38;5;241m=[39mmtp[38;5;241m.[39mOrbSpace(molecule,[38;5;124m"[39m[38;5;124mhina-cas.h5[39m[38;5;124m"[39m)
[1;32m      4[0m mcscfdrv [38;5;241m=[39m mtp[38;5;241m.[39mMcscfDriver()
[0;32m----> 5[0m [43mmcscfdrv[49m[38;5;241;43m.[39;49m[43mcompute[49m[43m([49m[43mmolecule[49m[43m,[49m[43mbasis[49m[43m,[49m[43mspace[49m[43m,[49m[38;5;241;43m4[39;49m[43m)[49m [38;5;66;03m# 1 ground state + 3 excited states[39;00m
[1;32m      7[0m SI[38;5;241m=[39mmtp[38;5;241m.[39mInterState()
[1;32m      8[0m sa_mcscf_results [38;5;241m=[39m SI[38;5;241m.[39mdiposc(molecule,basis,mcscfdrv[38;5;241m.[39mCIVecs)

File [0;32m/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/multipsi/McscfDriver.py:136[0m, in [0;36mMcscfDriver.compute[0;34m(self, molecule, basis, molspace, nstates, weights)[0m
[1;32m    134[0m     [38;5;28mself[39m[38;5;241m.[39mS [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    135[0m [38;5;28mself[39m[38;5;241m.[39mS [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcomm[38;5;241m.[39mbcast([38;5;28mself[39m[38;5;241m.[39mS, root[38;5;241m=[39m[38;5;241m0[39m)
[0;32m--> 136[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmolspace[49m[38;5;241;43m.[39;49m[43morthonormalize[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mS[49m[43m)[49m
[1;32m    138[0m [38;5;66;03m# Initialize the integrals[39;00m
[1;32m    139[0m intdriver [38;5;241m=[39m Integrals([38;5;28mself[39m[38;5;241m.[39mcomm)

File [0;32m/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/multipsi/OrbSpace.py:679[0m, in [0;36mOrbSpace.orthonormalize[0;34m(self, S)[0m
[1;32m    677[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mrank [38;5;241m==[39m [38;5;241m0[39m:
[1;32m    678[0m     mo [38;5;241m=[39m inporb[38;5;241m.[39malpha_to_numpy()
[0;32m--> 679[0m     newmo [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgs_ortho[49m[43m([49m[43mmo[49m[43m,[49m[43mS[49m[43m)[49m
[1;32m    680[0m     ene [38;5;241m=[39m inporb[38;5;241m.[39mea_to_numpy()
[1;32m    681[0m     occ [38;5;241m=[39m inporb[38;5;241m.[39mocca_to_numpy()

File [0;32m/opt/anaconda3/envs/echem_test/lib/python3.9/site-packages/multipsi/OrbSpace.py:693[0m, in [0;36mOrbSpace.gs_ortho[0;34m(self, mo, S)[0m
[1;32m    689[0m [38;5;124;03m"""[39;00m
[1;32m    690[0m [38;5;124;03mOrthonormalize the starting basis using Gram-Schmidt orthonormalization[39;00m
[1;32m    691[0m [38;5;124;03m"""[39;00m
[1;32m    692[0m moT [38;5;241m=[39m np[38;5;241m.[39mtranspose(mo)
[0;32m--> 693[0m Spq [38;5;241m=[39m np[38;5;241m.[39mmatmul([43mnp[49m[38;5;241;43m.[39;49m[43mmatmul[49m[43m([49m[43mmoT[49m[43m,[49m[43m [49m[43mS[49m[43m)[49m, mo)
[1;32m    695[0m N [38;5;241m=[39m Spq[38;5;241m.[39mshape[[38;5;241m0[39m]
[1;32m    696[0m Orth [38;5;241m=[39m np[38;5;241m.[39mzeros((N, N))

[0;31mValueError[0m: matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)->(n?,m?) (size 80 is different from 91)
ValueError: matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)->(n?,m?) (size 80 is different from 91)

